var SB=Object.defineProperty;var AB=(t,e,n)=>e in t?SB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var J=(t,e,n)=>AB(t,typeof e!="symbol"?e+"":e,n);function Aw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function s_(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var i_={exports:{}},eg={},o_={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kh=Symbol.for("react.element"),EB=Symbol.for("react.portal"),CB=Symbol.for("react.fragment"),NB=Symbol.for("react.strict_mode"),TB=Symbol.for("react.profiler"),_B=Symbol.for("react.provider"),IB=Symbol.for("react.context"),kB=Symbol.for("react.forward_ref"),RB=Symbol.for("react.suspense"),PB=Symbol.for("react.memo"),OB=Symbol.for("react.lazy"),RA=Symbol.iterator;function DB(t){return t===null||typeof t!="object"?null:(t=RA&&t[RA]||t["@@iterator"],typeof t=="function"?t:null)}var a_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u_=Object.assign,l_={};function dd(t,e,n){this.props=t,this.context=e,this.refs=l_,this.updater=n||a_}dd.prototype.isReactComponent={};dd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};dd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c_(){}c_.prototype=dd.prototype;function Ew(t,e,n){this.props=t,this.context=e,this.refs=l_,this.updater=n||a_}var Cw=Ew.prototype=new c_;Cw.constructor=Ew;u_(Cw,dd.prototype);Cw.isPureReactComponent=!0;var PA=Array.isArray,d_=Object.prototype.hasOwnProperty,Nw={current:null},f_={key:!0,ref:!0,__self:!0,__source:!0};function h_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)d_.call(e,r)&&!f_.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var u=Array(a),l=0;l<a;l++)u[l]=arguments[l+2];s.children=u}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:kh,type:t,key:i,ref:o,props:s,_owner:Nw.current}}function LB(t,e){return{$$typeof:kh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Tw(t){return typeof t=="object"&&t!==null&&t.$$typeof===kh}function FB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var OA=/\/+/g;function W1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?FB(""+t.key):e.toString(36)}function mm(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case kh:case EB:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+W1(o,0):r,PA(s)?(n="",t!=null&&(n=t.replace(OA,"$&/")+"/"),mm(s,e,n,"",function(l){return l})):s!=null&&(Tw(s)&&(s=LB(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(OA,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",PA(t))for(var a=0;a<t.length;a++){i=t[a];var u=r+W1(i,a);o+=mm(i,e,n,u,s)}else if(u=DB(t),typeof u=="function")for(t=u.call(t),a=0;!(i=t.next()).done;)i=i.value,u=r+W1(i,a++),o+=mm(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xp(t,e,n){if(t==null)return t;var r=[],s=0;return mm(t,r,"","",function(i){return e.call(n,i,s++)}),r}function $B(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ir={current:null},gm={transition:null},BB={ReactCurrentDispatcher:Ir,ReactCurrentBatchConfig:gm,ReactCurrentOwner:Nw};function p_(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:xp,forEach:function(t,e,n){xp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xp(t,function(){e++}),e},toArray:function(t){return xp(t,function(e){return e})||[]},only:function(t){if(!Tw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Qe.Component=dd;Qe.Fragment=CB;Qe.Profiler=TB;Qe.PureComponent=Ew;Qe.StrictMode=NB;Qe.Suspense=RB;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BB;Qe.act=p_;Qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=u_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Nw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(u in e)d_.call(e,u)&&!f_.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var l=0;l<u;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:kh,type:t.type,key:s,ref:i,props:r,_owner:o}};Qe.createContext=function(t){return t={$$typeof:IB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_B,_context:t},t.Consumer=t};Qe.createElement=h_;Qe.createFactory=function(t){var e=h_.bind(null,t);return e.type=t,e};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(t){return{$$typeof:kB,render:t}};Qe.isValidElement=Tw;Qe.lazy=function(t){return{$$typeof:OB,_payload:{_status:-1,_result:t},_init:$B}};Qe.memo=function(t,e){return{$$typeof:PB,type:t,compare:e===void 0?null:e}};Qe.startTransition=function(t){var e=gm.transition;gm.transition={};try{t()}finally{gm.transition=e}};Qe.unstable_act=p_;Qe.useCallback=function(t,e){return Ir.current.useCallback(t,e)};Qe.useContext=function(t){return Ir.current.useContext(t)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(t){return Ir.current.useDeferredValue(t)};Qe.useEffect=function(t,e){return Ir.current.useEffect(t,e)};Qe.useId=function(){return Ir.current.useId()};Qe.useImperativeHandle=function(t,e,n){return Ir.current.useImperativeHandle(t,e,n)};Qe.useInsertionEffect=function(t,e){return Ir.current.useInsertionEffect(t,e)};Qe.useLayoutEffect=function(t,e){return Ir.current.useLayoutEffect(t,e)};Qe.useMemo=function(t,e){return Ir.current.useMemo(t,e)};Qe.useReducer=function(t,e,n){return Ir.current.useReducer(t,e,n)};Qe.useRef=function(t){return Ir.current.useRef(t)};Qe.useState=function(t){return Ir.current.useState(t)};Qe.useSyncExternalStore=function(t,e,n){return Ir.current.useSyncExternalStore(t,e,n)};Qe.useTransition=function(){return Ir.current.useTransition()};Qe.version="18.3.1";o_.exports=Qe;var L=o_.exports;const _w=cd(L),lb=Aw({__proto__:null,default:_w},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MB=L,VB=Symbol.for("react.element"),UB=Symbol.for("react.fragment"),zB=Object.prototype.hasOwnProperty,WB=MB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jB={key:!0,ref:!0,__self:!0,__source:!0};function m_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)zB.call(e,r)&&!jB.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:VB,type:t,key:i,ref:o,props:s,_owner:WB.current}}eg.Fragment=UB;eg.jsx=m_;eg.jsxs=m_;i_.exports=eg;var _=i_.exports,GB={exports:{}};/*!
  * Bootstrap v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,r){t.exports=r()})(Ot,function(){const n=new Map,r={set(E,m,S){n.has(E)||n.set(E,new Map);const I=n.get(E);I.has(m)||I.size===0?I.set(m,S):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(I.keys())[0]}.`)},get:(E,m)=>n.has(E)&&n.get(E).get(m)||null,remove(E,m){if(!n.has(E))return;const S=n.get(E);S.delete(m),S.size===0&&n.delete(E)}},s="transitionend",i=E=>(E&&window.CSS&&window.CSS.escape&&(E=E.replace(/#([^\s"#']+)/g,(m,S)=>`#${CSS.escape(S)}`)),E),o=E=>{E.dispatchEvent(new Event(s))},a=E=>!(!E||typeof E!="object")&&(E.jquery!==void 0&&(E=E[0]),E.nodeType!==void 0),u=E=>a(E)?E.jquery?E[0]:E:typeof E=="string"&&E.length>0?document.querySelector(i(E)):null,l=E=>{if(!a(E)||E.getClientRects().length===0)return!1;const m=getComputedStyle(E).getPropertyValue("visibility")==="visible",S=E.closest("details:not([open])");if(!S)return m;if(S!==E){const I=E.closest("summary");if(I&&I.parentNode!==S||I===null)return!1}return m},c=E=>!E||E.nodeType!==Node.ELEMENT_NODE||!!E.classList.contains("disabled")||(E.disabled!==void 0?E.disabled:E.hasAttribute("disabled")&&E.getAttribute("disabled")!=="false"),d=E=>{if(!document.documentElement.attachShadow)return null;if(typeof E.getRootNode=="function"){const m=E.getRootNode();return m instanceof ShadowRoot?m:null}return E instanceof ShadowRoot?E:E.parentNode?d(E.parentNode):null},f=()=>{},h=E=>{E.offsetHeight},p=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,y=[],b=()=>document.documentElement.dir==="rtl",g=E=>{var m;m=()=>{const S=p();if(S){const I=E.NAME,q=S.fn[I];S.fn[I]=E.jQueryInterface,S.fn[I].Constructor=E,S.fn[I].noConflict=()=>(S.fn[I]=q,E.jQueryInterface)}},document.readyState==="loading"?(y.length||document.addEventListener("DOMContentLoaded",()=>{for(const S of y)S()}),y.push(m)):m()},v=(E,m=[],S=E)=>typeof E=="function"?E(...m):S,w=(E,m,S=!0)=>{if(!S)return void v(E);const I=(Q=>{if(!Q)return 0;let{transitionDuration:re,transitionDelay:pe}=window.getComputedStyle(Q);const Se=Number.parseFloat(re),Ce=Number.parseFloat(pe);return Se||Ce?(re=re.split(",")[0],pe=pe.split(",")[0],1e3*(Number.parseFloat(re)+Number.parseFloat(pe))):0})(m)+5;let q=!1;const H=({target:Q})=>{Q===m&&(q=!0,m.removeEventListener(s,H),v(E))};m.addEventListener(s,H),setTimeout(()=>{q||o(m)},I)},x=(E,m,S,I)=>{const q=E.length;let H=E.indexOf(m);return H===-1?!S&&I?E[q-1]:E[0]:(H+=S?1:-1,I&&(H=(H+q)%q),E[Math.max(0,Math.min(H,q-1))])},C=/[^.]*(?=\..*)\.|.*/,k=/\..*/,P=/::\d+$/,N={};let $=1;const U={mouseenter:"mouseover",mouseleave:"mouseout"},K=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Z(E,m){return m&&`${m}::${$++}`||E.uidEvent||$++}function ie(E){const m=Z(E);return E.uidEvent=m,N[m]=N[m]||{},N[m]}function ee(E,m,S=null){return Object.values(E).find(I=>I.callable===m&&I.delegationSelector===S)}function j(E,m,S){const I=typeof m=="string",q=I?S:m||S;let H=V(E);return K.has(H)||(H=E),[I,q,H]}function M(E,m,S,I,q){if(typeof m!="string"||!E)return;let[H,Q,re]=j(m,S,I);m in U&&(Q=(Ve=>function($e){if(!$e.relatedTarget||$e.relatedTarget!==$e.delegateTarget&&!$e.delegateTarget.contains($e.relatedTarget))return Ve.call(this,$e)})(Q));const pe=ie(E),Se=pe[re]||(pe[re]={}),Ce=ee(Se,Q,H?S:null);if(Ce)return void(Ce.oneOff=Ce.oneOff&&q);const ve=Z(Q,m.replace(C,"")),je=H?function(Fe,Ve,$e){return function Ue(St){const Pt=Fe.querySelectorAll(Ve);for(let{target:He}=St;He&&He!==this;He=He.parentNode)for(const ct of Pt)if(ct===He)return ue(St,{delegateTarget:He}),Ue.oneOff&&F.off(Fe,St.type,Ve,$e),$e.apply(He,[St])}}(E,S,Q):function(Fe,Ve){return function $e(Ue){return ue(Ue,{delegateTarget:Fe}),$e.oneOff&&F.off(Fe,Ue.type,Ve),Ve.apply(Fe,[Ue])}}(E,Q);je.delegationSelector=H?S:null,je.callable=Q,je.oneOff=q,je.uidEvent=ve,Se[ve]=je,E.addEventListener(re,je,H)}function O(E,m,S,I,q){const H=ee(m[S],I,q);H&&(E.removeEventListener(S,H,!!q),delete m[S][H.uidEvent])}function D(E,m,S,I){const q=m[S]||{};for(const[H,Q]of Object.entries(q))H.includes(I)&&O(E,m,S,Q.callable,Q.delegationSelector)}function V(E){return E=E.replace(k,""),U[E]||E}const F={on(E,m,S,I){M(E,m,S,I,!1)},one(E,m,S,I){M(E,m,S,I,!0)},off(E,m,S,I){if(typeof m!="string"||!E)return;const[q,H,Q]=j(m,S,I),re=Q!==m,pe=ie(E),Se=pe[Q]||{},Ce=m.startsWith(".");if(H===void 0){if(Ce)for(const ve of Object.keys(pe))D(E,pe,ve,m.slice(1));for(const[ve,je]of Object.entries(Se)){const Fe=ve.replace(P,"");re&&!m.includes(Fe)||O(E,pe,Q,je.callable,je.delegationSelector)}}else{if(!Object.keys(Se).length)return;O(E,pe,Q,H,q?S:null)}},trigger(E,m,S){if(typeof m!="string"||!E)return null;const I=p();let q=null,H=!0,Q=!0,re=!1;m!==V(m)&&I&&(q=I.Event(m,S),I(E).trigger(q),H=!q.isPropagationStopped(),Q=!q.isImmediatePropagationStopped(),re=q.isDefaultPrevented());const pe=ue(new Event(m,{bubbles:H,cancelable:!0}),S);return re&&pe.preventDefault(),Q&&E.dispatchEvent(pe),pe.defaultPrevented&&q&&q.preventDefault(),pe}};function ue(E,m={}){for(const[S,I]of Object.entries(m))try{E[S]=I}catch{Object.defineProperty(E,S,{configurable:!0,get:()=>I})}return E}function se(E){if(E==="true")return!0;if(E==="false")return!1;if(E===Number(E).toString())return Number(E);if(E===""||E==="null")return null;if(typeof E!="string")return E;try{return JSON.parse(decodeURIComponent(E))}catch{return E}}function he(E){return E.replace(/[A-Z]/g,m=>`-${m.toLowerCase()}`)}const ae={setDataAttribute(E,m,S){E.setAttribute(`data-bs-${he(m)}`,S)},removeDataAttribute(E,m){E.removeAttribute(`data-bs-${he(m)}`)},getDataAttributes(E){if(!E)return{};const m={},S=Object.keys(E.dataset).filter(I=>I.startsWith("bs")&&!I.startsWith("bsConfig"));for(const I of S){let q=I.replace(/^bs/,"");q=q.charAt(0).toLowerCase()+q.slice(1,q.length),m[q]=se(E.dataset[I])}return m},getDataAttribute:(E,m)=>se(E.getAttribute(`data-bs-${he(m)}`))};class be{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(m){return m=this._mergeConfigObj(m),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}_configAfterMerge(m){return m}_mergeConfigObj(m,S){const I=a(S)?ae.getDataAttribute(S,"config"):{};return{...this.constructor.Default,...typeof I=="object"?I:{},...a(S)?ae.getDataAttributes(S):{},...typeof m=="object"?m:{}}}_typeCheckConfig(m,S=this.constructor.DefaultType){for(const[q,H]of Object.entries(S)){const Q=m[q],re=a(Q)?"element":(I=Q)==null?`${I}`:Object.prototype.toString.call(I).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(H).test(re))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${q}" provided type "${re}" but expected type "${H}".`)}var I}}class _e extends be{constructor(m,S){super(),(m=u(m))&&(this._element=m,this._config=this._getConfig(S),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),F.off(this._element,this.constructor.EVENT_KEY);for(const m of Object.getOwnPropertyNames(this))this[m]=null}_queueCallback(m,S,I=!0){w(m,S,I)}_getConfig(m){return m=this._mergeConfigObj(m,this._element),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}static getInstance(m){return r.get(u(m),this.DATA_KEY)}static getOrCreateInstance(m,S={}){return this.getInstance(m)||new this(m,typeof S=="object"?S:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(m){return`${m}${this.EVENT_KEY}`}}const lt=E=>{let m=E.getAttribute("data-bs-target");if(!m||m==="#"){let S=E.getAttribute("href");if(!S||!S.includes("#")&&!S.startsWith("."))return null;S.includes("#")&&!S.startsWith("#")&&(S=`#${S.split("#")[1]}`),m=S&&S!=="#"?S.trim():null}return m?m.split(",").map(S=>i(S)).join(","):null},we={find:(E,m=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(m,E)),findOne:(E,m=document.documentElement)=>Element.prototype.querySelector.call(m,E),children:(E,m)=>[].concat(...E.children).filter(S=>S.matches(m)),parents(E,m){const S=[];let I=E.parentNode.closest(m);for(;I;)S.push(I),I=I.parentNode.closest(m);return S},prev(E,m){let S=E.previousElementSibling;for(;S;){if(S.matches(m))return[S];S=S.previousElementSibling}return[]},next(E,m){let S=E.nextElementSibling;for(;S;){if(S.matches(m))return[S];S=S.nextElementSibling}return[]},focusableChildren(E){const m=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(S=>`${S}:not([tabindex^="-"])`).join(",");return this.find(m,E).filter(S=>!c(S)&&l(S))},getSelectorFromElement(E){const m=lt(E);return m&&we.findOne(m)?m:null},getElementFromSelector(E){const m=lt(E);return m?we.findOne(m):null},getMultipleElementsFromSelector(E){const m=lt(E);return m?we.find(m):[]}},Hn=(E,m="hide")=>{const S=`click.dismiss${E.EVENT_KEY}`,I=E.NAME;F.on(document,S,`[data-bs-dismiss="${I}"]`,function(q){if(["A","AREA"].includes(this.tagName)&&q.preventDefault(),c(this))return;const H=we.getElementFromSelector(this)||this.closest(`.${I}`);E.getOrCreateInstance(H)[m]()})},hr=".bs.alert",Kn=`close${hr}`,Ss=`closed${hr}`;class As extends _e{static get NAME(){return"alert"}close(){if(F.trigger(this._element,Kn).defaultPrevented)return;this._element.classList.remove("show");const m=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,m)}_destroyElement(){this._element.remove(),F.trigger(this._element,Ss),this.dispose()}static jQueryInterface(m){return this.each(function(){const S=As.getOrCreateInstance(this);if(typeof m=="string"){if(S[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);S[m](this)}})}}Hn(As,"close"),g(As);const Kt='[data-bs-toggle="button"]';class En extends _e{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(m){return this.each(function(){const S=En.getOrCreateInstance(this);m==="toggle"&&S[m]()})}}F.on(document,"click.bs.button.data-api",Kt,E=>{E.preventDefault();const m=E.target.closest(Kt);En.getOrCreateInstance(m).toggle()}),g(En);const gn=".bs.swipe",yo=`touchstart${gn}`,Kr=`touchmove${gn}`,$l=`touchend${gn}`,Ld=`pointerdown${gn}`,nu=`pointerup${gn}`,bo={endCallback:null,leftCallback:null,rightCallback:null},Fd={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Bl extends be{constructor(m,S){super(),this._element=m,m&&Bl.isSupported()&&(this._config=this._getConfig(S),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return bo}static get DefaultType(){return Fd}static get NAME(){return"swipe"}dispose(){F.off(this._element,gn)}_start(m){this._supportPointerEvents?this._eventIsPointerPenTouch(m)&&(this._deltaX=m.clientX):this._deltaX=m.touches[0].clientX}_end(m){this._eventIsPointerPenTouch(m)&&(this._deltaX=m.clientX-this._deltaX),this._handleSwipe(),v(this._config.endCallback)}_move(m){this._deltaX=m.touches&&m.touches.length>1?0:m.touches[0].clientX-this._deltaX}_handleSwipe(){const m=Math.abs(this._deltaX);if(m<=40)return;const S=m/this._deltaX;this._deltaX=0,S&&v(S>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(F.on(this._element,Ld,m=>this._start(m)),F.on(this._element,nu,m=>this._end(m)),this._element.classList.add("pointer-event")):(F.on(this._element,yo,m=>this._start(m)),F.on(this._element,Kr,m=>this._move(m)),F.on(this._element,$l,m=>this._end(m)))}_eventIsPointerPenTouch(m){return this._supportPointerEvents&&(m.pointerType==="pen"||m.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const $i=".bs.carousel",Jo=".data-api",si="next",vo="prev",Bi="left",Xr="right",ii=`slide${$i}`,Ml=`slid${$i}`,Vl=`keydown${$i}`,h1=`mouseenter${$i}`,Mi=`mouseleave${$i}`,ep=`dragstart${$i}`,tp=`load${$i}${Jo}`,np=`click${$i}${Jo}`,rp="carousel",ru="active",su=".active",$d=".carousel-item",Bd=su+$d,Ul={ArrowLeft:Xr,ArrowRight:Bi},Md={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},p1={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class wo extends _e{constructor(m,S){super(m,S),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=we.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===rp&&this.cycle()}static get Default(){return Md}static get DefaultType(){return p1}static get NAME(){return"carousel"}next(){this._slide(si)}nextWhenVisible(){!document.hidden&&l(this._element)&&this.next()}prev(){this._slide(vo)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?F.one(this._element,Ml,()=>this.cycle()):this.cycle())}to(m){const S=this._getItems();if(m>S.length-1||m<0)return;if(this._isSliding)return void F.one(this._element,Ml,()=>this.to(m));const I=this._getItemIndex(this._getActive());if(I===m)return;const q=m>I?si:vo;this._slide(q,S[m])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(m){return m.defaultInterval=m.interval,m}_addEventListeners(){this._config.keyboard&&F.on(this._element,Vl,m=>this._keydown(m)),this._config.pause==="hover"&&(F.on(this._element,h1,()=>this.pause()),F.on(this._element,Mi,()=>this._maybeEnableCycle())),this._config.touch&&Bl.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const S of we.find(".carousel-item img",this._element))F.on(S,ep,I=>I.preventDefault());const m={leftCallback:()=>this._slide(this._directionToOrder(Bi)),rightCallback:()=>this._slide(this._directionToOrder(Xr)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Bl(this._element,m)}_keydown(m){if(/input|textarea/i.test(m.target.tagName))return;const S=Ul[m.key];S&&(m.preventDefault(),this._slide(this._directionToOrder(S)))}_getItemIndex(m){return this._getItems().indexOf(m)}_setActiveIndicatorElement(m){if(!this._indicatorsElement)return;const S=we.findOne(su,this._indicatorsElement);S.classList.remove(ru),S.removeAttribute("aria-current");const I=we.findOne(`[data-bs-slide-to="${m}"]`,this._indicatorsElement);I&&(I.classList.add(ru),I.setAttribute("aria-current","true"))}_updateInterval(){const m=this._activeElement||this._getActive();if(!m)return;const S=Number.parseInt(m.getAttribute("data-bs-interval"),10);this._config.interval=S||this._config.defaultInterval}_slide(m,S=null){if(this._isSliding)return;const I=this._getActive(),q=m===si,H=S||x(this._getItems(),I,q,this._config.wrap);if(H===I)return;const Q=this._getItemIndex(H),re=ve=>F.trigger(this._element,ve,{relatedTarget:H,direction:this._orderToDirection(m),from:this._getItemIndex(I),to:Q});if(re(ii).defaultPrevented||!I||!H)return;const pe=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Q),this._activeElement=H;const Se=q?"carousel-item-start":"carousel-item-end",Ce=q?"carousel-item-next":"carousel-item-prev";H.classList.add(Ce),h(H),I.classList.add(Se),H.classList.add(Se),this._queueCallback(()=>{H.classList.remove(Se,Ce),H.classList.add(ru),I.classList.remove(ru,Ce,Se),this._isSliding=!1,re(Ml)},I,this._isAnimated()),pe&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return we.findOne(Bd,this._element)}_getItems(){return we.find($d,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(m){return b()?m===Bi?vo:si:m===Bi?si:vo}_orderToDirection(m){return b()?m===vo?Bi:Xr:m===vo?Xr:Bi}static jQueryInterface(m){return this.each(function(){const S=wo.getOrCreateInstance(this,m);if(typeof m!="number"){if(typeof m=="string"){if(S[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);S[m]()}}else S.to(m)})}}F.on(document,np,"[data-bs-slide], [data-bs-slide-to]",function(E){const m=we.getElementFromSelector(this);if(!m||!m.classList.contains(rp))return;E.preventDefault();const S=wo.getOrCreateInstance(m),I=this.getAttribute("data-bs-slide-to");return I?(S.to(I),void S._maybeEnableCycle()):ae.getDataAttribute(this,"slide")==="next"?(S.next(),void S._maybeEnableCycle()):(S.prev(),void S._maybeEnableCycle())}),F.on(window,tp,()=>{const E=we.find('[data-bs-ride="carousel"]');for(const m of E)wo.getOrCreateInstance(m)}),g(wo);const iu=".bs.collapse",sp=`show${iu}`,zl=`shown${iu}`,Wl=`hide${iu}`,ip=`hidden${iu}`,m1=`click${iu}.data-api`,Vd="show",z="collapse",G="collapsing",Y=`:scope .${z} .${z}`,ne='[data-bs-toggle="collapse"]',xe={parent:null,toggle:!0},Te={parent:"(null|element)",toggle:"boolean"};class Pe extends _e{constructor(m,S){super(m,S),this._isTransitioning=!1,this._triggerArray=[];const I=we.find(ne);for(const q of I){const H=we.getSelectorFromElement(q),Q=we.find(H).filter(re=>re===this._element);H!==null&&Q.length&&this._triggerArray.push(q)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return xe}static get DefaultType(){return Te}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let m=[];if(this._config.parent&&(m=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(q=>q!==this._element).map(q=>Pe.getOrCreateInstance(q,{toggle:!1}))),m.length&&m[0]._isTransitioning||F.trigger(this._element,sp).defaultPrevented)return;for(const q of m)q.hide();const S=this._getDimension();this._element.classList.remove(z),this._element.classList.add(G),this._element.style[S]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const I=`scroll${S[0].toUpperCase()+S.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(G),this._element.classList.add(z,Vd),this._element.style[S]="",F.trigger(this._element,zl)},this._element,!0),this._element.style[S]=`${this._element[I]}px`}hide(){if(this._isTransitioning||!this._isShown()||F.trigger(this._element,Wl).defaultPrevented)return;const m=this._getDimension();this._element.style[m]=`${this._element.getBoundingClientRect()[m]}px`,h(this._element),this._element.classList.add(G),this._element.classList.remove(z,Vd);for(const S of this._triggerArray){const I=we.getElementFromSelector(S);I&&!this._isShown(I)&&this._addAriaAndCollapsedClass([S],!1)}this._isTransitioning=!0,this._element.style[m]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(G),this._element.classList.add(z),F.trigger(this._element,ip)},this._element,!0)}_isShown(m=this._element){return m.classList.contains(Vd)}_configAfterMerge(m){return m.toggle=!!m.toggle,m.parent=u(m.parent),m}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const m=this._getFirstLevelChildren(ne);for(const S of m){const I=we.getElementFromSelector(S);I&&this._addAriaAndCollapsedClass([S],this._isShown(I))}}_getFirstLevelChildren(m){const S=we.find(Y,this._config.parent);return we.find(m,this._config.parent).filter(I=>!S.includes(I))}_addAriaAndCollapsedClass(m,S){if(m.length)for(const I of m)I.classList.toggle("collapsed",!S),I.setAttribute("aria-expanded",S)}static jQueryInterface(m){const S={};return typeof m=="string"&&/show|hide/.test(m)&&(S.toggle=!1),this.each(function(){const I=Pe.getOrCreateInstance(this,S);if(typeof m=="string"){if(I[m]===void 0)throw new TypeError(`No method named "${m}"`);I[m]()}})}}F.on(document,m1,ne,function(E){(E.target.tagName==="A"||E.delegateTarget&&E.delegateTarget.tagName==="A")&&E.preventDefault();for(const m of we.getMultipleElementsFromSelector(this))Pe.getOrCreateInstance(m,{toggle:!1}).toggle()}),g(Pe);var le="top",Re="bottom",Ee="right",Ie="left",ot="auto",Ze=[le,Re,Ee,Ie],tt="start",Ke="end",fn="clippingParents",zt="viewport",Es="popper",oi="reference",Vi=Ze.reduce(function(E,m){return E.concat([m+"-"+tt,m+"-"+Ke])},[]),Ui=[].concat(Ze,[ot]).reduce(function(E,m){return E.concat([m,m+"-"+tt,m+"-"+Ke])},[]),xo="beforeRead",Yr="read",ou="afterRead",au="beforeMain",uu="main",ze="afterMain",Mt="beforeWrite",Xn="write",_t="afterWrite",Cs=[xo,Yr,ou,au,uu,ze,Mt,Xn,_t];function Qr(E){return E?(E.nodeName||"").toLowerCase():null}function pr(E){if(E==null)return window;if(E.toString()!=="[object Window]"){var m=E.ownerDocument;return m&&m.defaultView||window}return E}function lu(E){return E instanceof pr(E).Element||E instanceof Element}function Ns(E){return E instanceof pr(E).HTMLElement||E instanceof HTMLElement}function g1(E){return typeof ShadowRoot<"u"&&(E instanceof pr(E).ShadowRoot||E instanceof ShadowRoot)}const y1={name:"applyStyles",enabled:!0,phase:"write",fn:function(E){var m=E.state;Object.keys(m.elements).forEach(function(S){var I=m.styles[S]||{},q=m.attributes[S]||{},H=m.elements[S];Ns(H)&&Qr(H)&&(Object.assign(H.style,I),Object.keys(q).forEach(function(Q){var re=q[Q];re===!1?H.removeAttribute(Q):H.setAttribute(Q,re===!0?"":re)}))})},effect:function(E){var m=E.state,S={popper:{position:m.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(m.elements.popper.style,S.popper),m.styles=S,m.elements.arrow&&Object.assign(m.elements.arrow.style,S.arrow),function(){Object.keys(m.elements).forEach(function(I){var q=m.elements[I],H=m.attributes[I]||{},Q=Object.keys(m.styles.hasOwnProperty(I)?m.styles[I]:S[I]).reduce(function(re,pe){return re[pe]="",re},{});Ns(q)&&Qr(q)&&(Object.assign(q.style,Q),Object.keys(H).forEach(function(re){q.removeAttribute(re)}))})}},requires:["computeStyles"]};function zi(E){return E.split("-")[0]}var cu=Math.max,op=Math.min,jl=Math.round;function b1(){var E=navigator.userAgentData;return E!=null&&E.brands&&Array.isArray(E.brands)?E.brands.map(function(m){return m.brand+"/"+m.version}).join(" "):navigator.userAgent}function yS(){return!/^((?!chrome|android).)*safari/i.test(b1())}function Gl(E,m,S){m===void 0&&(m=!1),S===void 0&&(S=!1);var I=E.getBoundingClientRect(),q=1,H=1;m&&Ns(E)&&(q=E.offsetWidth>0&&jl(I.width)/E.offsetWidth||1,H=E.offsetHeight>0&&jl(I.height)/E.offsetHeight||1);var Q=(lu(E)?pr(E):window).visualViewport,re=!yS()&&S,pe=(I.left+(re&&Q?Q.offsetLeft:0))/q,Se=(I.top+(re&&Q?Q.offsetTop:0))/H,Ce=I.width/q,ve=I.height/H;return{width:Ce,height:ve,top:Se,right:pe+Ce,bottom:Se+ve,left:pe,x:pe,y:Se}}function v1(E){var m=Gl(E),S=E.offsetWidth,I=E.offsetHeight;return Math.abs(m.width-S)<=1&&(S=m.width),Math.abs(m.height-I)<=1&&(I=m.height),{x:E.offsetLeft,y:E.offsetTop,width:S,height:I}}function bS(E,m){var S=m.getRootNode&&m.getRootNode();if(E.contains(m))return!0;if(S&&g1(S)){var I=m;do{if(I&&E.isSameNode(I))return!0;I=I.parentNode||I.host}while(I)}return!1}function So(E){return pr(E).getComputedStyle(E)}function L6(E){return["table","td","th"].indexOf(Qr(E))>=0}function ea(E){return((lu(E)?E.ownerDocument:E.document)||window.document).documentElement}function ap(E){return Qr(E)==="html"?E:E.assignedSlot||E.parentNode||(g1(E)?E.host:null)||ea(E)}function vS(E){return Ns(E)&&So(E).position!=="fixed"?E.offsetParent:null}function Ud(E){for(var m=pr(E),S=vS(E);S&&L6(S)&&So(S).position==="static";)S=vS(S);return S&&(Qr(S)==="html"||Qr(S)==="body"&&So(S).position==="static")?m:S||function(I){var q=/firefox/i.test(b1());if(/Trident/i.test(b1())&&Ns(I)&&So(I).position==="fixed")return null;var H=ap(I);for(g1(H)&&(H=H.host);Ns(H)&&["html","body"].indexOf(Qr(H))<0;){var Q=So(H);if(Q.transform!=="none"||Q.perspective!=="none"||Q.contain==="paint"||["transform","perspective"].indexOf(Q.willChange)!==-1||q&&Q.willChange==="filter"||q&&Q.filter&&Q.filter!=="none")return H;H=H.parentNode}return null}(E)||m}function w1(E){return["top","bottom"].indexOf(E)>=0?"x":"y"}function zd(E,m,S){return cu(E,op(m,S))}function wS(E){return Object.assign({},{top:0,right:0,bottom:0,left:0},E)}function xS(E,m){return m.reduce(function(S,I){return S[I]=E,S},{})}const SS={name:"arrow",enabled:!0,phase:"main",fn:function(E){var m,S=E.state,I=E.name,q=E.options,H=S.elements.arrow,Q=S.modifiersData.popperOffsets,re=zi(S.placement),pe=w1(re),Se=[Ie,Ee].indexOf(re)>=0?"height":"width";if(H&&Q){var Ce=function(At,yt){return wS(typeof(At=typeof At=="function"?At(Object.assign({},yt.rects,{placement:yt.placement})):At)!="number"?At:xS(At,Ze))}(q.padding,S),ve=v1(H),je=pe==="y"?le:Ie,Fe=pe==="y"?Re:Ee,Ve=S.rects.reference[Se]+S.rects.reference[pe]-Q[pe]-S.rects.popper[Se],$e=Q[pe]-S.rects.reference[pe],Ue=Ud(H),St=Ue?pe==="y"?Ue.clientHeight||0:Ue.clientWidth||0:0,Pt=Ve/2-$e/2,He=Ce[je],ct=St-ve[Se]-Ce[Fe],Ge=St/2-ve[Se]/2+Pt,nt=zd(He,Ge,ct),gt=pe;S.modifiersData[I]=((m={})[gt]=nt,m.centerOffset=nt-Ge,m)}},effect:function(E){var m=E.state,S=E.options.element,I=S===void 0?"[data-popper-arrow]":S;I!=null&&(typeof I!="string"||(I=m.elements.popper.querySelector(I)))&&bS(m.elements.popper,I)&&(m.elements.arrow=I)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ql(E){return E.split("-")[1]}var F6={top:"auto",right:"auto",bottom:"auto",left:"auto"};function AS(E){var m,S=E.popper,I=E.popperRect,q=E.placement,H=E.variation,Q=E.offsets,re=E.position,pe=E.gpuAcceleration,Se=E.adaptive,Ce=E.roundOffsets,ve=E.isFixed,je=Q.x,Fe=je===void 0?0:je,Ve=Q.y,$e=Ve===void 0?0:Ve,Ue=typeof Ce=="function"?Ce({x:Fe,y:$e}):{x:Fe,y:$e};Fe=Ue.x,$e=Ue.y;var St=Q.hasOwnProperty("x"),Pt=Q.hasOwnProperty("y"),He=Ie,ct=le,Ge=window;if(Se){var nt=Ud(S),gt="clientHeight",At="clientWidth";nt===pr(S)&&So(nt=ea(S)).position!=="static"&&re==="absolute"&&(gt="scrollHeight",At="scrollWidth"),(q===le||(q===Ie||q===Ee)&&H===Ke)&&(ct=Re,$e-=(ve&&nt===Ge&&Ge.visualViewport?Ge.visualViewport.height:nt[gt])-I.height,$e*=pe?1:-1),q!==Ie&&(q!==le&&q!==Re||H!==Ke)||(He=Ee,Fe-=(ve&&nt===Ge&&Ge.visualViewport?Ge.visualViewport.width:nt[At])-I.width,Fe*=pe?1:-1)}var yt,on=Object.assign({position:re},Se&&F6),Zr=Ce===!0?function(ui,mr){var _s=ui.x,Is=ui.y,tn=mr.devicePixelRatio||1;return{x:jl(_s*tn)/tn||0,y:jl(Is*tn)/tn||0}}({x:Fe,y:$e},pr(S)):{x:Fe,y:$e};return Fe=Zr.x,$e=Zr.y,pe?Object.assign({},on,((yt={})[ct]=Pt?"0":"",yt[He]=St?"0":"",yt.transform=(Ge.devicePixelRatio||1)<=1?"translate("+Fe+"px, "+$e+"px)":"translate3d("+Fe+"px, "+$e+"px, 0)",yt)):Object.assign({},on,((m={})[ct]=Pt?$e+"px":"",m[He]=St?Fe+"px":"",m.transform="",m))}const x1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(E){var m=E.state,S=E.options,I=S.gpuAcceleration,q=I===void 0||I,H=S.adaptive,Q=H===void 0||H,re=S.roundOffsets,pe=re===void 0||re,Se={placement:zi(m.placement),variation:ql(m.placement),popper:m.elements.popper,popperRect:m.rects.popper,gpuAcceleration:q,isFixed:m.options.strategy==="fixed"};m.modifiersData.popperOffsets!=null&&(m.styles.popper=Object.assign({},m.styles.popper,AS(Object.assign({},Se,{offsets:m.modifiersData.popperOffsets,position:m.options.strategy,adaptive:Q,roundOffsets:pe})))),m.modifiersData.arrow!=null&&(m.styles.arrow=Object.assign({},m.styles.arrow,AS(Object.assign({},Se,{offsets:m.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:pe})))),m.attributes.popper=Object.assign({},m.attributes.popper,{"data-popper-placement":m.placement})},data:{}};var up={passive:!0};const S1={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(E){var m=E.state,S=E.instance,I=E.options,q=I.scroll,H=q===void 0||q,Q=I.resize,re=Q===void 0||Q,pe=pr(m.elements.popper),Se=[].concat(m.scrollParents.reference,m.scrollParents.popper);return H&&Se.forEach(function(Ce){Ce.addEventListener("scroll",S.update,up)}),re&&pe.addEventListener("resize",S.update,up),function(){H&&Se.forEach(function(Ce){Ce.removeEventListener("scroll",S.update,up)}),re&&pe.removeEventListener("resize",S.update,up)}},data:{}};var $6={left:"right",right:"left",bottom:"top",top:"bottom"};function lp(E){return E.replace(/left|right|bottom|top/g,function(m){return $6[m]})}var B6={start:"end",end:"start"};function ES(E){return E.replace(/start|end/g,function(m){return B6[m]})}function A1(E){var m=pr(E);return{scrollLeft:m.pageXOffset,scrollTop:m.pageYOffset}}function E1(E){return Gl(ea(E)).left+A1(E).scrollLeft}function C1(E){var m=So(E),S=m.overflow,I=m.overflowX,q=m.overflowY;return/auto|scroll|overlay|hidden/.test(S+q+I)}function CS(E){return["html","body","#document"].indexOf(Qr(E))>=0?E.ownerDocument.body:Ns(E)&&C1(E)?E:CS(ap(E))}function Wd(E,m){var S;m===void 0&&(m=[]);var I=CS(E),q=I===((S=E.ownerDocument)==null?void 0:S.body),H=pr(I),Q=q?[H].concat(H.visualViewport||[],C1(I)?I:[]):I,re=m.concat(Q);return q?re:re.concat(Wd(ap(Q)))}function N1(E){return Object.assign({},E,{left:E.x,top:E.y,right:E.x+E.width,bottom:E.y+E.height})}function NS(E,m,S){return m===zt?N1(function(I,q){var H=pr(I),Q=ea(I),re=H.visualViewport,pe=Q.clientWidth,Se=Q.clientHeight,Ce=0,ve=0;if(re){pe=re.width,Se=re.height;var je=yS();(je||!je&&q==="fixed")&&(Ce=re.offsetLeft,ve=re.offsetTop)}return{width:pe,height:Se,x:Ce+E1(I),y:ve}}(E,S)):lu(m)?function(I,q){var H=Gl(I,!1,q==="fixed");return H.top=H.top+I.clientTop,H.left=H.left+I.clientLeft,H.bottom=H.top+I.clientHeight,H.right=H.left+I.clientWidth,H.width=I.clientWidth,H.height=I.clientHeight,H.x=H.left,H.y=H.top,H}(m,S):N1(function(I){var q,H=ea(I),Q=A1(I),re=(q=I.ownerDocument)==null?void 0:q.body,pe=cu(H.scrollWidth,H.clientWidth,re?re.scrollWidth:0,re?re.clientWidth:0),Se=cu(H.scrollHeight,H.clientHeight,re?re.scrollHeight:0,re?re.clientHeight:0),Ce=-Q.scrollLeft+E1(I),ve=-Q.scrollTop;return So(re||H).direction==="rtl"&&(Ce+=cu(H.clientWidth,re?re.clientWidth:0)-pe),{width:pe,height:Se,x:Ce,y:ve}}(ea(E)))}function TS(E){var m,S=E.reference,I=E.element,q=E.placement,H=q?zi(q):null,Q=q?ql(q):null,re=S.x+S.width/2-I.width/2,pe=S.y+S.height/2-I.height/2;switch(H){case le:m={x:re,y:S.y-I.height};break;case Re:m={x:re,y:S.y+S.height};break;case Ee:m={x:S.x+S.width,y:pe};break;case Ie:m={x:S.x-I.width,y:pe};break;default:m={x:S.x,y:S.y}}var Se=H?w1(H):null;if(Se!=null){var Ce=Se==="y"?"height":"width";switch(Q){case tt:m[Se]=m[Se]-(S[Ce]/2-I[Ce]/2);break;case Ke:m[Se]=m[Se]+(S[Ce]/2-I[Ce]/2)}}return m}function Hl(E,m){m===void 0&&(m={});var S=m,I=S.placement,q=I===void 0?E.placement:I,H=S.strategy,Q=H===void 0?E.strategy:H,re=S.boundary,pe=re===void 0?fn:re,Se=S.rootBoundary,Ce=Se===void 0?zt:Se,ve=S.elementContext,je=ve===void 0?Es:ve,Fe=S.altBoundary,Ve=Fe!==void 0&&Fe,$e=S.padding,Ue=$e===void 0?0:$e,St=wS(typeof Ue!="number"?Ue:xS(Ue,Ze)),Pt=je===Es?oi:Es,He=E.rects.popper,ct=E.elements[Ve?Pt:je],Ge=function(mr,_s,Is,tn){var Wi=_s==="clippingParents"?function(It){var gr=Wd(ap(It)),ks=["absolute","fixed"].indexOf(So(It).position)>=0&&Ns(It)?Ud(It):It;return lu(ks)?gr.filter(function(na){return lu(na)&&bS(na,ks)&&Qr(na)!=="body"}):[]}(mr):[].concat(_s),ji=[].concat(Wi,[Is]),Yl=ji[0],Cn=ji.reduce(function(It,gr){var ks=NS(mr,gr,tn);return It.top=cu(ks.top,It.top),It.right=op(ks.right,It.right),It.bottom=op(ks.bottom,It.bottom),It.left=cu(ks.left,It.left),It},NS(mr,Yl,tn));return Cn.width=Cn.right-Cn.left,Cn.height=Cn.bottom-Cn.top,Cn.x=Cn.left,Cn.y=Cn.top,Cn}(lu(ct)?ct:ct.contextElement||ea(E.elements.popper),pe,Ce,Q),nt=Gl(E.elements.reference),gt=TS({reference:nt,element:He,strategy:"absolute",placement:q}),At=N1(Object.assign({},He,gt)),yt=je===Es?At:nt,on={top:Ge.top-yt.top+St.top,bottom:yt.bottom-Ge.bottom+St.bottom,left:Ge.left-yt.left+St.left,right:yt.right-Ge.right+St.right},Zr=E.modifiersData.offset;if(je===Es&&Zr){var ui=Zr[q];Object.keys(on).forEach(function(mr){var _s=[Ee,Re].indexOf(mr)>=0?1:-1,Is=[le,Re].indexOf(mr)>=0?"y":"x";on[mr]+=ui[Is]*_s})}return on}function M6(E,m){m===void 0&&(m={});var S=m,I=S.placement,q=S.boundary,H=S.rootBoundary,Q=S.padding,re=S.flipVariations,pe=S.allowedAutoPlacements,Se=pe===void 0?Ui:pe,Ce=ql(I),ve=Ce?re?Vi:Vi.filter(function(Ve){return ql(Ve)===Ce}):Ze,je=ve.filter(function(Ve){return Se.indexOf(Ve)>=0});je.length===0&&(je=ve);var Fe=je.reduce(function(Ve,$e){return Ve[$e]=Hl(E,{placement:$e,boundary:q,rootBoundary:H,padding:Q})[zi($e)],Ve},{});return Object.keys(Fe).sort(function(Ve,$e){return Fe[Ve]-Fe[$e]})}const _S={name:"flip",enabled:!0,phase:"main",fn:function(E){var m=E.state,S=E.options,I=E.name;if(!m.modifiersData[I]._skip){for(var q=S.mainAxis,H=q===void 0||q,Q=S.altAxis,re=Q===void 0||Q,pe=S.fallbackPlacements,Se=S.padding,Ce=S.boundary,ve=S.rootBoundary,je=S.altBoundary,Fe=S.flipVariations,Ve=Fe===void 0||Fe,$e=S.allowedAutoPlacements,Ue=m.options.placement,St=zi(Ue),Pt=pe||(St!==Ue&&Ve?function(It){if(zi(It)===ot)return[];var gr=lp(It);return[ES(It),gr,ES(gr)]}(Ue):[lp(Ue)]),He=[Ue].concat(Pt).reduce(function(It,gr){return It.concat(zi(gr)===ot?M6(m,{placement:gr,boundary:Ce,rootBoundary:ve,padding:Se,flipVariations:Ve,allowedAutoPlacements:$e}):gr)},[]),ct=m.rects.reference,Ge=m.rects.popper,nt=new Map,gt=!0,At=He[0],yt=0;yt<He.length;yt++){var on=He[yt],Zr=zi(on),ui=ql(on)===tt,mr=[le,Re].indexOf(Zr)>=0,_s=mr?"width":"height",Is=Hl(m,{placement:on,boundary:Ce,rootBoundary:ve,altBoundary:je,padding:Se}),tn=mr?ui?Ee:Ie:ui?Re:le;ct[_s]>Ge[_s]&&(tn=lp(tn));var Wi=lp(tn),ji=[];if(H&&ji.push(Is[Zr]<=0),re&&ji.push(Is[tn]<=0,Is[Wi]<=0),ji.every(function(It){return It})){At=on,gt=!1;break}nt.set(on,ji)}if(gt)for(var Yl=function(It){var gr=He.find(function(ks){var na=nt.get(ks);if(na)return na.slice(0,It).every(function(bp){return bp})});if(gr)return At=gr,"break"},Cn=Ve?3:1;Cn>0&&Yl(Cn)!=="break";Cn--);m.placement!==At&&(m.modifiersData[I]._skip=!0,m.placement=At,m.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function IS(E,m,S){return S===void 0&&(S={x:0,y:0}),{top:E.top-m.height-S.y,right:E.right-m.width+S.x,bottom:E.bottom-m.height+S.y,left:E.left-m.width-S.x}}function kS(E){return[le,Ee,Re,Ie].some(function(m){return E[m]>=0})}const RS={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(E){var m=E.state,S=E.name,I=m.rects.reference,q=m.rects.popper,H=m.modifiersData.preventOverflow,Q=Hl(m,{elementContext:"reference"}),re=Hl(m,{altBoundary:!0}),pe=IS(Q,I),Se=IS(re,q,H),Ce=kS(pe),ve=kS(Se);m.modifiersData[S]={referenceClippingOffsets:pe,popperEscapeOffsets:Se,isReferenceHidden:Ce,hasPopperEscaped:ve},m.attributes.popper=Object.assign({},m.attributes.popper,{"data-popper-reference-hidden":Ce,"data-popper-escaped":ve})}},PS={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(E){var m=E.state,S=E.options,I=E.name,q=S.offset,H=q===void 0?[0,0]:q,Q=Ui.reduce(function(Ce,ve){return Ce[ve]=function(je,Fe,Ve){var $e=zi(je),Ue=[Ie,le].indexOf($e)>=0?-1:1,St=typeof Ve=="function"?Ve(Object.assign({},Fe,{placement:je})):Ve,Pt=St[0],He=St[1];return Pt=Pt||0,He=(He||0)*Ue,[Ie,Ee].indexOf($e)>=0?{x:He,y:Pt}:{x:Pt,y:He}}(ve,m.rects,H),Ce},{}),re=Q[m.placement],pe=re.x,Se=re.y;m.modifiersData.popperOffsets!=null&&(m.modifiersData.popperOffsets.x+=pe,m.modifiersData.popperOffsets.y+=Se),m.modifiersData[I]=Q}},T1={name:"popperOffsets",enabled:!0,phase:"read",fn:function(E){var m=E.state,S=E.name;m.modifiersData[S]=TS({reference:m.rects.reference,element:m.rects.popper,strategy:"absolute",placement:m.placement})},data:{}},OS={name:"preventOverflow",enabled:!0,phase:"main",fn:function(E){var m=E.state,S=E.options,I=E.name,q=S.mainAxis,H=q===void 0||q,Q=S.altAxis,re=Q!==void 0&&Q,pe=S.boundary,Se=S.rootBoundary,Ce=S.altBoundary,ve=S.padding,je=S.tether,Fe=je===void 0||je,Ve=S.tetherOffset,$e=Ve===void 0?0:Ve,Ue=Hl(m,{boundary:pe,rootBoundary:Se,padding:ve,altBoundary:Ce}),St=zi(m.placement),Pt=ql(m.placement),He=!Pt,ct=w1(St),Ge=ct==="x"?"y":"x",nt=m.modifiersData.popperOffsets,gt=m.rects.reference,At=m.rects.popper,yt=typeof $e=="function"?$e(Object.assign({},m.rects,{placement:m.placement})):$e,on=typeof yt=="number"?{mainAxis:yt,altAxis:yt}:Object.assign({mainAxis:0,altAxis:0},yt),Zr=m.modifiersData.offset?m.modifiersData.offset[m.placement]:null,ui={x:0,y:0};if(nt){if(H){var mr,_s=ct==="y"?le:Ie,Is=ct==="y"?Re:Ee,tn=ct==="y"?"height":"width",Wi=nt[ct],ji=Wi+Ue[_s],Yl=Wi-Ue[Is],Cn=Fe?-At[tn]/2:0,It=Pt===tt?gt[tn]:At[tn],gr=Pt===tt?-At[tn]:-gt[tn],ks=m.elements.arrow,na=Fe&&ks?v1(ks):{width:0,height:0},bp=m.modifiersData["arrow#persistent"]?m.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},vA=bp[_s],wA=bp[Is],vp=zd(0,gt[tn],na[tn]),pB=He?gt[tn]/2-Cn-vp-vA-on.mainAxis:It-vp-vA-on.mainAxis,mB=He?-gt[tn]/2+Cn+vp+wA+on.mainAxis:gr+vp+wA+on.mainAxis,V1=m.elements.arrow&&Ud(m.elements.arrow),gB=V1?ct==="y"?V1.clientTop||0:V1.clientLeft||0:0,xA=(mr=Zr==null?void 0:Zr[ct])!=null?mr:0,yB=Wi+mB-xA,SA=zd(Fe?op(ji,Wi+pB-xA-gB):ji,Wi,Fe?cu(Yl,yB):Yl);nt[ct]=SA,ui[ct]=SA-Wi}if(re){var AA,bB=ct==="x"?le:Ie,vB=ct==="x"?Re:Ee,bu=nt[Ge],wp=Ge==="y"?"height":"width",EA=bu+Ue[bB],CA=bu-Ue[vB],U1=[le,Ie].indexOf(St)!==-1,NA=(AA=Zr==null?void 0:Zr[Ge])!=null?AA:0,TA=U1?EA:bu-gt[wp]-At[wp]-NA+on.altAxis,_A=U1?bu+gt[wp]+At[wp]-NA-on.altAxis:CA,IA=Fe&&U1?function(wB,xB,z1){var kA=zd(wB,xB,z1);return kA>z1?z1:kA}(TA,bu,_A):zd(Fe?TA:EA,bu,Fe?_A:CA);nt[Ge]=IA,ui[Ge]=IA-bu}m.modifiersData[I]=ui}},requiresIfExists:["offset"]};function V6(E,m,S){S===void 0&&(S=!1);var I,q,H=Ns(m),Q=Ns(m)&&function(ve){var je=ve.getBoundingClientRect(),Fe=jl(je.width)/ve.offsetWidth||1,Ve=jl(je.height)/ve.offsetHeight||1;return Fe!==1||Ve!==1}(m),re=ea(m),pe=Gl(E,Q,S),Se={scrollLeft:0,scrollTop:0},Ce={x:0,y:0};return(H||!H&&!S)&&((Qr(m)!=="body"||C1(re))&&(Se=(I=m)!==pr(I)&&Ns(I)?{scrollLeft:(q=I).scrollLeft,scrollTop:q.scrollTop}:A1(I)),Ns(m)?((Ce=Gl(m,!0)).x+=m.clientLeft,Ce.y+=m.clientTop):re&&(Ce.x=E1(re))),{x:pe.left+Se.scrollLeft-Ce.x,y:pe.top+Se.scrollTop-Ce.y,width:pe.width,height:pe.height}}function U6(E){var m=new Map,S=new Set,I=[];function q(H){S.add(H.name),[].concat(H.requires||[],H.requiresIfExists||[]).forEach(function(Q){if(!S.has(Q)){var re=m.get(Q);re&&q(re)}}),I.push(H)}return E.forEach(function(H){m.set(H.name,H)}),E.forEach(function(H){S.has(H.name)||q(H)}),I}var DS={placement:"bottom",modifiers:[],strategy:"absolute"};function LS(){for(var E=arguments.length,m=new Array(E),S=0;S<E;S++)m[S]=arguments[S];return!m.some(function(I){return!(I&&typeof I.getBoundingClientRect=="function")})}function cp(E){E===void 0&&(E={});var m=E,S=m.defaultModifiers,I=S===void 0?[]:S,q=m.defaultOptions,H=q===void 0?DS:q;return function(Q,re,pe){pe===void 0&&(pe=H);var Se,Ce,ve={placement:"bottom",orderedModifiers:[],options:Object.assign({},DS,H),modifiersData:{},elements:{reference:Q,popper:re},attributes:{},styles:{}},je=[],Fe=!1,Ve={state:ve,setOptions:function(Ue){var St=typeof Ue=="function"?Ue(ve.options):Ue;$e(),ve.options=Object.assign({},H,ve.options,St),ve.scrollParents={reference:lu(Q)?Wd(Q):Q.contextElement?Wd(Q.contextElement):[],popper:Wd(re)};var Pt,He,ct=function(Ge){var nt=U6(Ge);return Cs.reduce(function(gt,At){return gt.concat(nt.filter(function(yt){return yt.phase===At}))},[])}((Pt=[].concat(I,ve.options.modifiers),He=Pt.reduce(function(Ge,nt){var gt=Ge[nt.name];return Ge[nt.name]=gt?Object.assign({},gt,nt,{options:Object.assign({},gt.options,nt.options),data:Object.assign({},gt.data,nt.data)}):nt,Ge},{}),Object.keys(He).map(function(Ge){return He[Ge]})));return ve.orderedModifiers=ct.filter(function(Ge){return Ge.enabled}),ve.orderedModifiers.forEach(function(Ge){var nt=Ge.name,gt=Ge.options,At=gt===void 0?{}:gt,yt=Ge.effect;if(typeof yt=="function"){var on=yt({state:ve,name:nt,instance:Ve,options:At});je.push(on||function(){})}}),Ve.update()},forceUpdate:function(){if(!Fe){var Ue=ve.elements,St=Ue.reference,Pt=Ue.popper;if(LS(St,Pt)){ve.rects={reference:V6(St,Ud(Pt),ve.options.strategy==="fixed"),popper:v1(Pt)},ve.reset=!1,ve.placement=ve.options.placement,ve.orderedModifiers.forEach(function(yt){return ve.modifiersData[yt.name]=Object.assign({},yt.data)});for(var He=0;He<ve.orderedModifiers.length;He++)if(ve.reset!==!0){var ct=ve.orderedModifiers[He],Ge=ct.fn,nt=ct.options,gt=nt===void 0?{}:nt,At=ct.name;typeof Ge=="function"&&(ve=Ge({state:ve,options:gt,name:At,instance:Ve})||ve)}else ve.reset=!1,He=-1}}},update:(Se=function(){return new Promise(function(Ue){Ve.forceUpdate(),Ue(ve)})},function(){return Ce||(Ce=new Promise(function(Ue){Promise.resolve().then(function(){Ce=void 0,Ue(Se())})})),Ce}),destroy:function(){$e(),Fe=!0}};if(!LS(Q,re))return Ve;function $e(){je.forEach(function(Ue){return Ue()}),je=[]}return Ve.setOptions(pe).then(function(Ue){!Fe&&pe.onFirstUpdate&&pe.onFirstUpdate(Ue)}),Ve}}var z6=cp(),W6=cp({defaultModifiers:[S1,T1,x1,y1]}),_1=cp({defaultModifiers:[S1,T1,x1,y1,PS,_S,OS,SS,RS]});const FS=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ze,afterRead:ou,afterWrite:_t,applyStyles:y1,arrow:SS,auto:ot,basePlacements:Ze,beforeMain:au,beforeRead:xo,beforeWrite:Mt,bottom:Re,clippingParents:fn,computeStyles:x1,createPopper:_1,createPopperBase:z6,createPopperLite:W6,detectOverflow:Hl,end:Ke,eventListeners:S1,flip:_S,hide:RS,left:Ie,main:uu,modifierPhases:Cs,offset:PS,placements:Ui,popper:Es,popperGenerator:cp,popperOffsets:T1,preventOverflow:OS,read:Yr,reference:oi,right:Ee,start:tt,top:le,variationPlacements:Vi,viewport:zt,write:Xn},Symbol.toStringTag,{value:"Module"})),$S="dropdown",du=".bs.dropdown",I1=".data-api",j6="ArrowUp",BS="ArrowDown",G6=`hide${du}`,q6=`hidden${du}`,H6=`show${du}`,K6=`shown${du}`,MS=`click${du}${I1}`,VS=`keydown${du}${I1}`,X6=`keyup${du}${I1}`,Kl="show",fu='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Y6=`${fu}.${Kl}`,dp=".dropdown-menu",Q6=b()?"top-end":"top-start",Z6=b()?"top-start":"top-end",J6=b()?"bottom-end":"bottom-start",e$=b()?"bottom-start":"bottom-end",t$=b()?"left-start":"right-start",n$=b()?"right-start":"left-start",r$={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},s$={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ai extends _e{constructor(m,S){super(m,S),this._popper=null,this._parent=this._element.parentNode,this._menu=we.next(this._element,dp)[0]||we.prev(this._element,dp)[0]||we.findOne(dp,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return r$}static get DefaultType(){return s$}static get NAME(){return $S}toggle(){return this._isShown()?this.hide():this.show()}show(){if(c(this._element)||this._isShown())return;const m={relatedTarget:this._element};if(!F.trigger(this._element,H6,m).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const S of[].concat(...document.body.children))F.on(S,"mouseover",f);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Kl),this._element.classList.add(Kl),F.trigger(this._element,K6,m)}}hide(){if(c(this._element)||!this._isShown())return;const m={relatedTarget:this._element};this._completeHide(m)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(m){if(!F.trigger(this._element,G6,m).defaultPrevented){if("ontouchstart"in document.documentElement)for(const S of[].concat(...document.body.children))F.off(S,"mouseover",f);this._popper&&this._popper.destroy(),this._menu.classList.remove(Kl),this._element.classList.remove(Kl),this._element.setAttribute("aria-expanded","false"),ae.removeDataAttribute(this._menu,"popper"),F.trigger(this._element,q6,m)}}_getConfig(m){if(typeof(m=super._getConfig(m)).reference=="object"&&!a(m.reference)&&typeof m.reference.getBoundingClientRect!="function")throw new TypeError(`${$S.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return m}_createPopper(){if(FS===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let m=this._element;this._config.reference==="parent"?m=this._parent:a(this._config.reference)?m=u(this._config.reference):typeof this._config.reference=="object"&&(m=this._config.reference);const S=this._getPopperConfig();this._popper=_1(m,this._menu,S)}_isShown(){return this._menu.classList.contains(Kl)}_getPlacement(){const m=this._parent;if(m.classList.contains("dropend"))return t$;if(m.classList.contains("dropstart"))return n$;if(m.classList.contains("dropup-center"))return"top";if(m.classList.contains("dropdown-center"))return"bottom";const S=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return m.classList.contains("dropup")?S?Z6:Q6:S?e$:J6}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:m}=this._config;return typeof m=="string"?m.split(",").map(S=>Number.parseInt(S,10)):typeof m=="function"?S=>m(S,this._element):m}_getPopperConfig(){const m={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ae.setDataAttribute(this._menu,"popper","static"),m.modifiers=[{name:"applyStyles",enabled:!1}]),{...m,...v(this._config.popperConfig,[m])}}_selectMenuItem({key:m,target:S}){const I=we.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(q=>l(q));I.length&&x(I,S,m===BS,!I.includes(S)).focus()}static jQueryInterface(m){return this.each(function(){const S=ai.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0)throw new TypeError(`No method named "${m}"`);S[m]()}})}static clearMenus(m){if(m.button===2||m.type==="keyup"&&m.key!=="Tab")return;const S=we.find(Y6);for(const I of S){const q=ai.getInstance(I);if(!q||q._config.autoClose===!1)continue;const H=m.composedPath(),Q=H.includes(q._menu);if(H.includes(q._element)||q._config.autoClose==="inside"&&!Q||q._config.autoClose==="outside"&&Q||q._menu.contains(m.target)&&(m.type==="keyup"&&m.key==="Tab"||/input|select|option|textarea|form/i.test(m.target.tagName)))continue;const re={relatedTarget:q._element};m.type==="click"&&(re.clickEvent=m),q._completeHide(re)}}static dataApiKeydownHandler(m){const S=/input|textarea/i.test(m.target.tagName),I=m.key==="Escape",q=[j6,BS].includes(m.key);if(!q&&!I||S&&!I)return;m.preventDefault();const H=this.matches(fu)?this:we.prev(this,fu)[0]||we.next(this,fu)[0]||we.findOne(fu,m.delegateTarget.parentNode),Q=ai.getOrCreateInstance(H);if(q)return m.stopPropagation(),Q.show(),void Q._selectMenuItem(m);Q._isShown()&&(m.stopPropagation(),Q.hide(),H.focus())}}F.on(document,VS,fu,ai.dataApiKeydownHandler),F.on(document,VS,dp,ai.dataApiKeydownHandler),F.on(document,MS,ai.clearMenus),F.on(document,X6,ai.clearMenus),F.on(document,MS,fu,function(E){E.preventDefault(),ai.getOrCreateInstance(this).toggle()}),g(ai);const US="backdrop",zS="show",WS=`mousedown.bs.${US}`,i$={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},o$={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class jS extends be{constructor(m){super(),this._config=this._getConfig(m),this._isAppended=!1,this._element=null}static get Default(){return i$}static get DefaultType(){return o$}static get NAME(){return US}show(m){if(!this._config.isVisible)return void v(m);this._append();const S=this._getElement();this._config.isAnimated&&h(S),S.classList.add(zS),this._emulateAnimation(()=>{v(m)})}hide(m){this._config.isVisible?(this._getElement().classList.remove(zS),this._emulateAnimation(()=>{this.dispose(),v(m)})):v(m)}dispose(){this._isAppended&&(F.off(this._element,WS),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const m=document.createElement("div");m.className=this._config.className,this._config.isAnimated&&m.classList.add("fade"),this._element=m}return this._element}_configAfterMerge(m){return m.rootElement=u(m.rootElement),m}_append(){if(this._isAppended)return;const m=this._getElement();this._config.rootElement.append(m),F.on(m,WS,()=>{v(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(m){w(m,this._getElement(),this._config.isAnimated)}}const fp=".bs.focustrap",a$=`focusin${fp}`,u$=`keydown.tab${fp}`,GS="backward",l$={autofocus:!0,trapElement:null},c$={autofocus:"boolean",trapElement:"element"};class qS extends be{constructor(m){super(),this._config=this._getConfig(m),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return l$}static get DefaultType(){return c$}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),F.off(document,fp),F.on(document,a$,m=>this._handleFocusin(m)),F.on(document,u$,m=>this._handleKeydown(m)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,F.off(document,fp))}_handleFocusin(m){const{trapElement:S}=this._config;if(m.target===document||m.target===S||S.contains(m.target))return;const I=we.focusableChildren(S);I.length===0?S.focus():this._lastTabNavDirection===GS?I[I.length-1].focus():I[0].focus()}_handleKeydown(m){m.key==="Tab"&&(this._lastTabNavDirection=m.shiftKey?GS:"forward")}}const HS=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",KS=".sticky-top",hp="padding-right",XS="margin-right";class k1{constructor(){this._element=document.body}getWidth(){const m=document.documentElement.clientWidth;return Math.abs(window.innerWidth-m)}hide(){const m=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,hp,S=>S+m),this._setElementAttributes(HS,hp,S=>S+m),this._setElementAttributes(KS,XS,S=>S-m)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,hp),this._resetElementAttributes(HS,hp),this._resetElementAttributes(KS,XS)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(m,S,I){const q=this.getWidth();this._applyManipulationCallback(m,H=>{if(H!==this._element&&window.innerWidth>H.clientWidth+q)return;this._saveInitialAttribute(H,S);const Q=window.getComputedStyle(H).getPropertyValue(S);H.style.setProperty(S,`${I(Number.parseFloat(Q))}px`)})}_saveInitialAttribute(m,S){const I=m.style.getPropertyValue(S);I&&ae.setDataAttribute(m,S,I)}_resetElementAttributes(m,S){this._applyManipulationCallback(m,I=>{const q=ae.getDataAttribute(I,S);q!==null?(ae.removeDataAttribute(I,S),I.style.setProperty(S,q)):I.style.removeProperty(S)})}_applyManipulationCallback(m,S){if(a(m))S(m);else for(const I of we.find(m,this._element))S(I)}}const Ts=".bs.modal",d$=`hide${Ts}`,f$=`hidePrevented${Ts}`,YS=`hidden${Ts}`,QS=`show${Ts}`,h$=`shown${Ts}`,p$=`resize${Ts}`,m$=`click.dismiss${Ts}`,g$=`mousedown.dismiss${Ts}`,y$=`keydown.dismiss${Ts}`,b$=`click${Ts}.data-api`,ZS="modal-open",JS="show",R1="modal-static",v$={backdrop:!0,focus:!0,keyboard:!0},w$={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class hu extends _e{constructor(m,S){super(m,S),this._dialog=we.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new k1,this._addEventListeners()}static get Default(){return v$}static get DefaultType(){return w$}static get NAME(){return"modal"}toggle(m){return this._isShown?this.hide():this.show(m)}show(m){this._isShown||this._isTransitioning||F.trigger(this._element,QS,{relatedTarget:m}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ZS),this._adjustDialog(),this._backdrop.show(()=>this._showElement(m)))}hide(){this._isShown&&!this._isTransitioning&&(F.trigger(this._element,d$).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(JS),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){F.off(window,Ts),F.off(this._dialog,Ts),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new jS({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new qS({trapElement:this._element})}_showElement(m){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const S=we.findOne(".modal-body",this._dialog);S&&(S.scrollTop=0),h(this._element),this._element.classList.add(JS),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,F.trigger(this._element,h$,{relatedTarget:m})},this._dialog,this._isAnimated())}_addEventListeners(){F.on(this._element,y$,m=>{m.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),F.on(window,p$,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),F.on(this._element,g$,m=>{F.one(this._element,m$,S=>{this._element===m.target&&this._element===S.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ZS),this._resetAdjustments(),this._scrollBar.reset(),F.trigger(this._element,YS)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(F.trigger(this._element,f$).defaultPrevented)return;const m=this._element.scrollHeight>document.documentElement.clientHeight,S=this._element.style.overflowY;S==="hidden"||this._element.classList.contains(R1)||(m||(this._element.style.overflowY="hidden"),this._element.classList.add(R1),this._queueCallback(()=>{this._element.classList.remove(R1),this._queueCallback(()=>{this._element.style.overflowY=S},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const m=this._element.scrollHeight>document.documentElement.clientHeight,S=this._scrollBar.getWidth(),I=S>0;if(I&&!m){const q=b()?"paddingLeft":"paddingRight";this._element.style[q]=`${S}px`}if(!I&&m){const q=b()?"paddingRight":"paddingLeft";this._element.style[q]=`${S}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(m,S){return this.each(function(){const I=hu.getOrCreateInstance(this,m);if(typeof m=="string"){if(I[m]===void 0)throw new TypeError(`No method named "${m}"`);I[m](S)}})}}F.on(document,b$,'[data-bs-toggle="modal"]',function(E){const m=we.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&E.preventDefault(),F.one(m,QS,I=>{I.defaultPrevented||F.one(m,YS,()=>{l(this)&&this.focus()})});const S=we.findOne(".modal.show");S&&hu.getInstance(S).hide(),hu.getOrCreateInstance(m).toggle(this)}),Hn(hu),g(hu);const Ao=".bs.offcanvas",eA=".data-api",x$=`load${Ao}${eA}`,tA="show",nA="showing",rA="hiding",sA=".offcanvas.show",S$=`show${Ao}`,A$=`shown${Ao}`,E$=`hide${Ao}`,iA=`hidePrevented${Ao}`,oA=`hidden${Ao}`,C$=`resize${Ao}`,N$=`click${Ao}${eA}`,T$=`keydown.dismiss${Ao}`,_$={backdrop:!0,keyboard:!0,scroll:!1},I$={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Eo extends _e{constructor(m,S){super(m,S),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return _$}static get DefaultType(){return I$}static get NAME(){return"offcanvas"}toggle(m){return this._isShown?this.hide():this.show(m)}show(m){this._isShown||F.trigger(this._element,S$,{relatedTarget:m}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new k1().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(nA),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(tA),this._element.classList.remove(nA),F.trigger(this._element,A$,{relatedTarget:m})},this._element,!0))}hide(){this._isShown&&(F.trigger(this._element,E$).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(rA),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(tA,rA),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new k1().reset(),F.trigger(this._element,oA)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const m=!!this._config.backdrop;return new jS({className:"offcanvas-backdrop",isVisible:m,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:m?()=>{this._config.backdrop!=="static"?this.hide():F.trigger(this._element,iA)}:null})}_initializeFocusTrap(){return new qS({trapElement:this._element})}_addEventListeners(){F.on(this._element,T$,m=>{m.key==="Escape"&&(this._config.keyboard?this.hide():F.trigger(this._element,iA))})}static jQueryInterface(m){return this.each(function(){const S=Eo.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);S[m](this)}})}}F.on(document,N$,'[data-bs-toggle="offcanvas"]',function(E){const m=we.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&E.preventDefault(),c(this))return;F.one(m,oA,()=>{l(this)&&this.focus()});const S=we.findOne(sA);S&&S!==m&&Eo.getInstance(S).hide(),Eo.getOrCreateInstance(m).toggle(this)}),F.on(window,x$,()=>{for(const E of we.find(sA))Eo.getOrCreateInstance(E).show()}),F.on(window,C$,()=>{for(const E of we.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(E).position!=="fixed"&&Eo.getOrCreateInstance(E).hide()}),Hn(Eo),g(Eo);const aA={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},k$=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),R$=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,P$=(E,m)=>{const S=E.nodeName.toLowerCase();return m.includes(S)?!k$.has(S)||!!R$.test(E.nodeValue):m.filter(I=>I instanceof RegExp).some(I=>I.test(S))},O$={allowList:aA,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},D$={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},L$={entry:"(string|element|function|null)",selector:"(string|element)"};class F$ extends be{constructor(m){super(),this._config=this._getConfig(m)}static get Default(){return O$}static get DefaultType(){return D$}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(m=>this._resolvePossibleFunction(m)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(m){return this._checkContent(m),this._config.content={...this._config.content,...m},this}toHtml(){const m=document.createElement("div");m.innerHTML=this._maybeSanitize(this._config.template);for(const[q,H]of Object.entries(this._config.content))this._setContent(m,H,q);const S=m.children[0],I=this._resolvePossibleFunction(this._config.extraClass);return I&&S.classList.add(...I.split(" ")),S}_typeCheckConfig(m){super._typeCheckConfig(m),this._checkContent(m.content)}_checkContent(m){for(const[S,I]of Object.entries(m))super._typeCheckConfig({selector:S,entry:I},L$)}_setContent(m,S,I){const q=we.findOne(I,m);q&&((S=this._resolvePossibleFunction(S))?a(S)?this._putElementInTemplate(u(S),q):this._config.html?q.innerHTML=this._maybeSanitize(S):q.textContent=S:q.remove())}_maybeSanitize(m){return this._config.sanitize?function(S,I,q){if(!S.length)return S;if(q&&typeof q=="function")return q(S);const H=new window.DOMParser().parseFromString(S,"text/html"),Q=[].concat(...H.body.querySelectorAll("*"));for(const re of Q){const pe=re.nodeName.toLowerCase();if(!Object.keys(I).includes(pe)){re.remove();continue}const Se=[].concat(...re.attributes),Ce=[].concat(I["*"]||[],I[pe]||[]);for(const ve of Se)P$(ve,Ce)||re.removeAttribute(ve.nodeName)}return H.body.innerHTML}(m,this._config.allowList,this._config.sanitizeFn):m}_resolvePossibleFunction(m){return v(m,[this])}_putElementInTemplate(m,S){if(this._config.html)return S.innerHTML="",void S.append(m);S.textContent=m.textContent}}const $$=new Set(["sanitize","allowList","sanitizeFn"]),P1="fade",pp="show",uA=".modal",lA="hide.bs.modal",jd="hover",O1="focus",B$={AUTO:"auto",TOP:"top",RIGHT:b()?"left":"right",BOTTOM:"bottom",LEFT:b()?"right":"left"},M$={allowList:aA,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},V$={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class pu extends _e{constructor(m,S){if(FS===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(m,S),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return M$}static get DefaultType(){return V$}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),F.off(this._element.closest(uA),lA,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const m=F.trigger(this._element,this.constructor.eventName("show")),S=(d(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(m.defaultPrevented||!S)return;this._disposePopper();const I=this._getTipElement();this._element.setAttribute("aria-describedby",I.getAttribute("id"));const{container:q}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(q.append(I),F.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(I),I.classList.add(pp),"ontouchstart"in document.documentElement)for(const H of[].concat(...document.body.children))F.on(H,"mouseover",f);this._queueCallback(()=>{F.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!F.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(pp),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))F.off(m,"mouseover",f);this._activeTrigger.click=!1,this._activeTrigger[O1]=!1,this._activeTrigger[jd]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),F.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(m){const S=this._getTemplateFactory(m).toHtml();if(!S)return null;S.classList.remove(P1,pp),S.classList.add(`bs-${this.constructor.NAME}-auto`);const I=(q=>{do q+=Math.floor(1e6*Math.random());while(document.getElementById(q));return q})(this.constructor.NAME).toString();return S.setAttribute("id",I),this._isAnimated()&&S.classList.add(P1),S}setContent(m){this._newContent=m,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(m){return this._templateFactory?this._templateFactory.changeContent(m):this._templateFactory=new F$({...this._config,content:m,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(m){return this.constructor.getOrCreateInstance(m.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(P1)}_isShown(){return this.tip&&this.tip.classList.contains(pp)}_createPopper(m){const S=v(this._config.placement,[this,m,this._element]),I=B$[S.toUpperCase()];return _1(this._element,m,this._getPopperConfig(I))}_getOffset(){const{offset:m}=this._config;return typeof m=="string"?m.split(",").map(S=>Number.parseInt(S,10)):typeof m=="function"?S=>m(S,this._element):m}_resolvePossibleFunction(m){return v(m,[this._element])}_getPopperConfig(m){const S={placement:m,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:I=>{this._getTipElement().setAttribute("data-popper-placement",I.state.placement)}}]};return{...S,...v(this._config.popperConfig,[S])}}_setListeners(){const m=this._config.trigger.split(" ");for(const S of m)if(S==="click")F.on(this._element,this.constructor.eventName("click"),this._config.selector,I=>{this._initializeOnDelegatedTarget(I).toggle()});else if(S!=="manual"){const I=S===jd?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),q=S===jd?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");F.on(this._element,I,this._config.selector,H=>{const Q=this._initializeOnDelegatedTarget(H);Q._activeTrigger[H.type==="focusin"?O1:jd]=!0,Q._enter()}),F.on(this._element,q,this._config.selector,H=>{const Q=this._initializeOnDelegatedTarget(H);Q._activeTrigger[H.type==="focusout"?O1:jd]=Q._element.contains(H.relatedTarget),Q._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},F.on(this._element.closest(uA),lA,this._hideModalHandler)}_fixTitle(){const m=this._element.getAttribute("title");m&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",m),this._element.setAttribute("data-bs-original-title",m),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(m,S){clearTimeout(this._timeout),this._timeout=setTimeout(m,S)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(m){const S=ae.getDataAttributes(this._element);for(const I of Object.keys(S))$$.has(I)&&delete S[I];return m={...S,...typeof m=="object"&&m?m:{}},m=this._mergeConfigObj(m),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}_configAfterMerge(m){return m.container=m.container===!1?document.body:u(m.container),typeof m.delay=="number"&&(m.delay={show:m.delay,hide:m.delay}),typeof m.title=="number"&&(m.title=m.title.toString()),typeof m.content=="number"&&(m.content=m.content.toString()),m}_getDelegateConfig(){const m={};for(const[S,I]of Object.entries(this._config))this.constructor.Default[S]!==I&&(m[S]=I);return m.selector=!1,m.trigger="manual",m}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(m){return this.each(function(){const S=pu.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0)throw new TypeError(`No method named "${m}"`);S[m]()}})}}g(pu);const U$={...pu.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},z$={...pu.DefaultType,content:"(null|string|element|function)"};class mp extends pu{static get Default(){return U$}static get DefaultType(){return z$}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(m){return this.each(function(){const S=mp.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0)throw new TypeError(`No method named "${m}"`);S[m]()}})}}g(mp);const D1=".bs.scrollspy",W$=`activate${D1}`,cA=`click${D1}`,j$=`load${D1}.data-api`,Xl="active",L1="[href]",dA=".nav-link",G$=`${dA}, .nav-item > ${dA}, .list-group-item`,q$={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},H$={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Gd extends _e{constructor(m,S){super(m,S),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return q$}static get DefaultType(){return H$}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const m of this._observableSections.values())this._observer.observe(m)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(m){return m.target=u(m.target)||document.body,m.rootMargin=m.offset?`${m.offset}px 0px -30%`:m.rootMargin,typeof m.threshold=="string"&&(m.threshold=m.threshold.split(",").map(S=>Number.parseFloat(S))),m}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(F.off(this._config.target,cA),F.on(this._config.target,cA,L1,m=>{const S=this._observableSections.get(m.target.hash);if(S){m.preventDefault();const I=this._rootElement||window,q=S.offsetTop-this._element.offsetTop;if(I.scrollTo)return void I.scrollTo({top:q,behavior:"smooth"});I.scrollTop=q}}))}_getNewObserver(){const m={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(S=>this._observerCallback(S),m)}_observerCallback(m){const S=Q=>this._targetLinks.get(`#${Q.target.id}`),I=Q=>{this._previousScrollData.visibleEntryTop=Q.target.offsetTop,this._process(S(Q))},q=(this._rootElement||document.documentElement).scrollTop,H=q>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=q;for(const Q of m){if(!Q.isIntersecting){this._activeTarget=null,this._clearActiveClass(S(Q));continue}const re=Q.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(H&&re){if(I(Q),!q)return}else H||re||I(Q)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const m=we.find(L1,this._config.target);for(const S of m){if(!S.hash||c(S))continue;const I=we.findOne(decodeURI(S.hash),this._element);l(I)&&(this._targetLinks.set(decodeURI(S.hash),S),this._observableSections.set(S.hash,I))}}_process(m){this._activeTarget!==m&&(this._clearActiveClass(this._config.target),this._activeTarget=m,m.classList.add(Xl),this._activateParents(m),F.trigger(this._element,W$,{relatedTarget:m}))}_activateParents(m){if(m.classList.contains("dropdown-item"))we.findOne(".dropdown-toggle",m.closest(".dropdown")).classList.add(Xl);else for(const S of we.parents(m,".nav, .list-group"))for(const I of we.prev(S,G$))I.classList.add(Xl)}_clearActiveClass(m){m.classList.remove(Xl);const S=we.find(`${L1}.${Xl}`,m);for(const I of S)I.classList.remove(Xl)}static jQueryInterface(m){return this.each(function(){const S=Gd.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);S[m]()}})}}F.on(window,j$,()=>{for(const E of we.find('[data-bs-spy="scroll"]'))Gd.getOrCreateInstance(E)}),g(Gd);const mu=".bs.tab",K$=`hide${mu}`,X$=`hidden${mu}`,Y$=`show${mu}`,Q$=`shown${mu}`,Z$=`click${mu}`,J$=`keydown${mu}`,eB=`load${mu}`,tB="ArrowLeft",fA="ArrowRight",nB="ArrowUp",hA="ArrowDown",F1="Home",pA="End",gu="active",mA="fade",$1="show",gA=".dropdown-toggle",B1=`:not(${gA})`,yA='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',M1=`.nav-link${B1}, .list-group-item${B1}, [role="tab"]${B1}, ${yA}`,rB=`.${gu}[data-bs-toggle="tab"], .${gu}[data-bs-toggle="pill"], .${gu}[data-bs-toggle="list"]`;class yu extends _e{constructor(m){super(m),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),F.on(this._element,J$,S=>this._keydown(S)))}static get NAME(){return"tab"}show(){const m=this._element;if(this._elemIsActive(m))return;const S=this._getActiveElem(),I=S?F.trigger(S,K$,{relatedTarget:m}):null;F.trigger(m,Y$,{relatedTarget:S}).defaultPrevented||I&&I.defaultPrevented||(this._deactivate(S,m),this._activate(m,S))}_activate(m,S){m&&(m.classList.add(gu),this._activate(we.getElementFromSelector(m)),this._queueCallback(()=>{m.getAttribute("role")==="tab"?(m.removeAttribute("tabindex"),m.setAttribute("aria-selected",!0),this._toggleDropDown(m,!0),F.trigger(m,Q$,{relatedTarget:S})):m.classList.add($1)},m,m.classList.contains(mA)))}_deactivate(m,S){m&&(m.classList.remove(gu),m.blur(),this._deactivate(we.getElementFromSelector(m)),this._queueCallback(()=>{m.getAttribute("role")==="tab"?(m.setAttribute("aria-selected",!1),m.setAttribute("tabindex","-1"),this._toggleDropDown(m,!1),F.trigger(m,X$,{relatedTarget:S})):m.classList.remove($1)},m,m.classList.contains(mA)))}_keydown(m){if(![tB,fA,nB,hA,F1,pA].includes(m.key))return;m.stopPropagation(),m.preventDefault();const S=this._getChildren().filter(q=>!c(q));let I;if([F1,pA].includes(m.key))I=S[m.key===F1?0:S.length-1];else{const q=[fA,hA].includes(m.key);I=x(S,m.target,q,!0)}I&&(I.focus({preventScroll:!0}),yu.getOrCreateInstance(I).show())}_getChildren(){return we.find(M1,this._parent)}_getActiveElem(){return this._getChildren().find(m=>this._elemIsActive(m))||null}_setInitialAttributes(m,S){this._setAttributeIfNotExists(m,"role","tablist");for(const I of S)this._setInitialAttributesOnChild(I)}_setInitialAttributesOnChild(m){m=this._getInnerElement(m);const S=this._elemIsActive(m),I=this._getOuterElement(m);m.setAttribute("aria-selected",S),I!==m&&this._setAttributeIfNotExists(I,"role","presentation"),S||m.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(m,"role","tab"),this._setInitialAttributesOnTargetPanel(m)}_setInitialAttributesOnTargetPanel(m){const S=we.getElementFromSelector(m);S&&(this._setAttributeIfNotExists(S,"role","tabpanel"),m.id&&this._setAttributeIfNotExists(S,"aria-labelledby",`${m.id}`))}_toggleDropDown(m,S){const I=this._getOuterElement(m);if(!I.classList.contains("dropdown"))return;const q=(H,Q)=>{const re=we.findOne(H,I);re&&re.classList.toggle(Q,S)};q(gA,gu),q(".dropdown-menu",$1),I.setAttribute("aria-expanded",S)}_setAttributeIfNotExists(m,S,I){m.hasAttribute(S)||m.setAttribute(S,I)}_elemIsActive(m){return m.classList.contains(gu)}_getInnerElement(m){return m.matches(M1)?m:we.findOne(M1,m)}_getOuterElement(m){return m.closest(".nav-item, .list-group-item")||m}static jQueryInterface(m){return this.each(function(){const S=yu.getOrCreateInstance(this);if(typeof m=="string"){if(S[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);S[m]()}})}}F.on(document,Z$,yA,function(E){["A","AREA"].includes(this.tagName)&&E.preventDefault(),c(this)||yu.getOrCreateInstance(this).show()}),F.on(window,eB,()=>{for(const E of we.find(rB))yu.getOrCreateInstance(E)}),g(yu);const ta=".bs.toast",sB=`mouseover${ta}`,iB=`mouseout${ta}`,oB=`focusin${ta}`,aB=`focusout${ta}`,uB=`hide${ta}`,lB=`hidden${ta}`,cB=`show${ta}`,dB=`shown${ta}`,bA="hide",gp="show",yp="showing",fB={animation:"boolean",autohide:"boolean",delay:"number"},hB={animation:!0,autohide:!0,delay:5e3};class qd extends _e{constructor(m,S){super(m,S),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return hB}static get DefaultType(){return fB}static get NAME(){return"toast"}show(){F.trigger(this._element,cB).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(bA),h(this._element),this._element.classList.add(gp,yp),this._queueCallback(()=>{this._element.classList.remove(yp),F.trigger(this._element,dB),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(F.trigger(this._element,uB).defaultPrevented||(this._element.classList.add(yp),this._queueCallback(()=>{this._element.classList.add(bA),this._element.classList.remove(yp,gp),F.trigger(this._element,lB)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(gp),super.dispose()}isShown(){return this._element.classList.contains(gp)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(m,S){switch(m.type){case"mouseover":case"mouseout":this._hasMouseInteraction=S;break;case"focusin":case"focusout":this._hasKeyboardInteraction=S}if(S)return void this._clearTimeout();const I=m.relatedTarget;this._element===I||this._element.contains(I)||this._maybeScheduleHide()}_setListeners(){F.on(this._element,sB,m=>this._onInteraction(m,!0)),F.on(this._element,iB,m=>this._onInteraction(m,!1)),F.on(this._element,oB,m=>this._onInteraction(m,!0)),F.on(this._element,aB,m=>this._onInteraction(m,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(m){return this.each(function(){const S=qd.getOrCreateInstance(this,m);if(typeof m=="string"){if(S[m]===void 0)throw new TypeError(`No method named "${m}"`);S[m](this)}})}}return Hn(qd),g(qd),{Alert:As,Button:En,Carousel:wo,Collapse:Pe,Dropdown:ai,Modal:hu,Offcanvas:Eo,Popover:mp,ScrollSpy:Gd,Tab:yu,Toast:qd,Tooltip:pu}})})(GB);var g_={exports:{}},ms={},y_={exports:{}},b_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,V){var F=D.length;D.push(V);e:for(;0<F;){var ue=F-1>>>1,se=D[ue];if(0<s(se,V))D[ue]=V,D[F]=se,F=ue;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var V=D[0],F=D.pop();if(F!==V){D[0]=F;e:for(var ue=0,se=D.length,he=se>>>1;ue<he;){var ae=2*(ue+1)-1,be=D[ae],_e=ae+1,lt=D[_e];if(0>s(be,F))_e<se&&0>s(lt,be)?(D[ue]=lt,D[_e]=F,ue=_e):(D[ue]=be,D[ae]=F,ue=ae);else if(_e<se&&0>s(lt,F))D[ue]=lt,D[_e]=F,ue=_e;else break e}}return V}function s(D,V){var F=D.sortIndex-V.sortIndex;return F!==0?F:D.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var u=[],l=[],c=1,d=null,f=3,h=!1,p=!1,y=!1,b=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var V=n(l);V!==null;){if(V.callback===null)r(l);else if(V.startTime<=D)r(l),V.sortIndex=V.expirationTime,e(u,V);else break;V=n(l)}}function x(D){if(y=!1,w(D),!p)if(n(u)!==null)p=!0,M(C);else{var V=n(l);V!==null&&O(x,V.startTime-D)}}function C(D,V){p=!1,y&&(y=!1,g(N),N=-1),h=!0;var F=f;try{for(w(V),d=n(u);d!==null&&(!(d.expirationTime>V)||D&&!K());){var ue=d.callback;if(typeof ue=="function"){d.callback=null,f=d.priorityLevel;var se=ue(d.expirationTime<=V);V=t.unstable_now(),typeof se=="function"?d.callback=se:d===n(u)&&r(u),w(V)}else r(u);d=n(u)}if(d!==null)var he=!0;else{var ae=n(l);ae!==null&&O(x,ae.startTime-V),he=!1}return he}finally{d=null,f=F,h=!1}}var k=!1,P=null,N=-1,$=5,U=-1;function K(){return!(t.unstable_now()-U<$)}function Z(){if(P!==null){var D=t.unstable_now();U=D;var V=!0;try{V=P(!0,D)}finally{V?ie():(k=!1,P=null)}}else k=!1}var ie;if(typeof v=="function")ie=function(){v(Z)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,j=ee.port2;ee.port1.onmessage=Z,ie=function(){j.postMessage(null)}}else ie=function(){b(Z,0)};function M(D){P=D,k||(k=!0,ie())}function O(D,V){N=b(function(){D(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,M(C))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(D){switch(f){case 1:case 2:case 3:var V=3;break;default:V=f}var F=f;f=V;try{return D()}finally{f=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,V){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=f;f=D;try{return V()}finally{f=F}},t.unstable_scheduleCallback=function(D,V,F){var ue=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ue+F:ue):F=ue,D){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=F+se,D={id:c++,callback:V,priorityLevel:D,startTime:F,expirationTime:se,sortIndex:-1},F>ue?(D.sortIndex=F,e(l,D),n(u)===null&&D===n(l)&&(y?(g(N),N=-1):y=!0,O(x,F-ue))):(D.sortIndex=se,e(u,D),p||h||(p=!0,M(C))),D},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(D){var V=f;return function(){var F=f;f=V;try{return D.apply(this,arguments)}finally{f=F}}}})(b_);y_.exports=b_;var qB=y_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HB=L,ds=qB;function ce(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v_=new Set,Xf={};function vl(t,e){jc(t,e),jc(t+"Capture",e)}function jc(t,e){for(Xf[t]=e,t=0;t<e.length;t++)v_.add(e[t])}var Vo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cb=Object.prototype.hasOwnProperty,KB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,DA={},LA={};function XB(t){return cb.call(LA,t)?!0:cb.call(DA,t)?!1:KB.test(t)?LA[t]=!0:(DA[t]=!0,!1)}function YB(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QB(t,e,n,r){if(e===null||typeof e>"u"||YB(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Gn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gn[t]=new kr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gn[e]=new kr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gn[t]=new kr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gn[t]=new kr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gn[t]=new kr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gn[t]=new kr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gn[t]=new kr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gn[t]=new kr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gn[t]=new kr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Iw=/[\-:]([a-z])/g;function kw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Iw,kw);Gn[e]=new kr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Iw,kw);Gn[e]=new kr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Iw,kw);Gn[e]=new kr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gn[t]=new kr(t,1,!1,t.toLowerCase(),null,!1,!1)});Gn.xlinkHref=new kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gn[t]=new kr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Rw(t,e,n,r){var s=Gn.hasOwnProperty(e)?Gn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QB(e,n,s,r)&&(n=null),r||s===null?XB(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ko=HB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sp=Symbol.for("react.element"),cc=Symbol.for("react.portal"),dc=Symbol.for("react.fragment"),Pw=Symbol.for("react.strict_mode"),db=Symbol.for("react.profiler"),w_=Symbol.for("react.provider"),x_=Symbol.for("react.context"),Ow=Symbol.for("react.forward_ref"),fb=Symbol.for("react.suspense"),hb=Symbol.for("react.suspense_list"),Dw=Symbol.for("react.memo"),fa=Symbol.for("react.lazy"),S_=Symbol.for("react.offscreen"),FA=Symbol.iterator;function Hd(t){return t===null||typeof t!="object"?null:(t=FA&&t[FA]||t["@@iterator"],typeof t=="function"?t:null)}var Jt=Object.assign,j1;function vf(t){if(j1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);j1=e&&e[1]||""}return`
`+j1+t}var G1=!1;function q1(t,e){if(!t||G1)return"";G1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=a);break}}}finally{G1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?vf(t):""}function ZB(t){switch(t.tag){case 5:return vf(t.type);case 16:return vf("Lazy");case 13:return vf("Suspense");case 19:return vf("SuspenseList");case 0:case 2:case 15:return t=q1(t.type,!1),t;case 11:return t=q1(t.type.render,!1),t;case 1:return t=q1(t.type,!0),t;default:return""}}function pb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case dc:return"Fragment";case cc:return"Portal";case db:return"Profiler";case Pw:return"StrictMode";case fb:return"Suspense";case hb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case x_:return(t.displayName||"Context")+".Consumer";case w_:return(t._context.displayName||"Context")+".Provider";case Ow:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dw:return e=t.displayName||null,e!==null?e:pb(t.type)||"Memo";case fa:e=t._payload,t=t._init;try{return pb(t(e))}catch{}}return null}function JB(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pb(e);case 8:return e===Pw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ba(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function A_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eM(t){var e=A_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ap(t){t._valueTracker||(t._valueTracker=eM(t))}function E_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=A_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function mb(t,e){var n=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function $A(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ba(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function C_(t,e){e=e.checked,e!=null&&Rw(t,"checked",e,!1)}function gb(t,e){C_(t,e);var n=Ba(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yb(t,e.type,n):e.hasOwnProperty("defaultValue")&&yb(t,e.type,Ba(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function BA(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yb(t,e,n){(e!=="number"||Gm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var wf=Array.isArray;function Ic(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ba(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function bb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MA(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ce(92));if(wf(n)){if(1<n.length)throw Error(ce(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ba(n)}}function N_(t,e){var n=Ba(e.value),r=Ba(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function VA(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function T_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?T_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ep,__=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ep=Ep||document.createElement("div"),Ep.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ep.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tM=["Webkit","ms","Moz","O"];Object.keys(Lf).forEach(function(t){tM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lf[e]=Lf[t]})});function I_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lf.hasOwnProperty(t)&&Lf[t]?(""+e).trim():e+"px"}function k_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=I_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var nM=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wb(t,e){if(e){if(nM[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function xb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sb=null;function Lw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ab=null,kc=null,Rc=null;function UA(t){if(t=Oh(t)){if(typeof Ab!="function")throw Error(ce(280));var e=t.stateNode;e&&(e=ig(e),Ab(t.stateNode,t.type,e))}}function R_(t){kc?Rc?Rc.push(t):Rc=[t]:kc=t}function P_(){if(kc){var t=kc,e=Rc;if(Rc=kc=null,UA(t),e)for(t=0;t<e.length;t++)UA(e[t])}}function O_(t,e){return t(e)}function D_(){}var H1=!1;function L_(t,e,n){if(H1)return t(e,n);H1=!0;try{return O_(t,e,n)}finally{H1=!1,(kc!==null||Rc!==null)&&(D_(),P_())}}function Qf(t,e){var n=t.stateNode;if(n===null)return null;var r=ig(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ce(231,e,typeof n));return n}var Eb=!1;if(Vo)try{var Kd={};Object.defineProperty(Kd,"passive",{get:function(){Eb=!0}}),window.addEventListener("test",Kd,Kd),window.removeEventListener("test",Kd,Kd)}catch{Eb=!1}function rM(t,e,n,r,s,i,o,a,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(c){this.onError(c)}}var Ff=!1,qm=null,Hm=!1,Cb=null,sM={onError:function(t){Ff=!0,qm=t}};function iM(t,e,n,r,s,i,o,a,u){Ff=!1,qm=null,rM.apply(sM,arguments)}function oM(t,e,n,r,s,i,o,a,u){if(iM.apply(this,arguments),Ff){if(Ff){var l=qm;Ff=!1,qm=null}else throw Error(ce(198));Hm||(Hm=!0,Cb=l)}}function wl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function F_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zA(t){if(wl(t)!==t)throw Error(ce(188))}function aM(t){var e=t.alternate;if(!e){if(e=wl(t),e===null)throw Error(ce(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return zA(s),t;if(i===r)return zA(s),e;i=i.sibling}throw Error(ce(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(ce(189))}}if(n.alternate!==r)throw Error(ce(190))}if(n.tag!==3)throw Error(ce(188));return n.stateNode.current===n?t:e}function $_(t){return t=aM(t),t!==null?B_(t):null}function B_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=B_(t);if(e!==null)return e;t=t.sibling}return null}var M_=ds.unstable_scheduleCallback,WA=ds.unstable_cancelCallback,uM=ds.unstable_shouldYield,lM=ds.unstable_requestPaint,un=ds.unstable_now,cM=ds.unstable_getCurrentPriorityLevel,Fw=ds.unstable_ImmediatePriority,V_=ds.unstable_UserBlockingPriority,Km=ds.unstable_NormalPriority,dM=ds.unstable_LowPriority,U_=ds.unstable_IdlePriority,tg=null,ro=null;function fM(t){if(ro&&typeof ro.onCommitFiberRoot=="function")try{ro.onCommitFiberRoot(tg,t,void 0,(t.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:mM,hM=Math.log,pM=Math.LN2;function mM(t){return t>>>=0,t===0?32:31-(hM(t)/pM|0)|0}var Cp=64,Np=4194304;function xf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=xf(a):(i&=o,i!==0&&(r=xf(i)))}else o=n&~s,o!==0?r=xf(o):i!==0&&(r=xf(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ti(e),s=1<<n,r|=t[n],e&=~s;return r}function gM(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yM(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Ti(i),a=1<<o,u=s[o];u===-1?(!(a&n)||a&r)&&(s[o]=gM(a,e)):u<=e&&(t.expiredLanes|=a),i&=~a}}function Nb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function z_(){var t=Cp;return Cp<<=1,!(Cp&4194240)&&(Cp=64),t}function K1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Rh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ti(e),t[e]=n}function bM(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Ti(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function $w(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ti(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var vt=0;function W_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var j_,Bw,G_,q_,H_,Tb=!1,Tp=[],Na=null,Ta=null,_a=null,Zf=new Map,Jf=new Map,ya=[],vM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jA(t,e){switch(t){case"focusin":case"focusout":Na=null;break;case"dragenter":case"dragleave":Ta=null;break;case"mouseover":case"mouseout":_a=null;break;case"pointerover":case"pointerout":Zf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jf.delete(e.pointerId)}}function Xd(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Oh(e),e!==null&&Bw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function wM(t,e,n,r,s){switch(e){case"focusin":return Na=Xd(Na,t,e,n,r,s),!0;case"dragenter":return Ta=Xd(Ta,t,e,n,r,s),!0;case"mouseover":return _a=Xd(_a,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Zf.set(i,Xd(Zf.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Jf.set(i,Xd(Jf.get(i)||null,t,e,n,r,s)),!0}return!1}function K_(t){var e=$u(t.target);if(e!==null){var n=wl(e);if(n!==null){if(e=n.tag,e===13){if(e=F_(n),e!==null){t.blockedOn=e,H_(t.priority,function(){G_(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ym(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=_b(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Sb=r,n.target.dispatchEvent(r),Sb=null}else return e=Oh(n),e!==null&&Bw(e),t.blockedOn=n,!1;e.shift()}return!0}function GA(t,e,n){ym(t)&&n.delete(e)}function xM(){Tb=!1,Na!==null&&ym(Na)&&(Na=null),Ta!==null&&ym(Ta)&&(Ta=null),_a!==null&&ym(_a)&&(_a=null),Zf.forEach(GA),Jf.forEach(GA)}function Yd(t,e){t.blockedOn===e&&(t.blockedOn=null,Tb||(Tb=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,xM)))}function eh(t){function e(s){return Yd(s,t)}if(0<Tp.length){Yd(Tp[0],t);for(var n=1;n<Tp.length;n++){var r=Tp[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Na!==null&&Yd(Na,t),Ta!==null&&Yd(Ta,t),_a!==null&&Yd(_a,t),Zf.forEach(e),Jf.forEach(e),n=0;n<ya.length;n++)r=ya[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ya.length&&(n=ya[0],n.blockedOn===null);)K_(n),n.blockedOn===null&&ya.shift()}var Pc=Ko.ReactCurrentBatchConfig,Ym=!0;function SM(t,e,n,r){var s=vt,i=Pc.transition;Pc.transition=null;try{vt=1,Mw(t,e,n,r)}finally{vt=s,Pc.transition=i}}function AM(t,e,n,r){var s=vt,i=Pc.transition;Pc.transition=null;try{vt=4,Mw(t,e,n,r)}finally{vt=s,Pc.transition=i}}function Mw(t,e,n,r){if(Ym){var s=_b(t,e,n,r);if(s===null)sy(t,e,r,Qm,n),jA(t,r);else if(wM(s,t,e,n,r))r.stopPropagation();else if(jA(t,r),e&4&&-1<vM.indexOf(t)){for(;s!==null;){var i=Oh(s);if(i!==null&&j_(i),i=_b(t,e,n,r),i===null&&sy(t,e,r,Qm,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sy(t,e,r,null,n)}}var Qm=null;function _b(t,e,n,r){if(Qm=null,t=Lw(r),t=$u(t),t!==null)if(e=wl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=F_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qm=t,null}function X_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cM()){case Fw:return 1;case V_:return 4;case Km:case dM:return 16;case U_:return 536870912;default:return 16}default:return 16}}var va=null,Vw=null,bm=null;function Y_(){if(bm)return bm;var t,e=Vw,n=e.length,r,s="value"in va?va.value:va.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return bm=s.slice(t,1<r?1-r:void 0)}function vm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _p(){return!0}function qA(){return!1}function gs(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_p:qA,this.isPropagationStopped=qA,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_p)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_p)},persist:function(){},isPersistent:_p}),e}var fd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uw=gs(fd),Ph=Jt({},fd,{view:0,detail:0}),EM=gs(Ph),X1,Y1,Qd,ng=Jt({},Ph,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qd&&(Qd&&t.type==="mousemove"?(X1=t.screenX-Qd.screenX,Y1=t.screenY-Qd.screenY):Y1=X1=0,Qd=t),X1)},movementY:function(t){return"movementY"in t?t.movementY:Y1}}),HA=gs(ng),CM=Jt({},ng,{dataTransfer:0}),NM=gs(CM),TM=Jt({},Ph,{relatedTarget:0}),Q1=gs(TM),_M=Jt({},fd,{animationName:0,elapsedTime:0,pseudoElement:0}),IM=gs(_M),kM=Jt({},fd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RM=gs(kM),PM=Jt({},fd,{data:0}),KA=gs(PM),OM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FM(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=LM[t])?!!e[t]:!1}function zw(){return FM}var $M=Jt({},Ph,{key:function(t){if(t.key){var e=OM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?DM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zw,charCode:function(t){return t.type==="keypress"?vm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BM=gs($M),MM=Jt({},ng,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XA=gs(MM),VM=Jt({},Ph,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zw}),UM=gs(VM),zM=Jt({},fd,{propertyName:0,elapsedTime:0,pseudoElement:0}),WM=gs(zM),jM=Jt({},ng,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GM=gs(jM),qM=[9,13,27,32],Ww=Vo&&"CompositionEvent"in window,$f=null;Vo&&"documentMode"in document&&($f=document.documentMode);var HM=Vo&&"TextEvent"in window&&!$f,Q_=Vo&&(!Ww||$f&&8<$f&&11>=$f),YA=" ",QA=!1;function Z_(t,e){switch(t){case"keyup":return qM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fc=!1;function KM(t,e){switch(t){case"compositionend":return J_(e);case"keypress":return e.which!==32?null:(QA=!0,YA);case"textInput":return t=e.data,t===YA&&QA?null:t;default:return null}}function XM(t,e){if(fc)return t==="compositionend"||!Ww&&Z_(t,e)?(t=Y_(),bm=Vw=va=null,fc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Q_&&e.locale!=="ko"?null:e.data;default:return null}}var YM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZA(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YM[t.type]:e==="textarea"}function eI(t,e,n,r){R_(r),e=Zm(e,"onChange"),0<e.length&&(n=new Uw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bf=null,th=null;function QM(t){dI(t,0)}function rg(t){var e=mc(t);if(E_(e))return t}function ZM(t,e){if(t==="change")return e}var tI=!1;if(Vo){var Z1;if(Vo){var J1="oninput"in document;if(!J1){var JA=document.createElement("div");JA.setAttribute("oninput","return;"),J1=typeof JA.oninput=="function"}Z1=J1}else Z1=!1;tI=Z1&&(!document.documentMode||9<document.documentMode)}function eE(){Bf&&(Bf.detachEvent("onpropertychange",nI),th=Bf=null)}function nI(t){if(t.propertyName==="value"&&rg(th)){var e=[];eI(e,th,t,Lw(t)),L_(QM,e)}}function JM(t,e,n){t==="focusin"?(eE(),Bf=e,th=n,Bf.attachEvent("onpropertychange",nI)):t==="focusout"&&eE()}function e8(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rg(th)}function t8(t,e){if(t==="click")return rg(e)}function n8(t,e){if(t==="input"||t==="change")return rg(e)}function r8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ri=typeof Object.is=="function"?Object.is:r8;function nh(t,e){if(Ri(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!cb.call(e,s)||!Ri(t[s],e[s]))return!1}return!0}function tE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nE(t,e){var n=tE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tE(n)}}function rI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sI(){for(var t=window,e=Gm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gm(t.document)}return e}function jw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function s8(t){var e=sI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rI(n.ownerDocument.documentElement,n)){if(r!==null&&jw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=nE(n,i);var o=nE(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var i8=Vo&&"documentMode"in document&&11>=document.documentMode,hc=null,Ib=null,Mf=null,kb=!1;function rE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;kb||hc==null||hc!==Gm(r)||(r=hc,"selectionStart"in r&&jw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Mf&&nh(Mf,r)||(Mf=r,r=Zm(Ib,"onSelect"),0<r.length&&(e=new Uw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=hc)))}function Ip(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var pc={animationend:Ip("Animation","AnimationEnd"),animationiteration:Ip("Animation","AnimationIteration"),animationstart:Ip("Animation","AnimationStart"),transitionend:Ip("Transition","TransitionEnd")},ey={},iI={};Vo&&(iI=document.createElement("div").style,"AnimationEvent"in window||(delete pc.animationend.animation,delete pc.animationiteration.animation,delete pc.animationstart.animation),"TransitionEvent"in window||delete pc.transitionend.transition);function sg(t){if(ey[t])return ey[t];if(!pc[t])return t;var e=pc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iI)return ey[t]=e[n];return t}var oI=sg("animationend"),aI=sg("animationiteration"),uI=sg("animationstart"),lI=sg("transitionend"),cI=new Map,sE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ha(t,e){cI.set(t,e),vl(e,[t])}for(var ty=0;ty<sE.length;ty++){var ny=sE[ty],o8=ny.toLowerCase(),a8=ny[0].toUpperCase()+ny.slice(1);Ha(o8,"on"+a8)}Ha(oI,"onAnimationEnd");Ha(aI,"onAnimationIteration");Ha(uI,"onAnimationStart");Ha("dblclick","onDoubleClick");Ha("focusin","onFocus");Ha("focusout","onBlur");Ha(lI,"onTransitionEnd");jc("onMouseEnter",["mouseout","mouseover"]);jc("onMouseLeave",["mouseout","mouseover"]);jc("onPointerEnter",["pointerout","pointerover"]);jc("onPointerLeave",["pointerout","pointerover"]);vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),u8=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sf));function iE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,oM(r,e,void 0,t),t.currentTarget=null}function dI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],u=a.instance,l=a.currentTarget;if(a=a.listener,u!==i&&s.isPropagationStopped())break e;iE(s,a,l),i=u}else for(o=0;o<r.length;o++){if(a=r[o],u=a.instance,l=a.currentTarget,a=a.listener,u!==i&&s.isPropagationStopped())break e;iE(s,a,l),i=u}}}if(Hm)throw t=Cb,Hm=!1,Cb=null,t}function Vt(t,e){var n=e[Lb];n===void 0&&(n=e[Lb]=new Set);var r=t+"__bubble";n.has(r)||(fI(e,t,2,!1),n.add(r))}function ry(t,e,n){var r=0;e&&(r|=4),fI(n,t,r,e)}var kp="_reactListening"+Math.random().toString(36).slice(2);function rh(t){if(!t[kp]){t[kp]=!0,v_.forEach(function(n){n!=="selectionchange"&&(u8.has(n)||ry(n,!1,t),ry(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kp]||(e[kp]=!0,ry("selectionchange",!1,e))}}function fI(t,e,n,r){switch(X_(e)){case 1:var s=SM;break;case 4:s=AM;break;default:s=Mw}n=s.bind(null,e,n,t),s=void 0,!Eb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sy(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;a!==null;){if(o=$u(a),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}a=a.parentNode}}r=r.return}L_(function(){var l=i,c=Lw(n),d=[];e:{var f=cI.get(t);if(f!==void 0){var h=Uw,p=t;switch(t){case"keypress":if(vm(n)===0)break e;case"keydown":case"keyup":h=BM;break;case"focusin":p="focus",h=Q1;break;case"focusout":p="blur",h=Q1;break;case"beforeblur":case"afterblur":h=Q1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=HA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=NM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=UM;break;case oI:case aI:case uI:h=IM;break;case lI:h=WM;break;case"scroll":h=EM;break;case"wheel":h=GM;break;case"copy":case"cut":case"paste":h=RM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=XA}var y=(e&4)!==0,b=!y&&t==="scroll",g=y?f!==null?f+"Capture":null:f;y=[];for(var v=l,w;v!==null;){w=v;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,g!==null&&(x=Qf(v,g),x!=null&&y.push(sh(v,x,w)))),b)break;v=v.return}0<y.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Sb&&(p=n.relatedTarget||n.fromElement)&&($u(p)||p[Uo]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?$u(p):null,p!==null&&(b=wl(p),p!==b||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(y=HA,x="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(y=XA,x="onPointerLeave",g="onPointerEnter",v="pointer"),b=h==null?f:mc(h),w=p==null?f:mc(p),f=new y(x,v+"leave",h,n,c),f.target=b,f.relatedTarget=w,x=null,$u(c)===l&&(y=new y(g,v+"enter",p,n,c),y.target=w,y.relatedTarget=b,x=y),b=x,h&&p)t:{for(y=h,g=p,v=0,w=y;w;w=Ql(w))v++;for(w=0,x=g;x;x=Ql(x))w++;for(;0<v-w;)y=Ql(y),v--;for(;0<w-v;)g=Ql(g),w--;for(;v--;){if(y===g||g!==null&&y===g.alternate)break t;y=Ql(y),g=Ql(g)}y=null}else y=null;h!==null&&oE(d,f,h,y,!1),p!==null&&b!==null&&oE(d,b,p,y,!0)}}e:{if(f=l?mc(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var C=ZM;else if(ZA(f))if(tI)C=n8;else{C=e8;var k=JM}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=t8);if(C&&(C=C(t,l))){eI(d,C,n,c);break e}k&&k(t,f,l),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&yb(f,"number",f.value)}switch(k=l?mc(l):window,t){case"focusin":(ZA(k)||k.contentEditable==="true")&&(hc=k,Ib=l,Mf=null);break;case"focusout":Mf=Ib=hc=null;break;case"mousedown":kb=!0;break;case"contextmenu":case"mouseup":case"dragend":kb=!1,rE(d,n,c);break;case"selectionchange":if(i8)break;case"keydown":case"keyup":rE(d,n,c)}var P;if(Ww)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else fc?Z_(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(Q_&&n.locale!=="ko"&&(fc||N!=="onCompositionStart"?N==="onCompositionEnd"&&fc&&(P=Y_()):(va=c,Vw="value"in va?va.value:va.textContent,fc=!0)),k=Zm(l,N),0<k.length&&(N=new KA(N,t,null,n,c),d.push({event:N,listeners:k}),P?N.data=P:(P=J_(n),P!==null&&(N.data=P)))),(P=HM?KM(t,n):XM(t,n))&&(l=Zm(l,"onBeforeInput"),0<l.length&&(c=new KA("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=P))}dI(d,e)})}function sh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zm(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Qf(t,n),i!=null&&r.unshift(sh(t,i,s)),i=Qf(t,e),i!=null&&r.push(sh(t,i,s))),t=t.return}return r}function Ql(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function oE(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,u=a.alternate,l=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&l!==null&&(a=l,s?(u=Qf(n,i),u!=null&&o.unshift(sh(n,u,a))):s||(u=Qf(n,i),u!=null&&o.push(sh(n,u,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var l8=/\r\n?/g,c8=/\u0000|\uFFFD/g;function aE(t){return(typeof t=="string"?t:""+t).replace(l8,`
`).replace(c8,"")}function Rp(t,e,n){if(e=aE(e),aE(t)!==e&&n)throw Error(ce(425))}function Jm(){}var Rb=null,Pb=null;function Ob(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Db=typeof setTimeout=="function"?setTimeout:void 0,d8=typeof clearTimeout=="function"?clearTimeout:void 0,uE=typeof Promise=="function"?Promise:void 0,f8=typeof queueMicrotask=="function"?queueMicrotask:typeof uE<"u"?function(t){return uE.resolve(null).then(t).catch(h8)}:Db;function h8(t){setTimeout(function(){throw t})}function iy(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),eh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);eh(e)}function Ia(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var hd=Math.random().toString(36).slice(2),Xi="__reactFiber$"+hd,ih="__reactProps$"+hd,Uo="__reactContainer$"+hd,Lb="__reactEvents$"+hd,p8="__reactListeners$"+hd,m8="__reactHandles$"+hd;function $u(t){var e=t[Xi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Uo]||n[Xi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lE(t);t!==null;){if(n=t[Xi])return n;t=lE(t)}return e}t=n,n=t.parentNode}return null}function Oh(t){return t=t[Xi]||t[Uo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function mc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ce(33))}function ig(t){return t[ih]||null}var Fb=[],gc=-1;function Ka(t){return{current:t}}function Ut(t){0>gc||(t.current=Fb[gc],Fb[gc]=null,gc--)}function Dt(t,e){gc++,Fb[gc]=t.current,t.current=e}var Ma={},lr=Ka(Ma),zr=Ka(!1),Ju=Ma;function Gc(t,e){var n=t.type.contextTypes;if(!n)return Ma;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wr(t){return t=t.childContextTypes,t!=null}function e0(){Ut(zr),Ut(lr)}function cE(t,e,n){if(lr.current!==Ma)throw Error(ce(168));Dt(lr,e),Dt(zr,n)}function hI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ce(108,JB(t)||"Unknown",s));return Jt({},n,r)}function t0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ma,Ju=lr.current,Dt(lr,t),Dt(zr,zr.current),!0}function dE(t,e,n){var r=t.stateNode;if(!r)throw Error(ce(169));n?(t=hI(t,e,Ju),r.__reactInternalMemoizedMergedChildContext=t,Ut(zr),Ut(lr),Dt(lr,t)):Ut(zr),Dt(zr,n)}var Io=null,og=!1,oy=!1;function pI(t){Io===null?Io=[t]:Io.push(t)}function g8(t){og=!0,pI(t)}function Xa(){if(!oy&&Io!==null){oy=!0;var t=0,e=vt;try{var n=Io;for(vt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Io=null,og=!1}catch(s){throw Io!==null&&(Io=Io.slice(t+1)),M_(Fw,Xa),s}finally{vt=e,oy=!1}}return null}var yc=[],bc=0,n0=null,r0=0,$s=[],Bs=0,el=null,Oo=1,Do="";function _u(t,e){yc[bc++]=r0,yc[bc++]=n0,n0=t,r0=e}function mI(t,e,n){$s[Bs++]=Oo,$s[Bs++]=Do,$s[Bs++]=el,el=t;var r=Oo;t=Do;var s=32-Ti(r)-1;r&=~(1<<s),n+=1;var i=32-Ti(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Oo=1<<32-Ti(e)+s|n<<s|r,Do=i+t}else Oo=1<<i|n<<s|r,Do=t}function Gw(t){t.return!==null&&(_u(t,1),mI(t,1,0))}function qw(t){for(;t===n0;)n0=yc[--bc],yc[bc]=null,r0=yc[--bc],yc[bc]=null;for(;t===el;)el=$s[--Bs],$s[Bs]=null,Do=$s[--Bs],$s[Bs]=null,Oo=$s[--Bs],$s[Bs]=null}var us=null,is=null,Gt=!1,Si=null;function gI(t,e){var n=Ms(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,us=t,is=Ia(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,us=t,is=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=el!==null?{id:Oo,overflow:Do}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ms(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,us=t,is=null,!0):!1;default:return!1}}function $b(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bb(t){if(Gt){var e=is;if(e){var n=e;if(!fE(t,e)){if($b(t))throw Error(ce(418));e=Ia(n.nextSibling);var r=us;e&&fE(t,e)?gI(r,n):(t.flags=t.flags&-4097|2,Gt=!1,us=t)}}else{if($b(t))throw Error(ce(418));t.flags=t.flags&-4097|2,Gt=!1,us=t}}}function hE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;us=t}function Pp(t){if(t!==us)return!1;if(!Gt)return hE(t),Gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ob(t.type,t.memoizedProps)),e&&(e=is)){if($b(t))throw yI(),Error(ce(418));for(;e;)gI(t,e),e=Ia(e.nextSibling)}if(hE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ce(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){is=Ia(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}is=null}}else is=us?Ia(t.stateNode.nextSibling):null;return!0}function yI(){for(var t=is;t;)t=Ia(t.nextSibling)}function qc(){is=us=null,Gt=!1}function Hw(t){Si===null?Si=[t]:Si.push(t)}var y8=Ko.ReactCurrentBatchConfig;function Zd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ce(309));var r=n.stateNode}if(!r)throw Error(ce(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ce(284));if(!n._owner)throw Error(ce(290,t))}return t}function Op(t,e){throw t=Object.prototype.toString.call(e),Error(ce(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pE(t){var e=t._init;return e(t._payload)}function bI(t){function e(g,v){if(t){var w=g.deletions;w===null?(g.deletions=[v],g.flags|=16):w.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function s(g,v){return g=Oa(g,v),g.index=0,g.sibling=null,g}function i(g,v,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<v?(g.flags|=2,v):w):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,w,x){return v===null||v.tag!==6?(v=hy(w,g.mode,x),v.return=g,v):(v=s(v,w),v.return=g,v)}function u(g,v,w,x){var C=w.type;return C===dc?c(g,v,w.props.children,x,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===fa&&pE(C)===v.type)?(x=s(v,w.props),x.ref=Zd(g,v,w),x.return=g,x):(x=Nm(w.type,w.key,w.props,null,g.mode,x),x.ref=Zd(g,v,w),x.return=g,x)}function l(g,v,w,x){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=py(w,g.mode,x),v.return=g,v):(v=s(v,w.children||[]),v.return=g,v)}function c(g,v,w,x,C){return v===null||v.tag!==7?(v=qu(w,g.mode,x,C),v.return=g,v):(v=s(v,w),v.return=g,v)}function d(g,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=hy(""+v,g.mode,w),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Sp:return w=Nm(v.type,v.key,v.props,null,g.mode,w),w.ref=Zd(g,null,v),w.return=g,w;case cc:return v=py(v,g.mode,w),v.return=g,v;case fa:var x=v._init;return d(g,x(v._payload),w)}if(wf(v)||Hd(v))return v=qu(v,g.mode,w,null),v.return=g,v;Op(g,v)}return null}function f(g,v,w,x){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(g,v,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sp:return w.key===C?u(g,v,w,x):null;case cc:return w.key===C?l(g,v,w,x):null;case fa:return C=w._init,f(g,v,C(w._payload),x)}if(wf(w)||Hd(w))return C!==null?null:c(g,v,w,x,null);Op(g,w)}return null}function h(g,v,w,x,C){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(w)||null,a(v,g,""+x,C);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Sp:return g=g.get(x.key===null?w:x.key)||null,u(v,g,x,C);case cc:return g=g.get(x.key===null?w:x.key)||null,l(v,g,x,C);case fa:var k=x._init;return h(g,v,w,k(x._payload),C)}if(wf(x)||Hd(x))return g=g.get(w)||null,c(v,g,x,C,null);Op(v,x)}return null}function p(g,v,w,x){for(var C=null,k=null,P=v,N=v=0,$=null;P!==null&&N<w.length;N++){P.index>N?($=P,P=null):$=P.sibling;var U=f(g,P,w[N],x);if(U===null){P===null&&(P=$);break}t&&P&&U.alternate===null&&e(g,P),v=i(U,v,N),k===null?C=U:k.sibling=U,k=U,P=$}if(N===w.length)return n(g,P),Gt&&_u(g,N),C;if(P===null){for(;N<w.length;N++)P=d(g,w[N],x),P!==null&&(v=i(P,v,N),k===null?C=P:k.sibling=P,k=P);return Gt&&_u(g,N),C}for(P=r(g,P);N<w.length;N++)$=h(P,g,N,w[N],x),$!==null&&(t&&$.alternate!==null&&P.delete($.key===null?N:$.key),v=i($,v,N),k===null?C=$:k.sibling=$,k=$);return t&&P.forEach(function(K){return e(g,K)}),Gt&&_u(g,N),C}function y(g,v,w,x){var C=Hd(w);if(typeof C!="function")throw Error(ce(150));if(w=C.call(w),w==null)throw Error(ce(151));for(var k=C=null,P=v,N=v=0,$=null,U=w.next();P!==null&&!U.done;N++,U=w.next()){P.index>N?($=P,P=null):$=P.sibling;var K=f(g,P,U.value,x);if(K===null){P===null&&(P=$);break}t&&P&&K.alternate===null&&e(g,P),v=i(K,v,N),k===null?C=K:k.sibling=K,k=K,P=$}if(U.done)return n(g,P),Gt&&_u(g,N),C;if(P===null){for(;!U.done;N++,U=w.next())U=d(g,U.value,x),U!==null&&(v=i(U,v,N),k===null?C=U:k.sibling=U,k=U);return Gt&&_u(g,N),C}for(P=r(g,P);!U.done;N++,U=w.next())U=h(P,g,N,U.value,x),U!==null&&(t&&U.alternate!==null&&P.delete(U.key===null?N:U.key),v=i(U,v,N),k===null?C=U:k.sibling=U,k=U);return t&&P.forEach(function(Z){return e(g,Z)}),Gt&&_u(g,N),C}function b(g,v,w,x){if(typeof w=="object"&&w!==null&&w.type===dc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Sp:e:{for(var C=w.key,k=v;k!==null;){if(k.key===C){if(C=w.type,C===dc){if(k.tag===7){n(g,k.sibling),v=s(k,w.props.children),v.return=g,g=v;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===fa&&pE(C)===k.type){n(g,k.sibling),v=s(k,w.props),v.ref=Zd(g,k,w),v.return=g,g=v;break e}n(g,k);break}else e(g,k);k=k.sibling}w.type===dc?(v=qu(w.props.children,g.mode,x,w.key),v.return=g,g=v):(x=Nm(w.type,w.key,w.props,null,g.mode,x),x.ref=Zd(g,v,w),x.return=g,g=x)}return o(g);case cc:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(g,v.sibling),v=s(v,w.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=py(w,g.mode,x),v.return=g,g=v}return o(g);case fa:return k=w._init,b(g,v,k(w._payload),x)}if(wf(w))return p(g,v,w,x);if(Hd(w))return y(g,v,w,x);Op(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(g,v.sibling),v=s(v,w),v.return=g,g=v):(n(g,v),v=hy(w,g.mode,x),v.return=g,g=v),o(g)):n(g,v)}return b}var Hc=bI(!0),vI=bI(!1),s0=Ka(null),i0=null,vc=null,Kw=null;function Xw(){Kw=vc=i0=null}function Yw(t){var e=s0.current;Ut(s0),t._currentValue=e}function Mb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oc(t,e){i0=t,Kw=vc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Vr=!0),t.firstContext=null)}function Xs(t){var e=t._currentValue;if(Kw!==t)if(t={context:t,memoizedValue:e,next:null},vc===null){if(i0===null)throw Error(ce(308));vc=t,i0.dependencies={lanes:0,firstContext:t}}else vc=vc.next=t;return e}var Bu=null;function Qw(t){Bu===null?Bu=[t]:Bu.push(t)}function wI(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Qw(e)):(n.next=s.next,s.next=n),e.interleaved=n,zo(t,r)}function zo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ha=!1;function Zw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ka(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,at&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,zo(t,n)}return s=r.interleaved,s===null?(e.next=e,Qw(r)):(e.next=s.next,s.next=e),r.interleaved=e,zo(t,n)}function wm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$w(t,n)}}function mE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function o0(t,e,n,r){var s=t.updateQueue;ha=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,l=u.next;u.next=null,o===null?i=l:o.next=l,o=u;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=l:a.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=s.baseState;o=0,c=l=u=null,a=i;do{var f=a.lane,h=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(f=e,h=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Jt({},d,f);break e;case 2:ha=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(u=d),s.baseState=u,s.firstBaseUpdate=l,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);nl|=o,t.lanes=o,t.memoizedState=d}}function gE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ce(191,s));s.call(r)}}}var Dh={},so=Ka(Dh),oh=Ka(Dh),ah=Ka(Dh);function Mu(t){if(t===Dh)throw Error(ce(174));return t}function Jw(t,e){switch(Dt(ah,e),Dt(oh,t),Dt(so,Dh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:vb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=vb(e,t)}Ut(so),Dt(so,e)}function Kc(){Ut(so),Ut(oh),Ut(ah)}function SI(t){Mu(ah.current);var e=Mu(so.current),n=vb(e,t.type);e!==n&&(Dt(oh,t),Dt(so,n))}function ex(t){oh.current===t&&(Ut(so),Ut(oh))}var Qt=Ka(0);function a0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ay=[];function tx(){for(var t=0;t<ay.length;t++)ay[t]._workInProgressVersionPrimary=null;ay.length=0}var xm=Ko.ReactCurrentDispatcher,uy=Ko.ReactCurrentBatchConfig,tl=0,Zt=null,vn=null,_n=null,u0=!1,Vf=!1,uh=0,b8=0;function Yn(){throw Error(ce(321))}function nx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ri(t[n],e[n]))return!1;return!0}function rx(t,e,n,r,s,i){if(tl=i,Zt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xm.current=t===null||t.memoizedState===null?S8:A8,t=n(r,s),Vf){i=0;do{if(Vf=!1,uh=0,25<=i)throw Error(ce(301));i+=1,_n=vn=null,e.updateQueue=null,xm.current=E8,t=n(r,s)}while(Vf)}if(xm.current=l0,e=vn!==null&&vn.next!==null,tl=0,_n=vn=Zt=null,u0=!1,e)throw Error(ce(300));return t}function sx(){var t=uh!==0;return uh=0,t}function Ki(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?Zt.memoizedState=_n=t:_n=_n.next=t,_n}function Ys(){if(vn===null){var t=Zt.alternate;t=t!==null?t.memoizedState:null}else t=vn.next;var e=_n===null?Zt.memoizedState:_n.next;if(e!==null)_n=e,vn=t;else{if(t===null)throw Error(ce(310));vn=t,t={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},_n===null?Zt.memoizedState=_n=t:_n=_n.next=t}return _n}function lh(t,e){return typeof e=="function"?e(t):e}function ly(t){var e=Ys(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=vn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,u=null,l=i;do{var c=l.lane;if((tl&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(a=u=d,o=r):u=u.next=d,Zt.lanes|=c,nl|=c}l=l.next}while(l!==null&&l!==i);u===null?o=r:u.next=a,Ri(r,e.memoizedState)||(Vr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Zt.lanes|=i,nl|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cy(t){var e=Ys(),n=e.queue;if(n===null)throw Error(ce(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ri(i,e.memoizedState)||(Vr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function AI(){}function EI(t,e){var n=Zt,r=Ys(),s=e(),i=!Ri(r.memoizedState,s);if(i&&(r.memoizedState=s,Vr=!0),r=r.queue,ix(TI.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||_n!==null&&_n.memoizedState.tag&1){if(n.flags|=2048,ch(9,NI.bind(null,n,r,s,e),void 0,null),On===null)throw Error(ce(349));tl&30||CI(n,e,s)}return s}function CI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Zt.updateQueue,e===null?(e={lastEffect:null,stores:null},Zt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function NI(t,e,n,r){e.value=n,e.getSnapshot=r,_I(e)&&II(t)}function TI(t,e,n){return n(function(){_I(e)&&II(t)})}function _I(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ri(t,n)}catch{return!0}}function II(t){var e=zo(t,1);e!==null&&_i(e,t,1,-1)}function yE(t){var e=Ki();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lh,lastRenderedState:t},e.queue=t,t=t.dispatch=x8.bind(null,Zt,t),[e.memoizedState,t]}function ch(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Zt.updateQueue,e===null?(e={lastEffect:null,stores:null},Zt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function kI(){return Ys().memoizedState}function Sm(t,e,n,r){var s=Ki();Zt.flags|=t,s.memoizedState=ch(1|e,n,void 0,r===void 0?null:r)}function ag(t,e,n,r){var s=Ys();r=r===void 0?null:r;var i=void 0;if(vn!==null){var o=vn.memoizedState;if(i=o.destroy,r!==null&&nx(r,o.deps)){s.memoizedState=ch(e,n,i,r);return}}Zt.flags|=t,s.memoizedState=ch(1|e,n,i,r)}function bE(t,e){return Sm(8390656,8,t,e)}function ix(t,e){return ag(2048,8,t,e)}function RI(t,e){return ag(4,2,t,e)}function PI(t,e){return ag(4,4,t,e)}function OI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function DI(t,e,n){return n=n!=null?n.concat([t]):null,ag(4,4,OI.bind(null,e,t),n)}function ox(){}function LI(t,e){var n=Ys();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function FI(t,e){var n=Ys();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $I(t,e,n){return tl&21?(Ri(n,e)||(n=z_(),Zt.lanes|=n,nl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Vr=!0),t.memoizedState=n)}function v8(t,e){var n=vt;vt=n!==0&&4>n?n:4,t(!0);var r=uy.transition;uy.transition={};try{t(!1),e()}finally{vt=n,uy.transition=r}}function BI(){return Ys().memoizedState}function w8(t,e,n){var r=Pa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},MI(t))VI(e,n);else if(n=wI(t,e,n,r),n!==null){var s=Nr();_i(n,t,r,s),UI(n,e,r)}}function x8(t,e,n){var r=Pa(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(MI(t))VI(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ri(a,o)){var u=e.interleaved;u===null?(s.next=s,Qw(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=wI(t,e,s,r),n!==null&&(s=Nr(),_i(n,t,r,s),UI(n,e,r))}}function MI(t){var e=t.alternate;return t===Zt||e!==null&&e===Zt}function VI(t,e){Vf=u0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function UI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$w(t,n)}}var l0={readContext:Xs,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useInsertionEffect:Yn,useLayoutEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useMutableSource:Yn,useSyncExternalStore:Yn,useId:Yn,unstable_isNewReconciler:!1},S8={readContext:Xs,useCallback:function(t,e){return Ki().memoizedState=[t,e===void 0?null:e],t},useContext:Xs,useEffect:bE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Sm(4194308,4,OI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Sm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sm(4,2,t,e)},useMemo:function(t,e){var n=Ki();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ki();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=w8.bind(null,Zt,t),[r.memoizedState,t]},useRef:function(t){var e=Ki();return t={current:t},e.memoizedState=t},useState:yE,useDebugValue:ox,useDeferredValue:function(t){return Ki().memoizedState=t},useTransition:function(){var t=yE(!1),e=t[0];return t=v8.bind(null,t[1]),Ki().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Zt,s=Ki();if(Gt){if(n===void 0)throw Error(ce(407));n=n()}else{if(n=e(),On===null)throw Error(ce(349));tl&30||CI(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,bE(TI.bind(null,r,i,t),[t]),r.flags|=2048,ch(9,NI.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Ki(),e=On.identifierPrefix;if(Gt){var n=Do,r=Oo;n=(r&~(1<<32-Ti(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=uh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=b8++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},A8={readContext:Xs,useCallback:LI,useContext:Xs,useEffect:ix,useImperativeHandle:DI,useInsertionEffect:RI,useLayoutEffect:PI,useMemo:FI,useReducer:ly,useRef:kI,useState:function(){return ly(lh)},useDebugValue:ox,useDeferredValue:function(t){var e=Ys();return $I(e,vn.memoizedState,t)},useTransition:function(){var t=ly(lh)[0],e=Ys().memoizedState;return[t,e]},useMutableSource:AI,useSyncExternalStore:EI,useId:BI,unstable_isNewReconciler:!1},E8={readContext:Xs,useCallback:LI,useContext:Xs,useEffect:ix,useImperativeHandle:DI,useInsertionEffect:RI,useLayoutEffect:PI,useMemo:FI,useReducer:cy,useRef:kI,useState:function(){return cy(lh)},useDebugValue:ox,useDeferredValue:function(t){var e=Ys();return vn===null?e.memoizedState=t:$I(e,vn.memoizedState,t)},useTransition:function(){var t=cy(lh)[0],e=Ys().memoizedState;return[t,e]},useMutableSource:AI,useSyncExternalStore:EI,useId:BI,unstable_isNewReconciler:!1};function gi(t,e){if(t&&t.defaultProps){e=Jt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Vb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Jt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ug={isMounted:function(t){return(t=t._reactInternals)?wl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Nr(),s=Pa(t),i=Fo(r,s);i.payload=e,n!=null&&(i.callback=n),e=ka(t,i,s),e!==null&&(_i(e,t,s,r),wm(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Nr(),s=Pa(t),i=Fo(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ka(t,i,s),e!==null&&(_i(e,t,s,r),wm(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nr(),r=Pa(t),s=Fo(n,r);s.tag=2,e!=null&&(s.callback=e),e=ka(t,s,r),e!==null&&(_i(e,t,r,n),wm(e,t,r))}};function vE(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!nh(n,r)||!nh(s,i):!0}function zI(t,e,n){var r=!1,s=Ma,i=e.contextType;return typeof i=="object"&&i!==null?i=Xs(i):(s=Wr(e)?Ju:lr.current,r=e.contextTypes,i=(r=r!=null)?Gc(t,s):Ma),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ug,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function wE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ug.enqueueReplaceState(e,e.state,null)}function Ub(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Zw(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Xs(i):(i=Wr(e)?Ju:lr.current,s.context=Gc(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Vb(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ug.enqueueReplaceState(s,s.state,null),o0(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Xc(t,e){try{var n="",r=e;do n+=ZB(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var C8=typeof WeakMap=="function"?WeakMap:Map;function WI(t,e,n){n=Fo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){d0||(d0=!0,Zb=r),zb(t,e)},n}function jI(t,e,n){n=Fo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){zb(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){zb(t,e),typeof r!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function xE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new C8;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=M8.bind(null,t,e,n),e.then(t,t))}function SE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function AE(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fo(-1,1),e.tag=2,ka(n,e,1))),n.lanes|=1),t)}var N8=Ko.ReactCurrentOwner,Vr=!1;function Sr(t,e,n,r){e.child=t===null?vI(e,null,n,r):Hc(e,t.child,n,r)}function EE(t,e,n,r,s){n=n.render;var i=e.ref;return Oc(e,s),r=rx(t,e,n,r,i,s),n=sx(),t!==null&&!Vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wo(t,e,s)):(Gt&&n&&Gw(e),e.flags|=1,Sr(t,e,r,s),e.child)}function CE(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!px(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,GI(t,e,i,r,s)):(t=Nm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:nh,n(o,r)&&t.ref===e.ref)return Wo(t,e,s)}return e.flags|=1,t=Oa(i,r),t.ref=e.ref,t.return=e,e.child=t}function GI(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(nh(i,r)&&t.ref===e.ref)if(Vr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Vr=!0);else return e.lanes=t.lanes,Wo(t,e,s)}return Wb(t,e,n,r,s)}function qI(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(xc,ts),ts|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Dt(xc,ts),ts|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Dt(xc,ts),ts|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Dt(xc,ts),ts|=r;return Sr(t,e,s,n),e.child}function HI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wb(t,e,n,r,s){var i=Wr(n)?Ju:lr.current;return i=Gc(e,i),Oc(e,s),n=rx(t,e,n,r,i,s),r=sx(),t!==null&&!Vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wo(t,e,s)):(Gt&&r&&Gw(e),e.flags|=1,Sr(t,e,n,s),e.child)}function NE(t,e,n,r,s){if(Wr(n)){var i=!0;t0(e)}else i=!1;if(Oc(e,s),e.stateNode===null)Am(t,e),zI(e,n,r),Ub(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var u=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Xs(l):(l=Wr(n)?Ju:lr.current,l=Gc(e,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||u!==l)&&wE(e,o,r,l),ha=!1;var f=e.memoizedState;o.state=f,o0(e,r,o,s),u=e.memoizedState,a!==r||f!==u||zr.current||ha?(typeof c=="function"&&(Vb(e,n,c,r),u=e.memoizedState),(a=ha||vE(e,n,a,r,f,u,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,xI(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:gi(e.type,a),o.props=l,d=e.pendingProps,f=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Xs(u):(u=Wr(n)?Ju:lr.current,u=Gc(e,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==u)&&wE(e,o,r,u),ha=!1,f=e.memoizedState,o.state=f,o0(e,r,o,s);var p=e.memoizedState;a!==d||f!==p||zr.current||ha?(typeof h=="function"&&(Vb(e,n,h,r),p=e.memoizedState),(l=ha||vE(e,n,l,r,f,p,u)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=u,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return jb(t,e,n,r,i,s)}function jb(t,e,n,r,s,i){HI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&dE(e,n,!1),Wo(t,e,i);r=e.stateNode,N8.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Hc(e,t.child,null,i),e.child=Hc(e,null,a,i)):Sr(t,e,a,i),e.memoizedState=r.state,s&&dE(e,n,!0),e.child}function KI(t){var e=t.stateNode;e.pendingContext?cE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cE(t,e.context,!1),Jw(t,e.containerInfo)}function TE(t,e,n,r,s){return qc(),Hw(s),e.flags|=256,Sr(t,e,n,r),e.child}var Gb={dehydrated:null,treeContext:null,retryLane:0};function qb(t){return{baseLanes:t,cachePool:null,transitions:null}}function XI(t,e,n){var r=e.pendingProps,s=Qt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Dt(Qt,s&1),t===null)return Bb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=dg(o,r,0,null),t=qu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=qb(n),e.memoizedState=Gb,t):ax(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return T8(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Oa(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Oa(a,i):(i=qu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?qb(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Gb,r}return i=t.child,t=i.sibling,r=Oa(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ax(t,e){return e=dg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Dp(t,e,n,r){return r!==null&&Hw(r),Hc(e,t.child,null,n),t=ax(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function T8(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=dy(Error(ce(422))),Dp(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=dg({mode:"visible",children:r.children},s,0,null),i=qu(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Hc(e,t.child,null,o),e.child.memoizedState=qb(o),e.memoizedState=Gb,i);if(!(e.mode&1))return Dp(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(ce(419)),r=dy(i,r,void 0),Dp(t,e,o,r)}if(a=(o&t.childLanes)!==0,Vr||a){if(r=On,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,zo(t,s),_i(r,t,s,-1))}return hx(),r=dy(Error(ce(421))),Dp(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=V8.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,is=Ia(s.nextSibling),us=e,Gt=!0,Si=null,t!==null&&($s[Bs++]=Oo,$s[Bs++]=Do,$s[Bs++]=el,Oo=t.id,Do=t.overflow,el=e),e=ax(e,r.children),e.flags|=4096,e)}function _E(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Mb(t.return,e,n)}function fy(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function YI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Sr(t,e,r.children,n),r=Qt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_E(t,n,e);else if(t.tag===19)_E(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Dt(Qt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&a0(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),fy(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&a0(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}fy(e,!0,n,null,i);break;case"together":fy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Am(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),nl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ce(153));if(e.child!==null){for(t=e.child,n=Oa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Oa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _8(t,e,n){switch(e.tag){case 3:KI(e),qc();break;case 5:SI(e);break;case 1:Wr(e.type)&&t0(e);break;case 4:Jw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Dt(s0,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Dt(Qt,Qt.current&1),e.flags|=128,null):n&e.child.childLanes?XI(t,e,n):(Dt(Qt,Qt.current&1),t=Wo(t,e,n),t!==null?t.sibling:null);Dt(Qt,Qt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Dt(Qt,Qt.current),r)break;return null;case 22:case 23:return e.lanes=0,qI(t,e,n)}return Wo(t,e,n)}var QI,Hb,ZI,JI;QI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hb=function(){};ZI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Mu(so.current);var i=null;switch(n){case"input":s=mb(t,s),r=mb(t,r),i=[];break;case"select":s=Jt({},s,{value:void 0}),r=Jt({},r,{value:void 0}),i=[];break;case"textarea":s=bb(t,s),r=bb(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Jm)}wb(n,r);var o;n=null;for(l in s)if(!r.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var a=s[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Xf.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(a=s!=null?s[l]:void 0,r.hasOwnProperty(l)&&u!==a&&(u!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&a[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Xf.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Vt("scroll",t),i||a===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};JI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Jd(t,e){if(!Gt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function I8(t,e,n){var r=e.pendingProps;switch(qw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(e),null;case 1:return Wr(e.type)&&e0(),Qn(e),null;case 3:return r=e.stateNode,Kc(),Ut(zr),Ut(lr),tx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Pp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Si!==null&&(tv(Si),Si=null))),Hb(t,e),Qn(e),null;case 5:ex(e);var s=Mu(ah.current);if(n=e.type,t!==null&&e.stateNode!=null)ZI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ce(166));return Qn(e),null}if(t=Mu(so.current),Pp(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Xi]=e,r[ih]=i,t=(e.mode&1)!==0,n){case"dialog":Vt("cancel",r),Vt("close",r);break;case"iframe":case"object":case"embed":Vt("load",r);break;case"video":case"audio":for(s=0;s<Sf.length;s++)Vt(Sf[s],r);break;case"source":Vt("error",r);break;case"img":case"image":case"link":Vt("error",r),Vt("load",r);break;case"details":Vt("toggle",r);break;case"input":$A(r,i),Vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Vt("invalid",r);break;case"textarea":MA(r,i),Vt("invalid",r)}wb(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Rp(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Rp(r.textContent,a,t),s=["children",""+a]):Xf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Vt("scroll",r)}switch(n){case"input":Ap(r),BA(r,i,!0);break;case"textarea":Ap(r),VA(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Jm)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=T_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Xi]=e,t[ih]=r,QI(t,e,!1,!1),e.stateNode=t;e:{switch(o=xb(n,r),n){case"dialog":Vt("cancel",t),Vt("close",t),s=r;break;case"iframe":case"object":case"embed":Vt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Sf.length;s++)Vt(Sf[s],t);s=r;break;case"source":Vt("error",t),s=r;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),s=r;break;case"details":Vt("toggle",t),s=r;break;case"input":$A(t,r),s=mb(t,r),Vt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Jt({},r,{value:void 0}),Vt("invalid",t);break;case"textarea":MA(t,r),s=bb(t,r),Vt("invalid",t);break;default:s=r}wb(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?k_(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&__(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Yf(t,u):typeof u=="number"&&Yf(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Xf.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Vt("scroll",t):u!=null&&Rw(t,i,u,o))}switch(n){case"input":Ap(t),BA(t,r,!1);break;case"textarea":Ap(t),VA(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ba(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ic(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ic(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qn(e),null;case 6:if(t&&e.stateNode!=null)JI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ce(166));if(n=Mu(ah.current),Mu(so.current),Pp(e)){if(r=e.stateNode,n=e.memoizedProps,r[Xi]=e,(i=r.nodeValue!==n)&&(t=us,t!==null))switch(t.tag){case 3:Rp(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Rp(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xi]=e,e.stateNode=r}return Qn(e),null;case 13:if(Ut(Qt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Gt&&is!==null&&e.mode&1&&!(e.flags&128))yI(),qc(),e.flags|=98560,i=!1;else if(i=Pp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ce(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[Xi]=e}else qc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qn(e),i=!1}else Si!==null&&(tv(Si),Si=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Qt.current&1?xn===0&&(xn=3):hx())),e.updateQueue!==null&&(e.flags|=4),Qn(e),null);case 4:return Kc(),Hb(t,e),t===null&&rh(e.stateNode.containerInfo),Qn(e),null;case 10:return Yw(e.type._context),Qn(e),null;case 17:return Wr(e.type)&&e0(),Qn(e),null;case 19:if(Ut(Qt),i=e.memoizedState,i===null)return Qn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Jd(i,!1);else{if(xn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=a0(t),o!==null){for(e.flags|=128,Jd(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Dt(Qt,Qt.current&1|2),e.child}t=t.sibling}i.tail!==null&&un()>Yc&&(e.flags|=128,r=!0,Jd(i,!1),e.lanes=4194304)}else{if(!r)if(t=a0(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Jd(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Gt)return Qn(e),null}else 2*un()-i.renderingStartTime>Yc&&n!==1073741824&&(e.flags|=128,r=!0,Jd(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=un(),e.sibling=null,n=Qt.current,Dt(Qt,r?n&1|2:n&1),e):(Qn(e),null);case 22:case 23:return fx(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ts&1073741824&&(Qn(e),e.subtreeFlags&6&&(e.flags|=8192)):Qn(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function k8(t,e){switch(qw(e),e.tag){case 1:return Wr(e.type)&&e0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Kc(),Ut(zr),Ut(lr),tx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ex(e),null;case 13:if(Ut(Qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));qc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ut(Qt),null;case 4:return Kc(),null;case 10:return Yw(e.type._context),null;case 22:case 23:return fx(),null;case 24:return null;default:return null}}var Lp=!1,sr=!1,R8=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function wc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nn(t,e,r)}else n.current=null}function Kb(t,e,n){try{n()}catch(r){nn(t,e,r)}}var IE=!1;function P8(t,e){if(Rb=Ym,t=sI(),jw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,u=-1,l=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(u=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===s&&(a=o),f===i&&++c===r&&(u=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pb={focusedElem:t,selectionRange:n},Ym=!1,Ae=e;Ae!==null;)if(e=Ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ae=t;else for(;Ae!==null;){e=Ae;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,b=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:gi(e.type,y),b);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(x){nn(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,Ae=t;break}Ae=e.return}return p=IE,IE=!1,p}function Uf(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Kb(e,n,i)}s=s.next}while(s!==r)}}function lg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Xb(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ek(t){var e=t.alternate;e!==null&&(t.alternate=null,ek(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xi],delete e[ih],delete e[Lb],delete e[p8],delete e[m8])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tk(t){return t.tag===5||t.tag===3||t.tag===4}function kE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Jm));else if(r!==4&&(t=t.child,t!==null))for(Yb(t,e,n),t=t.sibling;t!==null;)Yb(t,e,n),t=t.sibling}function Qb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qb(t,e,n),t=t.sibling;t!==null;)Qb(t,e,n),t=t.sibling}var Un=null,vi=!1;function ra(t,e,n){for(n=n.child;n!==null;)nk(t,e,n),n=n.sibling}function nk(t,e,n){if(ro&&typeof ro.onCommitFiberUnmount=="function")try{ro.onCommitFiberUnmount(tg,n)}catch{}switch(n.tag){case 5:sr||wc(n,e);case 6:var r=Un,s=vi;Un=null,ra(t,e,n),Un=r,vi=s,Un!==null&&(vi?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(vi?(t=Un,n=n.stateNode,t.nodeType===8?iy(t.parentNode,n):t.nodeType===1&&iy(t,n),eh(t)):iy(Un,n.stateNode));break;case 4:r=Un,s=vi,Un=n.stateNode.containerInfo,vi=!0,ra(t,e,n),Un=r,vi=s;break;case 0:case 11:case 14:case 15:if(!sr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Kb(n,e,o),s=s.next}while(s!==r)}ra(t,e,n);break;case 1:if(!sr&&(wc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){nn(n,e,a)}ra(t,e,n);break;case 21:ra(t,e,n);break;case 22:n.mode&1?(sr=(r=sr)||n.memoizedState!==null,ra(t,e,n),sr=r):ra(t,e,n);break;default:ra(t,e,n)}}function RE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new R8),e.forEach(function(r){var s=U8.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function li(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Un=a.stateNode,vi=!1;break e;case 3:Un=a.stateNode.containerInfo,vi=!0;break e;case 4:Un=a.stateNode.containerInfo,vi=!0;break e}a=a.return}if(Un===null)throw Error(ce(160));nk(i,o,s),Un=null,vi=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(l){nn(s,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rk(e,t),e=e.sibling}function rk(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(li(e,t),Gi(t),r&4){try{Uf(3,t,t.return),lg(3,t)}catch(y){nn(t,t.return,y)}try{Uf(5,t,t.return)}catch(y){nn(t,t.return,y)}}break;case 1:li(e,t),Gi(t),r&512&&n!==null&&wc(n,n.return);break;case 5:if(li(e,t),Gi(t),r&512&&n!==null&&wc(n,n.return),t.flags&32){var s=t.stateNode;try{Yf(s,"")}catch(y){nn(t,t.return,y)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&C_(s,i),xb(a,o);var l=xb(a,i);for(o=0;o<u.length;o+=2){var c=u[o],d=u[o+1];c==="style"?k_(s,d):c==="dangerouslySetInnerHTML"?__(s,d):c==="children"?Yf(s,d):Rw(s,c,d,l)}switch(a){case"input":gb(s,i);break;case"textarea":N_(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Ic(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ic(s,!!i.multiple,i.defaultValue,!0):Ic(s,!!i.multiple,i.multiple?[]:"",!1))}s[ih]=i}catch(y){nn(t,t.return,y)}}break;case 6:if(li(e,t),Gi(t),r&4){if(t.stateNode===null)throw Error(ce(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(y){nn(t,t.return,y)}}break;case 3:if(li(e,t),Gi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{eh(e.containerInfo)}catch(y){nn(t,t.return,y)}break;case 4:li(e,t),Gi(t);break;case 13:li(e,t),Gi(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(cx=un())),r&4&&RE(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(sr=(l=sr)||c,li(e,t),sr=l):li(e,t),Gi(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(Ae=t,c=t.child;c!==null;){for(d=Ae=c;Ae!==null;){switch(f=Ae,h=f.child,f.tag){case 0:case 11:case 14:case 15:Uf(4,f,f.return);break;case 1:wc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){nn(r,n,y)}}break;case 5:wc(f,f.return);break;case 22:if(f.memoizedState!==null){OE(d);continue}}h!==null?(h.return=f,Ae=h):OE(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,u=d.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=I_("display",o))}catch(y){nn(t,t.return,y)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(y){nn(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:li(e,t),Gi(t),r&4&&RE(t);break;case 21:break;default:li(e,t),Gi(t)}}function Gi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tk(n)){var r=n;break e}n=n.return}throw Error(ce(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Yf(s,""),r.flags&=-33);var i=kE(t);Qb(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=kE(t);Yb(t,a,o);break;default:throw Error(ce(161))}}catch(u){nn(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function O8(t,e,n){Ae=t,sk(t)}function sk(t,e,n){for(var r=(t.mode&1)!==0;Ae!==null;){var s=Ae,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Lp;if(!o){var a=s.alternate,u=a!==null&&a.memoizedState!==null||sr;a=Lp;var l=sr;if(Lp=o,(sr=u)&&!l)for(Ae=s;Ae!==null;)o=Ae,u=o.child,o.tag===22&&o.memoizedState!==null?DE(s):u!==null?(u.return=o,Ae=u):DE(s);for(;i!==null;)Ae=i,sk(i),i=i.sibling;Ae=s,Lp=a,sr=l}PE(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ae=i):PE(t)}}function PE(t){for(;Ae!==null;){var e=Ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sr||lg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!sr)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:gi(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&gE(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&eh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}sr||e.flags&512&&Xb(e)}catch(f){nn(e,e.return,f)}}if(e===t){Ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ae=n;break}Ae=e.return}}function OE(t){for(;Ae!==null;){var e=Ae;if(e===t){Ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ae=n;break}Ae=e.return}}function DE(t){for(;Ae!==null;){var e=Ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lg(4,e)}catch(u){nn(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){nn(e,s,u)}}var i=e.return;try{Xb(e)}catch(u){nn(e,i,u)}break;case 5:var o=e.return;try{Xb(e)}catch(u){nn(e,o,u)}}}catch(u){nn(e,e.return,u)}if(e===t){Ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ae=a;break}Ae=e.return}}var D8=Math.ceil,c0=Ko.ReactCurrentDispatcher,ux=Ko.ReactCurrentOwner,qs=Ko.ReactCurrentBatchConfig,at=0,On=null,pn=null,jn=0,ts=0,xc=Ka(0),xn=0,dh=null,nl=0,cg=0,lx=0,zf=null,Mr=null,cx=0,Yc=1/0,_o=null,d0=!1,Zb=null,Ra=null,Fp=!1,wa=null,f0=0,Wf=0,Jb=null,Em=-1,Cm=0;function Nr(){return at&6?un():Em!==-1?Em:Em=un()}function Pa(t){return t.mode&1?at&2&&jn!==0?jn&-jn:y8.transition!==null?(Cm===0&&(Cm=z_()),Cm):(t=vt,t!==0||(t=window.event,t=t===void 0?16:X_(t.type)),t):1}function _i(t,e,n,r){if(50<Wf)throw Wf=0,Jb=null,Error(ce(185));Rh(t,n,r),(!(at&2)||t!==On)&&(t===On&&(!(at&2)&&(cg|=n),xn===4&&ba(t,jn)),jr(t,r),n===1&&at===0&&!(e.mode&1)&&(Yc=un()+500,og&&Xa()))}function jr(t,e){var n=t.callbackNode;yM(t,e);var r=Xm(t,t===On?jn:0);if(r===0)n!==null&&WA(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&WA(n),e===1)t.tag===0?g8(LE.bind(null,t)):pI(LE.bind(null,t)),f8(function(){!(at&6)&&Xa()}),n=null;else{switch(W_(r)){case 1:n=Fw;break;case 4:n=V_;break;case 16:n=Km;break;case 536870912:n=U_;break;default:n=Km}n=fk(n,ik.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ik(t,e){if(Em=-1,Cm=0,at&6)throw Error(ce(327));var n=t.callbackNode;if(Dc()&&t.callbackNode!==n)return null;var r=Xm(t,t===On?jn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=h0(t,r);else{e=r;var s=at;at|=2;var i=ak();(On!==t||jn!==e)&&(_o=null,Yc=un()+500,Gu(t,e));do try{$8();break}catch(a){ok(t,a)}while(!0);Xw(),c0.current=i,at=s,pn!==null?e=0:(On=null,jn=0,e=xn)}if(e!==0){if(e===2&&(s=Nb(t),s!==0&&(r=s,e=ev(t,s))),e===1)throw n=dh,Gu(t,0),ba(t,r),jr(t,un()),n;if(e===6)ba(t,r);else{if(s=t.current.alternate,!(r&30)&&!L8(s)&&(e=h0(t,r),e===2&&(i=Nb(t),i!==0&&(r=i,e=ev(t,i))),e===1))throw n=dh,Gu(t,0),ba(t,r),jr(t,un()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ce(345));case 2:Iu(t,Mr,_o);break;case 3:if(ba(t,r),(r&130023424)===r&&(e=cx+500-un(),10<e)){if(Xm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Nr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Db(Iu.bind(null,t,Mr,_o),e);break}Iu(t,Mr,_o);break;case 4:if(ba(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Ti(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=un()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*D8(r/1960))-r,10<r){t.timeoutHandle=Db(Iu.bind(null,t,Mr,_o),r);break}Iu(t,Mr,_o);break;case 5:Iu(t,Mr,_o);break;default:throw Error(ce(329))}}}return jr(t,un()),t.callbackNode===n?ik.bind(null,t):null}function ev(t,e){var n=zf;return t.current.memoizedState.isDehydrated&&(Gu(t,e).flags|=256),t=h0(t,e),t!==2&&(e=Mr,Mr=n,e!==null&&tv(e)),t}function tv(t){Mr===null?Mr=t:Mr.push.apply(Mr,t)}function L8(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ri(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ba(t,e){for(e&=~lx,e&=~cg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ti(e),r=1<<n;t[n]=-1,e&=~r}}function LE(t){if(at&6)throw Error(ce(327));Dc();var e=Xm(t,0);if(!(e&1))return jr(t,un()),null;var n=h0(t,e);if(t.tag!==0&&n===2){var r=Nb(t);r!==0&&(e=r,n=ev(t,r))}if(n===1)throw n=dh,Gu(t,0),ba(t,e),jr(t,un()),n;if(n===6)throw Error(ce(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Iu(t,Mr,_o),jr(t,un()),null}function dx(t,e){var n=at;at|=1;try{return t(e)}finally{at=n,at===0&&(Yc=un()+500,og&&Xa())}}function rl(t){wa!==null&&wa.tag===0&&!(at&6)&&Dc();var e=at;at|=1;var n=qs.transition,r=vt;try{if(qs.transition=null,vt=1,t)return t()}finally{vt=r,qs.transition=n,at=e,!(at&6)&&Xa()}}function fx(){ts=xc.current,Ut(xc)}function Gu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,d8(n)),pn!==null)for(n=pn.return;n!==null;){var r=n;switch(qw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&e0();break;case 3:Kc(),Ut(zr),Ut(lr),tx();break;case 5:ex(r);break;case 4:Kc();break;case 13:Ut(Qt);break;case 19:Ut(Qt);break;case 10:Yw(r.type._context);break;case 22:case 23:fx()}n=n.return}if(On=t,pn=t=Oa(t.current,null),jn=ts=e,xn=0,dh=null,lx=cg=nl=0,Mr=zf=null,Bu!==null){for(e=0;e<Bu.length;e++)if(n=Bu[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Bu=null}return t}function ok(t,e){do{var n=pn;try{if(Xw(),xm.current=l0,u0){for(var r=Zt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}u0=!1}if(tl=0,_n=vn=Zt=null,Vf=!1,uh=0,ux.current=null,n===null||n.return===null){xn=1,dh=e,pn=null;break}e:{var i=t,o=n.return,a=n,u=e;if(e=jn,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=SE(o);if(h!==null){h.flags&=-257,AE(h,o,a,i,e),h.mode&1&&xE(i,l,e),e=h,u=l;var p=e.updateQueue;if(p===null){var y=new Set;y.add(u),e.updateQueue=y}else p.add(u);break e}else{if(!(e&1)){xE(i,l,e),hx();break e}u=Error(ce(426))}}else if(Gt&&a.mode&1){var b=SE(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),AE(b,o,a,i,e),Hw(Xc(u,a));break e}}i=u=Xc(u,a),xn!==4&&(xn=2),zf===null?zf=[i]:zf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=WI(i,u,e);mE(i,g);break e;case 1:a=u;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ra===null||!Ra.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var x=jI(i,a,e);mE(i,x);break e}}i=i.return}while(i!==null)}lk(n)}catch(C){e=C,pn===n&&n!==null&&(pn=n=n.return);continue}break}while(!0)}function ak(){var t=c0.current;return c0.current=l0,t===null?l0:t}function hx(){(xn===0||xn===3||xn===2)&&(xn=4),On===null||!(nl&268435455)&&!(cg&268435455)||ba(On,jn)}function h0(t,e){var n=at;at|=2;var r=ak();(On!==t||jn!==e)&&(_o=null,Gu(t,e));do try{F8();break}catch(s){ok(t,s)}while(!0);if(Xw(),at=n,c0.current=r,pn!==null)throw Error(ce(261));return On=null,jn=0,xn}function F8(){for(;pn!==null;)uk(pn)}function $8(){for(;pn!==null&&!uM();)uk(pn)}function uk(t){var e=dk(t.alternate,t,ts);t.memoizedProps=t.pendingProps,e===null?lk(t):pn=e,ux.current=null}function lk(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=k8(n,e),n!==null){n.flags&=32767,pn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{xn=6,pn=null;return}}else if(n=I8(n,e,ts),n!==null){pn=n;return}if(e=e.sibling,e!==null){pn=e;return}pn=e=t}while(e!==null);xn===0&&(xn=5)}function Iu(t,e,n){var r=vt,s=qs.transition;try{qs.transition=null,vt=1,B8(t,e,n,r)}finally{qs.transition=s,vt=r}return null}function B8(t,e,n,r){do Dc();while(wa!==null);if(at&6)throw Error(ce(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ce(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(bM(t,i),t===On&&(pn=On=null,jn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fp||(Fp=!0,fk(Km,function(){return Dc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qs.transition,qs.transition=null;var o=vt;vt=1;var a=at;at|=4,ux.current=null,P8(t,n),rk(n,t),s8(Pb),Ym=!!Rb,Pb=Rb=null,t.current=n,O8(n),lM(),at=a,vt=o,qs.transition=i}else t.current=n;if(Fp&&(Fp=!1,wa=t,f0=s),i=t.pendingLanes,i===0&&(Ra=null),fM(n.stateNode),jr(t,un()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(d0)throw d0=!1,t=Zb,Zb=null,t;return f0&1&&t.tag!==0&&Dc(),i=t.pendingLanes,i&1?t===Jb?Wf++:(Wf=0,Jb=t):Wf=0,Xa(),null}function Dc(){if(wa!==null){var t=W_(f0),e=qs.transition,n=vt;try{if(qs.transition=null,vt=16>t?16:t,wa===null)var r=!1;else{if(t=wa,wa=null,f0=0,at&6)throw Error(ce(331));var s=at;for(at|=4,Ae=t.current;Ae!==null;){var i=Ae,o=i.child;if(Ae.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var l=a[u];for(Ae=l;Ae!==null;){var c=Ae;switch(c.tag){case 0:case 11:case 15:Uf(8,c,i)}var d=c.child;if(d!==null)d.return=c,Ae=d;else for(;Ae!==null;){c=Ae;var f=c.sibling,h=c.return;if(ek(c),c===l){Ae=null;break}if(f!==null){f.return=h,Ae=f;break}Ae=h}}}var p=i.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var b=y.sibling;y.sibling=null,y=b}while(y!==null)}}Ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ae=o;else e:for(;Ae!==null;){if(i=Ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uf(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ae=g;break e}Ae=i.return}}var v=t.current;for(Ae=v;Ae!==null;){o=Ae;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ae=w;else e:for(o=v;Ae!==null;){if(a=Ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lg(9,a)}}catch(C){nn(a,a.return,C)}if(a===o){Ae=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,Ae=x;break e}Ae=a.return}}if(at=s,Xa(),ro&&typeof ro.onPostCommitFiberRoot=="function")try{ro.onPostCommitFiberRoot(tg,t)}catch{}r=!0}return r}finally{vt=n,qs.transition=e}}return!1}function FE(t,e,n){e=Xc(n,e),e=WI(t,e,1),t=ka(t,e,1),e=Nr(),t!==null&&(Rh(t,1,e),jr(t,e))}function nn(t,e,n){if(t.tag===3)FE(t,t,n);else for(;e!==null;){if(e.tag===3){FE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ra===null||!Ra.has(r))){t=Xc(n,t),t=jI(e,t,1),e=ka(e,t,1),t=Nr(),e!==null&&(Rh(e,1,t),jr(e,t));break}}e=e.return}}function M8(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Nr(),t.pingedLanes|=t.suspendedLanes&n,On===t&&(jn&n)===n&&(xn===4||xn===3&&(jn&130023424)===jn&&500>un()-cx?Gu(t,0):lx|=n),jr(t,e)}function ck(t,e){e===0&&(t.mode&1?(e=Np,Np<<=1,!(Np&130023424)&&(Np=4194304)):e=1);var n=Nr();t=zo(t,e),t!==null&&(Rh(t,e,n),jr(t,n))}function V8(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ck(t,n)}function U8(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(e),ck(t,n)}var dk;dk=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zr.current)Vr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Vr=!1,_8(t,e,n);Vr=!!(t.flags&131072)}else Vr=!1,Gt&&e.flags&1048576&&mI(e,r0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Am(t,e),t=e.pendingProps;var s=Gc(e,lr.current);Oc(e,n),s=rx(null,e,r,t,s,n);var i=sx();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wr(r)?(i=!0,t0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Zw(e),s.updater=ug,e.stateNode=s,s._reactInternals=e,Ub(e,r,t,n),e=jb(null,e,r,!0,i,n)):(e.tag=0,Gt&&i&&Gw(e),Sr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Am(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=W8(r),t=gi(r,t),s){case 0:e=Wb(null,e,r,t,n);break e;case 1:e=NE(null,e,r,t,n);break e;case 11:e=EE(null,e,r,t,n);break e;case 14:e=CE(null,e,r,gi(r.type,t),n);break e}throw Error(ce(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gi(r,s),Wb(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gi(r,s),NE(t,e,r,s,n);case 3:e:{if(KI(e),t===null)throw Error(ce(387));r=e.pendingProps,i=e.memoizedState,s=i.element,xI(t,e),o0(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Xc(Error(ce(423)),e),e=TE(t,e,r,n,s);break e}else if(r!==s){s=Xc(Error(ce(424)),e),e=TE(t,e,r,n,s);break e}else for(is=Ia(e.stateNode.containerInfo.firstChild),us=e,Gt=!0,Si=null,n=vI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qc(),r===s){e=Wo(t,e,n);break e}Sr(t,e,r,n)}e=e.child}return e;case 5:return SI(e),t===null&&Bb(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ob(r,s)?o=null:i!==null&&Ob(r,i)&&(e.flags|=32),HI(t,e),Sr(t,e,o,n),e.child;case 6:return t===null&&Bb(e),null;case 13:return XI(t,e,n);case 4:return Jw(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Hc(e,null,r,n):Sr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gi(r,s),EE(t,e,r,s,n);case 7:return Sr(t,e,e.pendingProps,n),e.child;case 8:return Sr(t,e,e.pendingProps.children,n),e.child;case 12:return Sr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Dt(s0,r._currentValue),r._currentValue=o,i!==null)if(Ri(i.value,o)){if(i.children===s.children&&!zr.current){e=Wo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Fo(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Mb(i.return,n,e),a.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ce(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Mb(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Sr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Oc(e,n),s=Xs(s),r=r(s),e.flags|=1,Sr(t,e,r,n),e.child;case 14:return r=e.type,s=gi(r,e.pendingProps),s=gi(r.type,s),CE(t,e,r,s,n);case 15:return GI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gi(r,s),Am(t,e),e.tag=1,Wr(r)?(t=!0,t0(e)):t=!1,Oc(e,n),zI(e,r,s),Ub(e,r,s,n),jb(null,e,r,!0,t,n);case 19:return YI(t,e,n);case 22:return qI(t,e,n)}throw Error(ce(156,e.tag))};function fk(t,e){return M_(t,e)}function z8(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ms(t,e,n,r){return new z8(t,e,n,r)}function px(t){return t=t.prototype,!(!t||!t.isReactComponent)}function W8(t){if(typeof t=="function")return px(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ow)return 11;if(t===Dw)return 14}return 2}function Oa(t,e){var n=t.alternate;return n===null?(n=Ms(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Nm(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")px(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case dc:return qu(n.children,s,i,e);case Pw:o=8,s|=8;break;case db:return t=Ms(12,n,e,s|2),t.elementType=db,t.lanes=i,t;case fb:return t=Ms(13,n,e,s),t.elementType=fb,t.lanes=i,t;case hb:return t=Ms(19,n,e,s),t.elementType=hb,t.lanes=i,t;case S_:return dg(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case w_:o=10;break e;case x_:o=9;break e;case Ow:o=11;break e;case Dw:o=14;break e;case fa:o=16,r=null;break e}throw Error(ce(130,t==null?t:typeof t,""))}return e=Ms(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function qu(t,e,n,r){return t=Ms(7,t,r,e),t.lanes=n,t}function dg(t,e,n,r){return t=Ms(22,t,r,e),t.elementType=S_,t.lanes=n,t.stateNode={isHidden:!1},t}function hy(t,e,n){return t=Ms(6,t,null,e),t.lanes=n,t}function py(t,e,n){return e=Ms(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function j8(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=K1(0),this.expirationTimes=K1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=K1(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mx(t,e,n,r,s,i,o,a,u){return t=new j8(t,e,n,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ms(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zw(i),t}function G8(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hk(t){if(!t)return Ma;t=t._reactInternals;e:{if(wl(t)!==t||t.tag!==1)throw Error(ce(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(t.tag===1){var n=t.type;if(Wr(n))return hI(t,n,e)}return e}function pk(t,e,n,r,s,i,o,a,u){return t=mx(n,r,!0,t,s,i,o,a,u),t.context=hk(null),n=t.current,r=Nr(),s=Pa(n),i=Fo(r,s),i.callback=e??null,ka(n,i,s),t.current.lanes=s,Rh(t,s,r),jr(t,r),t}function fg(t,e,n,r){var s=e.current,i=Nr(),o=Pa(s);return n=hk(n),e.context===null?e.context=n:e.pendingContext=n,e=Fo(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ka(s,e,o),t!==null&&(_i(t,s,o,i),wm(t,s,o)),o}function p0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $E(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gx(t,e){$E(t,e),(t=t.alternate)&&$E(t,e)}function q8(){return null}var mk=typeof reportError=="function"?reportError:function(t){console.error(t)};function yx(t){this._internalRoot=t}hg.prototype.render=yx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ce(409));fg(t,e,null,null)};hg.prototype.unmount=yx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;rl(function(){fg(null,t,null,null)}),e[Uo]=null}};function hg(t){this._internalRoot=t}hg.prototype.unstable_scheduleHydration=function(t){if(t){var e=q_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ya.length&&e!==0&&e<ya[n].priority;n++);ya.splice(n,0,t),n===0&&K_(t)}};function bx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function BE(){}function H8(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var l=p0(o);i.call(l)}}var o=pk(e,r,t,0,null,!1,!1,"",BE);return t._reactRootContainer=o,t[Uo]=o.current,rh(t.nodeType===8?t.parentNode:t),rl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var l=p0(u);a.call(l)}}var u=mx(t,0,!1,null,null,!1,!1,"",BE);return t._reactRootContainer=u,t[Uo]=u.current,rh(t.nodeType===8?t.parentNode:t),rl(function(){fg(e,u,n,r)}),u}function mg(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var u=p0(o);a.call(u)}}fg(e,o,t,s)}else o=H8(n,e,t,s,r);return p0(o)}j_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xf(e.pendingLanes);n!==0&&($w(e,n|1),jr(e,un()),!(at&6)&&(Yc=un()+500,Xa()))}break;case 13:rl(function(){var r=zo(t,1);if(r!==null){var s=Nr();_i(r,t,1,s)}}),gx(t,1)}};Bw=function(t){if(t.tag===13){var e=zo(t,134217728);if(e!==null){var n=Nr();_i(e,t,134217728,n)}gx(t,134217728)}};G_=function(t){if(t.tag===13){var e=Pa(t),n=zo(t,e);if(n!==null){var r=Nr();_i(n,t,e,r)}gx(t,e)}};q_=function(){return vt};H_=function(t,e){var n=vt;try{return vt=t,e()}finally{vt=n}};Ab=function(t,e,n){switch(e){case"input":if(gb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ig(r);if(!s)throw Error(ce(90));E_(r),gb(r,s)}}}break;case"textarea":N_(t,n);break;case"select":e=n.value,e!=null&&Ic(t,!!n.multiple,e,!1)}};O_=dx;D_=rl;var K8={usingClientEntryPoint:!1,Events:[Oh,mc,ig,R_,P_,dx]},ef={findFiberByHostInstance:$u,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X8={bundleType:ef.bundleType,version:ef.version,rendererPackageName:ef.rendererPackageName,rendererConfig:ef.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ko.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$_(t),t===null?null:t.stateNode},findFiberByHostInstance:ef.findFiberByHostInstance||q8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $p=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$p.isDisabled&&$p.supportsFiber)try{tg=$p.inject(X8),ro=$p}catch{}}ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K8;ms.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bx(e))throw Error(ce(200));return G8(t,e,null,n)};ms.createRoot=function(t,e){if(!bx(t))throw Error(ce(299));var n=!1,r="",s=mk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mx(t,1,!1,null,null,n,!1,r,s),t[Uo]=e.current,rh(t.nodeType===8?t.parentNode:t),new yx(e)};ms.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ce(188)):(t=Object.keys(t).join(","),Error(ce(268,t)));return t=$_(e),t=t===null?null:t.stateNode,t};ms.flushSync=function(t){return rl(t)};ms.hydrate=function(t,e,n){if(!pg(e))throw Error(ce(200));return mg(null,t,e,!0,n)};ms.hydrateRoot=function(t,e,n){if(!bx(t))throw Error(ce(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=mk;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=pk(e,null,t,1,n??null,s,!1,i,o),t[Uo]=e.current,rh(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new hg(e)};ms.render=function(t,e,n){if(!pg(e))throw Error(ce(200));return mg(null,t,e,!1,n)};ms.unmountComponentAtNode=function(t){if(!pg(t))throw Error(ce(40));return t._reactRootContainer?(rl(function(){mg(null,null,t,!1,function(){t._reactRootContainer=null,t[Uo]=null})}),!0):!1};ms.unstable_batchedUpdates=dx;ms.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!pg(n))throw Error(ce(200));if(t==null||t._reactInternals===void 0)throw Error(ce(38));return mg(t,e,n,!1,r)};ms.version="18.3.1-next-f1338f8080-20240426";function gk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gk)}catch(t){console.error(t)}}gk(),g_.exports=ms;var Lh=g_.exports;const Y8=cd(Lh),Q8=Aw({__proto__:null,default:Y8},[Lh]);/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yt(){return Yt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yt.apply(this,arguments)}var hn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(hn||(hn={}));const ME="popstate";function Z8(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return fh("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Fh(s)}return eV(e,n,null,t)}function Xe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function J8(){return Math.random().toString(36).substr(2,8)}function VE(t,e){return{usr:t.state,key:t.key,idx:e}}function fh(t,e,n,r){return n===void 0&&(n=null),Yt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ya(e):e,{state:n,key:e&&e.key||r||J8()})}function Fh(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ya(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function eV(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=hn.Pop,u=null,l=c();l==null&&(l=0,o.replaceState(Yt({},o.state,{idx:l}),""));function c(){return(o.state||{idx:null}).idx}function d(){a=hn.Pop;let b=c(),g=b==null?null:b-l;l=b,u&&u({action:a,location:y.location,delta:g})}function f(b,g){a=hn.Push;let v=fh(y.location,b,g);l=c()+1;let w=VE(v,l),x=y.createHref(v);try{o.pushState(w,"",x)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(x)}i&&u&&u({action:a,location:y.location,delta:1})}function h(b,g){a=hn.Replace;let v=fh(y.location,b,g);l=c();let w=VE(v,l),x=y.createHref(v);o.replaceState(w,"",x),i&&u&&u({action:a,location:y.location,delta:0})}function p(b){let g=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof b=="string"?b:Fh(b);return v=v.replace(/ $/,"%20"),Xe(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let y={get action(){return a},get location(){return t(s,o)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(ME,d),u=b,()=>{s.removeEventListener(ME,d),u=null}},createHref(b){return e(s,b)},createURL:p,encodeLocation(b){let g=p(b);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(b){return o.go(b)}};return y}var Tt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Tt||(Tt={}));const tV=new Set(["lazy","caseSensitive","path","id","index","children"]);function nV(t){return t.index===!0}function hh(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],a=typeof s.id=="string"?s.id:o.join("-");if(Xe(s.index!==!0||!s.children,"Cannot specify children on an index route"),Xe(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),nV(s)){let u=Yt({},s,e(s),{id:a});return r[a]=u,u}else{let u=Yt({},s,e(s),{id:a,children:void 0});return r[a]=u,s.children&&(u.children=hh(s.children,e,o,r)),u}})}function Pu(t,e,n){return n===void 0&&(n="/"),Tm(t,e,n,!1)}function Tm(t,e,n,r){let s=typeof e=="string"?Ya(e):e,i=$h(s.pathname||"/",n);if(i==null)return null;let o=yk(t);sV(o);let a=null;for(let u=0;a==null&&u<o.length;++u){let l=mV(i);a=hV(o[u],l,r)}return a}function rV(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function yk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let u={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Xe(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=Da([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(Xe(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),yk(i.children,e,c,l)),!(i.path==null&&!i.index)&&e.push({path:l,score:dV(l,i.index),routesMeta:c})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let u of bk(i.path))s(i,o,u)}),e}function bk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=bk(r.join("/")),a=[];return a.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&a.push(...o),a.map(u=>t.startsWith("/")&&u===""?"/":u)}function sV(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fV(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const iV=/^:[\w-]+$/,oV=3,aV=2,uV=1,lV=10,cV=-2,UE=t=>t==="*";function dV(t,e){let n=t.split("/"),r=n.length;return n.some(UE)&&(r+=cV),e&&(r+=aV),n.filter(s=>!UE(s)).reduce((s,i)=>s+(iV.test(i)?oV:i===""?uV:lV),r)}function fV(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function hV(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let u=r[a],l=a===r.length-1,c=i==="/"?e:e.slice(i.length)||"/",d=zE({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=zE({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:Da([i,d.pathname]),pathnameBase:bV(Da([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=Da([i,d.pathnameBase]))}return o}function zE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=pV(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let y=a[d]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?l[f]=void 0:l[f]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:t}}function pV(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,u)=>(r.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function mV(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function $h(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function gV(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ya(t):t;return{pathname:n?n.startsWith("/")?n:yV(n,e):e,search:vV(r),hash:wV(s)}}function yV(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function my(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vk(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wk(t,e){let n=vk(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function xk(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ya(t):(s=Yt({},t),Xe(!s.pathname||!s.pathname.includes("?"),my("?","pathname","search",s)),Xe(!s.pathname||!s.pathname.includes("#"),my("#","pathname","hash",s)),Xe(!s.search||!s.search.includes("#"),my("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}a=d>=0?e[d]:"/"}let u=gV(s,a),l=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const Da=t=>t.join("/").replace(/\/\/+/g,"/"),bV=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vV=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wV=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class m0{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function gg(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Sk=["post","put","patch","delete"],xV=new Set(Sk),SV=["get",...Sk],AV=new Set(SV),EV=new Set([301,302,303,307,308]),CV=new Set([307,308]),gy={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},NV={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},tf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},vx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TV=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),Ak="remix-router-transitions";function _V(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Xe(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let z=t.detectErrorBoundary;s=G=>({hasErrorBoundary:z(G)})}else s=TV;let i={},o=hh(t.routes,s,void 0,i),a,u=t.basename||"/",l=t.unstable_dataStrategy||OV,c=t.unstable_patchRoutesOnNavigation,d=Yt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,h=new Set,p=1e3,y=new Set,b=null,g=null,v=null,w=t.hydrationData!=null,x=Pu(o,t.history.location,u),C=null;if(x==null&&!c){let z=wr(404,{pathname:t.history.location.pathname}),{matches:G,route:Y}=ZE(o);x=G,C={[Y.id]:z}}x&&!t.hydrationData&&zl(x,o,t.history.location.pathname).active&&(x=null);let k;if(x)if(x.some(z=>z.route.lazy))k=!1;else if(!x.some(z=>z.route.loader))k=!0;else if(d.v7_partialHydration){let z=t.hydrationData?t.hydrationData.loaderData:null,G=t.hydrationData?t.hydrationData.errors:null,Y=ne=>ne.route.loader?typeof ne.route.loader=="function"&&ne.route.loader.hydrate===!0?!1:z&&z[ne.route.id]!==void 0||G&&G[ne.route.id]!==void 0:!0;if(G){let ne=x.findIndex(xe=>G[xe.route.id]!==void 0);k=x.slice(0,ne+1).every(Y)}else k=x.every(Y)}else k=t.hydrationData!=null;else if(k=!1,x=[],d.v7_partialHydration){let z=zl(null,o,t.history.location.pathname);z.active&&z.matches&&(x=z.matches)}let P,N={historyAction:t.history.action,location:t.history.location,matches:x,initialized:k,navigation:gy,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||C,fetchers:new Map,blockers:new Map},$=hn.Pop,U=!1,K,Z=!1,ie=new Map,ee=null,j=!1,M=!1,O=[],D=new Set,V=new Map,F=0,ue=-1,se=new Map,he=new Set,ae=new Map,be=new Map,_e=new Set,lt=new Map,we=new Map,Hn=new Map,hr=!1;function Kn(){if(f=t.history.listen(z=>{let{action:G,location:Y,delta:ne}=z;if(hr){hr=!1;return}Qc(we.size===0||ne!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let xe=$d({currentLocation:N.location,nextLocation:Y,historyAction:G});if(xe&&ne!=null){hr=!0,t.history.go(ne*-1),su(xe,{state:"blocked",location:Y,proceed(){su(xe,{state:"proceeding",proceed:void 0,reset:void 0,location:Y}),t.history.go(ne)},reset(){let Te=new Map(N.blockers);Te.set(xe,tf),Kt({blockers:Te})}});return}return Kr(G,Y)}),n){qV(e,ie);let z=()=>HV(e,ie);e.addEventListener("pagehide",z),ee=()=>e.removeEventListener("pagehide",z)}return N.initialized||Kr(hn.Pop,N.location,{initialHydration:!0}),P}function Ss(){f&&f(),ee&&ee(),h.clear(),K&&K.abort(),N.fetchers.forEach((z,G)=>Vl(G)),N.blockers.forEach((z,G)=>ru(G))}function As(z){return h.add(z),()=>h.delete(z)}function Kt(z,G){G===void 0&&(G={}),N=Yt({},N,z);let Y=[],ne=[];d.v7_fetcherPersist&&N.fetchers.forEach((xe,Te)=>{xe.state==="idle"&&(_e.has(Te)?ne.push(Te):Y.push(Te))}),[...h].forEach(xe=>xe(N,{deletedFetchers:ne,unstable_viewTransitionOpts:G.viewTransitionOpts,unstable_flushSync:G.flushSync===!0})),d.v7_fetcherPersist&&(Y.forEach(xe=>N.fetchers.delete(xe)),ne.forEach(xe=>Vl(xe)))}function En(z,G,Y){var ne,xe;let{flushSync:Te}=Y===void 0?{}:Y,Pe=N.actionData!=null&&N.navigation.formMethod!=null&&wi(N.navigation.formMethod)&&N.navigation.state==="loading"&&((ne=z.state)==null?void 0:ne._isRedirect)!==!0,le;G.actionData?Object.keys(G.actionData).length>0?le=G.actionData:le=null:Pe?le=N.actionData:le=null;let Re=G.loaderData?YE(N.loaderData,G.loaderData,G.matches||[],G.errors):N.loaderData,Ee=N.blockers;Ee.size>0&&(Ee=new Map(Ee),Ee.forEach((Ze,tt)=>Ee.set(tt,tf)));let Ie=U===!0||N.navigation.formMethod!=null&&wi(N.navigation.formMethod)&&((xe=z.state)==null?void 0:xe._isRedirect)!==!0;a&&(o=a,a=void 0),j||$===hn.Pop||($===hn.Push?t.history.push(z,z.state):$===hn.Replace&&t.history.replace(z,z.state));let ot;if($===hn.Pop){let Ze=ie.get(N.location.pathname);Ze&&Ze.has(z.pathname)?ot={currentLocation:N.location,nextLocation:z}:ie.has(z.pathname)&&(ot={currentLocation:z,nextLocation:N.location})}else if(Z){let Ze=ie.get(N.location.pathname);Ze?Ze.add(z.pathname):(Ze=new Set([z.pathname]),ie.set(N.location.pathname,Ze)),ot={currentLocation:N.location,nextLocation:z}}Kt(Yt({},G,{actionData:le,loaderData:Re,historyAction:$,location:z,initialized:!0,navigation:gy,revalidation:"idle",restoreScrollPosition:sp(z,G.matches||N.matches),preventScrollReset:Ie,blockers:Ee}),{viewTransitionOpts:ot,flushSync:Te===!0}),$=hn.Pop,U=!1,Z=!1,j=!1,M=!1,O=[]}async function gn(z,G){if(typeof z=="number"){t.history.go(z);return}let Y=nv(N.location,N.matches,u,d.v7_prependBasename,z,d.v7_relativeSplatPath,G==null?void 0:G.fromRouteId,G==null?void 0:G.relative),{path:ne,submission:xe,error:Te}=WE(d.v7_normalizeFormMethod,!1,Y,G),Pe=N.location,le=fh(N.location,ne,G&&G.state);le=Yt({},le,t.history.encodeLocation(le));let Re=G&&G.replace!=null?G.replace:void 0,Ee=hn.Push;Re===!0?Ee=hn.Replace:Re===!1||xe!=null&&wi(xe.formMethod)&&xe.formAction===N.location.pathname+N.location.search&&(Ee=hn.Replace);let Ie=G&&"preventScrollReset"in G?G.preventScrollReset===!0:void 0,ot=(G&&G.unstable_flushSync)===!0,Ze=$d({currentLocation:Pe,nextLocation:le,historyAction:Ee});if(Ze){su(Ze,{state:"blocked",location:le,proceed(){su(Ze,{state:"proceeding",proceed:void 0,reset:void 0,location:le}),gn(z,G)},reset(){let tt=new Map(N.blockers);tt.set(Ze,tf),Kt({blockers:tt})}});return}return await Kr(Ee,le,{submission:xe,pendingError:Te,preventScrollReset:Ie,replace:G&&G.replace,enableViewTransition:G&&G.unstable_viewTransition,flushSync:ot})}function yo(){if(Bi(),Kt({revalidation:"loading"}),N.navigation.state!=="submitting"){if(N.navigation.state==="idle"){Kr(N.historyAction,N.location,{startUninterruptedRevalidation:!0});return}Kr($||N.historyAction,N.navigation.location,{overrideNavigation:N.navigation})}}async function Kr(z,G,Y){K&&K.abort(),K=null,$=z,j=(Y&&Y.startUninterruptedRevalidation)===!0,iu(N.location,N.matches),U=(Y&&Y.preventScrollReset)===!0,Z=(Y&&Y.enableViewTransition)===!0;let ne=a||o,xe=Y&&Y.overrideNavigation,Te=Pu(ne,G,u),Pe=(Y&&Y.flushSync)===!0,le=zl(Te,ne,G.pathname);if(le.active&&le.matches&&(Te=le.matches),!Te){let{error:Ke,notFoundMatches:fn,route:zt}=Bd(G.pathname);En(G,{matches:fn,loaderData:{},errors:{[zt.id]:Ke}},{flushSync:Pe});return}if(N.initialized&&!M&&MV(N.location,G)&&!(Y&&Y.submission&&wi(Y.submission.formMethod))){En(G,{matches:Te},{flushSync:Pe});return}K=new AbortController;let Re=Zl(t.history,G,K.signal,Y&&Y.submission),Ee;if(Y&&Y.pendingError)Ee=[Sc(Te).route.id,{type:Tt.error,error:Y.pendingError}];else if(Y&&Y.submission&&wi(Y.submission.formMethod)){let Ke=await $l(Re,G,Y.submission,Te,le.active,{replace:Y.replace,flushSync:Pe});if(Ke.shortCircuited)return;if(Ke.pendingActionResult){let[fn,zt]=Ke.pendingActionResult;if(rs(zt)&&gg(zt.error)&&zt.error.status===404){K=null,En(G,{matches:Ke.matches,loaderData:{},errors:{[fn]:zt.error}});return}}Te=Ke.matches||Te,Ee=Ke.pendingActionResult,xe=yy(G,Y.submission),Pe=!1,le.active=!1,Re=Zl(t.history,Re.url,Re.signal)}let{shortCircuited:Ie,matches:ot,loaderData:Ze,errors:tt}=await Ld(Re,G,Te,le.active,xe,Y&&Y.submission,Y&&Y.fetcherSubmission,Y&&Y.replace,Y&&Y.initialHydration===!0,Pe,Ee);Ie||(K=null,En(G,Yt({matches:ot||Te},QE(Ee),{loaderData:Ze,errors:tt})))}async function $l(z,G,Y,ne,xe,Te){Te===void 0&&(Te={}),Bi();let Pe=jV(G,Y);if(Kt({navigation:Pe},{flushSync:Te.flushSync===!0}),xe){let Ee=await Wl(ne,G.pathname,z.signal);if(Ee.type==="aborted")return{shortCircuited:!0};if(Ee.type==="error"){let{boundaryId:Ie,error:ot}=Ul(G.pathname,Ee);return{matches:Ee.partialMatches,pendingActionResult:[Ie,{type:Tt.error,error:ot}]}}else if(Ee.matches)ne=Ee.matches;else{let{notFoundMatches:Ie,error:ot,route:Ze}=Bd(G.pathname);return{matches:Ie,pendingActionResult:[Ze.id,{type:Tt.error,error:ot}]}}}let le,Re=Af(ne,G);if(!Re.route.action&&!Re.route.lazy)le={type:Tt.error,error:wr(405,{method:z.method,pathname:G.pathname,routeId:Re.route.id})};else if(le=(await si("action",z,[Re],ne))[0],z.signal.aborted)return{shortCircuited:!0};if(Uu(le)){let Ee;return Te&&Te.replace!=null?Ee=Te.replace:Ee=HE(le.response.headers.get("Location"),new URL(z.url),u)===N.location.pathname+N.location.search,await Jo(z,le,{submission:Y,replace:Ee}),{shortCircuited:!0}}if(Vu(le))throw wr(400,{type:"defer-action"});if(rs(le)){let Ee=Sc(ne,Re.route.id);return(Te&&Te.replace)!==!0&&($=hn.Push),{matches:ne,pendingActionResult:[Ee.route.id,le]}}return{matches:ne,pendingActionResult:[Re.route.id,le]}}async function Ld(z,G,Y,ne,xe,Te,Pe,le,Re,Ee,Ie){let ot=xe||yy(G,Te),Ze=Te||Pe||nC(ot),tt=!j&&(!d.v7_partialHydration||!Re);if(ne){if(tt){let Mt=nu(Ie);Kt(Yt({navigation:ot},Mt!==void 0?{actionData:Mt}:{}),{flushSync:Ee})}let ze=await Wl(Y,G.pathname,z.signal);if(ze.type==="aborted")return{shortCircuited:!0};if(ze.type==="error"){let{boundaryId:Mt,error:Xn}=Ul(G.pathname,ze);return{matches:ze.partialMatches,loaderData:{},errors:{[Mt]:Xn}}}else if(ze.matches)Y=ze.matches;else{let{error:Mt,notFoundMatches:Xn,route:_t}=Bd(G.pathname);return{matches:Xn,loaderData:{},errors:{[_t.id]:Mt}}}}let Ke=a||o,[fn,zt]=jE(t.history,N,Y,Ze,G,d.v7_partialHydration&&Re===!0,d.v7_skipActionErrorRevalidation,M,O,D,_e,ae,he,Ke,u,Ie);if(Md(ze=>!(Y&&Y.some(Mt=>Mt.route.id===ze))||fn&&fn.some(Mt=>Mt.route.id===ze)),ue=++F,fn.length===0&&zt.length===0){let ze=tp();return En(G,Yt({matches:Y,loaderData:{},errors:Ie&&rs(Ie[1])?{[Ie[0]]:Ie[1].error}:null},QE(Ie),ze?{fetchers:new Map(N.fetchers)}:{}),{flushSync:Ee}),{shortCircuited:!0}}if(tt){let ze={};if(!ne){ze.navigation=ot;let Mt=nu(Ie);Mt!==void 0&&(ze.actionData=Mt)}zt.length>0&&(ze.fetchers=bo(zt)),Kt(ze,{flushSync:Ee})}zt.forEach(ze=>{V.has(ze.key)&&Mi(ze.key),ze.controller&&V.set(ze.key,ze.controller)});let Es=()=>zt.forEach(ze=>Mi(ze.key));K&&K.signal.addEventListener("abort",Es);let{loaderResults:oi,fetcherResults:Vi}=await vo(N.matches,Y,fn,zt,z);if(z.signal.aborted)return{shortCircuited:!0};K&&K.signal.removeEventListener("abort",Es),zt.forEach(ze=>V.delete(ze.key));let Ui=JE([...oi,...Vi]);if(Ui){if(Ui.idx>=fn.length){let ze=zt[Ui.idx-fn.length].key;he.add(ze)}return await Jo(z,Ui.result,{replace:le}),{shortCircuited:!0}}let{loaderData:xo,errors:Yr}=XE(N,Y,fn,oi,Ie,zt,Vi,lt);lt.forEach((ze,Mt)=>{ze.subscribe(Xn=>{(Xn||ze.done)&&lt.delete(Mt)})}),d.v7_partialHydration&&Re&&N.errors&&Object.entries(N.errors).filter(ze=>{let[Mt]=ze;return!fn.some(Xn=>Xn.route.id===Mt)}).forEach(ze=>{let[Mt,Xn]=ze;Yr=Object.assign(Yr||{},{[Mt]:Xn})});let ou=tp(),au=np(ue),uu=ou||au||zt.length>0;return Yt({matches:Y,loaderData:xo,errors:Yr},uu?{fetchers:new Map(N.fetchers)}:{})}function nu(z){if(z&&!rs(z[1]))return{[z[0]]:z[1].data};if(N.actionData)return Object.keys(N.actionData).length===0?null:N.actionData}function bo(z){return z.forEach(G=>{let Y=N.fetchers.get(G.key),ne=nf(void 0,Y?Y.data:void 0);N.fetchers.set(G.key,ne)}),new Map(N.fetchers)}function Fd(z,G,Y,ne){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");V.has(z)&&Mi(z);let xe=(ne&&ne.unstable_flushSync)===!0,Te=a||o,Pe=nv(N.location,N.matches,u,d.v7_prependBasename,Y,d.v7_relativeSplatPath,G,ne==null?void 0:ne.relative),le=Pu(Te,Pe,u),Re=zl(le,Te,Pe);if(Re.active&&Re.matches&&(le=Re.matches),!le){ii(z,G,wr(404,{pathname:Pe}),{flushSync:xe});return}let{path:Ee,submission:Ie,error:ot}=WE(d.v7_normalizeFormMethod,!0,Pe,ne);if(ot){ii(z,G,ot,{flushSync:xe});return}let Ze=Af(le,Ee);if(U=(ne&&ne.preventScrollReset)===!0,Ie&&wi(Ie.formMethod)){Bl(z,G,Ee,Ze,le,Re.active,xe,Ie);return}ae.set(z,{routeId:G,path:Ee}),$i(z,G,Ee,Ze,le,Re.active,xe,Ie)}async function Bl(z,G,Y,ne,xe,Te,Pe,le){Bi(),ae.delete(z);function Re(_t){if(!_t.route.action&&!_t.route.lazy){let Cs=wr(405,{method:le.formMethod,pathname:Y,routeId:G});return ii(z,G,Cs,{flushSync:Pe}),!0}return!1}if(!Te&&Re(ne))return;let Ee=N.fetchers.get(z);Xr(z,GV(le,Ee),{flushSync:Pe});let Ie=new AbortController,ot=Zl(t.history,Y,Ie.signal,le);if(Te){let _t=await Wl(xe,Y,ot.signal);if(_t.type==="aborted")return;if(_t.type==="error"){let{error:Cs}=Ul(Y,_t);ii(z,G,Cs,{flushSync:Pe});return}else if(_t.matches){if(xe=_t.matches,ne=Af(xe,Y),Re(ne))return}else{ii(z,G,wr(404,{pathname:Y}),{flushSync:Pe});return}}V.set(z,Ie);let Ze=F,Ke=(await si("action",ot,[ne],xe))[0];if(ot.signal.aborted){V.get(z)===Ie&&V.delete(z);return}if(d.v7_fetcherPersist&&_e.has(z)){if(Uu(Ke)||rs(Ke)){Xr(z,da(void 0));return}}else{if(Uu(Ke))if(V.delete(z),ue>Ze){Xr(z,da(void 0));return}else return he.add(z),Xr(z,nf(le)),Jo(ot,Ke,{fetcherSubmission:le});if(rs(Ke)){ii(z,G,Ke.error);return}}if(Vu(Ke))throw wr(400,{type:"defer-action"});let fn=N.navigation.location||N.location,zt=Zl(t.history,fn,Ie.signal),Es=a||o,oi=N.navigation.state!=="idle"?Pu(Es,N.navigation.location,u):N.matches;Xe(oi,"Didn't find any matches after fetcher action");let Vi=++F;se.set(z,Vi);let Ui=nf(le,Ke.data);N.fetchers.set(z,Ui);let[xo,Yr]=jE(t.history,N,oi,le,fn,!1,d.v7_skipActionErrorRevalidation,M,O,D,_e,ae,he,Es,u,[ne.route.id,Ke]);Yr.filter(_t=>_t.key!==z).forEach(_t=>{let Cs=_t.key,Qr=N.fetchers.get(Cs),pr=nf(void 0,Qr?Qr.data:void 0);N.fetchers.set(Cs,pr),V.has(Cs)&&Mi(Cs),_t.controller&&V.set(Cs,_t.controller)}),Kt({fetchers:new Map(N.fetchers)});let ou=()=>Yr.forEach(_t=>Mi(_t.key));Ie.signal.addEventListener("abort",ou);let{loaderResults:au,fetcherResults:uu}=await vo(N.matches,oi,xo,Yr,zt);if(Ie.signal.aborted)return;Ie.signal.removeEventListener("abort",ou),se.delete(z),V.delete(z),Yr.forEach(_t=>V.delete(_t.key));let ze=JE([...au,...uu]);if(ze){if(ze.idx>=xo.length){let _t=Yr[ze.idx-xo.length].key;he.add(_t)}return Jo(zt,ze.result)}let{loaderData:Mt,errors:Xn}=XE(N,N.matches,xo,au,void 0,Yr,uu,lt);if(N.fetchers.has(z)){let _t=da(Ke.data);N.fetchers.set(z,_t)}np(Vi),N.navigation.state==="loading"&&Vi>ue?(Xe($,"Expected pending action"),K&&K.abort(),En(N.navigation.location,{matches:oi,loaderData:Mt,errors:Xn,fetchers:new Map(N.fetchers)})):(Kt({errors:Xn,loaderData:YE(N.loaderData,Mt,oi,Xn),fetchers:new Map(N.fetchers)}),M=!1)}async function $i(z,G,Y,ne,xe,Te,Pe,le){let Re=N.fetchers.get(z);Xr(z,nf(le,Re?Re.data:void 0),{flushSync:Pe});let Ee=new AbortController,Ie=Zl(t.history,Y,Ee.signal);if(Te){let Ke=await Wl(xe,Y,Ie.signal);if(Ke.type==="aborted")return;if(Ke.type==="error"){let{error:fn}=Ul(Y,Ke);ii(z,G,fn,{flushSync:Pe});return}else if(Ke.matches)xe=Ke.matches,ne=Af(xe,Y);else{ii(z,G,wr(404,{pathname:Y}),{flushSync:Pe});return}}V.set(z,Ee);let ot=F,tt=(await si("loader",Ie,[ne],xe))[0];if(Vu(tt)&&(tt=await _k(tt,Ie.signal,!0)||tt),V.get(z)===Ee&&V.delete(z),!Ie.signal.aborted){if(_e.has(z)){Xr(z,da(void 0));return}if(Uu(tt))if(ue>ot){Xr(z,da(void 0));return}else{he.add(z),await Jo(Ie,tt);return}if(rs(tt)){ii(z,G,tt.error);return}Xe(!Vu(tt),"Unhandled fetcher deferred data"),Xr(z,da(tt.data))}}async function Jo(z,G,Y){let{submission:ne,fetcherSubmission:xe,replace:Te}=Y===void 0?{}:Y;G.response.headers.has("X-Remix-Revalidate")&&(M=!0);let Pe=G.response.headers.get("Location");Xe(Pe,"Expected a Location header on the redirect Response"),Pe=HE(Pe,new URL(z.url),u);let le=fh(N.location,Pe,{_isRedirect:!0});if(n){let tt=!1;if(G.response.headers.has("X-Remix-Reload-Document"))tt=!0;else if(vx.test(Pe)){const Ke=t.history.createURL(Pe);tt=Ke.origin!==e.location.origin||$h(Ke.pathname,u)==null}if(tt){Te?e.location.replace(Pe):e.location.assign(Pe);return}}K=null;let Re=Te===!0||G.response.headers.has("X-Remix-Replace")?hn.Replace:hn.Push,{formMethod:Ee,formAction:Ie,formEncType:ot}=N.navigation;!ne&&!xe&&Ee&&Ie&&ot&&(ne=nC(N.navigation));let Ze=ne||xe;if(CV.has(G.response.status)&&Ze&&wi(Ze.formMethod))await Kr(Re,le,{submission:Yt({},Ze,{formAction:Pe}),preventScrollReset:U});else{let tt=yy(le,ne);await Kr(Re,le,{overrideNavigation:tt,fetcherSubmission:xe,preventScrollReset:U})}}async function si(z,G,Y,ne){try{let xe=await DV(l,z,G,Y,ne,i,s);return await Promise.all(xe.map((Te,Pe)=>{if(UV(Te)){let le=Te.result;return{type:Tt.redirect,response:$V(le,G,Y[Pe].route.id,ne,u,d.v7_relativeSplatPath)}}return FV(Te)}))}catch(xe){return Y.map(()=>({type:Tt.error,error:xe}))}}async function vo(z,G,Y,ne,xe){let[Te,...Pe]=await Promise.all([Y.length?si("loader",xe,Y,G):[],...ne.map(le=>{if(le.matches&&le.match&&le.controller){let Re=Zl(t.history,le.path,le.controller.signal);return si("loader",Re,[le.match],le.matches).then(Ee=>Ee[0])}else return Promise.resolve({type:Tt.error,error:wr(404,{pathname:le.path})})})]);return await Promise.all([tC(z,Y,Te,Te.map(()=>xe.signal),!1,N.loaderData),tC(z,ne.map(le=>le.match),Pe,ne.map(le=>le.controller?le.controller.signal:null),!0)]),{loaderResults:Te,fetcherResults:Pe}}function Bi(){M=!0,O.push(...Md()),ae.forEach((z,G)=>{V.has(G)&&(D.add(G),Mi(G))})}function Xr(z,G,Y){Y===void 0&&(Y={}),N.fetchers.set(z,G),Kt({fetchers:new Map(N.fetchers)},{flushSync:(Y&&Y.flushSync)===!0})}function ii(z,G,Y,ne){ne===void 0&&(ne={});let xe=Sc(N.matches,G);Vl(z),Kt({errors:{[xe.route.id]:Y},fetchers:new Map(N.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Ml(z){return d.v7_fetcherPersist&&(be.set(z,(be.get(z)||0)+1),_e.has(z)&&_e.delete(z)),N.fetchers.get(z)||NV}function Vl(z){let G=N.fetchers.get(z);V.has(z)&&!(G&&G.state==="loading"&&se.has(z))&&Mi(z),ae.delete(z),se.delete(z),he.delete(z),_e.delete(z),D.delete(z),N.fetchers.delete(z)}function h1(z){if(d.v7_fetcherPersist){let G=(be.get(z)||0)-1;G<=0?(be.delete(z),_e.add(z)):be.set(z,G)}else Vl(z);Kt({fetchers:new Map(N.fetchers)})}function Mi(z){let G=V.get(z);Xe(G,"Expected fetch controller: "+z),G.abort(),V.delete(z)}function ep(z){for(let G of z){let Y=Ml(G),ne=da(Y.data);N.fetchers.set(G,ne)}}function tp(){let z=[],G=!1;for(let Y of he){let ne=N.fetchers.get(Y);Xe(ne,"Expected fetcher: "+Y),ne.state==="loading"&&(he.delete(Y),z.push(Y),G=!0)}return ep(z),G}function np(z){let G=[];for(let[Y,ne]of se)if(ne<z){let xe=N.fetchers.get(Y);Xe(xe,"Expected fetcher: "+Y),xe.state==="loading"&&(Mi(Y),se.delete(Y),G.push(Y))}return ep(G),G.length>0}function rp(z,G){let Y=N.blockers.get(z)||tf;return we.get(z)!==G&&we.set(z,G),Y}function ru(z){N.blockers.delete(z),we.delete(z)}function su(z,G){let Y=N.blockers.get(z)||tf;Xe(Y.state==="unblocked"&&G.state==="blocked"||Y.state==="blocked"&&G.state==="blocked"||Y.state==="blocked"&&G.state==="proceeding"||Y.state==="blocked"&&G.state==="unblocked"||Y.state==="proceeding"&&G.state==="unblocked","Invalid blocker state transition: "+Y.state+" -> "+G.state);let ne=new Map(N.blockers);ne.set(z,G),Kt({blockers:ne})}function $d(z){let{currentLocation:G,nextLocation:Y,historyAction:ne}=z;if(we.size===0)return;we.size>1&&Qc(!1,"A router only supports one blocker at a time");let xe=Array.from(we.entries()),[Te,Pe]=xe[xe.length-1],le=N.blockers.get(Te);if(!(le&&le.state==="proceeding")&&Pe({currentLocation:G,nextLocation:Y,historyAction:ne}))return Te}function Bd(z){let G=wr(404,{pathname:z}),Y=a||o,{matches:ne,route:xe}=ZE(Y);return Md(),{notFoundMatches:ne,route:xe,error:G}}function Ul(z,G){return{boundaryId:Sc(G.partialMatches).route.id,error:wr(400,{type:"route-discovery",pathname:z,message:G.error!=null&&"message"in G.error?G.error:String(G.error)})}}function Md(z){let G=[];return lt.forEach((Y,ne)=>{(!z||z(ne))&&(Y.cancel(),G.push(ne),lt.delete(ne))}),G}function p1(z,G,Y){if(b=z,v=G,g=Y||null,!w&&N.navigation===gy){w=!0;let ne=sp(N.location,N.matches);ne!=null&&Kt({restoreScrollPosition:ne})}return()=>{b=null,v=null,g=null}}function wo(z,G){return g&&g(z,G.map(ne=>rV(ne,N.loaderData)))||z.key}function iu(z,G){if(b&&v){let Y=wo(z,G);b[Y]=v()}}function sp(z,G){if(b){let Y=wo(z,G),ne=b[Y];if(typeof ne=="number")return ne}return null}function zl(z,G,Y){if(c){if(y.has(Y))return{active:!1,matches:z};if(z){if(Object.keys(z[0].params).length>0)return{active:!0,matches:Tm(G,Y,u,!0)}}else return{active:!0,matches:Tm(G,Y,u,!0)||[]}}return{active:!1,matches:null}}async function Wl(z,G,Y){let ne=z;for(;;){let xe=a==null,Te=a||o;try{await PV(c,G,ne,Te,i,s,Hn,Y)}catch(Re){return{type:"error",error:Re,partialMatches:ne}}finally{xe&&(o=[...o])}if(Y.aborted)return{type:"aborted"};let Pe=Pu(Te,G,u);if(Pe)return ip(G,y),{type:"success",matches:Pe};let le=Tm(Te,G,u,!0);if(!le||ne.length===le.length&&ne.every((Re,Ee)=>Re.route.id===le[Ee].route.id))return ip(G,y),{type:"success",matches:null};ne=le}}function ip(z,G){if(G.size>=p){let Y=G.values().next().value;G.delete(Y)}G.add(z)}function m1(z){i={},a=hh(z,s,void 0,i)}function Vd(z,G){let Y=a==null;Ck(z,G,a||o,i,s),Y&&(o=[...o],Kt({}))}return P={get basename(){return u},get future(){return d},get state(){return N},get routes(){return o},get window(){return e},initialize:Kn,subscribe:As,enableScrollRestoration:p1,navigate:gn,fetch:Fd,revalidate:yo,createHref:z=>t.history.createHref(z),encodeLocation:z=>t.history.encodeLocation(z),getFetcher:Ml,deleteFetcher:h1,dispose:Ss,getBlocker:rp,deleteBlocker:ru,patchRoutes:Vd,_internalFetchControllers:V,_internalActiveDeferreds:lt,_internalSetRoutes:m1},P}function IV(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function nv(t,e,n,r,s,i,o,a){let u,l;if(o){u=[];for(let d of e)if(u.push(d),d.route.id===o){l=d;break}}else u=e,l=e[e.length-1];let c=xk(s||".",wk(u,i),$h(t.pathname,n)||t.pathname,a==="path");return s==null&&(c.search=t.search,c.hash=t.hash),(s==null||s===""||s===".")&&l&&l.route.index&&!wx(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(c.pathname=c.pathname==="/"?n:Da([n,c.pathname])),Fh(c)}function WE(t,e,n,r){if(!r||!IV(r))return{path:n};if(r.formMethod&&!WV(r.formMethod))return{path:n,error:wr(405,{method:r.formMethod})};let s=()=>({path:n,error:wr(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),a=Nk(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!wi(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[y,b]=p;return""+h+y+"="+b+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!wi(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}Xe(typeof FormData=="function","FormData is not available in this environment");let u,l;if(r.formData)u=rv(r.formData),l=r.formData;else if(r.body instanceof FormData)u=rv(r.body),l=r.body;else if(r.body instanceof URLSearchParams)u=r.body,l=KE(u);else if(r.body==null)u=new URLSearchParams,l=new FormData;else try{u=new URLSearchParams(r.body),l=KE(u)}catch{return s()}let c={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(wi(c.formMethod))return{path:n,submission:c};let d=Ya(n);return e&&d.search&&wx(d.search)&&u.append("index",""),d.search="?"+u,{path:Fh(d),submission:c}}function kV(t,e){let n=t;if(e){let r=t.findIndex(s=>s.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function jE(t,e,n,r,s,i,o,a,u,l,c,d,f,h,p,y){let b=y?rs(y[1])?y[1].error:y[1].data:void 0,g=t.createURL(e.location),v=t.createURL(s),w=y&&rs(y[1])?y[0]:void 0,x=w?kV(n,w):n,C=y?y[1].statusCode:void 0,k=o&&C&&C>=400,P=x.filter(($,U)=>{let{route:K}=$;if(K.lazy)return!0;if(K.loader==null)return!1;if(i)return typeof K.loader!="function"||K.loader.hydrate?!0:e.loaderData[K.id]===void 0&&(!e.errors||e.errors[K.id]===void 0);if(RV(e.loaderData,e.matches[U],$)||u.some(ee=>ee===$.route.id))return!0;let Z=e.matches[U],ie=$;return GE($,Yt({currentUrl:g,currentParams:Z.params,nextUrl:v,nextParams:ie.params},r,{actionResult:b,actionStatus:C,defaultShouldRevalidate:k?!1:a||g.pathname+g.search===v.pathname+v.search||g.search!==v.search||Ek(Z,ie)}))}),N=[];return d.forEach(($,U)=>{if(i||!n.some(j=>j.route.id===$.routeId)||c.has(U))return;let K=Pu(h,$.path,p);if(!K){N.push({key:U,routeId:$.routeId,path:$.path,matches:null,match:null,controller:null});return}let Z=e.fetchers.get(U),ie=Af(K,$.path),ee=!1;f.has(U)?ee=!1:l.has(U)?(l.delete(U),ee=!0):Z&&Z.state!=="idle"&&Z.data===void 0?ee=a:ee=GE(ie,Yt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:v,nextParams:n[n.length-1].params},r,{actionResult:b,actionStatus:C,defaultShouldRevalidate:k?!1:a})),ee&&N.push({key:U,routeId:$.routeId,path:$.path,matches:K,match:ie,controller:new AbortController})}),[P,N]}function RV(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function Ek(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function GE(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function PV(t,e,n,r,s,i,o,a){let u=[e,...n.map(l=>l.route.id)].join("-");try{let l=o.get(u);l||(l=t({path:e,matches:n,patch:(c,d)=>{a.aborted||Ck(c,d,r,s,i)}}),o.set(u,l)),l&&VV(l)&&await l}finally{o.delete(u)}}function Ck(t,e,n,r,s){if(t){var i;let o=r[t];Xe(o,"No route found to patch children into: routeId = "+t);let a=hh(e,s,[t,"patch",String(((i=o.children)==null?void 0:i.length)||"0")],r);o.children?o.children.push(...a):o.children=a}else{let o=hh(e,s,["patch",String(n.length||"0")],r);n.push(...o)}}async function qE(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Xe(s,"No route found in manifest");let i={};for(let o in r){let u=s[o]!==void 0&&o!=="hasErrorBoundary";Qc(!u,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!u&&!tV.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,Yt({},e(s),{lazy:void 0}))}function OV(t){return Promise.all(t.matches.map(e=>e.resolve()))}async function DV(t,e,n,r,s,i,o,a){let u=r.reduce((d,f)=>d.add(f.route.id),new Set),l=new Set,c=await t({matches:s.map(d=>{let f=u.has(d.route.id);return Yt({},d,{shouldLoad:f,resolve:p=>(l.add(d.route.id),f?LV(e,n,d,i,o,p,a):Promise.resolve({type:Tt.data,result:void 0}))})}),request:n,params:s[0].params,context:a});return s.forEach(d=>Xe(l.has(d.route.id),'`match.resolve()` was not called for route id "'+d.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),c.filter((d,f)=>u.has(s[f].route.id))}async function LV(t,e,n,r,s,i,o){let a,u,l=c=>{let d,f=new Promise((y,b)=>d=b);u=()=>d(),e.signal.addEventListener("abort",u);let h=y=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):c({request:e,params:n.params,context:o},...y!==void 0?[y]:[]),p;return i?p=i(y=>h(y)):p=(async()=>{try{return{type:"data",result:await h()}}catch(y){return{type:"error",result:y}}})(),Promise.race([p,f])};try{let c=n.route[t];if(n.route.lazy)if(c){let d,[f]=await Promise.all([l(c).catch(h=>{d=h}),qE(n.route,s,r)]);if(d!==void 0)throw d;a=f}else if(await qE(n.route,s,r),c=n.route[t],c)a=await l(c);else if(t==="action"){let d=new URL(e.url),f=d.pathname+d.search;throw wr(405,{method:e.method,pathname:f,routeId:n.route.id})}else return{type:Tt.data,result:void 0};else if(c)a=await l(c);else{let d=new URL(e.url),f=d.pathname+d.search;throw wr(404,{pathname:f})}Xe(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:Tt.error,result:c}}finally{u&&e.signal.removeEventListener("abort",u)}return a}async function FV(t){let{result:e,type:n}=t;if(Tk(e)){let l;try{let c=e.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?e.body==null?l=null:l=await e.json():l=await e.text()}catch(c){return{type:Tt.error,error:c}}return n===Tt.error?{type:Tt.error,error:new m0(e.status,e.statusText,l),statusCode:e.status,headers:e.headers}:{type:Tt.data,data:l,statusCode:e.status,headers:e.headers}}if(n===Tt.error){if(eC(e)){var r;if(e.data instanceof Error){var s;return{type:Tt.error,error:e.data,statusCode:(s=e.init)==null?void 0:s.status}}e=new m0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data)}return{type:Tt.error,error:e,statusCode:gg(e)?e.status:void 0}}if(zV(e)){var i,o;return{type:Tt.deferred,deferredData:e,statusCode:(i=e.init)==null?void 0:i.status,headers:((o=e.init)==null?void 0:o.headers)&&new Headers(e.init.headers)}}if(eC(e)){var a,u;return{type:Tt.data,data:e.data,statusCode:(a=e.init)==null?void 0:a.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:Tt.data,data:e}}function $V(t,e,n,r,s,i){let o=t.headers.get("Location");if(Xe(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!vx.test(o)){let a=r.slice(0,r.findIndex(u=>u.route.id===n)+1);o=nv(new URL(e.url),a,s,!0,o,i),t.headers.set("Location",o)}return t}function HE(t,e,n){if(vx.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=$h(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Zl(t,e,n,r){let s=t.createURL(Nk(e)).toString(),i={signal:n};if(r&&wi(r.formMethod)){let{formMethod:o,formEncType:a}=r;i.method=o.toUpperCase(),a==="application/json"?(i.headers=new Headers({"Content-Type":a}),i.body=JSON.stringify(r.json)):a==="text/plain"?i.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?i.body=rv(r.formData):i.body=r.formData}return new Request(s,i)}function rv(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function KE(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function BV(t,e,n,r,s,i){let o={},a=null,u,l=!1,c={},d=r&&rs(r[1])?r[1].error:void 0;return n.forEach((f,h)=>{let p=e[h].route.id;if(Xe(!Uu(f),"Cannot handle redirect results in processLoaderData"),rs(f)){let y=f.error;d!==void 0&&(y=d,d=void 0),a=a||{};{let b=Sc(t,p);a[b.route.id]==null&&(a[b.route.id]=y)}o[p]=void 0,l||(l=!0,u=gg(f.error)?f.error.status:500),f.headers&&(c[p]=f.headers)}else Vu(f)?(s.set(p,f.deferredData),o[p]=f.deferredData.data,f.statusCode!=null&&f.statusCode!==200&&!l&&(u=f.statusCode),f.headers&&(c[p]=f.headers)):(o[p]=f.data,f.statusCode&&f.statusCode!==200&&!l&&(u=f.statusCode),f.headers&&(c[p]=f.headers))}),d!==void 0&&r&&(a={[r[0]]:d},o[r[0]]=void 0),{loaderData:o,errors:a,statusCode:u||200,loaderHeaders:c}}function XE(t,e,n,r,s,i,o,a){let{loaderData:u,errors:l}=BV(e,n,r,s,a);for(let c=0;c<i.length;c++){let{key:d,match:f,controller:h}=i[c];Xe(o!==void 0&&o[c]!==void 0,"Did not find corresponding fetcher result");let p=o[c];if(!(h&&h.signal.aborted))if(rs(p)){let y=Sc(t.matches,f==null?void 0:f.route.id);l&&l[y.route.id]||(l=Yt({},l,{[y.route.id]:p.error})),t.fetchers.delete(d)}else if(Uu(p))Xe(!1,"Unhandled fetcher revalidation redirect");else if(Vu(p))Xe(!1,"Unhandled fetcher deferred data");else{let y=da(p.data);t.fetchers.set(d,y)}}return{loaderData:u,errors:l}}function YE(t,e,n,r){let s=Yt({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function QE(t){return t?rs(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Sc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function ZE(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function wr(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,a="Unknown Server Error",u="Unknown @remix-run/router error";return t===400?(a="Bad Request",i==="route-discovery"?u='Unable to match URL "'+n+'" - the `unstable_patchRoutesOnNavigation()` '+(`function threw the following error:
`+o):s&&n&&r?u="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?u="defer() is not supported in actions":i==="invalid-body"&&(u="Unable to encode submission body")):t===403?(a="Forbidden",u='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",u='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",s&&n&&r?u="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(u='Invalid request method "'+s.toUpperCase()+'"')),new m0(t||500,a,new Error(u),!0)}function JE(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Uu(n))return{result:n,idx:e}}}function Nk(t){let e=typeof t=="string"?Ya(t):t;return Fh(Yt({},e,{hash:""}))}function MV(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function VV(t){return typeof t=="object"&&t!=null&&"then"in t}function UV(t){return Tk(t.result)&&EV.has(t.result.status)}function Vu(t){return t.type===Tt.deferred}function rs(t){return t.type===Tt.error}function Uu(t){return(t&&t.type)===Tt.redirect}function eC(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function zV(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function Tk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function WV(t){return AV.has(t.toLowerCase())}function wi(t){return xV.has(t.toLowerCase())}async function tC(t,e,n,r,s,i){for(let o=0;o<n.length;o++){let a=n[o],u=e[o];if(!u)continue;let l=t.find(d=>d.route.id===u.route.id),c=l!=null&&!Ek(l,u)&&(i&&i[u.route.id])!==void 0;if(Vu(a)&&(s||c)){let d=r[o];Xe(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await _k(a,d,s).then(f=>{f&&(n[o]=f||n[o])})}}}async function _k(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Tt.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Tt.error,error:s}}return{type:Tt.data,data:t.deferredData.data}}}function wx(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Af(t,e){let n=typeof e=="string"?Ya(e).search:e.search;if(t[t.length-1].route.index&&wx(n||""))return t[t.length-1];let r=vk(t);return r[r.length-1]}function nC(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function yy(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function jV(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function nf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function GV(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function da(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function qV(t,e){try{let n=t.sessionStorage.getItem(Ak);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function HV(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(Ak,JSON.stringify(n))}catch(r){Qc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function g0(){return g0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},g0.apply(this,arguments)}const yg=L.createContext(null),Ik=L.createContext(null),bg=L.createContext(null),xx=L.createContext(null),xl=L.createContext({outlet:null,matches:[],isDataRoute:!1}),kk=L.createContext(null);function vg(){return L.useContext(xx)!=null}function Rk(){return vg()||Xe(!1),L.useContext(xx).location}function Pk(t){L.useContext(bg).static||L.useLayoutEffect(t)}function wg(){let{isDataRoute:t}=L.useContext(xl);return t?a5():KV()}function KV(){vg()||Xe(!1);let t=L.useContext(yg),{basename:e,future:n,navigator:r}=L.useContext(bg),{matches:s}=L.useContext(xl),{pathname:i}=Rk(),o=JSON.stringify(wk(s,n.v7_relativeSplatPath)),a=L.useRef(!1);return Pk(()=>{a.current=!0}),L.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let d=xk(l,JSON.parse(o),i,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Da([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,o,i,t])}const Ok=L.createContext(null);function XV(){return L.useContext(Ok)}function YV(t){let e=L.useContext(xl).outlet;return e&&L.createElement(Ok.Provider,{value:t},e)}function QV(t,e,n,r){vg()||Xe(!1);let{navigator:s}=L.useContext(bg),{matches:i}=L.useContext(xl),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let l=Rk(),c;c=l;let d=c.pathname||"/",f=d;if(u!=="/"){let y=u.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let h=Pu(t,{pathname:f});return n5(h&&h.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Da([u,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:Da([u,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r)}function ZV(){let t=o5(),e=gg(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),n?L.createElement("pre",{style:s},n):null,null)}const JV=L.createElement(ZV,null);class e5 extends L.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?L.createElement(xl.Provider,{value:this.props.routeContext},L.createElement(kk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function t5(t){let{routeContext:e,match:n,children:r}=t,s=L.useContext(yg);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),L.createElement(xl.Provider,{value:e},r)}function n5(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let c=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);c>=0||Xe(!1),o=o.slice(0,Math.min(o.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){u=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((c,d,f)=>{let h,p=!1,y=null,b=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,y=d.route.errorElement||JV,u&&(l<0&&f===0?(u5("route-fallback"),p=!0,b=null):l===f&&(p=!0,b=d.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),v=()=>{let w;return h?w=y:p?w=b:d.route.Component?w=L.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,L.createElement(t5,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?L.createElement(e5,{location:n.location,revalidation:n.revalidation,component:y,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var Dk=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Dk||{}),y0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(y0||{});function r5(t){let e=L.useContext(yg);return e||Xe(!1),e}function s5(t){let e=L.useContext(Ik);return e||Xe(!1),e}function i5(t){let e=L.useContext(xl);return e||Xe(!1),e}function Lk(t){let e=i5(),n=e.matches[e.matches.length-1];return n.route.id||Xe(!1),n.route.id}function o5(){var t;let e=L.useContext(kk),n=s5(y0.UseRouteError),r=Lk(y0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function a5(){let{router:t}=r5(Dk.UseNavigateStable),e=Lk(y0.UseNavigateStable),n=L.useRef(!1);return Pk(()=>{n.current=!0}),L.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,g0({fromRouteId:e},i)))},[t,e])}const rC={};function u5(t,e,n){rC[t]||(rC[t]=!0)}function l5(t){return YV(t.context)}function c5(t){let{basename:e="/",children:n=null,location:r,navigationType:s=hn.Pop,navigator:i,static:o=!1,future:a}=t;vg()&&Xe(!1);let u=e.replace(/^\/*/,"/"),l=L.useMemo(()=>({basename:u,navigator:i,static:o,future:g0({v7_relativeSplatPath:!1},a)}),[u,a,i,o]);typeof r=="string"&&(r=Ya(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,y=L.useMemo(()=>{let b=$h(c,u);return b==null?null:{location:{pathname:b,search:d,hash:f,state:h,key:p},navigationType:s}},[u,c,d,f,h,p,s]);return y==null?null:L.createElement(bg.Provider,{value:l},L.createElement(xx.Provider,{children:n,value:y}))}new Promise(()=>{});function d5(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:L.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:L.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:L.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function b0(){return b0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b0.apply(this,arguments)}const f5="6";try{window.__reactRouterVersion=f5}catch{}function h5(t,e){return _V({basename:void 0,future:b0({},void 0,{v7_prependBasename:!0}),history:Z8({window:void 0}),hydrationData:p5(),routes:t,mapRouteProperties:d5,unstable_dataStrategy:void 0,unstable_patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function p5(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=b0({},e,{errors:m5(e.errors)})),e}function m5(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new m0(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const g5=L.createContext({isTransitioning:!1}),y5=L.createContext(new Map),b5="startTransition",sC=lb[b5],v5="flushSync",iC=Q8[v5];function w5(t){sC?sC(t):t()}function rf(t){iC?iC(t):t()}class x5{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function S5(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=L.useState(n.state),[o,a]=L.useState(),[u,l]=L.useState({isTransitioning:!1}),[c,d]=L.useState(),[f,h]=L.useState(),[p,y]=L.useState(),b=L.useRef(new Map),{v7_startTransition:g}=r||{},v=L.useCallback(N=>{g?w5(N):N()},[g]),w=L.useCallback((N,$)=>{let{deletedFetchers:U,unstable_flushSync:K,unstable_viewTransitionOpts:Z}=$;U.forEach(ee=>b.current.delete(ee)),N.fetchers.forEach((ee,j)=>{ee.data!==void 0&&b.current.set(j,ee.data)});let ie=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!Z||ie){K?rf(()=>i(N)):v(()=>i(N));return}if(K){rf(()=>{f&&(c&&c.resolve(),f.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})});let ee=n.window.document.startViewTransition(()=>{rf(()=>i(N))});ee.finished.finally(()=>{rf(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})})}),rf(()=>h(ee));return}f?(c&&c.resolve(),f.skipTransition(),y({state:N,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})):(a(N),l({isTransitioning:!0,flushSync:!1,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation}))},[n.window,f,c,b,v]);L.useLayoutEffect(()=>n.subscribe(w),[n,w]),L.useEffect(()=>{u.isTransitioning&&!u.flushSync&&d(new x5)},[u]),L.useEffect(()=>{if(c&&o&&n.window){let N=o,$=c.promise,U=n.window.document.startViewTransition(async()=>{v(()=>i(N)),await $});U.finished.finally(()=>{d(void 0),h(void 0),a(void 0),l({isTransitioning:!1})}),h(U)}},[v,o,c,n.window]),L.useEffect(()=>{c&&o&&s.location.key===o.location.key&&c.resolve()},[c,f,s.location,o]),L.useEffect(()=>{!u.isTransitioning&&p&&(a(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),y(void 0))},[u.isTransitioning,p]),L.useEffect(()=>{},[]);let x=L.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:N=>n.navigate(N),push:(N,$,U)=>n.navigate(N,{state:$,preventScrollReset:U==null?void 0:U.preventScrollReset}),replace:(N,$,U)=>n.navigate(N,{replace:!0,state:$,preventScrollReset:U==null?void 0:U.preventScrollReset})}),[n]),C=n.basename||"/",k=L.useMemo(()=>({router:n,navigator:x,static:!1,basename:C}),[n,x,C]),P=L.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return L.createElement(L.Fragment,null,L.createElement(yg.Provider,{value:k},L.createElement(Ik.Provider,{value:s},L.createElement(y5.Provider,{value:b.current},L.createElement(g5.Provider,{value:u},L.createElement(c5,{basename:C,location:s.location,navigationType:s.historyAction,navigator:x,future:P},s.initialized||n.future.v7_partialHydration?L.createElement(A5,{routes:n.routes,future:n.future,state:s}):e))))),null)}const A5=L.memo(E5);function E5(t){let{routes:e,future:n,state:r}=t;return QV(e,void 0,r,n)}var oC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(oC||(oC={}));var aC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(aC||(aC={}));function Vn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var C5=typeof Symbol=="function"&&Symbol.observable||"@@observable",uC=C5,by=()=>Math.random().toString(36).substring(7).split("").join("."),N5={INIT:`@@redux/INIT${by()}`,REPLACE:`@@redux/REPLACE${by()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${by()}`},v0=N5;function Sx(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Ax(t,e,n){if(typeof t!="function")throw new Error(Vn(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Vn(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Vn(1));return n(Ax)(t,e)}let r=t,s=e,i=new Map,o=i,a=0,u=!1;function l(){o===i&&(o=new Map,i.forEach((b,g)=>{o.set(g,b)}))}function c(){if(u)throw new Error(Vn(3));return s}function d(b){if(typeof b!="function")throw new Error(Vn(4));if(u)throw new Error(Vn(5));let g=!0;l();const v=a++;return o.set(v,b),function(){if(g){if(u)throw new Error(Vn(6));g=!1,l(),o.delete(v),i=null}}}function f(b){if(!Sx(b))throw new Error(Vn(7));if(typeof b.type>"u")throw new Error(Vn(8));if(typeof b.type!="string")throw new Error(Vn(17));if(u)throw new Error(Vn(9));try{u=!0,s=r(s,b)}finally{u=!1}return(i=o).forEach(v=>{v()}),b}function h(b){if(typeof b!="function")throw new Error(Vn(10));r=b,f({type:v0.REPLACE})}function p(){const b=d;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(Vn(11));function v(){const x=g;x.next&&x.next(c())}return v(),{unsubscribe:b(v)}},[uC](){return this}}}return f({type:v0.INIT}),{dispatch:f,subscribe:d,getState:c,replaceReducer:h,[uC]:p}}function T5(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:v0.INIT})>"u")throw new Error(Vn(12));if(typeof n(void 0,{type:v0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Vn(13))})}function Fk(t){const e=Object.keys(t),n={};for(let i=0;i<e.length;i++){const o=e[i];typeof t[o]=="function"&&(n[o]=t[o])}const r=Object.keys(n);let s;try{T5(n)}catch(i){s=i}return function(o={},a){if(s)throw s;let u=!1;const l={};for(let c=0;c<r.length;c++){const d=r[c],f=n[d],h=o[d],p=f(h,a);if(typeof p>"u")throw a&&a.type,new Error(Vn(14));l[d]=p,u=u||p!==h}return u=u||r.length!==Object.keys(o).length,u?l:o}}function w0(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...r)=>e(n(...r)))}function _5(...t){return e=>(n,r)=>{const s=e(n,r);let i=()=>{throw new Error(Vn(15))};const o={getState:s.getState,dispatch:(u,...l)=>i(u,...l)},a=t.map(u=>u(o));return i=w0(...a)(s.dispatch),{...s,dispatch:i}}}function I5(t){return Sx(t)&&"type"in t&&typeof t.type=="string"}var $k=Symbol.for("immer-nothing"),lC=Symbol.for("immer-draftable"),fs=Symbol.for("immer-state");function Ci(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Zc=Object.getPrototypeOf;function sl(t){return!!t&&!!t[fs]}function jo(t){var e;return t?Bk(t)||Array.isArray(t)||!!t[lC]||!!((e=t.constructor)!=null&&e[lC])||Sg(t)||Ag(t):!1}var k5=Object.prototype.constructor.toString();function Bk(t){if(!t||typeof t!="object")return!1;const e=Zc(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===k5}function x0(t,e){xg(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,r)=>e(r,n,t))}function xg(t){const e=t[fs];return e?e.type_:Array.isArray(t)?1:Sg(t)?2:Ag(t)?3:0}function sv(t,e){return xg(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Mk(t,e,n){const r=xg(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function R5(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Sg(t){return t instanceof Map}function Ag(t){return t instanceof Set}function ku(t){return t.copy_||t.base_}function iv(t,e){if(Sg(t))return new Map(t);if(Ag(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=Bk(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[fs];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(Zc(t),r)}else{const r=Zc(t);if(r!==null&&n)return{...t};const s=Object.create(r);return Object.assign(s,t)}}function Ex(t,e=!1){return Eg(t)||sl(t)||!jo(t)||(xg(t)>1&&(t.set=t.add=t.clear=t.delete=P5),Object.freeze(t),e&&Object.entries(t).forEach(([n,r])=>Ex(r,!0))),t}function P5(){Ci(2)}function Eg(t){return Object.isFrozen(t)}var O5={};function il(t){const e=O5[t];return e||Ci(0,t),e}var ph;function Vk(){return ph}function D5(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function cC(t,e){e&&(il("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function ov(t){av(t),t.drafts_.forEach(L5),t.drafts_=null}function av(t){t===ph&&(ph=t.parent_)}function dC(t){return ph=D5(ph,t)}function L5(t){const e=t[fs];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function fC(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[fs].modified_&&(ov(e),Ci(4)),jo(t)&&(t=S0(e,t),e.parent_||A0(e,t)),e.patches_&&il("Patches").generateReplacementPatches_(n[fs].base_,t,e.patches_,e.inversePatches_)):t=S0(e,n,[]),ov(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==$k?t:void 0}function S0(t,e,n){if(Eg(e))return e;const r=e[fs];if(!r)return x0(e,(s,i)=>hC(t,r,e,s,i,n)),e;if(r.scope_!==t)return e;if(!r.modified_)return A0(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,o=!1;r.type_===3&&(i=new Set(s),s.clear(),o=!0),x0(i,(a,u)=>hC(t,r,s,a,u,n,o)),A0(t,s,!1),n&&t.patches_&&il("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function hC(t,e,n,r,s,i,o){if(sl(s)){const a=i&&e&&e.type_!==3&&!sv(e.assigned_,r)?i.concat(r):void 0,u=S0(t,s,a);if(Mk(n,r,u),sl(u))t.canAutoFreeze_=!1;else return}else o&&n.add(s);if(jo(s)&&!Eg(s)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;S0(t,s),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&A0(t,s)}}function A0(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ex(e,n)}function F5(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:Vk(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=Cx;n&&(s=[r],i=mh);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return r.draft_=a,r.revoke_=o,a}var Cx={get(t,e){if(e===fs)return t;const n=ku(t);if(!sv(n,e))return $5(t,n,e);const r=n[e];return t.finalized_||!jo(r)?r:r===vy(t.base_,e)?(wy(t),t.copy_[e]=lv(r,t)):r},has(t,e){return e in ku(t)},ownKeys(t){return Reflect.ownKeys(ku(t))},set(t,e,n){const r=Uk(ku(t),e);if(r!=null&&r.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const s=vy(ku(t),e),i=s==null?void 0:s[fs];if(i&&i.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(R5(n,s)&&(n!==void 0||sv(t.base_,e)))return!0;wy(t),uv(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vy(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,wy(t),uv(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=ku(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Ci(11)},getPrototypeOf(t){return Zc(t.base_)},setPrototypeOf(){Ci(12)}},mh={};x0(Cx,(t,e)=>{mh[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});mh.deleteProperty=function(t,e){return mh.set.call(this,t,e,void 0)};mh.set=function(t,e,n){return Cx.set.call(this,t[0],e,n,t[0])};function vy(t,e){const n=t[fs];return(n?ku(n):t)[e]}function $5(t,e,n){var s;const r=Uk(e,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(t.draft_):void 0}function Uk(t,e){if(!(e in t))return;let n=Zc(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Zc(n)}}function uv(t){t.modified_||(t.modified_=!0,t.parent_&&uv(t.parent_))}function wy(t){t.copy_||(t.copy_=iv(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var B5=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const i=n;n=e;const o=this;return function(u=i,...l){return o.produce(u,c=>n.call(this,c,...l))}}typeof n!="function"&&Ci(6),r!==void 0&&typeof r!="function"&&Ci(7);let s;if(jo(e)){const i=dC(this),o=lv(e,void 0);let a=!0;try{s=n(o),a=!1}finally{a?ov(i):av(i)}return cC(i,r),fC(s,i)}else if(!e||typeof e!="object"){if(s=n(e),s===void 0&&(s=e),s===$k&&(s=void 0),this.autoFreeze_&&Ex(s,!0),r){const i=[],o=[];il("Patches").generateReplacementPatches_(e,s,i,o),r(i,o)}return s}else Ci(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,u=>e(u,...a));let r,s;return[this.produce(e,n,(o,a)=>{r=o,s=a}),r,s]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){jo(t)||Ci(8),sl(t)&&(t=M5(t));const e=dC(this),n=lv(t,void 0);return n[fs].isManual_=!0,av(e),n}finishDraft(t,e){const n=t&&t[fs];(!n||!n.isManual_)&&Ci(9);const{scope_:r}=n;return cC(r,e),fC(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const s=e[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(e=e.slice(n+1));const r=il("Patches").applyPatches_;return sl(t)?r(t,e):this.produce(t,s=>r(s,e))}};function lv(t,e){const n=Sg(t)?il("MapSet").proxyMap_(t,e):Ag(t)?il("MapSet").proxySet_(t,e):F5(t,e);return(e?e.scope_:Vk()).drafts_.push(n),n}function M5(t){return sl(t)||Ci(10,t),zk(t)}function zk(t){if(!jo(t)||Eg(t))return t;const e=t[fs];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=iv(t,e.scope_.immer_.useStrictShallowCopy_)}else n=iv(t,!0);return x0(n,(r,s)=>{Mk(n,r,zk(s))}),e&&(e.finalized_=!1),n}var hs=new B5,Wk=hs.produce;hs.produceWithPatches.bind(hs);hs.setAutoFreeze.bind(hs);hs.setUseStrictShallowCopy.bind(hs);hs.applyPatches.bind(hs);hs.createDraft.bind(hs);hs.finishDraft.bind(hs);function jk(t){return({dispatch:n,getState:r})=>s=>i=>typeof i=="function"?i(n,r,t):s(i)}var V5=jk(),U5=jk,z5=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?w0:w0.apply(null,arguments)};function pC(t,e){function n(...r){if(e){let s=e(...r);if(!s)throw new Error(Ii(0));return{type:t,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:t,payload:r[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=r=>I5(r)&&r.type===t,n}var Gk=class Ef extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Ef.prototype)}static get[Symbol.species](){return Ef}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Ef(...e[0].concat(this)):new Ef(...e.concat(this))}};function mC(t){return jo(t)?Wk(t,()=>{}):t}function gC(t,e,n){if(t.has(e)){let s=t.get(e);return n.update&&(s=n.update(s,e,t),t.set(e,s)),s}if(!n.insert)throw new Error(Ii(10));const r=n.insert(e,t);return t.set(e,r),r}function W5(t){return typeof t=="boolean"}var j5=()=>function(e){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new Gk;return n&&(W5(n)?o.push(V5):o.push(U5(n.extraArgument))),o},G5="RTK_autoBatch",qk=t=>e=>{setTimeout(e,t)},q5=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:qk(10),H5=(t={type:"raf"})=>e=>(...n)=>{const r=e(...n);let s=!0,i=!1,o=!1;const a=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?q5:t.type==="callback"?t.queueNotification:qk(t.timeout),l=()=>{o=!1,i&&(i=!1,a.forEach(c=>c()))};return Object.assign({},r,{subscribe(c){const d=()=>s&&c(),f=r.subscribe(d);return a.add(c),()=>{f(),a.delete(c)}},dispatch(c){var d;try{return s=!((d=c==null?void 0:c.meta)!=null&&d[G5]),i=!s,i&&(o||(o=!0,u(l))),r.dispatch(c)}finally{s=!0}}})},K5=t=>function(n){const{autoBatch:r=!0}=n??{};let s=new Gk(t);return r&&s.push(H5(typeof r=="object"?r:void 0)),s};function X5(t){const e=j5(),{reducer:n=void 0,middleware:r,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=t||{};let a;if(typeof n=="function")a=n;else if(Sx(n))a=Fk(n);else throw new Error(Ii(1));let u;typeof r=="function"?u=r(e):u=e();let l=w0;s&&(l=z5({trace:!1,...typeof s=="object"&&s}));const c=_5(...u),d=K5(c);let f=typeof o=="function"?o(d):d();const h=l(...f);return Ax(a,i,h)}function Hk(t){const e={},n=[];let r;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(Ii(28));if(a in e)throw new Error(Ii(29));return e[a]=o,s},addMatcher(i,o){return n.push({matcher:i,reducer:o}),s},addDefaultCase(i){return r=i,s}};return t(s),[e,n,r]}function Y5(t){return typeof t=="function"}function Q5(t,e){let[n,r,s]=Hk(e),i;if(Y5(t))i=()=>mC(t());else{const a=mC(t);i=()=>a}function o(a=i(),u){let l=[n[u.type],...r.filter(({matcher:c})=>c(u)).map(({reducer:c})=>c)];return l.filter(c=>!!c).length===0&&(l=[s]),l.reduce((c,d)=>{if(d)if(sl(c)){const h=d(c,u);return h===void 0?c:h}else{if(jo(c))return Wk(c,f=>d(f,u));{const f=d(c,u);if(f===void 0){if(c===null)return c;throw new Error(Ii(9))}return f}}return c},a)}return o.getInitialState=i,o}var Z5=Symbol.for("rtk-slice-createasyncthunk");function J5(t,e){return`${t}/${e}`}function eU({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[Z5];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Ii(11));typeof process<"u";const a=(typeof s.reducers=="function"?s.reducers(nU()):s.reducers)||{},u=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(w,x){const C=typeof w=="string"?w:w.type;if(!C)throw new Error(Ii(12));if(C in l.sliceCaseReducersByType)throw new Error(Ii(13));return l.sliceCaseReducersByType[C]=x,c},addMatcher(w,x){return l.sliceMatchers.push({matcher:w,reducer:x}),c},exposeAction(w,x){return l.actionCreators[w]=x,c},exposeCaseReducer(w,x){return l.sliceCaseReducersByName[w]=x,c}};u.forEach(w=>{const x=a[w],C={reducerName:w,type:J5(i,w),createNotation:typeof s.reducers=="function"};sU(x)?oU(C,x,c,e):rU(C,x,c)});function d(){const[w={},x=[],C=void 0]=typeof s.extraReducers=="function"?Hk(s.extraReducers):[s.extraReducers],k={...w,...l.sliceCaseReducersByType};return Q5(s.initialState,P=>{for(let N in k)P.addCase(N,k[N]);for(let N of l.sliceMatchers)P.addMatcher(N.matcher,N.reducer);for(let N of x)P.addMatcher(N.matcher,N.reducer);C&&P.addDefaultCase(C)})}const f=w=>w,h=new Map;let p;function y(w,x){return p||(p=d()),p(w,x)}function b(){return p||(p=d()),p.getInitialState()}function g(w,x=!1){function C(P){let N=P[w];return typeof N>"u"&&x&&(N=b()),N}function k(P=f){const N=gC(h,x,{insert:()=>new WeakMap});return gC(N,P,{insert:()=>{const $={};for(const[U,K]of Object.entries(s.selectors??{}))$[U]=tU(K,P,b,x);return $}})}return{reducerPath:w,getSelectors:k,get selectors(){return k(C)},selectSlice:C}}const v={name:i,reducer:y,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:b,...g(o),injectInto(w,{reducerPath:x,...C}={}){const k=x??o;return w.inject({reducerPath:k,reducer:y},C),{...v,...g(k,!0)}}};return v}}function tU(t,e,n,r){function s(i,...o){let a=e(i);return typeof a>"u"&&r&&(a=n()),t(a,...o)}return s.unwrapped=t,s}var Nx=eU();function nU(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function rU({type:t,reducerName:e,createNotation:n},r,s){let i,o;if("reducer"in r){if(n&&!iU(r))throw new Error(Ii(17));i=r.reducer,o=r.prepare}else i=r;s.addCase(t,i).exposeCaseReducer(e,i).exposeAction(e,o?pC(t,o):pC(t))}function sU(t){return t._reducerDefinitionType==="asyncThunk"}function iU(t){return t._reducerDefinitionType==="reducerWithPrepare"}function oU({type:t,reducerName:e},n,r,s){if(!s)throw new Error(Ii(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:u,settled:l,options:c}=n,d=s(t,i,c);r.exposeAction(e,d),o&&r.addCase(d.fulfilled,o),a&&r.addCase(d.pending,a),u&&r.addCase(d.rejected,u),l&&r.addMatcher(d.settled,l),r.exposeCaseReducer(e,{fulfilled:o||Bp,pending:a||Bp,rejected:u||Bp,settled:l||Bp})}function Bp(){}function Ii(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Kk={exports:{}},Xk={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bh=L;function aU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var uU=typeof Object.is=="function"?Object.is:aU,lU=Bh.useSyncExternalStore,cU=Bh.useRef,dU=Bh.useEffect,fU=Bh.useMemo,hU=Bh.useDebugValue;Xk.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=cU(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=fU(function(){function u(h){if(!l){if(l=!0,c=h,h=r(h),s!==void 0&&o.hasValue){var p=o.value;if(s(p,h))return d=p}return d=h}if(p=d,uU(c,h))return p;var y=r(h);return s!==void 0&&s(p,y)?p:(c=h,d=y)}var l=!1,c,d,f=n===void 0?null:n;return[function(){return u(e())},f===null?void 0:function(){return u(f())}]},[e,n,r,s]);var a=lU(t,i[0],i[1]);return dU(function(){o.hasValue=!0,o.value=a},[a]),hU(a),a};Kk.exports=Xk;var pU=Kk.exports,os="default"in lb?_w:lb,yC=Symbol.for("react-redux-context"),bC=typeof globalThis<"u"?globalThis:{};function mU(){if(!os.createContext)return{};const t=bC[yC]??(bC[yC]=new Map);let e=t.get(os.createContext);return e||(e=os.createContext(null),t.set(os.createContext,e)),e}var Va=mU(),gU=()=>{throw new Error("uSES not initialized!")};function Tx(t=Va){return function(){return os.useContext(t)}}var Yk=Tx(),Qk=gU,yU=t=>{Qk=t},bU=(t,e)=>t===e;function vU(t=Va){const e=t===Va?Yk:Tx(t),n=(r,s={})=>{const{equalityFn:i=bU,devModeChecks:o={}}=typeof s=="function"?{equalityFn:s}:s,{store:a,subscription:u,getServerState:l,stabilityCheck:c,identityFunctionCheck:d}=e();os.useRef(!0);const f=os.useCallback({[r.name](p){return r(p)}}[r.name],[r,c,o.stabilityCheck]),h=Qk(u.addNestedSub,a.getState,l||a.getState,f,i);return os.useDebugValue(h),h};return Object.assign(n,{withTypes:()=>n}),n}var _x=vU();function wU(t){t()}function xU(){let t=null,e=null;return{clear(){t=null,e=null},notify(){wU(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=t;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const s=e={callback:n,next:null,prev:e};return s.prev?s.prev.next=s:t=s,function(){!r||t===null||(r=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var vC={notify(){},get:()=>[]};function SU(t,e){let n,r=vC,s=0,i=!1;function o(y){c();const b=r.subscribe(y);let g=!1;return()=>{g||(g=!0,b(),d())}}function a(){r.notify()}function u(){p.onStateChange&&p.onStateChange()}function l(){return i}function c(){s++,n||(n=t.subscribe(u),r=xU())}function d(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=vC)}function f(){i||(i=!0,c())}function h(){i&&(i=!1,d())}const p={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:u,isSubscribed:l,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>r};return p}var AU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",EU=typeof navigator<"u"&&navigator.product==="ReactNative",CU=AU||EU?os.useLayoutEffect:os.useEffect;function NU({store:t,context:e,children:n,serverState:r,stabilityCheck:s="once",identityFunctionCheck:i="once"}){const o=os.useMemo(()=>{const l=SU(t);return{store:t,subscription:l,getServerState:r?()=>r:void 0,stabilityCheck:s,identityFunctionCheck:i}},[t,r,s,i]),a=os.useMemo(()=>t.getState(),[t]);CU(()=>{const{subscription:l}=o;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==t.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[o,a]);const u=e||Va;return os.createElement(u.Provider,{value:o},n)}var TU=NU;function Zk(t=Va){const e=t===Va?Yk:Tx(t),n=()=>{const{store:r}=e();return r};return Object.assign(n,{withTypes:()=>n}),n}var _U=Zk();function IU(t=Va){const e=t===Va?_U:Zk(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var Zs=IU();yU(pU.useSyncExternalStoreWithSelector);const wC={token:"",username:""},Jk=Nx({name:"user",initialState:wC,reducers:{userSetToken(t,e){t.token=e.payload},userSetUsername(t,e){t.username=e.payload},userReset(){return wC}}}),Xo=()=>_x(t=>t.user),{userSetToken:kU,userSetUsername:RU,userReset:PU}=Jk.actions,OU=Jk.reducer;var e3={};(function(t){var e=Ot&&Ot.__extends||function(){var j=function(M,O){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,V){D.__proto__=V}||function(D,V){for(var F in V)V.hasOwnProperty(F)&&(D[F]=V[F])},j(M,O)};return function(M,O){j(M,O);function D(){this.constructor=M}M.prototype=O===null?Object.create(O):(D.prototype=O.prototype,new D)}}(),n=Ot&&Ot.__assign||function(){return n=Object.assign||function(j){for(var M,O=1,D=arguments.length;O<D;O++){M=arguments[O];for(var V in M)Object.prototype.hasOwnProperty.call(M,V)&&(j[V]=M[V])}return j},n.apply(this,arguments)},r=Ot&&Ot.__awaiter||function(j,M,O,D){function V(F){return F instanceof O?F:new O(function(ue){ue(F)})}return new(O||(O=Promise))(function(F,ue){function se(be){try{ae(D.next(be))}catch(_e){ue(_e)}}function he(be){try{ae(D.throw(be))}catch(_e){ue(_e)}}function ae(be){be.done?F(be.value):V(be.value).then(se,he)}ae((D=D.apply(j,M||[])).next())})},s=Ot&&Ot.__generator||function(j,M){var O={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},D,V,F,ue;return ue={next:se(0),throw:se(1),return:se(2)},typeof Symbol=="function"&&(ue[Symbol.iterator]=function(){return this}),ue;function se(ae){return function(be){return he([ae,be])}}function he(ae){if(D)throw new TypeError("Generator is already executing.");for(;O;)try{if(D=1,V&&(F=ae[0]&2?V.return:ae[0]?V.throw||((F=V.return)&&F.call(V),0):V.next)&&!(F=F.call(V,ae[1])).done)return F;switch(V=0,F&&(ae=[ae[0]&2,F.value]),ae[0]){case 0:case 1:F=ae;break;case 4:return O.label++,{value:ae[1],done:!1};case 5:O.label++,V=ae[1],ae=[0];continue;case 7:ae=O.ops.pop(),O.trys.pop();continue;default:if(F=O.trys,!(F=F.length>0&&F[F.length-1])&&(ae[0]===6||ae[0]===2)){O=0;continue}if(ae[0]===3&&(!F||ae[1]>F[0]&&ae[1]<F[3])){O.label=ae[1];break}if(ae[0]===6&&O.label<F[1]){O.label=F[1],F=ae;break}if(F&&O.label<F[2]){O.label=F[2],O.ops.push(ae);break}F[2]&&O.ops.pop(),O.trys.pop();continue}ae=M.call(j,O)}catch(be){ae=[6,be],V=0}finally{D=F=0}if(ae[0]&5)throw ae[1];return{value:ae[0]?ae[1]:void 0,done:!0}}},i=Ot&&Ot.__spreadArrays||function(){for(var j=0,M=0,O=arguments.length;M<O;M++)j+=arguments[M].length;for(var D=Array(j),V=0,M=0;M<O;M++)for(var F=arguments[M],ue=0,se=F.length;ue<se;ue++,V++)D[V]=F[ue];return D};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function j(){}return j.prototype.toString=function(){return"ErrorOAuth2"},j}();t.ErrorOAuth2=o;var a=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorUnknown"},M}(o);t.ErrorUnknown=a;var u=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorNoAuthCode"},M}(o);t.ErrorNoAuthCode=u;var l=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidReturnedStateParam"},M}(o);t.ErrorInvalidReturnedStateParam=l;var c=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidJson"},M}(o);t.ErrorInvalidJson=c;var d=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidScope"},M}(o);t.ErrorInvalidScope=d;var f=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidRequest"},M}(o);t.ErrorInvalidRequest=f;var h=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidToken"},M}(o);t.ErrorInvalidToken=h;var p=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorAuthenticationGrant"},M}(o);t.ErrorAuthenticationGrant=p;var y=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorUnauthorizedClient"},M}(p);t.ErrorUnauthorizedClient=y;var b=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorAccessDenied"},M}(p);t.ErrorAccessDenied=b;var g=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorUnsupportedResponseType"},M}(p);t.ErrorUnsupportedResponseType=g;var v=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorServerError"},M}(p);t.ErrorServerError=v;var w=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorTemporarilyUnavailable"},M}(p);t.ErrorTemporarilyUnavailable=w;var x=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorAccessTokenResponse"},M}(o);t.ErrorAccessTokenResponse=x;var C=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidClient"},M}(x);t.ErrorInvalidClient=C;var k=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorInvalidGrant"},M}(x);t.ErrorInvalidGrant=k;var P=function(j){e(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.toString=function(){return"ErrorUnsupportedGrantType"},M}(x);t.ErrorUnsupportedGrantType=P;var N=function(){function j(){this.realm="",this.error=""}return j}();t.ErrorWWWAuthenticate=N,t.RawErrorToErrorClassMap={invalid_request:f,invalid_grant:k,unauthorized_client:y,access_denied:b,unsupported_response_type:g,invalid_scope:d,server_error:v,temporarily_unavailable:w,invalid_client:C,unsupported_grant_type:P,invalid_json:c,invalid_token:h};function $(j){return new(t.RawErrorToErrorClassMap[j]||a)}t.toErrorClass=$;function U(j){var M=j.slice(7).replace(/"/g,"").split(", ").map(function(O){var D,V=O.split("="),F=V[0],ue=V[1];return D={},D[F]=ue,D}).reduce(function(O,D){return n(n({},O),D)},{});return{realm:M.realm,error:M.error}}t.fromWWWAuthenticateHeaderStringToObject=U;var K="Authorization",Z="WWW-Authenticate";t.LOCALSTORAGE_ID="oauth2authcodepkce",t.LOCALSTORAGE_STATE=t.LOCALSTORAGE_ID+"-state",t.RECOMMENDED_CODE_VERIFIER_LENGTH=96,t.RECOMMENDED_STATE_LENGTH=32;var ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",ee=function(){function j(M){return this.state={},this.config=M,this.recoverState(),this}return j.prototype.decorateFetchHTTPClient=function(M){var O=this;return function(D,V){for(var F=[],ue=2;ue<arguments.length;ue++)F[ue-2]=arguments[ue];return O.state.isHTTPDecoratorActive?O.getAccessToken().then(function(se){var he=se.token,ae=Object.assign({},V);return ae.headers||(ae.headers={}),ae.headers[K]="Bearer "+he.value,M.apply(void 0,i([D,ae],F))}).then(function(se){if(se.ok||!se.headers.has(Z.toLowerCase()))return se;var he=$(U(se.headers.get(Z.toLowerCase())).error);return he instanceof h&&O.config.onAccessTokenExpiry(function(){return O.exchangeRefreshTokenForAccessToken()}),Promise.reject(he)}):M.apply(void 0,i([D,V],F))}},j.prototype.isReturningFromAuthServer=function(){var M=j.extractParamFromUrl(location.href,"error");if(M)return Promise.reject($(M));var O=j.extractParamFromUrl(location.href,"code");if(!O)return Promise.resolve(!1);var D=JSON.parse(localStorage.getItem(t.LOCALSTORAGE_STATE)||"{}"),V=j.extractParamFromUrl(location.href,"state");return V!==D.stateQueryParam?(console.warn("state query string parameter doesn't match the one sent! Possible malicious activity somewhere."),Promise.reject(new l)):(D.authorizationCode=O,D.hasAuthCodeBeenExchangedForAccessToken=!1,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(D)),this.setState(D),Promise.resolve(!0))},j.prototype.fetchAuthorizationCode=function(M){return r(this,void 0,void 0,function(){var O,D,V,F,ue,se,he,ae,be,_e,lt;return s(this,function(we){switch(we.label){case 0:return this.assertStateAndConfigArePresent(),O=this.config,D=O.clientId,V=O.extraAuthorizationParams,F=O.redirectUrl,ue=O.scopes,[4,j.generatePKCECodes()];case 1:return se=we.sent(),he=se.codeChallenge,ae=se.codeVerifier,be=j.generateRandomState(t.RECOMMENDED_STATE_LENGTH),this.state=n(n({},this.state),{codeChallenge:he,codeVerifier:ae,stateQueryParam:be,isHTTPDecoratorActive:!0}),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(this.state)),_e=this.config.authorizationUrl+"?response_type=code&"+("client_id="+encodeURIComponent(D)+"&")+("redirect_uri="+encodeURIComponent(F)+"&")+("scope="+encodeURIComponent(ue.join(" "))+"&")+("state="+be+"&")+("code_challenge="+encodeURIComponent(he)+"&")+"code_challenge_method=S256",(V||M)&&(lt=n(n({},V),M),_e=_e+"&"+j.objectToQueryString(lt)),location.replace(_e),[2]}})})},j.prototype.getAccessToken=function(){var M=this;this.assertStateAndConfigArePresent();var O=this.config.onAccessTokenExpiry,D=this.state,V=D.accessToken,F=D.authorizationCode,ue=D.explicitlyExposedTokens,se=D.hasAuthCodeBeenExchangedForAccessToken,he=D.refreshToken,ae=D.scopes;return F?this.authCodeForAccessTokenRequest?this.authCodeForAccessTokenRequest:!this.isAuthorized()||!se?(this.authCodeForAccessTokenRequest=this.exchangeAuthCodeForAccessToken(),this.authCodeForAccessTokenRequest):he&&this.isAccessTokenExpired()?O(function(){return M.exchangeRefreshTokenForAccessToken()}):Promise.resolve({token:V,explicitlyExposedTokens:ue,scopes:ae,refreshToken:he}):Promise.reject(new u)},j.prototype.exchangeRefreshTokenForAccessToken=function(){var M=this,O;this.assertStateAndConfigArePresent();var D=this.config,V=D.extraRefreshParams,F=D.clientId,ue=D.tokenUrl,se=this.state.refreshToken;se||console.warn("No refresh token is present.");var he=ue,ae="grant_type=refresh_token&"+("refresh_token="+((O=se)===null||O===void 0?void 0:O.value)+"&")+("client_id="+F);return V&&(ae=he+"&"+j.objectToQueryString(V)),fetch(he,{method:"POST",body:ae,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(be){return be.status>=400?be.json().then(function(_e){return Promise.reject(_e)}):be.json()}).then(function(be){var _e=be.access_token,lt=be.expires_in,we=be.refresh_token,Hn=be.scope,hr=M.config.explicitlyExposedTokens,Kn=[],Ss={},As={value:_e,expiry:new Date(Date.now()+parseInt(lt)*1e3).toString()};if(M.state.accessToken=As,we){var Kt={value:we};M.state.refreshToken=Kt}hr&&(Ss=Object.fromEntries(hr.map(function(gn){return[gn,be[gn]]}).filter(function(gn){gn[0];var yo=gn[1];return yo!==void 0})),M.state.explicitlyExposedTokens=Ss),Hn&&(Kn=Hn.split(" "),M.state.scopes=Kn),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(M.state));var En={token:As,scopes:Kn};return hr&&(En.explicitlyExposedTokens=Ss),En}).catch(function(be){var _e=M.config.onInvalidGrant,lt=be.error||"There was a network error.";switch(lt){case"invalid_grant":_e(function(){return M.fetchAuthorizationCode()});break}return Promise.reject($(lt))})},j.prototype.getGrantedScopes=function(){return this.state.scopes},j.prototype.isHTTPDecoratorActive=function(M){this.state.isHTTPDecoratorActive=M,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(this.state))},j.prototype.isAuthorized=function(){return!!this.state.accessToken},j.prototype.isAccessTokenExpired=function(){var M=this.state.accessToken;return!!(M&&new Date>=new Date(M.expiry))},j.prototype.reset=function(){this.setState({}),this.authCodeForAccessTokenRequest=void 0},j.prototype.assertStateAndConfigArePresent=function(){if(!this.state||!this.config)throw console.error("state:",this.state,"config:",this.config),new Error("state or config is not set.")},j.prototype.exchangeAuthCodeForAccessToken=function(M){var O=this;this.assertStateAndConfigArePresent();var D=this.state,V=D.authorizationCode,F=V===void 0?M:V,ue=D.codeVerifier,se=ue===void 0?"":ue,he=this.config,ae=he.clientId,be=he.onInvalidGrant,_e=he.redirectUrl;se?F||console.warn("No authorization grant code is being passed."):console.warn("No code verifier is being sent.");var lt=this.config.tokenUrl,we="grant_type=authorization_code&"+("code="+encodeURIComponent(F||"")+"&")+("redirect_uri="+encodeURIComponent(_e)+"&")+("client_id="+encodeURIComponent(ae)+"&")+("code_verifier="+se);return fetch(lt,{method:"POST",body:we,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(Hn){var hr=Hn.json().catch(function(Kn){return{error:"invalid_json"}});return Hn.ok?hr.then(function(Kn){var Ss=Kn.access_token,As=Kn.expires_in,Kt=Kn.refresh_token,En=Kn.scope,gn=O.config.explicitlyExposedTokens,yo=[],Kr={};O.state.hasAuthCodeBeenExchangedForAccessToken=!0,O.authCodeForAccessTokenRequest=void 0;var $l={value:Ss,expiry:new Date(Date.now()+parseInt(As)*1e3).toString()};if(O.state.accessToken=$l,Kt){var Ld={value:Kt};O.state.refreshToken=Ld}gn&&(Kr=Object.fromEntries(gn.map(function(bo){return[bo,Kn[bo]]}).filter(function(bo){bo[0];var Fd=bo[1];return Fd!==void 0})),O.state.explicitlyExposedTokens=Kr),En&&(yo=En.split(" "),O.state.scopes=yo),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(O.state));var nu={token:$l,scopes:yo};return gn&&(nu.explicitlyExposedTokens=Kr),nu}):hr.then(function(Kn){var Ss=Kn.error;switch(Ss){case"invalid_grant":be(function(){return O.fetchAuthorizationCode()});break}return Promise.reject($(Ss))})})},j.prototype.recoverState=function(){return this.state=JSON.parse(localStorage.getItem(t.LOCALSTORAGE_STATE)||"{}"),this},j.prototype.setState=function(M){return this.state=M,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(M)),this},j.base64urlEncode=function(M){var O=btoa(M);return O=O.replace(/\+/g,"-"),O=O.replace(/\//g,"_"),O=O.replace(/=/g,""),O},j.extractParamFromUrl=function(M,O){var D=M.split("?");if(D.length<2)return"";D=D[1].split("#");var V=D[0].split("&").reduce(function(ue,se){return ue.concat(se.split("="))},[]);if(V.length<2)return"";var F=V.indexOf(O);return decodeURIComponent(F>=0?V[F+1]:"")},j.objectToQueryString=function(M){return Object.entries(M).map(function(O){var D=O[0],V=O[1];return D+"="+encodeURIComponent(V)}).join("&")},j.generatePKCECodes=function(){var M=new Uint32Array(t.RECOMMENDED_CODE_VERIFIER_LENGTH);crypto.getRandomValues(M);var O=j.base64urlEncode(Array.from(M).map(function(D){return ie[D%ie.length]}).join(""));return crypto.subtle.digest("SHA-256",new TextEncoder().encode(O)).then(function(D){for(var V=new Uint8Array(D),F="",ue=V.byteLength,se=0;se<ue;se++)F+=String.fromCharCode(V[se]);return F}).then(j.base64urlEncode).then(function(D){return{codeChallenge:D,codeVerifier:O}})},j.generateRandomState=function(M){var O=new Uint32Array(M);return crypto.getRandomValues(O),Array.from(O).map(function(D){return ie[D%ie.length]}).join("")},j}();t.OAuth2AuthCodePKCE=ee})(e3);const cv="https://lichess.org",DU=["study:write","study:read","challenge:read","bot:play","board:play"],LU="lichess-api-demo",FU=`${location.protocol}//${location.host}/`,t3=()=>new e3.OAuth2AuthCodePKCE({authorizationUrl:`${cv}/oauth`,tokenUrl:`${cv}/api/token`,clientId:LU,scopes:DU,redirectUrl:FU,onAccessTokenExpiry:e=>e(),onInvalidGrant:console.warn}),Ix=t=>e=>{const n=e.body.getReader(),r=/\r?\n/,s=new TextDecoder;let i="";const o=()=>n.read().then(({done:a,value:u})=>{if(a)i.length>0&&t(JSON.parse(i));else{const l=s.decode(u,{stream:!0});i+=l;const c=i.split(r);i=c.pop();for(const d of c.filter(f=>f))t(JSON.parse(d));return o()}});return o()},kx=async(t,e,n={})=>await(await Sl(t,e,n)).json(),Sl=async(t,e,n={})=>{const r={...n,headers:{Authorization:`Bearer ${t}`}},s=await window.fetch(`${cv}${e}`,r);if(!s.ok){const i=`${s.status} ${s.statusText}`;throw alert(i),i}return s},$U=async(t,e,n,r)=>{const s=`/api/study/by/${e}`,i=r.map(a=>a.id),o=[];Sl(t,s).then(Ix(async a=>{const u=a.id;i.includes(u)||o.push({id:u,name:a.name})})).then(()=>n(o))},BU=()=>{t3().fetchAuthorizationCode()},MU=t=>{localStorage.removeItem("oauth2authcodepkce-state"),t(PU())},VU=t=>kx(t,"/api/account"),UU=(t,e,n,r)=>{const s="/api/broadcast/my-rounds",i=[];Sl(t,s).then(Ix(async o=>{i.push({id:o.round.id,name:o.round.name})})).then(()=>{r?e(i):$U(t,n,e,i)})},zU=(t,e)=>{const n="/api/import",r={body:new URLSearchParams({pgn:e}),method:"POST"};return kx(t,n,r)},WU=(t,e,n,r)=>{const s=`/api/study/${r}/import-pgn`,i={body:new URLSearchParams({pgn:e,name:n}),method:"POST"};Sl(t,s,i)},jU=(t,e,n)=>{const r=`/api/broadcast/round/${n}/push`;Sl(t,r,{body:e,method:"POST"})},GU=(t,e,n)=>{const r=`/api/board/game/stream/${n}`;Sl(t,r).then(Ix(e))},qU=t=>kx(t,"/api/account/playing"),HU=(t,e,n)=>{const r=`/api/board/game/${e}/move/${n}`;Sl(t,r,{method:"POST"})},KU=async(t,e)=>{var u;const n=t3();if(!await n.isReturningFromAuthServer())return;const s=await n.getAccessToken(),i=(u=s==null?void 0:s.token)==null?void 0:u.value;if(i===void 0){console.log("Access Context token is undefined");return}e(kU(i));const a=(await VU(i)).username;e(RU(a)),t("/")},XU=()=>{const t=wg(),e=Zs(),n=Xo().username,r=()=>{n===""?BU():(MU(e),t("/"))};return _.jsxs("div",{className:"row m-2",children:[_.jsxs("div",{className:"h1 col-6 h-100 d-flex justify-content-center align-items-end m-0",children:[_.jsx(_.Fragment,{children:""}),_.jsx("div",{children:"Chess Academy"})]}),_.jsx("div",{className:"col-6 h-100",children:_.jsx("div",{className:"h-100 d-flex justify-content-center align-items-end m-0",children:_.jsx("button",{className:"btn btn-dark btn-outline-light m-0",onClick:r,children:n===""?"Login":`Logout from "${n}"`})})})]})},sf=({text:t,tokenRequired:e})=>{const n=wg(),s=Xo().token===""&&e,i=()=>{s||n(`/${t.toLowerCase()}`)};return _.jsx("button",{className:"btn btn-dark btn-lg btn-outline-light w-100",onClick:i,children:s?`${t} (must Login)`:`${t}`})},YU=()=>_.jsxs("div",{className:"container-flex d-flex overflow-hidden h-100 flex-column p-0 m-0 text-center text-white bg-dark",children:[_.jsx(XU,{}),_.jsxs("div",{className:"row m-2",children:[_.jsx("div",{className:"col",children:_.jsx(sf,{text:"Upload",tokenRequired:!1})}),_.jsx("div",{className:"col",children:_.jsx(sf,{text:"Record",tokenRequired:!1})})]}),_.jsxs("div",{className:"row m-2",children:[_.jsx("div",{className:"col",children:_.jsx(sf,{text:"Broadcast",tokenRequired:!0})}),_.jsx("div",{className:"col",children:_.jsx(sf,{text:"Play",tokenRequired:!0})})]}),_.jsx("div",{className:"row m-2",children:_.jsx("div",{className:"col",children:_.jsx(sf,{text:"Export",tokenRequired:!0})})}),_.jsx("div",{className:"row my-2 mx-0 mt-auto"})]}),lo=t=>_.jsx("button",{onClick:t.onClick,className:"btn btn-dark btn-sm btn-outline-light w-100",children:t.children});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU=1e-7,ZU=1e-4;class JU{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class n3{refCount(e){return Pr("refCount")}incRef(e){return Pr("incRef")}timerAvailable(){return!0}time(e){return Pr("time")}read(e){return Pr("read")}readSync(e){return Pr("readSync")}readToGPU(e,n){return Pr("readToGPU")}numDataIds(){return Pr("numDataIds")}disposeData(e,n){return Pr("disposeData")}write(e,n,r){return Pr("write")}move(e,n,r,s,i){return Pr("move")}createTensorFromGPUData(e,n,r){return Pr("createTensorFromGPUData")}memory(){return Pr("memory")}floatPrecision(){return Pr("floatPrecision")}epsilon(){return this.floatPrecision()===32?QU:ZU}dispose(){return Pr("dispose")}}function Pr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0(t,e,n){return Math.max(t,Math.min(e,n))}function Rx(t){return t%2===0?t:t+1}function of(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function ez(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function R(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function ys(t,e,n=""){R(qt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function pd(t){R(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function de(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function tz(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function qt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Jc(t){return t%1===0}function dv(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Lc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function xC(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const u=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,u):setTimeout(a,u)};a()})}function nz(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function An(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),R(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),R(t.every(r=>Jc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Qa(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:An(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Ua(t,e){return Sn(t,e)}function Sn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function rz(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function sz(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function iz(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function C0(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function oz(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Cg(t){return typeof t=="string"||t instanceof String}function az(t){return typeof t=="boolean"}function uz(t){return typeof t=="number"}function Mh(t){return Array.isArray(t)?Mh(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":uz(t)?"float32":Cg(t)?"string":az(t)?"bool":"float32"}function fv(t){return!!(t&&t.constructor&&t.call&&t.apply)}function hv(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Dn(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function r3(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((u,l)=>u*l)*(r?2:1);for(let u=0;u<i;u++)s[u]=r3(t+u*a,o,n,r)}return s}function pv(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return r3(0,t,e,n)}function s3(t,e){const n=za(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function za(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function bs(t){t.forEach(e=>{R(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function mv(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function Px(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function ol(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SC="tfjsflags";class lz{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=cz,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(ol(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);SC in e&&e[SC].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=fz(s,i)})}}function cz(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(dz(e,r[0],r[1]),r.join("="))),e}function dz(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function fz(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function X(){return i3}let i3=null;function hz(t){i3=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xy;function o3(){if(xy==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");xy=t}return xy}function pz(){const t=o3();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Ox(t,e){const n=pz();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const a3="Abs",u3="Acos",l3="Acosh",Dx="Add",c3="AddN",d3="All",f3="Any",h3="ArgMax",p3="ArgMin",m3="Asin",g3="Asinh",y3="Atan",b3="Atanh",v3="Atan2",w3="AvgPool",mz="AvgPoolGrad",x3="AvgPool3D",gz="AvgPool3DGrad",S3="BatchMatMul",A3="BatchToSpaceND",E3="Bincount",C3="BitwiseAnd",N3="BroadcastArgs",Lx="Cast",T3="Ceil",_3="ClipByValue",I3="Complex",k3="ComplexAbs",R3="Concat",P3="Conv2D",O3="Conv2DBackpropFilter",D3="Conv2DBackpropInput",L3="Conv3D",yz="Conv3DBackpropFilterV2",F3="Conv3DBackpropInputV2",$3="Cos",B3="Cosh",M3="Cumprod",V3="Cumsum",U3="CropAndResize",z3="DenseBincount",W3="DepthToSpace",j3="DepthwiseConv2dNative",G3="DepthwiseConv2dNativeBackpropFilter",q3="DepthwiseConv2dNativeBackpropInput",H3="Diag",K3="Dilation2D",X3="RealDiv",Y3="Einsum",Q3="Elu",bz="EluGrad",Z3="Erf",J3="Equal",eR="Exp",tR="ExpandDims",nR="Expm1",rR="FFT",sR="Fill",iR="FlipLeftRight",oR="Floor",aR="FloorDiv",uR="FusedBatchNorm",lR="GatherV2",cR="GatherNd",dR="Greater",fR="GreaterEqual",Fx="Identity",hR="IFFT",pR="Imag",mR="IsFinite",gR="IsInf",yR="IsNan",bR="LeakyRelu",vR="Less",wR="LessEqual",xR="LinSpace",SR="Log",AR="Log1p",ER="LogicalAnd",CR="LogicalNot",NR="LogicalOr",TR="LRN",vz="LRNGrad",_R="Max",IR="Maximum",kR="MaxPool",wz="MaxPoolGrad",RR="MaxPool3D",xz="MaxPool3DGrad",PR="MaxPoolWithArgmax",OR="Mean",DR="Min",LR="Minimum",FR="MirrorPad",$R="Mod",BR="Multinomial",MR="Multiply",VR="Neg",UR="NotEqual",zR="NonMaxSuppressionV3",WR="NonMaxSuppressionV4",jR="NonMaxSuppressionV5",GR="OnesLike",qR="OneHot",HR="Pack",KR="PadV2",XR="Pow",YR="Prelu",QR="Prod",ZR="RaggedGather",JR="RaggedRange",eP="RaggedTensorToTensor",tP="Range",nP="Real",rP="Reciprocal",sP="Relu",iP="Reshape",oP="ResizeNearestNeighbor",Sz="ResizeNearestNeighborGrad",aP="ResizeBilinear",Az="ResizeBilinearGrad",uP="Relu6",lP="Reverse",cP="Round",dP="Rsqrt",fP="ScatterNd",hP="TensorScatterUpdate",pP="SearchSorted",mP="Select",gP="Selu",yP="Slice",bP="Sin",vP="Sinh",wP="Sign",xP="Sigmoid",SP="Softplus",AP="Sqrt",EP="Sum",CP="SpaceToBatchND",NP="SplitV",TP="Softmax",_P="SparseFillEmptyRows",IP="SparseReshape",kP="SparseSegmentMean",RP="SparseSegmentSum",PP="SparseToDense",OP="SquaredDifference",Ez="Square",DP="StaticRegexReplace",LP="StridedSlice",FP="StringNGrams",$P="StringSplit",BP="StringToHashBucketFast",MP="Sub",VP="Tan",UP="Tanh",$x="Tile",zP="TopK",WP="Transform",_m="Transpose",jP="Unique",GP="Unpack",qP="UnsortedSegmentSum",HP="ZerosLike",KP="Step",gv="FromPixels",XP="RotateWithOffset",yv="_FusedMatMul",bv="FusedConv2D",vv="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ni(...t){X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(...t)}function Cz(...t){X().getBool("IS_TEST")||X().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0=Ox("kernelRegistry",()=>new Map),Nz=Ox("gradRegistry",()=>new Map);function wv(t,e){const n=YP(t,e);return N0.get(n)}function AC(t){return Nz.get(t)}function EC(t){const e=N0.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function Tz(t){const{kernelName:e,backendName:n}=t,r=YP(e,n);N0.has(r)&&Ni(`The kernel '${e}' for backend '${n}' is already registered`),N0.set(r,t)}function YP(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var ZP=Ft,Vs=null;try{Vs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ft(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ft.prototype.__isLong__;Object.defineProperty(Ft.prototype,"__isLong__",{value:!0});function qr(t){return(t&&t.__isLong__)===!0}Ft.isLong=qr;var CC={},NC={};function Al(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=NC[t],r)?r:(n=$t(t,(t|0)<0?-1:0,!0),s&&(NC[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=CC[t],r)?r:(n=$t(t,t<0?-1:0,!1),s&&(CC[t]=n),n))}Ft.fromInt=Al;function Us(t,e){if(isNaN(t))return e?zu:zs;if(e){if(t<0)return zu;if(t>=JP)return nO}else{if(t<=-_C)return Ur;if(t+1>=_C)return tO}return t<0?Us(-t,e).neg():$t(t%ed|0,t/ed|0,e)}Ft.fromNumber=Us;function $t(t,e,n){return new Ft(t,e,n)}Ft.fromBits=$t;var T0=Math.pow;function Bx(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return zs;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Bx(t.substring(1),e,n).neg();for(var s=Us(T0(n,8)),i=zs,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),u=parseInt(t.substring(o,o+a),n);if(a<8){var l=Us(T0(n,a));i=i.mul(l).add(Us(u))}else i=i.mul(s),i=i.add(Us(u))}return i.unsigned=e,i}Ft.fromString=Bx;function Di(t,e){return typeof t=="number"?Us(t,e):typeof t=="string"?Bx(t,e):$t(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ft.fromValue=Di;var TC=65536,_z=1<<24,ed=TC*TC,JP=ed*ed,_C=JP/2,IC=Al(_z),zs=Al(0);Ft.ZERO=zs;var zu=Al(0,!0);Ft.UZERO=zu;var Ac=Al(1);Ft.ONE=Ac;var eO=Al(1,!0);Ft.UONE=eO;var xv=Al(-1);Ft.NEG_ONE=xv;var tO=$t(-1,2147483647,!1);Ft.MAX_VALUE=tO;var nO=$t(-1,-1,!0);Ft.MAX_UNSIGNED_VALUE=nO;var Ur=$t(0,-2147483648,!1);Ft.MIN_VALUE=Ur;var ge=Ft.prototype;ge.toInt=function(){return this.unsigned?this.low>>>0:this.low};ge.toNumber=function(){return this.unsigned?(this.high>>>0)*ed+(this.low>>>0):this.high*ed+(this.low>>>0)};ge.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ur)){var n=Us(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Us(T0(e,6),this.unsigned),o=this,a="";;){var u=o.div(i),l=o.sub(u.mul(i)).toInt()>>>0,c=l.toString(e);if(o=u,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ge.getHighBits=function(){return this.high};ge.getHighBitsUnsigned=function(){return this.high>>>0};ge.getLowBits=function(){return this.low};ge.getLowBitsUnsigned=function(){return this.low>>>0};ge.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ur)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ge.isZero=function(){return this.high===0&&this.low===0};ge.eqz=ge.isZero;ge.isNegative=function(){return!this.unsigned&&this.high<0};ge.isPositive=function(){return this.unsigned||this.high>=0};ge.isOdd=function(){return(this.low&1)===1};ge.isEven=function(){return(this.low&1)===0};ge.equals=function(e){return qr(e)||(e=Di(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ge.eq=ge.equals;ge.notEquals=function(e){return!this.eq(e)};ge.neq=ge.notEquals;ge.ne=ge.notEquals;ge.lessThan=function(e){return this.comp(e)<0};ge.lt=ge.lessThan;ge.lessThanOrEqual=function(e){return this.comp(e)<=0};ge.lte=ge.lessThanOrEqual;ge.le=ge.lessThanOrEqual;ge.greaterThan=function(e){return this.comp(e)>0};ge.gt=ge.greaterThan;ge.greaterThanOrEqual=function(e){return this.comp(e)>=0};ge.gte=ge.greaterThanOrEqual;ge.ge=ge.greaterThanOrEqual;ge.compare=function(e){if(qr(e)||(e=Di(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ge.comp=ge.compare;ge.negate=function(){return!this.unsigned&&this.eq(Ur)?Ur:this.not().add(Ac)};ge.neg=ge.negate;ge.add=function(e){qr(e)||(e=Di(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,u=e.low>>>16,l=e.low&65535,c=0,d=0,f=0,h=0;return h+=i+l,f+=h>>>16,h&=65535,f+=s+u,d+=f>>>16,f&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+o,c&=65535,$t(f<<16|h,c<<16|d,this.unsigned)};ge.subtract=function(e){return qr(e)||(e=Di(e)),this.add(e.neg())};ge.sub=ge.subtract;ge.multiply=function(e){if(this.isZero())return zs;if(qr(e)||(e=Di(e)),Vs){var n=Vs.mul(this.low,this.high,e.low,e.high);return $t(n,Vs.get_high(),this.unsigned)}if(e.isZero())return zs;if(this.eq(Ur))return e.isOdd()?Ur:zs;if(e.eq(Ur))return this.isOdd()?Ur:zs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(IC)&&e.lt(IC))return Us(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,u=e.high&65535,l=e.low>>>16,c=e.low&65535,d=0,f=0,h=0,p=0;return p+=o*c,h+=p>>>16,p&=65535,h+=i*c,f+=h>>>16,h&=65535,h+=o*l,f+=h>>>16,h&=65535,f+=s*c,d+=f>>>16,f&=65535,f+=i*l,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,d+=r*c+s*l+i*u+o*a,d&=65535,$t(h<<16|p,d<<16|f,this.unsigned)};ge.mul=ge.multiply;ge.divide=function(e){if(qr(e)||(e=Di(e)),e.isZero())throw Error("division by zero");if(Vs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Vs.div_u:Vs.div_s)(this.low,this.high,e.low,e.high);return $t(n,Vs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?zu:zs;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return zu;if(e.gt(this.shru(1)))return eO;i=zu}else{if(this.eq(Ur)){if(e.eq(Ac)||e.eq(xv))return Ur;if(e.eq(Ur))return Ac;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(zs)?e.isNegative()?Ac:xv:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(Ur))return this.unsigned?zu:zs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=zs}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),u=a<=48?1:T0(2,a-48),l=Us(r),c=l.mul(e);c.isNegative()||c.gt(s);)r-=u,l=Us(r,this.unsigned),c=l.mul(e);l.isZero()&&(l=Ac),i=i.add(l),s=s.sub(c)}return i};ge.div=ge.divide;ge.modulo=function(e){if(qr(e)||(e=Di(e)),Vs){var n=(this.unsigned?Vs.rem_u:Vs.rem_s)(this.low,this.high,e.low,e.high);return $t(n,Vs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ge.mod=ge.modulo;ge.rem=ge.modulo;ge.not=function(){return $t(~this.low,~this.high,this.unsigned)};ge.and=function(e){return qr(e)||(e=Di(e)),$t(this.low&e.low,this.high&e.high,this.unsigned)};ge.or=function(e){return qr(e)||(e=Di(e)),$t(this.low|e.low,this.high|e.high,this.unsigned)};ge.xor=function(e){return qr(e)||(e=Di(e)),$t(this.low^e.low,this.high^e.high,this.unsigned)};ge.shiftLeft=function(e){return qr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?$t(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):$t(0,this.low<<e-32,this.unsigned)};ge.shl=ge.shiftLeft;ge.shiftRight=function(e){return qr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?$t(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):$t(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ge.shr=ge.shiftRight;ge.shiftRightUnsigned=function(e){if(qr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return $t(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?$t(n,0,this.unsigned):$t(n>>>e-32,0,this.unsigned)};ge.shru=ge.shiftRightUnsigned;ge.shr_u=ge.shiftRightUnsigned;ge.toSigned=function(){return this.unsigned?$t(this.low,this.high,!1):this};ge.toUnsigned=function(){return this.unsigned?this:$t(this.low,this.high,!0)};ge.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ge.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ge.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ft.fromBytes=function(e,n,r){return r?Ft.fromBytesLE(e,n):Ft.fromBytesBE(e,n)};Ft.fromBytesLE=function(e,n){return new Ft(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ft.fromBytesBE=function(e,n){return new Ft(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const rO=cd(ZP),Iz=Aw({__proto__:null,default:rO},[ZP]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ou=rO||Iz;function Ng(t){return Ou.fromString(t,!0,16)}const sO=Ng("c3a5c85c97cb3127"),Ru=Ng("b492b66fbe98f273"),ir=Ng("9ae16a3b2f90404f");function Sv(t){return t.xor(t.shru(47))}function iO(t,e,n){const r=t.slice(e,e+n);return Ou.fromBytes(Array.from(r),!0,!0)}function kt(t,e){return iO(t,e,8)}function kC(t,e){return iO(t,e,4)}function wn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function La(t,e,n=Ng("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function kz(t,e,n,r,s,i){s=s.add(t),i=wn(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(wn(s,44)),[s.add(r),i.add(o)]}function Mp(t,e,n,r){return kz(kt(t,e),kt(t,e+8),kt(t,e+16),kt(t,e+24),n,r)}function Rz(t,e=t.length){if(e>=8){const n=ir.add(e*2),r=kt(t,0).add(ir),s=kt(t,e-8),i=wn(s,37).mul(n).add(r),o=wn(r,25).add(s).mul(n);return La(i,o,n)}if(e>=4){const n=ir.add(e*2),r=kC(t,0);return La(r.shl(3).add(e),kC(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return Sv(ir.mul(i).xor(sO.mul(o))).mul(ir)}return ir}function Pz(t,e=t.length){const n=ir.add(e*2),r=kt(t,0).mul(Ru),s=kt(t,8),i=kt(t,e-8).mul(n),o=kt(t,e-16).mul(ir);return La(wn(r.add(s),43).add(wn(i,30)).add(o),r.add(wn(s.add(ir),18)).add(i),n)}function Oz(t,e=t.length){const n=ir.add(e*2),r=kt(t,0).mul(ir),s=kt(t,8),i=kt(t,e-8).mul(n),o=kt(t,e-16).mul(ir),a=wn(r.add(s),43).add(wn(i,30)).add(o),u=La(a,r.add(wn(s.add(ir),18)).add(i),n),l=kt(t,16).mul(n),c=kt(t,24),d=a.add(kt(t,e-32)).mul(n),f=u.add(kt(t,e-24)).mul(n);return La(wn(l.add(c),43).add(wn(d,30)).add(f),l.add(wn(c.add(r),18)).add(d),n)}function Dz(t,e=t.length){const n=Ou.fromNumber(81,!0);if(e<=32)return e<=16?Rz(t,e):Pz(t,e);if(e<=64)return Oz(t,e);let r=n,s=n.mul(Ru).add(113),i=Sv(s.mul(ir).add(113)).mul(ir),o=[Ou.UZERO,Ou.UZERO],a=[Ou.UZERO,Ou.UZERO];r=r.mul(ir).add(kt(t,0));let u=0;const l=(e-1>>6)*64,c=l+(e-1&63)-63;do r=wn(r.add(s).add(o[0]).add(kt(t,u+8)),37).mul(Ru),s=wn(s.add(o[1]).add(kt(t,u+48)),42).mul(Ru),r=r.xor(a[1]),s=s.add(o[0]).add(kt(t,u+40)),i=wn(i.add(a[0]),33).mul(Ru),o=Mp(t,u,o[1].mul(Ru),r.add(a[0])),a=Mp(t,u+32,i.add(a[1]),s.add(kt(t,u+16))),[i,r]=[r,i],u+=64;while(u!==l);const d=Ru.add(i.and(255).shl(1));return u=c,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=wn(r.add(s).add(o[0]).add(kt(t,u+8)),37).mul(d),s=wn(s.add(o[1]).add(kt(t,u+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(kt(t,u+40))),i=wn(i.add(a[0]),33).mul(d),o=Mp(t,u,o[1].mul(d),r.add(a[0])),a=Mp(t,u+32,i.add(a[1]),s.add(kt(t,u+16))),[i,r]=[r,i],La(La(o[0],a[0],d).add(Sv(s).mul(sO)).add(i),La(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function md(t,e){return e==="string"?Hu(t):Tg([t],e)}function Lz(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Tg(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=al(t)),X().getBool("DEBUG")&&rz(t,e),Lz(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function xi(){return X().platform.now()}function Hu(t,e="utf-8"){return e=e||"utf-8",X().platform.encode(t,e)}function td(t,e="utf-8"){return e=e||"utf-8",X().platform.decode(t,e)}function Qs(t){return X().platform.isTypedArray!=null?X().platform.isTypedArray(t):QP(t)}function al(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||ol(t)||t==null||Qs(t)&&n)e.push(t);else if(Array.isArray(t)||Qs(t))for(let r=0;r<t.length;++r)al(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)al(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fz{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Bz)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=xi();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const l of s)l.dataSync();o=Promise.resolve({kernelMs:xi()-a})}if(X().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<s.length;l++){const c=s[l];c.data().then(d=>{$z(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(u=>{this.logger.logKernelProfile(n,a,u[0],u[1],i,u[2])})})}}function $z(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class Bz{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?Lc(`${s}ms`,9):s.error,u=Lc(e,25),l=n.rank,c=n.size,d=Lc(n.shape.toString(),14);let f="";for(const h in i){const p=i[h];if(p!=null){const y=p.shape||n.shape,b=y.length;f+=`${h}: ${b}D ${b>0?y:""} `}}console.log(`%c${u}	%c${a}	%c${l}D ${d}	%c${c}	%c${f}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(t,e,n){const r={},s={};for(let u=0;u<e.length;u++)r[e[u].id]=!0;for(let u=0;u<t.length;u++){const l=t[u],c=l.inputs;for(const d in c){const f=c[d];let h=!1;for(let p=0;p<e.length;p++)if(r[f.id]){l.outputs.forEach(y=>r[y.id]=!0),h=!0,s[l.id]=!0;break}if(h)break}}const i={};i[n.id]=!0;const o={};for(let u=t.length-1;u>=0;u--){const l=t[u],c=l.inputs;for(let d=0;d<l.outputs.length;d++)if(i[l.outputs[d].id]){for(const f in c)i[c[f].id]=!0,o[l.id]=!0;break}}const a=[];for(let u=0;u<t.length;u++){const l=t[u];if(s[l.id]&&o[l.id]){const c={};for(const f in l.inputs){const h=l.inputs[f];r[h.id]&&(c[f]=h)}const d=Object.assign({},l);d.inputs=c,d.outputs=l.outputs,a.push(d)}}return a}function Vz(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(u=>{const l=t[u.id];l!=null?o.push(l):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const u in i.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const l=n(()=>a[u]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${l.dtype}'`);const c=i.inputs[u];if(!qt(l.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${u}' has shape '${l.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=l;else{const d=t[c.id];t[c.id]=r(d,l),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RC=20,af=3,Sy=7;function Uz(t,e,n,r){const s=Dn(e),i=zz(t,e,n,s),o=e.length,a=Im(t,e,n,s,i),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(a.map(l=>"    "+l).join(`
`)),u.join(`
`)}function zz(t,e,n,r){const s=de(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,u=n==="complex64"?Nf(t):t;if(a>1)for(let l=0;l<s/i;l++){const c=l*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Cf(u[c+d],0,n).length)}return o}function Cf(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(Sy))} + ${parseFloat(t[1].toFixed(Sy))}j`:Cg(t)?r=`'${t}'`:n==="bool"?r=oO(t):r=parseFloat(t.toFixed(Sy)).toString(),Lc(r,e)}function oO(t){return t===0?"false":"true"}function Im(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],u=e.length;if(u===0){if(n==="complex64"){const y=Nf(t);return[Cf(y[0],0,n)]}return n==="bool"?[oO(t[0])]:[t[0].toString()]}if(u===1){if(a>RC){const b=af*o;let g=Array.from(t.slice(0,b)),v=Array.from(t.slice((a-af)*o,a*o));return n==="complex64"&&(g=Nf(g),v=Nf(v)),["["+g.map((w,x)=>Cf(w,s[x],n)).join(", ")+", ..., "+v.map((w,x)=>Cf(w,s[a-af+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?Nf(t):Array.from(t)).map((b,g)=>Cf(b,s[g],n)).join(", ")+"]"]}const l=e.slice(1),c=r.slice(1),d=r[0]*o,f=[];if(a>RC){for(let y=0;y<af;y++){const b=y*d,g=b+d;f.push(...Im(t.slice(b,g),l,n,c,s,!1))}f.push("...");for(let y=a-af;y<a;y++){const b=y*d,g=b+d;f.push(...Im(t.slice(b,g),l,n,c,s,y===a-1))}}else for(let y=0;y<a;y++){const b=y*d,g=b+d;f.push(...Im(t.slice(b,g),l,n,c,s,y===a-1))}const h=u===2?",":"";f[0]="["+(a>0?f[0]+h:"");for(let y=1;y<f.length-1;y++)f[y]=" "+f[y]+h;let p=`,
`;for(let y=2;y<u;y++)p+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(i?"":p),f}function Nf(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nd{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=de(e),r!=null){const s=r.length;R(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Sn(n,this.size),this.strides=Dn(e)}set(e,...n){n.length===0&&(n=[0]),R(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Ai().makeTensor(this.values,this.shape,this.dtype)}}let Ai=null,oc=null;function Wz(t){Ai=t}function jz(t){oc=t}class or{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=de(e),this.strides=Dn(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return oc.buffer(this.shape,this.dtype,e)}bufferSync(){return oc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return pv(this.shape,e,this.dtype==="complex64")}arraySync(){return pv(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ai().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>td(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ai().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ai().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>td(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ai().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ai().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return oc.print(this,e)}clone(){return this.throwIfDisposed(),oc.clone(this)}toString(e=!1){const n=this.dataSync();return Uz(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),oc.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Ai().makeVariable(this,e,n,r)}}Object.defineProperty(or,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function aO(){return Ox("Tensor",()=>or)}aO();class _0 extends or{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!qt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ai().disposeTensor(this),this.dataId=e.dataId,Ai().incRef(this,null)}dispose(){Ai().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(_0,Symbol.hasInstance,{value:t=>t instanceof or&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var PC;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(PC||(PC={}));var Av;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Av||(Av={}));var Ev;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Ev||(Ev={}));var Cv;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Cv||(Cv={}));var Nv;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Nv||(Nv={}));const Gz={float32:Cv,int32:Av,bool:Ev,complex64:Nv};function uo(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Gz[t][e]}function Mx(t){return uo(t,"int32")}function uO(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function lO(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function en(t,e){if(t.dtype===e.dtype)return[t,e];const n=uo(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function qz(t,e){R(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function cO(t){const e=[];return dO(t,e,new Set),e}function dO(t,e,n){if(t==null)return;if(t instanceof or){e.push(t);return}if(!Hz(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),dO(i,e,n))}}function Hz(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(t){return t.kernelName!=null}class OC{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class rd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new OC}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Ni(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Fz(this.backendInstance),!0}setupRegisteredKernels(){EC(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){EC(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof n3)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Ni(`Initialization of backend ${e} failed`),Ni(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Ni(`Initialization of backend ${e} failed`),Ni(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return rd.nextTensorId++}nextVariableId(){return rd.nextVariableId++}clone(e){const n=W.runKernel(Fx,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",u={x:o},l={dtype:a};return W.runKernel(Lx,u,l)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(wv(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(u=>{i+=u.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let u;const l=Ay(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Ay(e)){const{kernelName:p,inputs:y,attrs:b}=e;this.backendName==null&&this.backend;const g=wv(p,this.backendName);R(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();u=g.kernelFunc({inputs:y,attrs:b,backend:this.backend});const w=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,w);const x=w.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(s){const C=this.getTensorsForGradient(p,y,x);r=this.saveTensorsForBackwardMode(C)}return x}}else{const{forwardFunc:p}=e,y=b=>{s&&(r=b.map(g=>this.keep(this.clone(g))))};a=()=>{const b=this.backend.numDataIds();u=this.tidy(()=>p(this.backend,y));const g=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,b,g),g}}const{inputs:c,attrs:d}=e,f=Ay(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(l,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),s&&this.addTapeNode(l,c,n,f,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=AC(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(R(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(l=>n[l])):a=i.map(l=>n[l]);const u=r.filter((l,c)=>o[c]);return a.concat(u)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&Cg(e[0])&&(i=e.map(u=>Hu(u)));const o=s.write(i,n,r),a=new or(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const u=this.state.tensorInfo.get(o),l=oz(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new or(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new _0(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*C0(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof _0||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*C0(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},u=AC(e);u!=null&&(s=u.gradFunc),s!=null&&(a.gradient=l=>(l=l.map((c,d)=>{if(c==null){const f=r[d],h=za(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return c}),s(l.length>1?l:l[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=cO(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(R(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));R(i instanceof or,()=>"The result y returned by f() must be a tensor.");const o=Mz(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??Kz(i.shape),Vz(a,o,l=>this.tidy(l),Xz);const u=n.map(l=>a[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(const c of l.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:u}})}customGrad(e){return R(fv(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{R(n.every(a=>a instanceof or),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,u)=>{s[u]=a});const i=(a,u)=>(r=e(...n,u),R(r.value instanceof or,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),R(fv(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,u)=>{const l=r.gradFunc(a,u),c=Array.isArray(l)?l:[l];R(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),R(c.every(f=>f instanceof or),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=xi(),r=await this.backend.time(e);return r.wallMs=xi()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new OC;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}rd.nextTensorId=0;rd.nextVariableId=0;function Kz(t){const e=s3(de(t),"float32");return W.makeTensor(e,t,"float32")}function fO(){const t=o3();if(t._tfengine==null){const e=new lz(t);t._tfengine=new rd(e)}return hz(t._tfengine.ENV),Wz(()=>t._tfengine),t._tfengine}const W=fO();function Xz(t,e){const n={a:t,b:e};return W.runKernel(Dx,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(){return typeof navigator<"u"&&navigator!=null}function hO(t){if(t||Yz()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function pO(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _r=X();_r.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});_r.registerFlag("IS_BROWSER",()=>pO());_r.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");_r.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));_r.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));_r.registerFlag("PROD",()=>!1);_r.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>_r.getBool("DEBUG"));_r.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);_r.registerFlag("IS_TEST",()=>!1);_r.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>_r.getBool("DEBUG"));_r.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);_r.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);_r.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t,e){let n=t;if(Qs(t))return e==="string"?[]:[t.length];if(uO(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(lO(t))return[t.buffer.size/(e==null?4:C0(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Qs(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&X().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&mO(t,r,[]),r}function mO(t,e,n){if(n=n||[],!Array.isArray(t)&&!Qs(t)){R(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}R(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),R(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)mO(t[s],r,n.concat(s))}function DC(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function T(t,e,n,r="numeric"){if(t instanceof aO())return DC(r,t.dtype,e,n),t;let s=Mh(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),DC(r,s,e,n),t==null||!Qs(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const u=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const i=Za(t,s);!Qs(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Tg(t,s):al(t,[],!0);return W.makeTensor(a,i,s)}function I0(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>T(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gO="__op";function B(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+gO;const s=(...i)=>{W.startScope(n);try{const o=r(...i);return ol(o)&&console.error("Cannot return a Promise inside of tidy."),W.endScope(o),o}catch(o){throw W.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(t,e){const n=T(t,"real","complex"),r=T(e,"imag","complex");ys(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return W.runKernel(I3,s)}const Wa=B({complex_:Qz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ja(t,e,n,r){if(r==null)r=Mh(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(lO(t)||uO(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return W.backend.createTensorFromGPUData(t,e||n,r)}if(!Qs(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){bs(e);const s=de(e),i=de(n);R(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],u=o===n.length-1?a!==de(e.slice(o)):!0;R(n[o]===e[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Qs(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Tg(t,r):al(t,[],!0),W.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function io(t,e,n){const r=Za(t,n);return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ul={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Li{static join(e){return new Li(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Qs(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let u=r;u<this.shards.length;u++){const l=this.shards[u],d=e+a-l.start,f=a,p=Math.min(n,l.end)-l.start,y=new Uint8Array(l.buffer,d,p-d);if(o.set(y,f),a+=y.length,n<l.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Zz(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Zz(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(){W.disposeVariables()}function sa(){return W}function sd(){return W.memory()}function qe(t,e){return W.tidy(t,e)}function rn(t){cO(t).forEach(n=>n.dispose())}function Zi(t){return W.keep(t)}function Jz(){return W.ready()}function e7(){return W.backendName}function t7(t,e,n=1){return W.registerBackend(t,e,n)}function yO(){return W.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja=4;async function n7(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],u=Array.isArray(t)?t[o].tensor:t[a];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const l={name:a,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const c=new Promise(async d=>{const f=await u.bytes(),h=f.reduce((b,g)=>b+g.length,0)+ja*f.length,p=new Uint8Array(h);let y=0;for(let b=0;b<f.length;b++){const g=f[b],v=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(v,y),y+=ja,p.set(g,y),y+=g.length}d(p)});r.push(c)}else r.push(u.data());e!=null&&(l.group=e),n.push(l)}const i=await Promise.all(r);return{data:i7(i),specs:n}}function bO(t,e){const n=new Li(t),r={};let s=0;for(const i of e){const o=r7(i,(a,u)=>n.slice(s+a,s+u));r[i.name]=vO(i,n.slice(s,s+o)),s+=o}return r}function r7(t,e){const n=de(t.shape);let r;if("quantization"in t){const s=t.quantization;r=ul[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=ja+new Uint32Array(e(s,s+ja))[0];return s}else r=ul[t.dtype];return n*r}async function s7(t,e){const n=de(t.shape);let r;if("quantization"in t){const s=t.quantization;r=ul[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=ja+new Uint32Array(await e(s,s+ja))[0];return s}else r=ul[t.dtype];return n*r}function vO(t,e){const n=t.name,r=t.dtype,s=t.shape,i=de(s);let o,a=0;if("quantization"in t){const u=t.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${t.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const l=ul[u.dtype],c=u.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){o=new Float32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=f*u.scale+u.min}}else if(u.dtype==="float16")o=f7()(c);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(r==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=Math.round(f*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*l}else if(r==="string"){const u=de(t.shape);o=[];for(let l=0;l<u;l++){const c=new Uint32Array(e.slice(a,a+ja))[0];a+=ja;const d=new Uint8Array(e.slice(a,a+c));o.push(d),a+=c}}else{const u=ul[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const l=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let p=0;p<l.length;p++)l[p]=o[p*2],c[p]=o[p*2+1];const d=io(l,s,"float32"),f=io(c,s,"float32"),h=Wa(d,f);return d.dispose(),f.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*u}return io(o,s,r)}async function LC(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:i}=await t.read();if(s&&i==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+i.byteLength);o.set(r,0),o.set(new Uint8Array(i),r.length),r=o}return r.buffer}async function wO(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const i of e){const o=await s7(i,async(l,c)=>(s=await LC(r,s,c),s.slice(l,c)));s=await LC(r,s,o);const a=s.slice(0,o);s=s.slice(o);const u=vO(i,a);if(n[i.name]=u,e7()==="webgpu"){const l=yO();"uploadToGPU"in l&&de(u.shape)>=X().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&l.uploadToGPU(u.dataId)}}return n}function i7(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const Ux=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function FC(t){return Ux?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function o7(t){if(Ux)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function a7(t){if(Ux){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function u7(t){return Li.join(t)}function $C(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function xO(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function SO(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function zx(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),SO(t,n,r)}function Vh(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:FC(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:FC(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Li(t.weightData).byteLength}}function Tv(t){const e=[];for(const n of t)e.push(...n.weights);return e}function l7(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function c7(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function d7(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function f7(){const t=l7(),e=c7(),n=d7();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],u=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=u}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return jt.instance==null&&(jt.instance=new jt),jt.instance}static registerSaveRouter(e){jt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){jt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return jt.getHandlers(e,"save")}static getLoadHandlers(e,n){return jt.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?jt.getInstance().loadRouters:jt.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const h7=t=>jt.registerSaveRouter(t),p7=t=>jt.registerLoadRouter(t),m7=t=>jt.getSaveHandlers(t),g7=(t,e)=>jt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _v="tensorflowjs",Iv=1,Wu="models_store",xa="model_info_store";function AO(){if(!X().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function kv(t){const e=t.result;e.createObjectStore(Wu,{keyPath:"modelPath"}),e.createObjectStore(xa,{keyPath:"modelPath"})}class ll{constructor(e){if(this.indexedDB=AO(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open(_v,Iv);i.onupgradeneeded=()=>kv(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Wu,"readonly"),l=a.objectStore(Wu).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=c=>(o.close(),s(l.error)),a.oncomplete=()=>o.close()}else{n.weightData=Li.join(n.weightData);const a=Vh(n),u=o.transaction(xa,"readwrite");let l=u.objectStore(xa),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return s(f)}let d;c.onsuccess=()=>{d=o.transaction(Wu,"readwrite");const f=d.objectStore(Wu);let h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return s(p)}h.onsuccess=()=>r({modelArtifactsInfo:a}),h.onerror=p=>{l=u.objectStore(xa);const y=l.delete(this.modelPath);y.onsuccess=()=>(o.close(),s(h.error)),y.onerror=b=>(o.close(),s(h.error))}},c.onerror=f=>(o.close(),s(c.error)),u.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}ll.URL_SCHEME="indexeddb://";const EO=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ll.URL_SCHEME)?y7(t.slice(ll.URL_SCHEME.length)):null;jt.registerSaveRouter(EO);jt.registerLoadRouter(EO);function y7(t){return new ll(t)}function b7(t){return t.startsWith(ll.URL_SCHEME)?t.slice(ll.URL_SCHEME.length):t}class v7{constructor(){this.indexedDB=AO()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(_v,Iv);r.onupgradeneeded=()=>kv(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(xa,"readonly"),a=i.objectStore(xa).getAll();a.onsuccess=()=>{const u={};for(const l of a.result)u[l.modelPath]=l.modelArtifactsInfo;e(u)},a.onerror=u=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=b7(e),new Promise((n,r)=>{const s=this.indexedDB.open(_v,Iv);s.onupgradeneeded=()=>kv(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(xa,"readwrite"),a=o.objectStore(xa),u=a.get(e);let l;u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{l=i.transaction(Wu,"readwrite");const h=l.objectStore(Wu).delete(e);h.onsuccess=()=>n(u.result.modelArtifactsInfo),h.onerror=p=>r(u.error)};c.onsuccess=d,c.onerror=f=>(d(),i.close(),r(u.error))}},u.onerror=c=>(i.close(),r(u.error)),o.oncomplete=()=>{l==null?i.close():l.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Po="/",ac="tensorflowjs_models",CO="info",w7="model_topology",x7="weight_specs",S7="weight_data",A7="model_metadata";function NO(t){return{info:[ac,t,CO].join(Po),topology:[ac,t,w7].join(Po),weightSpecs:[ac,t,x7].join(Po),weightData:[ac,t,S7].join(Po),modelMetadata:[ac,t,A7].join(Po)}}function TO(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function E7(t){const e=t.split(Po);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Po)}function C7(t){return t.startsWith(cl.URL_SCHEME)?t.slice(cl.URL_SCHEME.length):t}class cl{constructor(e){if(!X().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=NO(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Vh(e),i=Li.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,o7(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw TO(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=a7(o),n}}cl.URL_SCHEME="localstorage://";const _O=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(cl.URL_SCHEME)?N7(t.slice(cl.URL_SCHEME.length)):null;jt.registerSaveRouter(_O);jt.registerLoadRouter(_O);function N7(t){return new cl(t)}class T7{constructor(){R(X().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),R(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=ac+Po,r=Po+CO;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=E7(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=C7(e);const n=NO(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return TO(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fc="://";class tr{constructor(){this.managers={}}static getInstance(){return tr.instance==null&&(tr.instance=new tr),tr.instance}static registerManager(e,n){R(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Fc)&&(e=e.slice(0,e.indexOf(Fc))),R(e.length>0,()=>"scheme must not be an empty string.");const r=tr.getInstance();R(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=tr.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(tr.getInstance().managers)}}function km(t){if(t.indexOf(Fc)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${tr.getSchemes().join(",")}`);return{scheme:t.split(Fc)[0],path:t.split(Fc)[1]}}async function IO(t,e,n=!1){R(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=jt.getLoadHandlers(t);R(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),R(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],i=jt.getSaveHandlers(e);R(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),R(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],a=km(t).scheme,u=km(t).path,l=a===km(t).scheme,c=await s.load();n&&l&&await tr.getManager(a).removeModel(u);const d=await o.save(c);return n&&!l&&await tr.getManager(a).removeModel(u),d.modelArtifactsInfo}async function _7(){const t=tr.getSchemes(),e={};for(const n of t){const r=await tr.getManager(n).listModels();for(const s in r){const i=n+Fc+s;e[i]=r[s]}}return e}async function I7(t){const e=km(t);return tr.getManager(e.scheme).removeModel(e.path)}async function k7(t,e){return IO(t,e,!1)}async function R7(t,e){return IO(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P7{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!X().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return QP(e)}}if(X().get("IS_BROWSER")){X().setPlatform("browser",new P7);try{tr.registerManager(cl.URL_SCHEME,new T7)}catch{}try{tr.registerManager(ll.URL_SCHEME,new v7)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7={importFetch:()=>require("node-fetch")};let Ey;class D7{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return X().global.fetch!=null?X().global.fetch(e,n):(Ey==null&&(Ey=O7.importFetch()),Ey(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}X().get("IS_NODE")&&!X().get("IS_BROWSER")&&X().setPlatform("node",new D7);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e="float32",n){return e=e||"float32",bs(t),new nd(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(t,e){const n=T(t,"x","cast");if(!sz(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return W.runKernel(Lx,r,s)}const cn=B({cast_:L7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(t){const n={x:T(t,"x","clone","string_or_numeric")};return W.runKernel(Fx,n)}const Fa=B({clone_:F7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kO(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */fO();const $7={buffer:Ht,cast:cn,clone:Fa,print:kO};jz($7);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(t,e){let n=T(t,"a","add"),r=T(e,"b","add");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(Dx,s)}const ke=B({add_:B7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(t,e){let n=T(t,"a","floorDiv"),r=T(e,"b","floorDiv");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(aR,s)}const RO=B({floorDiv_:M7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(t,e){let n=T(t,"a","div"),r=T(e,"b","div");if([n,r]=en(n,r),n.dtype==="int32"&&r.dtype==="int32")return RO(n,r);const s={a:n,b:r},i={};return W.runKernel(X3,s,i)}const ut=B({div_:V7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t,e){let n=T(t,"a","mul"),r=T(e,"b","mul");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(MR,s)}const fe=B({mul_:U7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(t){const e=T(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return W.runKernel(k3,n)}else{const n={x:e};return W.runKernel(a3,n)}}const ns=B({abs_:z7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(t){const n={x:T(t,"x","acos")};return W.runKernel(u3,n)}const j7=B({acos_:W7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t){const n={x:T(t,"x","acosh")};return W.runKernel(l3,n)}const q7=B({acosh_:G7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(t){R(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),R(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,i)=>T(s,`tensors${i}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!qt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return W.runKernel(c3,r)}const K7=B({addN_:H7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(t,e=null,n=!1){const s={x:T(t,"x","all","bool")},i={axis:e,keepDims:n};return W.runKernel(d3,s,i)}const Y7=B({all_:X7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(t,e=null,n=!1){const s={x:T(t,"x","any","bool")},i={axis:e,keepDims:n};return W.runKernel(f3,s,i)}const PO=B({any_:Q7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(t,e=0){const r={x:T(t,"x","argMax")},s={axis:e};return W.runKernel(h3,r,s)}const OO=B({argMax_:Z7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(t,e=0){const r={x:T(t,"x","argMin")},s={axis:e};return W.runKernel(p3,r,s)}const DO=B({argMin_:J7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(t){const n={x:T(t,"x","asin")};return W.runKernel(m3,n)}const tW=B({asin_:eW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(t){const n={x:T(t,"x","asinh")};return W.runKernel(g3,n)}const rW=B({asinh_:nW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(t){const n={x:T(t,"x","atan")};return W.runKernel(y3,n)}const iW=B({atan_:sW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t,e){let n=T(t,"a","atan2"),r=T(e,"b","atan2");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(v3,s)}const aW=B({atan2_:oW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t){const n={x:T(t,"x","atanh")};return W.runKernel(b3,n)}const lW=B({atanh_:uW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],u=gd(s);return vs(t,a,n,i,r,null,null,u)}function El(t,e,n,r,s,i,o="channelsLast"){const[a,u]=gh(e);let l;if(o==="channelsLast")l=[a,u,t[3],t[3]];else if(o==="channelsFirst")l=[a,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return vs(t,l,n,r,s,i,!1,o)}function Uh(t,e,n,r,s,i,o="NDHWC"){const[a,u,l]=Rv(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[a,u,l,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[a,u,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return zh(t,c,n,r,s,!1,d,i)}function vs(t,e,n,r,s,i,o=!1,a="channelsLast"){let[u,l,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[u,l,c,d]=t;else if(a==="channelsFirst")[u,d,l,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,h,,p]=e,[y,b]=gh(n),[g,v]=gh(r),w=$c(f,g),x=$c(h,v),{padInfo:C,outHeight:k,outWidth:P}=fW(s,l,c,y,b,w,x,i,a),N=o?p*d:p;let $;return a==="channelsFirst"?$=[u,N,k,P]:a==="channelsLast"&&($=[u,k,P,N]),{batchSize:u,dataFormat:a,inHeight:l,inWidth:c,inChannels:d,outHeight:k,outWidth:P,outChannels:N,padInfo:C,strideHeight:y,strideWidth:b,filterHeight:f,filterWidth:h,effectiveFilterHeight:w,effectiveFilterWidth:x,dilationHeight:g,dilationWidth:v,inShape:t,outShape:$,filterShape:e}}function zh(t,e,n,r,s,i=!1,o="channelsLast",a){let[u,l,c,d,f]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[u,l,c,d,f]=t;else if(o==="channelsFirst")[u,f,l,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[h,p,y,,b]=e,[g,v,w]=Rv(n),[x,C,k]=Rv(r),P=$c(h,x),N=$c(p,C),$=$c(y,k),{padInfo:U,outDepth:K,outHeight:Z,outWidth:ie}=hW(s,l,c,d,g,v,w,P,N,$,a),ee=i?b*f:b;let j;return o==="channelsFirst"?j=[u,ee,K,Z,ie]:o==="channelsLast"&&(j=[u,K,Z,ie,ee]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:d,inChannels:f,outDepth:K,outHeight:Z,outWidth:ie,outChannels:ee,padInfo:U,strideDepth:g,strideHeight:v,strideWidth:w,filterDepth:h,filterHeight:p,filterWidth:y,effectiveFilterDepth:P,effectiveFilterHeight:N,effectiveFilterWidth:$,dilationDepth:x,dilationHeight:C,dilationWidth:k,inShape:t,outShape:j,filterShape:e}}function cW(t,e,n,r,s){r==null&&(r=Wx(t,e,n));const i=t[0],o=t[1],a=yh((i-e+2*r)/n+1,s),u=yh((o-e+2*r)/n+1,s);return[a,u]}function dW(t,e,n,r,s,i){s==null&&(s=Wx(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=yh((t[a]-e[a]+2*s)/r[a]+1,i));return o}function Wx(t,e,n,r=1){const s=$c(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function gh(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Rv(t){return typeof t=="number"?[t,t,t]:t}function $c(t,e){return e<=1?t:t+(t-1)*(e-1)}function fW(t,e,n,r,s,i,o,a,u){let l,c,d;if(typeof t=="number"){l={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=cW([e,n],i,r,t,a);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const f=Math.max(0,(c-1)*r+i-e),h=Math.max(0,(d-1)*s+o-n),p=Math.floor(f/2),y=f-p,b=Math.floor(h/2),g=h-b;l={top:p,bottom:y,left:b,right:g,type:"SAME"}}else if(t==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const f=u==="channelsLast"?t[1][0]:t[2][0],h=u==="channelsLast"?t[1][1]:t[2][1],p=u==="channelsLast"?t[2][0]:t[3][0],y=u==="channelsLast"?t[2][1]:t[3][1];l={top:f,bottom:h,left:p,right:y,type:f===0&&h===0&&p===0&&y===0?"VALID":"EXPLICIT"},c=yh((e-i+f+h)/r+1,a),d=yh((n-o+p+y)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:l,outHeight:c,outWidth:d}}function hW(t,e,n,r,s,i,o,a,u,l,c){let d,f,h,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const b=dW([e,n,r,1],[a,u,l],1,[s,i,o],t,c);f=b[0],h=b[1],p=b[2]}else if(t==="same"){f=Math.ceil(e/s),h=Math.ceil(n/i),p=Math.ceil(r/o);const y=(f-1)*s+a-e,b=(h-1)*i+u-n,g=(p-1)*o+l-r,v=Math.floor(y/2),w=y-v,x=Math.floor(b/2),C=b-x,k=Math.floor(g/2),P=g-k;d={top:x,bottom:C,left:k,right:P,front:v,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:h,outWidth:p}}function yh(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function bh(t){const[e,n,r]=gh(t);return e===1&&n===1&&r===1}function Hr(t,e){return bh(t)||bh(e)}function dl(t){return gh(t).every(e=>e>0)}function gd(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Js(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")R(Jc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{R(Jc(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(t,e){const r={x:T(t,"x","reshape","string_or_numeric")},s={shape:e};return W.runKernel(iP,r,s)}const te=B({reshape_:pW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(t,e,n,r,s){const i=T(t,"x","avgPool","float32"),o=1;R(Hr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,u=!1;i.rank===3&&(u=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2]])),R(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Js("avgPool",r,s);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=W.runKernel(w3,l,c);return d=cn(d,i.dtype),u?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const FO=B({avgPool_:mW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e,n,r,s,i="NDHWC"){const o=T(t,"x","avgPool3d","float32");let a=o,u=!1;o.rank===4&&(u=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),R(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),R(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Js("avgPool3d",r,s);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let d=W.runKernel(x3,l,c);return d=cn(d,a.dtype),u?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const yW=B({avgPool3d_:gW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(t,e=0){R(t.length>=1,()=>"Pass at least one tensor to concat");const n=I0(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Fa(n[0]);const r=n,s={axis:e};return W.runKernel(R3,r,s)}const dn=B({concat_:bW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t,e,n=!1,r=!1){let s=T(t,"a","matMul"),i=T(e,"b","matMul");[s,i]=en(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return W.runKernel(S3,o,a)}const bt=B({matMul_:vW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(t){const n={x:T(t,"x","sigmoid","float32")};return W.runKernel(xP,n)}const Bc=B({sigmoid_:wW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e,n){const r=T(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return W.runKernel(yP,s,i)}const Le=B({slice_:xW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(t){const n={x:T(t,"x","tanh","float32")};return W.runKernel(UP,n)}const Pv=B({tanh_:SW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t,e,n,r,s,i){const o=T(t,"forgetBias","basicLSTMCell"),a=T(e,"lstmKernel","basicLSTMCell"),u=T(n,"lstmBias","basicLSTMCell"),l=T(r,"data","basicLSTMCell"),c=T(s,"c","basicLSTMCell"),d=T(i,"h","basicLSTMCell"),f=dn([l,d],1),h=bt(f,a),p=ke(h,u),y=p.shape[0],b=p.shape[1]/4,g=[y,b],v=Le(p,[0,0],g),w=Le(p,[0,b],g),x=Le(p,[0,b*2],g),C=Le(p,[0,b*3],g),k=ke(fe(Bc(v),Pv(w)),fe(c,Bc(ke(o,x)))),P=fe(Pv(k),Bc(C));return[k,P]}const EW=B({basicLSTMCell_:AW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t,e,n){const r=T(t,"x","batchToSpaceND"),s=e.reduce((a,u)=>a*u);R(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),R(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),R(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return W.runKernel(A3,i,o)}const $O=B({batchToSpaceND_:CW});function NW(t){let e;return t.rank===0||t.rank===1?e=te(t,[1,1,1,t.size]):t.rank===2?e=te(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(t,e,n,r,s,i){i==null&&(i=.001);const o=T(t,"x","batchNorm"),a=T(e,"mean","batchNorm"),u=T(n,"variance","batchNorm");let l;s!=null&&(l=T(s,"scale","batchNorm"));let c;r!=null&&(c=T(r,"offset","batchNorm")),R(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:NW(o),scale:l,offset:c,mean:a,variance:u},h={varianceEpsilon:i},p=W.runKernel(uR,f,h);return te(p,o.shape)}const _g=B({batchNorm_:TW});function _W(t,e,n,r,s,i){const o=T(t,"x","batchNorm"),a=T(e,"mean","batchNorm"),u=T(n,"variance","batchNorm");let l;s!=null&&(l=T(s,"scale","batchNorm"));let c;return r!=null&&(c=T(r,"offset","batchNorm")),R(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),R(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),R(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),l!=null&&R(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),_g(o,a,u,c,l,i)}const IW=B({batchNorm2d_:_W});function kW(t,e,n,r,s,i){const o=T(t,"x","batchNorm"),a=T(e,"mean","batchNorm"),u=T(n,"variance","batchNorm");let l;s!=null&&(l=T(s,"scale","batchNorm"));let c;return r!=null&&(c=T(r,"offset","batchNorm")),R(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),R(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),R(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),l!=null&&R(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),_g(o,a,u,c,l,i)}const RW=B({batchNorm3d_:kW});function PW(t,e,n,r,s,i){const o=T(t,"x","batchNorm"),a=T(e,"mean","batchNorm"),u=T(n,"variance","batchNorm");let l;s!=null&&(l=T(s,"scale","batchNorm"));let c;return r!=null&&(c=T(r,"offset","batchNorm")),R(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),R(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),R(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),l!=null&&R(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),_g(o,a,u,c,l,i)}const OW=B({batchNorm4d_:PW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t,e,n){const r=T(t,"x","bincount"),s=T(e,"weights","bincount");R(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return W.runKernel(E3,i,o)}const BO=B({bincount_:DW});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e){const n=T(t,"x","bitwiseAnd"),r=T(e,"y","bitwiseAnd");if(!qt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return W.runKernel(C3,s)}const FW=B({bitwiseAnd_:LW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t,e){const n=T(t,"s0","broadcastArgs","int32"),r=T(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return W.runKernel(N3,s)}const BW=B({broadcastArgs_:$W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t,e){let n=T(t,"broadcastTo","x");const r=n.shape;if(bs(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const l=n.shape.slice();for(;l.length<e.length;)l.unshift(1);n=te(n,l)}const s=n.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(s[l]===e[l])i[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return Fa(n);const a={x:n},u={reps:i};return W.runKernel($x,a,u)}const jf=B({broadcastTo_:MW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(t){const n={x:T(t,"x","ceil","float32")};return W.runKernel(T3,n)}const UW=B({ceil_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wh(t,e,n){bs(t),n=n||Mh(e);const r={shape:t,value:e,dtype:n};return W.runKernel(sR,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e,n){const r=T(t,"x","clipByValue");if(R(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Wh(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return W.runKernel(_3,s,i)}const WW=B({clipByValue_:zW});function jW(t){return dn(t,0)}const GW=B({concat1d_:jW});function qW(t,e){return dn(t,e)}const HW=B({concat2d_:qW});function KW(t,e){return dn(t,e)}const XW=B({concat3d_:KW});function YW(t,e){return dn(t,e)}const QW=B({concat4d_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n,r,s="NHWC",i=[1,1],o){const a=T(t,"x","conv2d","float32"),u=T(e,"filter","conv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),R(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Js("conv2d",r,o);const d=s==="NHWC"?l.shape[3]:l.shape[1];R(d===u.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${u.shape[2]}.`),R(Hr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),R(dl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),R(dl(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:l,filter:u},h={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=W.runKernel(P3,f,h);return c?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Ig=B({conv2d_:ZW});function JW(t,e,n,r,s="NWC",i=1,o){const a=T(t,"x","conv1d"),u=T(e,"filter","conv1d");let l=a,c=!1;a.rank===2&&(c=!0,l=te(a,[1,a.shape[0],a.shape[1]])),R(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),R(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Js("conv1d",r,o),R(l.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${u.shape[1]}.`),R(Hr(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),R(dl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),R(dl(n),()=>"Error in conv1D: Stride should be larger than 0."),R(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=te(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=te(l,[l.shape[0],1,l.shape[1],l.shape[2]]),b=Ig(f,d,[1,n],r,"NHWC",[1,i],o);return c?te(b,[b.shape[2],b.shape[3]]):te(b,[b.shape[0],b.shape[2],b.shape[3]])}const e9=B({conv1d_:JW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t,e,n,r,s,i="NHWC",o){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,u=e,l=!1;e.rank===3&&(l=!0,u=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),R(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),R(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),R(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?u.shape[3]:u.shape[1];R(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),R(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Js("conv2dDerInput",s,o);const f={dy:u,filter:n},h={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},p=W.runKernel(D3,f,h);return l?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const MO=B({conv2DBackpropInput_:t9});function n9(t,e,n,r,s,i){const o=T(t,"x","conv2dTranspose"),a=T(e,"filter","conv2dTranspose");return MO(n,o,a,r,s,"NHWC",i)}const r9=B({conv2dTranspose_:n9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=T(t,"x","conv3d"),a=T(e,"filter","conv3d");let u=o,l=!1;o.rank===4&&(l=!0,u=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),R(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),R(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),R(Hr(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),R(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),R(dl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),R(dl(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:u,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:i},f=W.runKernel(L3,c,d);return l?te(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const i9=B({conv3d_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t,e,n,r,s){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const u=i[4],l=o.shape[4];R(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),R(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),R(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),R(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),R(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:s,strides:r,inputShape:i},f=W.runKernel(F3,c,d);return a?te(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const a9=B({conv3DBackpropInput_:o9});function u9(t,e,n,r,s){const i=T(t,"x","conv3dTranspose"),o=T(e,"filter","conv3dTranspose");return a9(n,i,o,r,s)}const l9=B({conv3dTranspose_:u9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(t){const n={x:T(t,"x","cos","float32")};return W.runKernel($3,n)}const d9=B({cos_:c9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(t){const n={x:T(t,"x","cosh","float32")};return W.runKernel(B3,n)}const h9=B({cosh_:f9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(t,e=0,n=!1,r=!1){const i={x:T(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return W.runKernel(M3,i,o)}const m9=B({cumprod_:p9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(t,e=0,n=!1,r=!1){const i={x:T(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return W.runKernel(V3,i,o)}const y9=B({cumsum_:g9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(t,e,n,r=!1){const s=T(t,"x","denseBincount"),i=T(e,"weights","denseBincount");R(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),R(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return W.runKernel(z3,o,a)}const v9=B({denseBincount_:b9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(t,e,n="NHWC"){const r=T(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];R(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),R(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),R(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),R(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},u={blockSize:e,dataFormat:n};return W.runKernel(W3,a,u)}const x9=B({depthToSpace_:w9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(t,e,n,r,s="NHWC",i=[1,1],o){const a=T(t,"x","depthwiseConv2d","float32"),u=T(e,"filter","depthwiseConv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),R(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const d=s==="NHWC"?l.shape[3]:l.shape[1];R(d===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${u.shape[2]}.`),Js("depthwiseConv2d",r,o);const f={x:l,filter:u},h={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},p=W.runKernel(j3,f,h);return c?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const jx=B({depthwiseConv2d_:S9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(t){const n={x:T(t,"x","diag")};return W.runKernel(H3,n)}const E9=B({diag_:A9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(t,e,n,r,s=[1,1],i="NHWC"){const o=T(t,"x","dilation2d"),a=T(e,"filter","dilation2d");R(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),R(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),R(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let u=o,l=!1;o.rank===3&&(u=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0),R(u.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${a.shape[2]}`);const c={x:u,filter:a},d={strides:n,pad:r,dilations:s},f=W.runKernel(K3,c,d);return l?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const N9=B({dilation2d_:C9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function VO(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function st(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(t,e){let n=T(t,"a","equal","string_or_numeric"),r=T(e,"b","equal","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(J3,s)}const UO=B({equal_:T9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(t,e,n){const r=T(e,"a","where"),s=T(n,"b","where"),i=T(t,"condition","where","bool"),o=st(st(i.shape,r.shape),s.shape),a=jf(i,o),u=jf(r,o),l=jf(s,o),c={condition:a,t:u,e:l};return W.runKernel(mP,c)}const $o=B({where_:_9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(t){const n={x:T(t,"x","zerosLike")};return W.runKernel(HP,n)}const ls=B({zerosLike_:I9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(t,e){let n=T(t,"a","div"),r=T(e,"b","div");[n,r]=en(n,r);const s=ut(n,r),i=ls(s),o=UO(r,i);return $o(o,i,s)}const R9=B({divNoNan_:k9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(t,e){const n=T(t,"t1","dot"),r=T(e,"t2","dot");R((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(R(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=te(n,[1,-1]),a=te(r,[-1,1]),u=bt(o,a);return te(u,[])}else if(n.rank===1&&r.rank===2){const o=te(n,[1,-1]),a=te(r,[r.shape[0],r.shape[1]]),u=bt(o,a);return te(u,[u.size])}else if(n.rank===2&&r.rank===1){const o=te(r,[-1,1]),a=bt(n,o);return te(a,[a.size])}else{const o=te(r,[r.shape[0],r.shape[1]]);return bt(n,o)}}const O9=B({dot_:P9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(t,...e){const n=e.map((s,i)=>T(s,`tensors${i}`,"einsum")),r={equation:t};return W.runKernel(Y3,n,r)}const uc=B({einsum_:D9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(t){const n={x:T(t,"x","elu","float32")};return W.runKernel(Q3,n)}const zO=B({elu_:L9});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(t,e){const n=T(t,"x","ensureShape","string_or_numeric");if(!tz(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const $9=B({ensureShape_:F9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(t){let e=T(t,"x","erf");R(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=cn(e,"float32"));const n={x:e};return W.runKernel(Z3,n)}const M9=B({erf_:B9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function WO(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function co(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function ws(t,e){const n=e.map(r=>1);return WO(t,n,e)}function Fi(t,e,n){R(Gx(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function ei(t,e){if(Gx(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function qx(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function ti(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(t,e=null,n=!1){const s={x:T(t,"x","max")},i={reductionIndices:e,keepDims:n};return W.runKernel(_R,s,i)}const Ku=B({max_:V9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(t,e=null,n=!1){const s={x:T(t,"x","min")},i={axis:e,keepDims:n};return W.runKernel(DR,s,i)}const Ov=B({min_:U9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(t,e){let n=T(t,"base","pow"),r=T(e,"exp","pow");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(XR,s)}const vh=B({pow_:z9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ye(t,e){if((Qs(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Qs(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ja(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(t){const n={x:T(t,"x","sqrt","float32")};return W.runKernel(AP,n)}const Go=B({sqrt_:W9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(t){const e=T(t,"x","square"),n={};return W.runKernel("Square",{x:e},n)}const Hs=B({square_:j9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(t,e=null,n=!1){let r=T(t,"x","sum");r.dtype==="bool"&&(r=cn(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return W.runKernel(EP,s,i)}const Rt=B({sum_:G9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(t,e="euclidean",n=null,r=!1){t=T(t,"x","norm");const s=jO(t,e,n);let i=s.shape;if(r){const o=An(n,t.shape);i=ws(s.shape,o)}return te(s,i)}function jO(t,e,n=null){if(t.rank===0)return ns(t);if(t.rank!==1&&n===null)return jO(te(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Rt(ns(t),n);if(e===1/0)return Ku(ns(t),n);if(e===-1/0)return Ov(ns(t),n);if(e==="euclidean"||e===2)return Go(Rt(vh(ns(t),Ye(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Ku(Rt(ns(t),n[0]),n[1]-1);if(e===1/0)return Ku(Rt(ns(t),n[1]),n[0]);if(e===-1/0)return Ov(Rt(ns(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Go(Rt(Hs(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const kg=B({norm_:q9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(t,e=null,n=!1){return kg(t,"euclidean",e,n)}const K9=B({euclideanNorm_:H9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(t){const n={x:T(t,"x","exp")};return W.runKernel(eR,n)}const fl=B({exp_:X9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(t,e=0){const n=T(t,"x","expandDims","string_or_numeric");R(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return W.runKernel(tR,r,s)}const ss=B({expandDims_:Y9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(t){const n={x:T(t,"x","expm1")};return W.runKernel(nR,n)}const Z9=B({expm1_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(t,e){const n=T(t,"x","tile","string_or_numeric");R(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return W.runKernel($x,r,s)}const Gf=B({tile_:J9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(t,e,n,r="float32"){e==null&&(e=t);const s=Ht([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=te(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Gf(ss(o,0),[n[0],1,1]);if(n.length===2)return Gf(ss(ss(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Gf(ss(ss(ss(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const GO=B({eye_:ej});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(t){const n={x:T(t,"x","floor","float32")};return W.runKernel(oR,n)}const qO=B({floor_:tj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(t,e,n=0,r=0){const s=T(t,"x","gather"),i=T(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return W.runKernel(lR,o,a)}const R0=B({gather_:nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(t,e){let n=T(t,"a","greater","string_or_numeric"),r=T(e,"b","greater","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(dR,s)}const Rg=B({greater_:rj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(t,e){let n=T(t,"a","greaterEqual","string_or_numeric"),r=T(e,"b","greaterEqual","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(fR,s)}const HO=B({greaterEqual_:sj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ij(t){const n={input:T(t,"input","imag")};return W.runKernel(pR,n)}const Pg=B({imag_:ij});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oj(t){const n={x:T(t,"x","isFinite")};return W.runKernel(mR,n)}const aj=B({isFinite_:oj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uj(t){const n={x:T(t,"x","isInf")};return W.runKernel(gR,n)}const lj=B({isInf_:uj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(t){const n={x:T(t,"x","isNaN")};return W.runKernel(yR,n)}const dj=B({isNaN_:cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fj(t,e=.2){const r={x:T(t,"x","leakyRelu")},s={alpha:e};return W.runKernel(bR,r,s)}const KO=B({leakyRelu_:fj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(t,e){let n=T(t,"a","less","string_or_numeric"),r=T(e,"b","less","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(vR,s)}const P0=B({less_:hj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pj(t,e){let n=T(t,"a","lessEqual","string_or_numeric"),r=T(e,"b","lessEqual","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(wR,s)}const Hx=B({lessEqual_:pj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return W.runKernel(xR,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(t,e=5,n=1,r=1,s=.5){const i=T(t,"x","localResponseNormalization");R(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),R(Jc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={x:o},l={depthRadius:e,bias:n,alpha:r,beta:s},c=W.runKernel(TR,u,l);return a?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const yj=B({localResponseNormalization_:gj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(t){const n={x:T(t,"x","log","float32")};return W.runKernel(SR,n)}const wh=B({log_:bj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(t){const n={x:T(t,"x","log1p")};return W.runKernel(AR,n)}const XO=B({log1p_:vj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wj(t,e){R(fv(t),()=>"The f passed in variableGrads(f) must be a function"),R(e==null||Array.isArray(e)&&e.every(l=>l instanceof _0),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const l in W.registeredVariables)e.push(W.registeredVariables[l])}const r=n?e.filter(l=>!l.trainable):null,s=e.length;e=e.filter(l=>l.trainable),R(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=W.gradients(t,e,null,i);R(a.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),R(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return e.forEach((l,c)=>{a[c]!=null&&(u[l.name]=a[c])}),r!=null&&r.forEach(l=>u[l.name]=null),{value:o,grads:u}}function qo(t){return W.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(t){const n={x:T(t,"x","neg")};return W.runKernel(VR,n)}const oo=B({neg_:xj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(t){const n={x:T(t,"x","softplus")};return W.runKernel(SP,n)}const YO=B({softplus_:Sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(t){const e=T(t,"x","logSigmoid");return qo(r=>({value:oo(YO(oo(r))),gradFunc:o=>fe(o,Bc(oo(r)))}))(e)}const Ej=B({logSigmoid_:Aj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj(t,e){let n=T(t,"a","sub"),r=T(e,"b","sub");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel(MP,s)}const Oe=B({sub_:Cj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(t,e=-1){const n=T(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return qo((s,i)=>{const a=Ku(s,e,!0),u=Oe(s,a),l=Oe(cn(u,"float32"),wh(Rt(fl(u),e,!0)));return i([l]),{value:l,gradFunc:(d,f)=>{const[h]=f,p=!0,y=fl(h);return Oe(d,fe(Rt(d,e,p),y))}}})(n)}const Tj=B({logSoftmax_:Nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _j(t,e=null,n=!1){const r=T(t,"x","logSumExp"),s=An(e,r.shape),i=Ku(r,s,!0),o=Oe(r,i),a=fl(o),u=Rt(a,s),l=wh(u),c=ke(te(i,l.shape),l);if(n){const d=ws(c.shape,s);return te(c,d)}return c}const QO=B({logSumExp_:_j});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(t,e){const n=T(t,"a","logicalAnd","bool"),r=T(e,"b","logicalAnd","bool");st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(ER,s)}const O0=B({logicalAnd_:Ij});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(t){const n={x:T(t,"x","logicalNot","bool")};return W.runKernel(CR,n)}const ZO=B({logicalNot_:kj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rj(t,e){const n=T(t,"a","logicalOr","bool"),r=T(e,"b","logicalOr","bool");st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(NR,s)}const JO=B({logicalOr_:Rj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj(t,e){const n=T(t,"a","logicalXor","bool"),r=T(e,"b","logicalXor","bool");return st(n.shape,r.shape),O0(JO(t,e),ZO(O0(t,e)))}const Oj=B({logicalXor_:Pj});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vp=2147483648;function Dj(t,e,n="left"){const r=T(t,"sortedSequence","searchSorted"),s=T(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=s.shape[s.shape.length-1],a=te(r,[-1,i]),u=te(s,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(de(u.shape)>=Vp)throw new Error(`values tensor size must less than ${Vp}`);if(a.shape[1]>=Vp)throw new Error(`trailing dim_size must less than ${Vp} for int32 output type, was ${a.shape[1]}`);const l={sortedSequence:a,values:u},c={side:n};return W.runKernel(pP,l,c)}const Kx=B({searchSorted_:Dj});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(t,e){return Kx(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(t,e,n,r,s){const i=T(t,"x","maxPool"),o=1;let a=i,u=!1;i.rank===3&&(u=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2]])),R(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),R(Hr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Js("maxPool",r,s);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=W.runKernel(kR,l,c);return u?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const e4=B({maxPool_:Fj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $j(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=T(t,"x","maxPool3d");let a=o,u=!1;o.rank===4&&(u=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),R(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Js("maxPool3d",r,s);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},d=W.runKernel(RR,l,c);return u?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Bj=B({maxPool3d_:$j});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mj(t,e,n,r,s=!1){const o={x:T(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},u=W.runKernel(PR,o,a);return{result:u[0],indexes:u[1]}}const Vj=B({maxPoolWithArgmax_:Mj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uj(t,e){let n=T(t,"a","maximum"),r=T(e,"b","maximum");[n,r]=en(n,r),n.dtype==="bool"&&(n=cn(n,"int32"),r=cn(r,"int32")),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(IR,s)}const t4=B({maximum_:Uj});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zj(t,e=null,n=!1){const s={x:T(t,"x","mean")},i={axis:e,keepDims:n};return W.runKernel(OR,s,i)}const D0=B({mean_:zj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ga(t,e="float32"){if(bs(t),e==="complex64"){const r=Ga(t,"float32"),s=Ga(t,"float32");return Wa(r,s)}const n=za(de(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ju(t,e="float32"){if(bs(t),e==="complex64"){const r=ju(t,"float32"),s=Ga(t,"float32");return Wa(r,s)}const n=s3(de(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=T(t,"x","meshgrid",t instanceof or?t.dtype:"float32");if(e===void 0)return[r];let s=T(e,"y","meshgrid",e instanceof or?e.dtype:"float32");const i=de(r.shape),o=de(s.shape);return n==="xy"?(r=te(r,[1,-1]),s=te(s,[-1,1]),[bt(ju([o,1],r.dtype),r),bt(s,ju([1,i],s.dtype))]):(r=te(r,[-1,1]),s=te(s,[1,-1]),[bt(r,ju([1,o],r.dtype)),bt(ju([i,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jj(t,e){let n=T(t,"a","minimum"),r=T(e,"b","minimum");[n,r]=en(n,r),n.dtype==="bool"&&(n=cn(n,"int32"),r=cn(r,"int32")),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(LR,s)}const L0=B({minimum_:jj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gj(t,e,n){R(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=T(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");R(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)R(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),R(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return W.runKernel(FR,o,i)}const qj=B({mirrorPad_:Gj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hj(t,e){let n=T(t,"a","mod"),r=T(e,"b","mod");[n,r]=en(n,r);const s={a:n,b:r};return W.runKernel($R,s)}const Kj=B({mod_:Hj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xj(t,e=null,n=!1){t=T(t,"x","moments");const r=An(e,t.shape),s=D0(t,r,n);let i=s.shape;n||(i=ws(s.shape,r));const o=Hs(Oe(cn(t,"float32"),te(s,i))),a=D0(o,r,n);return{mean:s,variance:a}}const Yj=B({moments_:Xj});function Qj(t,e,n,r){const s=T(e,"data","multiRNNCell"),i=I0(n,"c","multiRNNCell"),o=I0(r,"h","multiRNNCell");let a=s;const u=[];for(let d=0;d<t.length;d++){const f=t[d](a,i[d],o[d]);u.push(f[0]),u.push(f[1]),a=f[1]}const l=[],c=[];for(let d=0;d<u.length;d+=2)l.push(u[d]),c.push(u[d+1]);return[l,c]}const Zj=B({multiRNNCell_:Qj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(t,e,n,r=!1){const s=T(t,"logits","multinomial"),i=s.size,o=s.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const u={logits:o===1?te(s,[1,-1]):s},l={numSamples:e,seed:n,normalized:r},c=W.runKernel(BR,u,l);return o===1?te(c,[c.size]):c}const eG=B({multinomial_:Jj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(t,e){let n=T(t,"a","notEqual","string_or_numeric"),r=T(e,"b","notEqual","string_or_numeric");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r};return W.runKernel(UR,s)}const n4=B({notEqual_:tG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:T(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return W.runKernel(qR,o,a)}const rG=B({oneHot_:nG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(t){const n={x:T(t,"x","onesLike")};return W.runKernel(GR,n)}const iG=B({onesLike_:sG});function oG(t,e){const n=T(t,"v1","outerProduct"),r=T(e,"v2","outerProduct");R(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=te(n,[-1,1]),i=te(r,[1,-1]);return bt(s,i)}const aG=B({outerProduct_:oG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t,e,n=0){const r=T(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return W.runKernel(KR,i,s)}const yd=B({pad_:uG});function lG(t,e,n=0){return R(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),yd(t,[e],n)}const cG=B({pad1d_:lG});function dG(t,e,n=0){return R(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),yd(t,e,n)}const fG=B({pad2d_:dG});function hG(t,e,n=0){return R(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),yd(t,e,n)}const pG=B({pad3d_:hG});function mG(t,e,n=0){return R(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),yd(t,e,n)}const gG=B({pad4d_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(t,e,n){const r=T(t,"x","spaceToBatchND");R(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),R(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),R(r.shape.reduce((o,a,u)=>u>0&&u<=e.length?o&&(a+n[u-1][0]+n[u-1][1])%e[u-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return W.runKernel(CP,s,i)}const r4=B({spaceToBatchND_:yG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=T(t,"x","maxPool");let u=a,l=!1;a.rank===3&&(l=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(Hr(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const c=El(u.shape,e,i,s,r),d=[c.dilationHeight,c.dilationWidth];let f;r==="same"?f=wG([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[p,y]=vG([c.inHeight,c.inWidth],d,f),b=h?r:"valid",g=h?u:r4(u,d,p),w=(n==="avg"?()=>FO(g,e,i,b,o):()=>e4(g,e,i,b,o))(),x=h?w:$O(w,d,y);return l?te(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function vG(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),i=t.concat(r,s),o=e.map((c,d)=>(c-i[d]%c)%c),a=s.map((c,d)=>c+o[d]),u=e.map((c,d)=>[r[d],a[d]]),l=e.map((c,d)=>[0,o[d]]);return[u,l]}function wG(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const xG=B({pool_:bG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(t,e){const n=T(t,"x","prelu"),r=T(e,"alpha","prelu"),s={x:n,alpha:r};return W.runKernel(YR,s)}const s4=B({prelu_:SG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t,e=null,n=!1){let r=T(t,"x","prod");r.dtype==="bool"&&(r=cn(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return W.runKernel(QR,s,i)}const EG=B({prod_:AG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(t,e,n,r){const s=t.map((c,d)=>T(c,`tensors${d}`,"raggedGather","int32")),i=T(e,"paramsDenseValues","raggedGather"),o=T(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:i,indices:o},u={outputRaggedRank:r},l=W.runKernel(ZR,a,u);return{outputNestedSplits:l.slice(0,l.length-1),outputDenseValues:l[l.length-1]}}const NG=B({raggedGather_:CG});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(t,e,n){const r=T(t,"starts","raggedRange"),s=T(e,"limits","raggedRange",r.dtype),i=T(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:s,deltas:i},a=W.runKernel(JR,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const _G=B({raggedRange_:TG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(t,e,n,r,s){const i=T(t,"shape","raggedTensorToTensor","int32"),o=T(e,"values","raggedTensorToTensor"),a=T(n,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((d,f)=>T(d,`tensors${f}`,"raggedTensorToTensor","int32")),l={shape:i,values:o,defaultValue:a,rowPartitionTensors:u},c={rowPartitionTypes:s};return W.runKernel(eP,l,c)}const kG=B({raggedTensorToTensor_:IG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e,n){bs(t);const r=de(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)s[i]=e();return W.makeTensor(s,t,n)}const PG=B({rand_:RG});var Xx={exports:{}};Xx.exports;(function(t){(function(e,n,r){function s(u){var l=this,c=a();l.next=function(){var d=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=d|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function i(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function o(u,l){var c=new s(u),d=l&&l.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&i(d,c),f.state=function(){return i(c,{})}),f}function a(){var u=4022871197,l=function(c){c=String(c);for(var d=0;d<c.length;d++){u+=c.charCodeAt(d);var f=.02519603282416938*u;u=f>>>0,f-=u,f*=u,u=f>>>0,f-=u,u+=f*4294967296}return(u>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=o:this.alea=o})(Ot,t)})(Xx);var OG=Xx.exports,Yx={exports:{}};Yx.exports;(function(t){(function(e,n,r){function s(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function i(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function o(a,u){var l=new s(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Ot,t)})(Yx);var DG=Yx.exports,Qx={exports:{}};Qx.exports;(function(t){(function(e,n,r){function s(a){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(d^d<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function o(a,u){var l=new s(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Ot,t)})(Qx);var LG=Qx.exports,Zx={exports:{}};Zx.exports;(function(t){(function(e,n,r){function s(a){var u=this;u.next=function(){var c=u.x,d=u.i,f,h;return f=c[d],f^=f>>>7,h=f^f<<24,f=c[d+1&7],h^=f^f>>>10,f=c[d+3&7],h^=f^f>>>3,f=c[d+4&7],h^=f^f<<7,f=c[d+7&7],f=f^f<<13,h^=f^f<<9,c[d]=h,u.i=d+1&7,h};function l(c,d){var f,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,f=0;f<d.length;++f)h[f&7]=h[f&7]<<15^d.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],c.x=h,c.i=0,f=256;f>0;--f)c.next()}l(u,a)}function i(a,u){return u.x=a.x.slice(),u.i=a.i,u}function o(a,u){a==null&&(a=+new Date);var l=new s(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Ot,t)})(Zx);var FG=Zx.exports,Jx={exports:{}};Jx.exports;(function(t){(function(e,n,r){function s(a){var u=this;u.next=function(){var c=u.w,d=u.X,f=u.i,h,p;return u.w=c=c+1640531527|0,p=d[f+34&127],h=d[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=d[f]=p^h,u.i=f,p+(c^c>>>16)|0};function l(c,d){var f,h,p,y,b,g=[],v=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,v=Math.max(v,d.length)),p=0,y=-32;y<v;++y)d&&(h^=d.charCodeAt((y+32)%d.length)),y===0&&(b=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,y>=0&&(b=b+1640531527|0,f=g[y&127]^=h+b,p=f==0?p+1:0);for(p>=128&&(g[(d&&d.length||0)&127]=-1),p=127,y=4*128;y>0;--y)h=g[p+34&127],f=g[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,g[p]=h^f;c.w=b,c.X=g,c.i=p}l(u,a)}function i(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function o(a,u){a==null&&(a=+new Date);var l=new s(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Ot,t)})(Jx);var $G=Jx.exports,e2={exports:{}};e2.exports;(function(t){(function(e,n,r){function s(a){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=a|0):l+=a;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function i(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function o(a,u){var l=new s(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Ot,t)})(e2);var BG=e2.exports,i4={exports:{}};const MG={},VG=Object.freeze(Object.defineProperty({__proto__:null,default:MG},Symbol.toStringTag,{value:"Module"})),UG=s_(VG);(function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",u=r.pow(s,i),l=r.pow(2,o),c=l*2,d=s-1,f;function h(x,C,k){var P=[];C=C==!0?{entropy:!0}:C||{};var N=g(b(C.entropy?[x,w(n)]:x??v(),3),P),$=new p(P),U=function(){for(var K=$.g(i),Z=u,ie=0;K<l;)K=(K+ie)*s,Z*=s,ie=$.g(1);for(;K>=c;)K/=2,Z/=2,ie>>>=1;return(K+ie)/Z};return U.int32=function(){return $.g(4)|0},U.quick=function(){return $.g(4)/4294967296},U.double=U,g(w($.S),n),(C.pass||k||function(K,Z,ie,ee){return ee&&(ee.S&&y(ee,$),K.state=function(){return y($,{})}),ie?(r[a]=K,Z):K})(U,N,"global"in C?C.global:this==r,C.state)}function p(x){var C,k=x.length,P=this,N=0,$=P.i=P.j=0,U=P.S=[];for(k||(x=[k++]);N<s;)U[N]=N++;for(N=0;N<s;N++)U[N]=U[$=d&$+x[N%k]+(C=U[N])],U[$]=C;(P.g=function(K){for(var Z,ie=0,ee=P.i,j=P.j,M=P.S;K--;)Z=M[ee=d&ee+1],ie=ie*s+M[d&(M[ee]=M[j=d&j+Z])+(M[j]=Z)];return P.i=ee,P.j=j,ie})(s)}function y(x,C){return C.i=x.i,C.j=x.j,C.S=x.S.slice(),C}function b(x,C){var k=[],P=typeof x,N;if(C&&P=="object")for(N in x)try{k.push(b(x[N],C-1))}catch{}return k.length?k:P=="string"?x:x+"\0"}function g(x,C){for(var k=x+"",P,N=0;N<k.length;)C[d&N]=d&(P^=C[d&N]*19)+k.charCodeAt(N++);return w(C)}function v(){try{var x;return f&&(x=f.randomBytes)?x=x(s):(x=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(x)),w(x)}catch{var C=e.navigator,k=C&&C.plugins;return[+new Date,e,k,e.screen,w(n)]}}function w(x){return String.fromCharCode.apply(0,x)}if(g(r.random(),n),t.exports){t.exports=h;try{f=UG}catch{}}else r["seed"+a]=h})(typeof self<"u"?self:Ot,[],Math)})(i4);var zG=i4.exports,WG=OG,jG=DG,GG=LG,qG=FG,HG=$G,KG=BG,Cl=zG;Cl.alea=WG;Cl.xor128=jG;Cl.xorwow=GG;Cl.xorshift7=qG;Cl.xor4096=HG;Cl.tychei=KG;var t2=Cl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n2{constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=t2.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class XG{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const i=s||Math.random();this.randu=t2.alea(i.toString()),this.randn=new n2(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,i,o;for(;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class YG{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=t2.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(t,e,n=1,r="float32",s){if(bs(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new XG(e,n,r,s),o=Ht(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const ZG=B({randomGamma_:QG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(t,e=0,n=1,r,s){if(bs(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new n2(e,n,r,!1,s),o=Ht(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const o4=B({randomNormal_:JG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return o4(t,0,1,e,n)}const tq=B({randomStandardNormal_:eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(t,e=0,n=1,r="float32",s){bs(t);const i=Ht(t,r),o=new YG(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const r2=B({randomUniform_:nq});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(t,e,n,r){return r2(t,e,n,"int32",r)}const sq=B({randomUniformInt_:rq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xh(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return W.runKernel(tP,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(t){const n={input:T(t,"input","real")};return W.runKernel(nP,n)}const Sh=B({real_:iq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){const n={x:T(t,"x","reciprocal")};return W.runKernel(rP,n)}const aq=B({reciprocal_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t){const n={x:T(t,"x","relu")};return W.runKernel(sP,n)}const Og=B({relu_:uq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(t){const n={x:T(t,"x","relu6")};return W.runKernel(uP,n)}const a4=B({relu6_:lq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e){const r={x:T(t,"x","reverse")},s={dims:e};return W.runKernel(lP,r,s)}const hl=B({reverse_:cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const e=T(t,"x","reverse");return R(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),hl(e,0)}const fq=B({reverse1d_:dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(t,e){const n=T(t,"x","reverse");return R(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),hl(n,e)}const pq=B({reverse2d_:hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(t,e){const n=T(t,"x","reverse");return R(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),hl(n,e)}const gq=B({reverse3d_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yq(t,e){const n=T(t,"x","reverse");return R(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),hl(n,e)}const bq=B({reverse4d_:yq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t){const n={x:T(t,"x","round")};return W.runKernel(cP,n)}const u4=B({round_:vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(t){const n={x:T(t,"x","rsqrt","float32")};return W.runKernel(dP,n)}const xq=B({rsqrt_:wq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t){const n={x:T(t,"x","selu")};return W.runKernel(gP,n)}const Aq=B({selu_:Sq});function Eq(t,e,n,r,s,i=[1,1],o="NHWC"){const a=T(t,"x","separableConv2d"),u=T(e,"depthwiseFilter","separableConv2d"),l=T(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");R(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),R(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),R(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),R(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),R(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const f=u.shape[2],h=u.shape[3];R(l.shape[2]===f*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*h}, but got ${l.shape[2]}.`);const p=jx(c,u,r,s,o,i),b=Ig(p,l,1,"valid",o);return d?te(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const Cq=B({separableConv2d_:Eq});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Nq(t,e){const n=T(t,"x","setdiff1d"),r=T(e,"y","setdiff1d");R(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),R(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),R(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),i=await r.data(),o=new Set(i);let a=0;for(let c=0;c<s.length;c++)o.has(s[c])||a++;const u=new nd([a],n.dtype),l=new nd([a],"int32");for(let c=0,d=0;c<s.length;c++)o.has(s[c])||(u.values[d]=s[c],l.values[d]=c,d++);return[u.toTensor(),l.toTensor()]}const Tq=Nq;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q(t){const n={x:T(t,"x","sign")};return W.runKernel(wP,n)}const Iq=B({sign_:_q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(t){const n={x:T(t,"x","sin","float32")};return W.runKernel(bP,n)}const Rq=B({sin_:kq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t){const n={x:T(t,"x","sinh")};return W.runKernel(vP,n)}const Oq=B({sinh_:Pq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t,e,n){const r=T(t,"x","slice1d");return R(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Le(r,[e],[n])}const Lq=B({slice1d_:Dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(t,e,n){const r=T(t,"x","slice2d");return R(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const $q=B({slice2d_:Fq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(t,e,n){const r=T(t,"x","slice3d");return R(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const Mq=B({slice3d_:Bq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(t,e,n){const r=T(t,"x","slice4d");return R(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const Uq=B({slice4d_:Vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t,e=-1){const n=T(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return W.runKernel(TP,r,s)}const Wq=B({softmax_:zq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(rR,e)}const s2=B({fft_:jq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(hR,e)}const F0=B({ifft_:Gq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=te(t,[n,e]);r=F0(s)}else{const s=[n,2*(e-1)],i=te(Sh(t),[n,e]),o=te(Pg(t),[n,e]),a=hl(Le(i,[0,1],[n,e-2]),1),u=fe(hl(Le(o,[0,1],[n,e-2]),1),Ye(-1)),l=dn([i,a],1),c=dn([o,u],1),d=te(Wa(l,c),[s[0],s[1]]);r=F0(d)}if(r=Sh(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=te(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const l4=B({irfft_:qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hq(t,e,n=0){const s={x:T(t,"x","split")},i={numOrSizeSplits:e,axis:n};return W.runKernel(NP,s,i)}const Ah=B({split_:Hq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq(t,e){R(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const p=t.shape.map(b=>0),y=t.shape.map(b=>b);y[t.shape.length-1]=e,s=Le(t,p,y),n=e}else if(e!=null&&e>n){const p=t.shape.map(y=>y);p[t.shape.length-1]=e-n,s=dn([t,Ga(p)],t.shape.length-1),n=e}else s=t;const i=ls(s),o=te(Wa(s,i),[r,n]),a=s2(o),u=Math.floor(n/2)+1,l=Sh(a),c=Pg(a),d=Ah(l,[u,n-u],l.shape.length-1),f=Ah(c,[u,n-u],c.shape.length-1),h=s.shape.slice();return h[s.shape.length-1]=u,te(Wa(d[0],f[0]),h)}const i2=B({rfft_:Kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xq(t,e){let n=T(t,"a","squaredDifference"),r=T(e,"b","squaredDifference");[n,r]=en(n,r),st(n.shape,r.shape);const s={a:n,b:r},i={};return W.runKernel(OP,s,i)}const c4=B({squaredDifference_:Xq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t,e){const n=T(t,"x","squeeze","string_or_numeric");return te(n,Qa(n.shape,e).newShape)}const Lo=B({squeeze_:Yq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qq(t,e=0){const n=I0(t,"tensors","stack","string_or_numeric");R(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&R(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return W.runKernel(HR,r,s)}const Ho=B({stack_:Qq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zq(t,e=0){const r={x:T(t,"x","step")},s={alpha:e};return W.runKernel(KP,r,s)}const d4=B({step_:Zq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jq(t,e,n,r,s=0,i=0,o=0,a=0,u=0){const c={x:T(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};return W.runKernel(LP,c,d)}const eH=B({stridedSlice_:Jq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(t){const n={x:T(t,"x","tan","float32")};return W.runKernel(VP,n)}const nH=B({tan_:tH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ws(t,e){pd(t);const n=Za(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ja(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xu(t,e,n){if(pd(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Za(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4(t,e,n){if(pd(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Za(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rH(t,e,n){if(pd(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Za(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(t,e,n){if(pd(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Za(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ja(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(t,e,n){if(pd(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Za(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ja(t,e,r,n)}function h4(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function o2(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}h4(n,e,t)}function Dg(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=s;d<i;++d)o*=n[d];const a=s<1?1:s,u=de(e.shape)/a,l=[...Dn(n.slice(0,s)),1],c=de(n);return{sliceRank:s,numUpdates:u,sliceSize:o,strides:l,outputSize:c}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(t,e,n){const r=T(t,"tensor","tensorScatterupdate"),s=T(e,"indices","tensorScatterupdate","int32"),i=T(n,"updates","tensorScatterupdate");if(o2(i,s,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);const o={tensor:r,indices:s,updates:i},a={};return W.runKernel(hP,o,a)}const aH=B({tensorScatterUpdate_:oH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(t,e=1,n=!0){const r=T(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,u]=W.runKernel(zP,i,o);return{values:a,indices:u}}const lH=B({topk_:uH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(t,e=0,n=1,r,s){if(bs(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new n2(e,n,r,!0,s),o=Ht(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const dH=B({truncatedNormal_:cH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(t,e=0){const n=T(t,"x","unique","string_or_numeric");R(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=W.runKernel(jP,r,s);return{values:i,indices:o}}const hH=B({unique_:fH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pH(t,e,n){const r=T(t,"x","unsortedSegmentSum"),s=T(e,"segmentIds","unsortedSegmentSum","int32");R(Jc(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return W.runKernel(qP,i,o)}const mH=B({unsortedSegmentSum_:pH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(t,e=0){const n=T(t,"x","unstack","string_or_numeric");R(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return W.runKernel(GP,r,s)}const Nl=B({unstack_:gH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yH(t,e){return Kx(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bH(t,e=!0,n,r){return W.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=Ht(t,"int32"),s=Ht([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vH(t){const e=T(t,"condition","whereAsync","bool"),n=await e.data(),r=p4(e.shape,n);return t!==e&&e.dispose(),r}const m4=vH;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wH(t,e,n){const r=T(t,"tensor","boolMask"),s=T(e,"mask","boolMask","bool"),i=n??0,o=s.rank,a=r.shape;R(o>0,()=>"mask cannot be scalar"),ys(a.slice(i,i+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let y=i;y<i+o;y++)u*=a[y];const l=a.slice(0,i).concat([u],a.slice(i+o)),c=te(r,l),d=te(s,[-1]),f=await m4(d),h=Lo(f,[1]),p=R0(c,h,i);return t!==r&&r.dispose(),e!==s&&s.dispose(),h.dispose(),c.dispose(),d.dispose(),f.dispose(),p}const xH=wH;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(t,e,n){const r=T(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),R(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{R(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?qe(()=>{let o=Sh(r),a=Pg(r);return o=W.runKernel(_m,{x:o},i),a=W.runKernel(_m,{x:a},i),n&&(a=oo(a)),Wa(o,a)}):W.runKernel(_m,s,i)}const $0=B({transpose_:SH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e,n,r,s=!0){const i=T(t,"v","movingAverage"),o=T(e,"x","movingAverage"),a=T(n,"decay","movingAverage");qz(i,o),R(qt(i.shape,o.shape),()=>"Shape mismatch in v and x");const u=Ye(1),l=Oe(u,a);let c=fe(Oe(o,i),l);if(s){R(r!=null,()=>"When using zeroDebias: true, step is required.");const d=T(r,"step","movingAverage");c=ut(c,Oe(u,vh(a,d)))}return ke(i,c)}const EH=B({movingAverage_:AH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(t,e,n){bs(n);const r=T(t,"indices","scatterND","int32"),s=T(e,"updates","scatterND");o2(s,r,n);const i={indices:r,updates:s},o={shape:n};return W.runKernel(fP,i,o)}const NH=B({scatterND_:CH});function TH(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(t,e,n,r=0){bs(n);const s=T(t,"sparseIndices","sparseToDense","int32"),i=T(e,"sparseValues","sparseToDense","string_or_numeric"),o=T(r,"defaultValue","sparseToDense",i.dtype);TH(s,i,n,o);const a={sparseIndices:s,sparseValues:i,defaultValue:o},u={outputShape:n};return W.runKernel(PP,a,u)}const IH=B({sparseToDense_:_H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(t,e){const n=T(e,"indices","gatherND","int32"),s={params:T(t,"x","gatherND","string_or_numeric"),indices:n};return W.runKernel(cR,s)}const RH=B({gatherND_:kH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(t,e){if(e==null)return t.shape.slice();if(qt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(t,e,n,r){const s=T(t,"x","dropout");if(R(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),R(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof or?s.clone():s;const i=PH(s,n),o=1-e,a=ut(qO(ke(r2(i,0,1,"float32",r),o)),o);return fe(s,a)}const DH=B({dropout_:OH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g4(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function a2(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);s[i]=e-n*Math.cos(o)}return Ws(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function LH(t,e,n=1){const r=T(t,"predictions","inTopK"),s=T(e,"targets","inTopK");R(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),R(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),ys(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];R(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),a=await s.data(),[u,l]=[o.length/i,i],c=Ua("bool",u);for(let d=0;d<u;d++){const f=d*l,h=o.subarray(f,f+l),p=[];for(let y=0;y<h.length;y++)p.push({value:h[y],index:y});p.sort((y,b)=>b.value-y.value),c[d]=0;for(let y=0;y<n;y++)if(p[y].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),io(c,s.shape,"bool")}const FH=LH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;u.rank===3&&(u=te(e,[1,e.shape[0],e.shape[1],e.shape[2]])),R(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),R(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),R(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const l=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];R(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),R(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Js("conv2dDerFilter",s,o);const d={x:a,dy:u},f={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return W.runKernel(O3,d,f)}const BH=B({conv2DBackpropFilter_:$H});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lg(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return fe(t,d4(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Fg(t,e){let n=e;const r=VO(t.shape,e.shape);return r.length>0&&(n=Rt(n,r)),te(n,t.shape)}function $g(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Og(t);if(e==="elu")return zO(t);if(e==="relu6")return a4(t);if(e==="prelu")return s4(t,n);if(e==="leakyrelu")return KO(t,r);if(e==="sigmoid")return Bc(t);throw new Error(`Unknown fused activation ${e}.`)}const Bg=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(u=u||"linear",Bg(W.state.gradientDepth,u)===!1){R(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=Ig(t,e,n,r,s,i,o);return a!=null&&(k=ke(k,a)),$g(k,u,l,c)}const d=T(t,"x","conv2d","float32"),f=T(e,"filter","conv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),R(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),R(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),Js("fused conv2d",r,o);const y=s==="NHWC"?h.shape[3]:h.shape[1];R(f.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${f.shape[2]}.`),R(Hr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const b=vs(h.shape,f.shape,n,i,r,o);let g;a!=null&&(g=T(a,"bias","fused conv2d"),[g]=en(g,d),s==="NHWC"?st(b.outShape,g.shape):(R(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),R(g.shape.length===0||g.shape[0]===b.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let v;if(l!=null){const k=l.shape;if(R(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)R(k[0]===1||k[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${b.outChannels}).`);else if(k.length===3)try{st(k,b.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(N)}v=T(l,"prelu weights","fused conv2d")}const w=(k,P)=>{R(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[N,$,U,K]=P,Z=Lg(k,U,u);R(bh(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const ie=MO($.shape,Z,N,n,r),ee=BH($,Z,N.shape,n,r),j=[ie,ee];if(K!=null){const M=Fg(K,Z);j.push(M)}return j},x={x:h,filter:f,bias:g,preluActivationWeights:v},C={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?qo((P,N,$)=>{let U=W.runKernel(bv,x,C);return $([N,P,U]),p&&(U=te(U,[U.shape[1],U.shape[2],U.shape[3]])),{value:U,gradFunc:w}})(h,f):qo((P,N,$,U)=>{let K=W.runKernel(bv,x,C);return U([N,P,K,$]),p&&(K=te(K,[K.shape[1],K.shape[2],K.shape[3]])),{value:K,gradFunc:w}})(h,f,g)}const VH=B({fusedConv2d_:MH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;u.rank===3&&(u=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={x:a,dy:u},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return W.runKernel(G3,l,c)}const zH=B({depthwiseConv2dNativeBackpropFilter_:UH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(t,e,n,r,s,i=[1,1],o){let a=e,u=!1;e.rank===3&&(u=!0,a=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},d=W.runKernel(q3,l,c);return u?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const jH=B({depthwiseConv2dNativeBackpropInput_:WH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(Bg(W.state.gradientDepth,u)===!1){let C=jx(t,e,n,r,s,i,o);return a!=null&&(C=ke(C,a)),$g(C,u,l,c)}const d=T(t,"x","depthwiseConv2d","float32"),f=T(e,"filter","depthwiseConv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=te(d,[1,d.shape[0],d.shape[1],d.shape[2]])),R(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),R(f.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`),R(h.shape[3]===f.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${f.shape[2]}.`),i==null&&(i=[1,1]),R(Hr(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Js("fused depthwiseConv2d",r,o);const y=vs(h.shape,f.shape,n,i,r,o,!0);let b;a!=null&&(b=T(a,"bias","fused conv2d"),[b]=en(b,d),st(y.outShape,b.shape));let g;l!=null&&(g=T(l,"prelu weights","fused depthwiseConv2d"));const v=(C,k)=>{R(bh(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[P,N,$,U]=k,K=Lg(C,$,u),Z=jH(N.shape,K,P,n,r,i,o),ie=zH(N,K,P.shape,n,r,i,o);if(U!=null){const ee=Fg(b,K);return[Z,ie,ee]}return[Z,ie]},w={x:h,filter:f,bias:b,preluActivationWeights:g},x={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?qo((k,P,N)=>{let $=W.runKernel(vv,w,x);return N([P,k,$]),p&&($=te($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:v}})(h,f):qo((k,P,N,$)=>{let U=W.runKernel(vv,w,x);return $([P,k,U,N]),p&&(U=te(U,[U.shape[1],U.shape[2],U.shape[3]])),{value:U,gradFunc:v}})(h,f,b)}const qH=B({fusedDepthwiseConv2d_:GH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(Bg(W.state.gradientDepth,i)===!1){let K=bt(t,e,n,r);return s!=null&&(K=ke(K,s)),$g(K,i,o,a)}let u=T(t,"a","fused matMul"),l=T(e,"b","fused matMul");[u,l]=en(u,l);const c=n?u.shape[u.rank-2]:u.shape[u.rank-1],d=r?l.shape[l.rank-1]:l.shape[l.rank-2],f=n?u.shape[u.rank-1]:u.shape[u.rank-2],h=r?l.shape[l.rank-2]:l.shape[l.rank-1],p=u.shape.slice(0,-2),y=l.shape.slice(0,-2),b=de(p),g=de(y);R(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${u.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=st(u.shape.slice(0,-2),l.shape.slice(0,-2)).concat([f,h]),x=n?te(u,[b,c,f]):te(u,[b,f,c]),C=r?te(l,[g,h,d]):te(l,[g,d,h]);let k;s!=null&&(k=T(s,"bias","fused matMul"),[k]=en(k,u),st(w,k.shape));let P;o!=null&&(P=T(o,"prelu weights","fused matMul"));const N=(K,Z)=>{const[ie,ee,j,M]=Z,O=Lg(te(K,j.shape),j,i);let D,V;if(!n&&!r?(D=bt(O,ee,!1,!0),V=bt(ie,O,!0,!1)):!n&&r?(D=bt(O,ee,!1,!1),V=bt(O,ie,!0,!1)):n&&!r?(D=bt(ee,O,!1,!0),V=bt(ie,O,!1,!1)):(D=bt(ee,O,!0,!0),V=bt(O,ie,!0,!0)),s!=null){const F=Fg(M,O);return[D,V,F]}else return[D,V]},$={a:x,b:C,bias:k,preluActivationWeights:P},U={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?qo((Z,ie,ee)=>{const j=W.runKernel(yv,$,U);return ee([Z,ie,j]),{value:te(j,w),gradFunc:N}})(x,C):qo((Z,ie,ee,j)=>{const M=W.runKernel(yv,$,U);return j([Z,ie,M,ee]),{value:te(M,w),gradFunc:N}})(x,C,k)}const KH=B({fusedMatMul_:HH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XH=Object.freeze(Object.defineProperty({__proto__:null,conv2d:VH,depthwiseConv2d:qH,matMul:KH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(t){return a2(t,.54,.46)}const QH=B({hammingWindow_:YH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(t){return a2(t,.5,.5)}const y4=B({hannWindow_:ZH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t,e,n,r=!1,s=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(Le(t,i,e)),i+=n;if(r)for(;i<t.size;){const a=i+e-t.size,u=dn([Le(t,i,e-a),Wh([a],s)]);o.push(u),i+=n}return o.length===0?Xu([],[0,e]):te(dn(o),[o.length,e])}const b4=B({frame_:JH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(t,e,n,r,s=y4){r==null&&(r=g4(e));const i=b4(t,e,n),o=fe(i,s(e));return i2(o,r)}const tK=B({stft_:eK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nK(t,e,n,r,s="bilinear",i=0){const o=T(t,"image","cropAndResize"),a=T(e,"boxes","cropAndResize","float32"),u=T(n,"boxInd","cropAndResize","int32"),l=a.shape[0];R(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),R(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),R(u.rank===1&&u.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),R(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),R(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),R(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:o,boxes:a,boxInd:u},d={method:s,extrapolationValue:i,cropSize:r};return W.runKernel(U3,c,d)}const rK=B({cropAndResize_:nK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(t){const e=T(t,"image","flipLeftRight","float32");R(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return W.runKernel(iR,n,{})}const iK=B({flipLeftRight_:sK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(t){const e=T(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];R(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),R(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Gf(e,s)}const aK=B({grayscaleToRGB_:oK});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(t){const e=T(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];R(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),R(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=cn(e,"float32"),o=Ws([.2989,.587,.114]);let a;switch(e.rank){case 2:a=uc("ij,j->i",i,o);break;case 3:a=uc("ijk,k->ij",i,o);break;case 4:a=uc("ijkl,l->ijk",i,o);break;case 5:a=uc("ijklm,m->ijkl",i,o);break;case 6:a=uc("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=ss(a,-1),cn(a,s)}const lK=B({rgbToGrayscale_:uK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(t,e,n=0,r=.5){const s=T(t,"image","rotateWithOffset","float32");R(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return W.runKernel(XP,i,o)}const dK=B({rotateWithOffset_:cK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),R(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),R(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),R(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),R(e.rank===1,()=>"scores must be a 1D tensor"),R(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),R(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=T(t,"boxes","nonMaxSuppression","float32"),o=T(e,"scores","nonMaxSuppression","float32"),a=bd(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return W.runKernel(zR,{boxes:i,scores:o},u)}const hK=B({nonMaxSuppression_:fK});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(t,e,n){const r=mK(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function mK(t,e,n){return yK(t,e,n||gK)}function gK(t,e){return t>e?1:t<e?-1:0}function yK(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(t,e,n,r,s){return u2(t,e,n,r,s,0)}function w4(t,e,n,r,s,i){return u2(t,e,n,r,s,0,!1,i,!0)}function x4(t,e,n,r,s,i){return u2(t,e,n,r,s,i,!0)}function u2(t,e,n,r,s,i,o=!1,a=!1,u=!1){const l=[];for(let b=0;b<e.length;b++)e[b]>s&&l.push({score:e[b],boxIndex:b,suppressBeginIndex:0});l.sort(BC);const c=i>0?-.5/i:0,d=[],f=[];for(;d.length<n&&l.length>0;){const b=l.pop(),{score:g,boxIndex:v,suppressBeginIndex:w}=b;if(g<s)break;let x=!1;for(let C=d.length-1;C>=w;--C){const k=bK(t,v,d[C]);if(k>=r){x=!0;break}if(b.score=b.score*vK(r,c,k),b.score<=s)break}b.suppressBeginIndex=d.length,x||(b.score===g?(d.push(v),f.push(b.score)):b.score>s&&pK(l,b,BC))}const h=d.length,p=n-h;a&&p>0&&(d.push(...new Array(p).fill(0)),f.push(...new Array(p).fill(0)));const y={selectedIndices:d};return o&&(y.selectedScores=f),u&&(y.validOutputs=h),y}function bK(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),f=Math.max(s[1],s[3]),h=(a-i)*(u-o),p=(d-l)*(f-c);if(h<=0||p<=0)return 0;const y=Math.max(i,l),b=Math.max(o,c),g=Math.min(a,d),v=Math.min(u,f),w=Math.max(g-y,0)*Math.max(v-b,0);return w/(h+p-w)}function vK(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function BC(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=T(t,"boxes","nonMaxSuppressionAsync"),o=T(e,"scores","nonMaxSuppressionAsync"),a=bd(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const u=await Promise.all([i.data(),o.data()]),l=u[0],c=u[1],{selectedIndices:d}=v4(l,c,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),Ws(d,"int32")}const xK=wK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=T(t,"boxes","nonMaxSuppression"),a=T(e,"scores","nonMaxSuppression"),u=bd(o,a,n,r,s,i);n=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,i=u.softNmsSigma;const l={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=W.runKernel(jR,l,c);return{selectedIndices:d[0],selectedScores:d[1]}}const AK=B({nonMaxSuppressionWithScore_:SK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=T(t,"boxes","nonMaxSuppressionAsync"),a=T(e,"scores","nonMaxSuppressionAsync"),u=bd(o,a,n,r,s,i);n=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,i=u.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),c=l[0],d=l[1],{selectedIndices:f,selectedScores:h}=x4(c,d,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ws(f,"int32"),selectedScores:Ws(h)}}const CK=EK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=T(t,"boxes","nonMaxSuppression"),a=T(e,"scores","nonMaxSuppression"),u=bd(o,a,n,r,s,null),l=u.maxOutputSize,c=u.iouThreshold,d=u.scoreThreshold,f={boxes:o,scores:a},h={maxOutputSize:l,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:i},p=W.runKernel(WR,f,h);return{selectedIndices:p[0],validOutputs:p[1]}}const TK=B({nonMaxSuppressionPadded_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _K(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=T(t,"boxes","nonMaxSuppressionAsync"),a=T(e,"scores","nonMaxSuppressionAsync"),u=bd(o,a,n,r,s,null),l=u.maxOutputSize,c=u.iouThreshold,d=u.scoreThreshold,[f,h]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:y}=w4(f,h,l,c,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ws(p,"int32"),validOutputs:Ye(y,"int32")}}const IK=_K;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(t,e,n=!1,r=!1){const s=T(t,"images","resizeBilinear");R(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),R(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),R(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},u={alignCorners:n,halfPixelCenters:r,size:e},l=W.runKernel(aP,a,u);return o?te(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const RK=B({resizeBilinear_:kK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(t,e,n=!1,r=!1){const s=T(t,"images","resizeNearestNeighbor");R(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),R(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),R(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),R(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=te(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},u={alignCorners:n,halfPixelCenters:r,size:e},l=W.runKernel(oP,a,u);return o?te(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const OK=B({resizeNearestNeighbor_:PK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DK(t,e="binary",n=!1,r=.5){const s=T(t,"image","threshold"),i=.2989,o=.587,a=.114,u=s.shape[0]*s.shape[1];let l=fe(Ws([r]),255),c,d,f,h;if(R(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),R(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),R(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),R(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,f]=Ah(s,[1,1,1],-1);const b=fe(c,i),g=fe(d,o),v=fe(f,a);h=ke(ke(b,g),v)}else h=t;if(e==="otsu"){const b=BO(cn(u4(h),"int32"),io([]),256);l=LK(b,u)}const p=n?Hx(h,l):Rg(h,l);return cn(fe(p,255),"int32")}function LK(t,e){let n=Ws([-1]),r=Ws([0]),s=Ws([0]),i,o,a,u,l,c;for(let d=0;d<t.size-1;d++){i=Le(t,0,d+1),o=Le(t,d+1),l=ut(Rt(i),e),c=ut(Rt(o),e);const f=Rt(fe(i,xh(0,i.size)));a=ut(f,Rt(i));const h=Wh(o.shape,i.size),p=ke(xh(0,o.size),h),y=fe(o,p);u=ut(Rt(y),Rt(o));const b=Oe(a,u),g=Oe(a,u),v=fe(l,c);s=fe(fe(v,b),g);const w=Rg(s,r);r=$o(w,s,r),n=$o(w,Ws([d]),n)}return n}const FK=B({threshold_:DK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $K(t,e,n="nearest",r="constant",s=0,i){const o=T(t,"image","transform","float32"),a=T(e,"transforms","transform","float32");R(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),R(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),R(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const u={image:o,transforms:a},l={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return W.runKernel(WP,u,l)}const BK=B({transform_:$K});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MK(t,e,n){const r=T(t,"a","bandPart");R(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,u;typeof e=="number"?(R(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),R(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=T(e<0?i:e,"numLower","bandPart")):(R(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=$o(P0(e,0),i,L0(e,i))),typeof n=="number"?(R(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),R(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),u=T(n<0?o:n,"numUpper","bandPart")):(R(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=$o(P0(n,0),o,L0(n,o)));const l=te(xh(0,i,1,"int32"),[-1,1]),c=xh(0,o,1,"int32"),d=Oe(l,c),f=O0(Hx(d,a),HO(d,oo(u))),h=Ga([i,o],r.dtype);return te(Ho(Nl(te(r,[-1,i,o])).map(p=>$o(f,p,h))),s)}const VK=B({bandPart_:MK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UK(t){let e;if(Array.isArray(t)){e=!1,R(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)R(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=Ah(t,t.shape[0],0).map(s=>Lo(s,[0]));R(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(W.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=fe(Rt(fe(n[o],i)),n[o]);i=Oe(i,a)}return ut(i,kg(i,"euclidean"))}));return e?Ho(n,0):n}const zK=B({gramSchmidt_:UK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WK(t,e=!1){if(R(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return MC(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((u,l)=>u*l),r=Nl(te(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(u=>{const[l,c]=MC(u,e);s.push(l),i.push(c)});const o=te(Ho(s,0),t.shape),a=te(Ho(i,0),t.shape);return[o,a]}}function MC(t,e=!1){return W.tidy(()=>{R(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=GO(n),i=Fa(t);const o=Xu([[1]],[1,1]);let a=Fa(o);const u=n>=r?r:n;for(let l=0;l<u;++l){const c=i,d=a,f=s;[a,i,s]=W.tidy(()=>{const h=Le(i,[l,l],[n-l,1]),p=kg(h),y=Le(i,[l,l],[1,1]),b=$o(Rg(y,0),Xu([[-1]]),Xu([[1]])),g=Oe(y,fe(b,p)),v=ut(h,g);v.shape[0]===1?a=Fa(o):a=dn([o,Le(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=oo(ut(bt(b,g),p)),x=Le(i,[l,0],[n-l,r]),C=fe(w,a),k=$0(a);if(l===0)i=Oe(x,bt(C,bt(k,x)));else{const $=Oe(x,bt(C,bt(k,x)));i=dn([Le(i,[0,0],[l,r]),$],0)}const P=$0(C),N=Le(s,[0,l],[n,s.shape[1]-l]);if(l===0)s=Oe(N,bt(bt(N,a),P));else{const $=Oe(N,bt(bt(N,a),P));s=dn([Le(s,[0,0],[n,l]),$],1)}return[a,i,s]}),rn([c,d,f])}return!e&&n>r&&(s=Le(s,[0,0],[n,r]),i=Le(i,[0,0],[r,r])),[s,i]})}const jK=B({qr_:WK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Cr||(Cr={}));function GK(t,e,n=Cr.SUM_BY_NONZERO_WEIGHTS){const r=T(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=T(e,"weights","computeWeightedLoss"));const i=s==null?r:fe(r,s);if(n===Cr.NONE)return i;if(n===Cr.SUM)return Rt(i);if(n===Cr.MEAN){if(s==null)return D0(i);{const o=r.size/s.size,a=ut(Rt(i),Rt(s));return o>1?ut(a,Ye(o)):a}}if(n===Cr.SUM_BY_NONZERO_WEIGHTS){if(s==null)return ut(Rt(i),Ye(r.size));{const o=fe(s,ju(r.shape)),a=cn(Rt(n4(o,Ye(0))),"float32");return ut(Rt(i),a)}}throw Error(`Unknown reduction: ${n}`)}const Yo=B({computeWeightedLoss_:GK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){const s=T(t,"labels","absoluteDifference"),i=T(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=T(n,"weights","absoluteDifference")),ys(s.shape,i.shape,"Error in absoluteDifference: ");const a=ns(Oe(s,i));return Yo(a,o,r)}const HK=B({absoluteDifference_:qK});function KK(t,e,n,r,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=T(t,"labels","cosineDistance"),o=T(e,"predictions","cosineDistance");let a=null;r!=null&&(a=T(r,"weights","cosineDistance")),ys(i.shape,o.shape,"Error in cosineDistance: ");const u=Ye(1),l=Oe(u,Rt(fe(i,o),n,!0));return Yo(l,a,s)}const XK=B({cosineDistance_:KK});function YK(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){let s=T(t,"labels","hingeLoss");const i=T(e,"predictions","hingeLoss");let o=null;n!=null&&(o=T(n,"weights","hingeLoss")),ys(s.shape,i.shape,"Error in hingeLoss: ");const a=Ye(1);s=Oe(fe(Ye(2),s),a);const u=Og(Oe(a,fe(s,i)));return Yo(u,o,r)}const QK=B({hingeLoss_:YK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZK(t,e,n,r=1,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=T(t,"labels","huberLoss"),o=T(e,"predictions","huberLoss");let a=null;n!=null&&(a=T(n,"weights","huberLoss")),ys(i.shape,o.shape,"Error in huberLoss: ");const u=Ye(r),l=ns(Oe(o,i)),c=L0(l,u),d=Oe(l,c),f=ke(fe(Ye(.5),Hs(c)),fe(u,d));return Yo(f,a,s)}const JK=B({huberLoss_:ZK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(t,e,n,r=1e-7,s=Cr.SUM_BY_NONZERO_WEIGHTS){const i=T(t,"labels","logLoss"),o=T(e,"predictions","logLoss");let a=null;n!=null&&(a=T(n,"weights","logLoss")),ys(i.shape,o.shape,"Error in logLoss: ");const u=Ye(1),l=Ye(r),c=oo(fe(i,wh(ke(o,l)))),d=fe(Oe(u,i),wh(ke(Oe(u,o),l))),f=Oe(c,d);return Yo(f,a,s)}const tX=B({logLoss_:eX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(t,e,n,r=Cr.SUM_BY_NONZERO_WEIGHTS){const s=T(t,"labels","meanSquaredError"),i=T(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=T(n,"weights","meanSquaredError")),ys(s.shape,i.shape,"Error in meanSquaredError: ");const a=c4(s,i);return Yo(a,o,r)}const rX=B({meanSquaredError_:nX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e){const n=T(t,"labels","sigmoidCrossEntropyWithLogits"),r=T(e,"logits","sigmoidCrossEntropyWithLogits");ys(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Og(r),i=fe(r,n),o=XO(fl(oo(ns(r))));return ke(Oe(s,i),o)}function iX(t,e,n,r=0,s=Cr.SUM_BY_NONZERO_WEIGHTS){let i=T(t,"multiClassLabels","sigmoidCrossEntropy");const o=T(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=T(n,"weights","sigmoidCrossEntropy")),ys(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const l=Ye(r),c=Ye(1),d=Ye(.5);i=ke(fe(i,Oe(c,l)),fe(d,l))}const u=sX(i,o);return Yo(u,a,s)}const oX=B({sigmoidCrossEntropy_:iX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aX(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return qo((s,i,o)=>{const u=QO(i,[n],!0),l=Oe(cn(i,"float32"),u);o([s,l]);const c=oo(fe(l,s));return{value:Rt(c,[n]),gradFunc:(h,p)=>{const[y,b]=p,g=ws(h.shape,[n]);return[fe(te(h,g),Oe(cn(y,"float32"),fl(b))),fe(te(h,g),Oe(fl(b),cn(y,"float32")))]}}})(t,e)}function uX(t,e,n,r=0,s=Cr.SUM_BY_NONZERO_WEIGHTS){let i=T(t,"onehotLabels","softmaxCrossEntropy");const o=T(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=T(n,"weights","softmaxCrossEntropy")),ys(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const l=Ye(r),c=Ye(1),d=Ye(i.shape[1]);i=ke(fe(i,Oe(c,l)),ut(l,d))}const u=aX(i,o);return Yo(u,a,s)}const lX=B({softmaxCrossEntropy_:uX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cX(t,e,n,r){const s=T(t,"indices","sparseFillEmptyRows","int32"),i=T(e,"values","sparseFillEmptyRows"),o=T(n,"denseShape","sparseFillEmptyRows","int32"),a=T(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const u={indices:s,values:i,denseShape:o,defaultValue:a},l=W.runKernel(_P,u);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}const dX=B({sparseFillEmptyRows_:cX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(t,e,n){const r=T(t,"inputIndices","sparseReshape","int32"),s=T(e,"inputShape","sparseReshape","int32"),i=T(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:s,newShape:i},a=W.runKernel(IP,o);return{outputIndices:a[0],outputShape:a[1]}}const hX=B({sparseReshape_:fX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(t,e,n){const r=T(t,"data","sparseSegmentMean"),s=T(e,"indices","sparseSegmentMean","int32"),i=T(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return W.runKernel(kP,o)}const mX=B({sparseSegmentMean_:pX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t,e,n){const r=T(t,"data","sparseSegmentSum"),s=T(e,"indices","sparseSegmentSum","int32"),i=T(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return W.runKernel(RP,o)}const yX=B({sparseSegmentSum_:gX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(t,e,n,r,s,i,o,a){const u=T(t,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const l=T(e,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:u,dataSplits:l},f=W.runKernel(FP,d,c);return{nGrams:f[0],nGramsSplits:f[1]}}const vX=B({stringNGrams_:bX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(t,e,n=!0){const r=T(t,"input","stringSplit","string"),s=T(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const i={skipEmpty:n},o={input:r,delimiter:s},a=W.runKernel($P,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const xX=B({stringSplit_:wX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(t,e){const n=T(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return W.runKernel(BP,s,r)}const AX=B({stringToHashBucketFast_:SX});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EX(t,e,n,r=!0){const s=T(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:r};return W.runKernel(DP,{x:s},i)}const CX=B({staticRegexReplace_:EX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={fft:s2,ifft:F0,rfft:i2,irfft:l4},TX={hammingWindow:QH,hannWindow:y4,frame:b4,stft:tK},l2={flipLeftRight:iK,grayscaleToRGB:aK,resizeNearestNeighbor:OK,resizeBilinear:RK,rgbToGrayscale:lK,rotateWithOffset:dK,cropAndResize:rK,nonMaxSuppression:hK,nonMaxSuppressionAsync:xK,nonMaxSuppressionWithScore:AK,nonMaxSuppressionWithScoreAsync:CK,nonMaxSuppressionPadded:TK,nonMaxSuppressionPaddedAsync:IK,threshold:FK,transform:BK},_X={bandPart:VK,gramSchmidt:zK,qr:jK},IX={absoluteDifference:HK,computeWeightedLoss:Yo,cosineDistance:XK,hingeLoss:QK,huberLoss:JK,logLoss:tX,meanSquaredError:rX,sigmoidCrossEntropy:oX,softmaxCrossEntropy:lX},kX={sparseFillEmptyRows:dX,sparseReshape:hX,sparseSegmentMean:mX,sparseSegmentSum:yX},RX={stringNGrams:vX,stringSplit:xX,stringToHashBucketFast:AX,staticRegexReplace:CX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX=new Map,OX=new Map;class DX{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Du{constructor(){this.classNameMap={}}static getMap(){return Du.instance==null&&(Du.instance=new Du),Du.instance}static register(e){Du.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function LX(t,e,n){R(t.className!=null,()=>"Class being registered does not have the static className property defined."),R(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),R(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return Du.register(t),PX.set(s,t),OX.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tl extends DX{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return rn(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return wj(e,n)}dispose(){this.iterations_!=null&&rn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ye(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Tl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FX extends Tl{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=W.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:qe(()=>ls(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:qe(()=>ls(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const u=this.accumulatedGrads[s].variable,l=this.accumulatedUpdates[s].variable;qe(()=>{const c=ke(fe(u,this.rho),fe(Hs(a),1-this.rho)),d=fe(ut(Go(ke(l,this.epsilon)),Go(ke(u,this.epsilon))),a),f=ke(fe(l,this.rho),fe(Hs(d),1-this.rho));u.assign(c),l.assign(f);const h=ke(fe(d,-this.learningRate),i);i.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(rn(this.accumulatedGrads.map(e=>e.variable)),rn(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $X extends Tl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=W.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:qe(()=>Wh(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;qe(()=>{const u=ke(a,Hs(o));a.assign(u);const l=ke(fe(ut(o,Go(ke(u,W.backend.epsilon()))),-this.learningRate),i);i.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&rn(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BX extends Tl{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],qe(()=>{this.accBeta1=Ye(n).variable(),this.accBeta2=Ye(r).variable()}),s==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);qe(()=>{const r=Oe(1,this.accBeta1),s=Oe(1,this.accBeta2);n.forEach((i,o)=>{const a=W.registeredVariables[i],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:qe(()=>ls(a).variable(u))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:qe(()=>ls(a).variable(u))});const l=Array.isArray(e)?e[o].tensor:e[i];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,f=ke(fe(c,this.beta1),fe(l,1-this.beta1)),h=ke(fe(d,this.beta2),fe(Hs(l),1-this.beta2)),p=ut(f,r),y=ut(h,s);c.assign(f),d.assign(h);const b=ke(fe(ut(p,ke(Go(y),this.epsilon)),-this.learningRate),a);a.assign(b)}),this.accBeta1.assign(fe(this.accBeta1,this.beta1)),this.accBeta2.assign(fe(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&rn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&rn(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),qe(()=>{this.accBeta1.assign(vh(this.beta1,this.iterations_+1)),this.accBeta2.assign(vh(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MX extends Tl{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],qe(()=>{this.iteration=Ye(0).variable(),this.accBeta1=Ye(n).variable()}),s==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);qe(()=>{const r=Oe(1,this.accBeta1),s=ut(-this.learningRate,ke(fe(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=W.registeredVariables[i],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:ls(a).variable(u)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:ls(a).variable(u)});const l=Array.isArray(e)?e[o].tensor:e[i];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,f=ke(fe(c,this.beta1),fe(l,1-this.beta1)),h=fe(d,this.beta2),p=ns(l),y=t4(h,p);c.assign(f),d.assign(y);const b=ke(fe(ut(s,r),ut(f,ke(y,this.epsilon))),a);a.assign(b)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(fe(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&rn(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&rn(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S4 extends Tl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=W.registeredVariables[r];qe(()=>{const a=ke(fe(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Zi(Ye(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VX extends S4{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ye(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=W.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:qe(()=>ls(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&qe(()=>{let u;const l=ke(fe(this.m,o),a);this.useNesterov?u=ke(fe(this.c,ke(a,fe(l,this.m))),i):u=ke(fe(this.c,l),i),o.assign(l),i.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&rn(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UX extends Tl{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=W.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=W.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:qe(()=>ls(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:qe(()=>ls(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:qe(()=>ls(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const u=this.accumulatedMeanSquares[s].variable,l=this.accumulatedMoments[s].variable;qe(()=>{const c=ke(fe(u,this.decay),fe(Hs(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,f=ke(fe(d,this.decay),fe(a,1-this.decay)),h=ut(fe(a,this.learningRate),Go(Oe(c,ke(Hs(f),this.epsilon)))),p=ke(fe(l,this.momentum),h);u.assign(c),d.assign(f),l.assign(p);const y=Oe(i,p);i.assign(y)}else{const d=ke(fe(u,this.decay),fe(Hs(a),1-this.decay)),f=ke(fe(l,this.momentum),ut(fe(a,this.learningRate),Go(ke(d,this.epsilon))));u.assign(d),l.assign(f);const h=Oe(i,f);i.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&rn(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&rn(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&rn(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX=[FX,$X,BX,MX,VX,UX,S4];function WX(){for(const t of zX)LX(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX="model",GX=".json",qX=".weights.bin";function VC(t){return new Promise(e=>setTimeout(e)).then(t)}class pl{constructor(e){if(!X().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(pl.URL_SCHEME)&&(e=e.slice(pl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=jX),this.modelJsonFileName=e+GX,this.weightDataFileName=e+qX}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Li.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=xO(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await VC(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=r,await VC(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Vh(e)}}}}pl.URL_SCHEME="downloads://";class HX{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const i=JSON.parse(s.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const u=zx(i,l=>this.loadWeights(l));e(u)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const s=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,s[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,s)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;r(a)},i.onerror=o=>s(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>$C(i.name)),s={};for(const i of e)i.paths.forEach(o=>{const a=$C(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const KX=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(pl.URL_SCHEME)?XX(t.slice(pl.URL_SCHEME.length)):null;jt.registerSaveRouter(KX);function XX(t="model"){return new pl(t)}function YX(t){return new HX(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(t,e,n,r){o(t),n=n??0,r=r??1,a(n,r);let s=0;const i=u=>(u.then(l=>{const c=n+ ++s/t.length*(r-n);return e(c),l}),u);function o(u){R(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function a(u,l){R(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),R(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),R(l>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${l}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function A4(t,e){e==null&&(e={});const n=e.fetchFunc==null?X().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await UC(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await UC(a,e.onProgress,.5,1)}function QX(t,e){var n;const r=e.fetchFunc==null?X().platform.fetch:e.fetchFunc;let s=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;s<t.length;){i||(i=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:l}=await i.read();if(u){s++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}o.enqueue(l);return}o.close()}})}async function ZX(t,e="",n,r){return E4(o=>A4(o,{requestInit:r}))(t,e,n)}function E4(t){return async(e,n="",r)=>{const s=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((h,p)=>{let y=0;h.weights.forEach(b=>{const g="quantization"in b?b.quantization.dtype:b.dtype,v=ul[g]*de(b.shape),w=()=>{s[p]=!0,i[p]==null&&(i[p]=[]),i[p].push({manifestEntry:b,groupOffset:y,sizeBytes:v})};r!=null?r.forEach((x,C)=>{x===b.name&&(w(),o[C]=!0)}):w(),a.push(b.name),y+=v})}),!o.every(h=>h)){const h=r.filter((p,y)=>!o[y]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const u=s.reduce((h,p,y)=>(p&&h.push(y),h),[]),l=[];u.forEach(h=>{e[h].paths.forEach(p=>{const y=n+(n.endsWith("/")?"":"/")+p;l.push(y)})});const c=await t(l),d={};let f=0;return u.forEach(h=>{const p=e[h].paths.length,y=new Li(c.slice(f,f+p));i[h].forEach(g=>{const v=y.slice(g.groupOffset,g.groupOffset+g.sizeBytes),w=bO(v,[g.manifestEntry]);for(const x in w)d[x]=w[x]}),f+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX="application/octet-stream",eY="application/json";class c2{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(R(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=X().platform.fetch,R(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&R(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=xO(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:eY}),"model.json"),e.weightData!=null){const o=Li.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:JX}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Vh(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return zx(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=Tv(e.weightsManifest),s=()=>QX(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=tY(n),i=this.weightPathPrefix||r,o=[],a=[];for(const u of e)for(const l of u.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(l)):o.push(i+l+s);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=Tv(e),s=await A4(n,this.loadOptions);return[r,s]}}c2.URL_SCHEME_REGEX=/^https?:\/\//;function tY(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function Dv(t){return t.match(c2.URL_SCHEME_REGEX)!=null}const C4=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>Dv(r)):n=Dv(t),n)return d2(t,e)}return null};jt.registerSaveRouter(C4);jt.registerLoadRouter(C4);function d2(t,e){return new c2(t,e)}function nY(t,e){return d2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cy{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class N4{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class rY{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function sY(t,e,n,r){const s=arguments;return new rY(T4(...s))}function T4(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Cy(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Cy({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Cy({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function iY(t){return new N4(t)}function oY(t){return new N4(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _4=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Li,browserFiles:YX,browserHTTPRequest:nY,concatenateArrayBuffers:u7,copyModel:k7,decodeWeights:bO,decodeWeightsStream:wO,encodeWeights:n7,fromMemory:sY,fromMemorySync:T4,getLoadHandlers:g7,getModelArtifactsForJSON:zx,getModelArtifactsForJSONSync:SO,getModelArtifactsInfoForJSON:Vh,getSaveHandlers:m7,getWeightSpecs:Tv,http:d2,isHTTPScheme:Dv,listModels:_7,loadWeights:ZX,moveModel:R7,registerLoadRouter:p7,registerSaveRouter:h7,removeModel:I7,weightsLoaderFactory:E4,withSaveHandler:iY,withSaveHandlerSync:oY},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vu;function aY(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(wv(gv,W.backendName)!=null){const p={pixels:t},y={numChannels:e};return W.runKernel(gv,p,y)}const[l,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)d=t.data;else if(i||s||a){if(vu==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")vu=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else vu=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});vu.canvas.width=l,vu.canvas.height=c,vu.drawImage(t,0,0,l,c),d=vu.getImageData(0,0,l,c).data}let f;if(e===4)f=new Int32Array(d);else{const p=l*c;f=new Int32Array(p*e);for(let y=0;y<p;y++)for(let b=0;b<e;++b)f[y*e+b]=d[y*4+b]}return f4(f,[c,l,e],"int32")}const uY=B({fromPixels_:aY});function I4(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(de(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=t.shape,u=s.slice();u.pop();let l=1;for(let d=i;d<n;++d)l*=a[d],u.push(a[d]);const c=[...Dn(t.shape).map(d=>d/l),1].slice(0,i);return[u,o,l,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lv=-2,lY=-1;function k4(t,e,n){const r=t.shape.length;R(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),R(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)R(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function cY(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function R4(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function P4(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function O4(t,e,n){return n<=t?n:n-(e-1)}function D4(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function dY(t,e,n,r,s,i,o,a,u){const l=t.length;let c=new Array(l),d=new Array(l),f=new Array(l);if(e.length&&n>0){const h=e[0],p=n+1;c=L4(o,h,p,r,t),d=F4(a,h,p,s,t),f=P4(i,h,p,t)}else for(let h=0;h<l;h++)c[h]=B4(o,r,i,t,h,u),d[h]=M4(a,s,i,t,h,u),f[h]=$4(i,h,u);return{begin:c,end:d,strides:f}}function L4(t,e,n,r,s){const i=[...s],o=D4(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const u=O4(e,n,a);let l=r[u];t&1<<u&&(l=0),i[a]=l}return i}function F4(t,e,n,r,s){const i=[...s],o=D4(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const u=O4(e,n,a);let l=r[u];t&1<<u&&(l=Number.MAX_SAFE_INTEGER),i[a]=l}for(let a=0;a<i.length;a++){const u=s[a];i[a]<0&&(i[a]+=u),i[a]=E0(0,i[a],s[a])}return i}function $4(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function B4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const u=r[s];return o<0&&(o+=u),o=E0(0,o,u-1),o}function M4(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const u=r[s];return o<0&&(o+=u),a>0?o=E0(0,o,u):o=E0(-1,o,u-1),o}function f2(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function h2(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function V4(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{R(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(R(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function U4(t,e,n,r,s,i,o,a,u){let l;if(r==null?(l=new Array(e.length),l.fill(1)):l=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:l.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};for(let w=0;w<d.dims;w++)c&&1<<w&a&&d.numAddAxisAfterEllipsis++,1<<w&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};fY(d,f);let h=!0,p=!0,y=!0;const b=[],g=[];for(let w=0;w<t.length;++w){if(f.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const x=!!(f.shrinkAxisMask&1<<w),C=t[w];if(C===-1){b.push(x?1:-1);continue}const k=[f.beginMask&1<<w,f.endMask&1<<w],P=[f.strides[w]>0?0:-1,f.strides[w]>0?C:C-1];if(x&&f.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&f.strides[w]===1;const N=!!(f.beginMask&1<<w&&f.endMask&1<<w);if(f.beginValid&&f.endValid){if(x){const Z=f.begin[w]<0?C+f.begin[w]:f.begin[w];if(f.begin[w]=Z,f.end[w]=f.begin[w]+1,Z<0||Z>=C)throw Error(`slice index ${f.begin[w]} of dimension ${w} out of bounds.`)}else f.begin[w]=zC(f.begin[w],0,f.strides[w],C,k,P),f.end[w]=zC(f.end[w],1,f.strides[w],C,k,P);const K=f.strides[w]===1&&f.begin[w]===0&&f.end[w]===C;h=h&&K,p=p&&(w===0&&f.strides[w]===1||K)}else h=h&&f.strides[w]===1&&N,p=p&&(w===0&&f.strides[w]===1||N);let $,U=!1;if(f.beginValid&&f.endValid?($=f.end[w]-f.begin[w],U=!0):x?($=1,U=!0):N&&C>=0&&(f.strides[w]<0?$=-C:$=C,U=!0),U){let K;$===0||$<0!=f.strides[w]<0?K=0:K=Math.trunc($/f.strides[w])+($%f.strides[w]!==0?1:0),b.push(K)}else b.push(-1)}for(let w=0;w<f.finalShapeGatherIndices.length;++w){const x=f.finalShapeGatherIndices[w];x>=0?g.push(b[x]):x===Lv&&g.push(1)}return{finalShapeSparse:g.filter((w,x)=>f.finalShapeGatherIndices[x]!==Lv),finalShape:g,isIdentity:h,sliceDim0:p,isSimpleSlice:y,begin:f.begin,end:f.end,strides:f.strides}}function fY(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(Lv),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(lY),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function zC(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const hY=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:k4,computeFlatOffset:h2,computeOutShape:R4,getNormalizedAxes:dY,isSliceContinous:f2,maskToAxes:cY,parseSliceParams:V4,sliceInfo:U4,startForAxis:B4,startIndicesWithElidedDims:L4,stopForAxis:M4,stopIndicesWithElidedDims:F4,stridesForAxis:$4,stridesWithElidedDims:P4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function mY(){return new Promise(t=>pY(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4(t,e){const n=t[0].length;t.forEach((s,i)=>{R(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),R(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)R(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function ml(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ei;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Ei||(Ei={}));function W4(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function j4(t){const e={FIRST_DIM_SIZE:Ei.FIRST_DIM_SIZE,VALUE_ROWIDS:Ei.VALUE_ROWIDS,ROW_LENGTHS:Ei.ROW_LENGTHS,ROW_SPLITS:Ei.ROW_SPLITS,ROW_LIMITS:Ei.ROW_LIMITS,ROW_STARTS:Ei.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function G4(t){return t.length===0?0:t[0]===Ei.FIRST_DIM_SIZE?t.length-1:t.length}function q4(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p2=30;function Mg(t){return t<=p2?t:hv(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H4(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function g2(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function y2(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function K4(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function X4(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4=1.7580993408473768,Q4=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4=.3275911,J4=.254829592,eD=-.284496736,tD=1.421413741,nD=-1.453152027,rD=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function gY(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function yY(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function bY(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function vY(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function wY(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function xY(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function SY(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ny="->",AY=/->/g,WC=",",jC="...";function sD(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(AY,"").length)/Ny.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Ny}").`);const[r,s]=t.split(Ny);R(r.indexOf(jC)===-1,()=>`The ellipsis notation ("${jC}") is not supported yet.`);const i=r.split(WC),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<s.length;++f){const h=s[f];if(!i.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let f=0;f<r.length;++f){const h=r[f];a.indexOf(h)===-1&&h!==WC&&a.push(h)}const u=new Array(i.length);for(let f=0;f<o;++f){if(new Set(i[f].split("")).size!==i[f].length)throw new Error(`Found duplicate axes in input component ${i[f]}. Support for duplicate axes in input is not implemented yet.`);u[f]=[];for(let h=0;h<i[f].length;++h)u[f].push(a.indexOf(i[f][h]))}const l=a.length,c=s.length,d=[];for(let f=c;f<l;++f)d.push(f);return{allDims:a,summedDims:d,idDims:u}}function iD(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function oD(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:R(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function aD(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],u=EY(e,a);for(const l of u)i.indexOf(l)===-1&&(r[o].push(l),i.push(l))}return{path:n,steps:r}}function uD(t){return t.every((e,n)=>e===n)}function EY(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function lD(t,e,n=0){let r=[];if(typeof e=="number")R(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);R(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,u)=>u>0?a+u:a);e[i]=t.shape[n]-o}R(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cD(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function dD(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function fD(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function pD(t,e){return`size ${t} must be non-negative, not ${e}`}function mD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function gD(t,e){const n=de(t),r=de(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function yD(t,e){const n=de(t),r=de(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(){return"segment ids must be >= 0"}function bD(){return"segment ids are not increasing"}function vD(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function wD(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xD(t,e){let n=!1,r;for(t<=p2?(r=t,n=!0):r=hv(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=hv(t,r+1);return r}function SD(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function AD(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let u=1,l=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:o,outputShape:a}}const CY=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:AD,computeOutShape:SD,segOpComputeOptimalWindowSize:xD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function id(t){try{return t.map(e=>td(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function ED(t){return t.map(e=>Hu(e))}const NY=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:J4,ERF_A2:eD,ERF_A3:tD,ERF_A4:nD,ERF_A5:rD,ERF_P:Z4,PARALLELIZE_THRESHOLD:p2,get RowPartitionType(){return Ei},SELU_SCALE:Q4,SELU_SCALEALPHA:Y4,applyActivation:$g,assertAndGetBroadcastShape:st,assertAxesAreInnerMostDims:Fi,assertParamsConsistent:z4,assignToTypedArray:wY,axesAreInnerMostDims:Gx,calculateShapes:Dg,checkEinsumDimSizes:oD,checkPadOnDimRoundingMode:Js,combineLocations:WO,combineRaggedTensorToTensorShapes:W4,complexWithEvenIndex:yY,complexWithOddIndex:bY,computeConv2DInfo:vs,computeConv3DInfo:zh,computeDefaultPad:Wx,computeDilation2DInfo:LO,computeOptimalWindowSize:Mg,computeOutAndReduceShapes:co,computeOutShape:ml,computePool2DInfo:El,computePool3DInfo:Uh,convertConv2DDataFormat:gd,decodeEinsumEquation:sD,eitherStridesOrDilationsAreOne:Hr,expandShapeToKeepDim:ws,exponent:SY,exponents:xY,fromStringArrayToUint8:ED,fromUint8ToStringArray:id,getAxesPermutation:ei,getBroadcastDims:k0,getComplexWithIndex:vY,getEinsumComputePath:aD,getEinsumPermutation:iD,getFusedBiasGradient:Fg,getFusedDyActivation:Lg,getImageCenter:H4,getInnerMostAxes:ti,getPermuted:g2,getRaggedRank:G4,getReductionAxes:VO,getReshaped:m2,getReshapedPermuted:y2,getRowPartitionTypesHelper:j4,getSliceBeginCoords:K4,getSliceSize:X4,getSparseFillEmptyRowsIndicesDenseShapeMismatch:cD,getSparseFillEmptyRowsNegativeIndexErrorMessage:dD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:fD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:mD,getSparseReshapeInputOutputMismatchErrorMessage:yD,getSparseReshapeInputOutputMultipleErrorMessage:gD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:hD,getSparseReshapeNegativeOutputDimErrorMessage:pD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:wD,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:$v,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:bD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:vD,getUndoAxesPermutation:qx,isIdentityPermutation:uD,log:Cz,mergeRealAndImagArrays:Fv,prepareAndValidate:I4,prepareSplitSize:lD,segment_util:CY,shouldFuse:Bg,slice_util:hY,splitRealAndImagArrays:gY,stridesOrDilationsArePositive:dl,tupleValuesAreOne:bh,upcastType:uo,validateDefaultValueShape:q4,validateInput:o2,validateUpdateShape:h4,warn:Ni},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WX();const Bv="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",nr=1088,rr=960,Rm=25,Sa=2*Rm,CD=["b","k","n","p","q","r","B","K","N","P","Q","R"],GC=["b","k","n","p","q","r"],B0=["a1","b1","c1","d1","e1","f1","g1","h1","a2","b2","c2","d2","e2","f2","g2","h2","a3","b3","c3","d3","e3","f3","g3","h3","a4","b4","c4","d4","e4","f4","g4","h4","a5","b5","c5","d5","e5","f5","g5","h5","a6","b6","c6","d6","e6","f6","g6","h6","a7","b7","c7","d7","e7","f7","g7","h7","a8","b8","c8","d8","e8","f8","g8","h8"],yi=128,Up=8*yi,b2=["h1","a1","a8","h8"],TY=()=>{const t={};return CD.forEach((e,n)=>{t[e]=n}),t},Tf=TY(),_Y=()=>{const t={};return B0.forEach((e,n)=>{t[e]=n}),t},bi=_Y(),qC=["#FF3838","#FF9D97","#FF701F","#FFB21D","#CFD231","#48F90A","#92CC17","#3DDB86","#1A9334","#00D4BB","#2C99A8","#00C2FF"],Mv=16/9,ND={audio:!1,video:{facingMode:{ideal:"environment"},width:{ideal:640},aspectRatio:Mv,resizeMode:"none"}},TD=t=>{t.clearRect(0,0,t.canvas.width,t.canvas.height)},_D=t=>{const e=t.getContext("2d");e.globalAlpha=.8;const n=e.canvas.width,r=e.canvas.height;TD(e);const i=`${Math.max(Math.round(Math.max(n,r)/40),14)}px Arial`,o=parseInt(i,10),a=Math.max(Math.min(n,r)/200,2.5);e.textBaseline="top",e.lineWidth=a,e.font=i;const u=n/nr,l=r/rr;return[e,o,a,u,l]},ID=(t,e,n,r,s)=>{t.strokeStyle=n,e.forEach((i,o)=>{t.strokeRect(i[0]*r,i[1]*s,1,1)})},IY=(t,e,n,r,s)=>{t.strokeStyle=n,t.beginPath();const i=e.length;for(let o=0;o<i;o++)t.moveTo(e[o][0]*r,e[o][1]*s),t.lineTo(e[(o+1)%i][0]*r,e[(o+1)%i][1]*s);t.stroke()},kY=(t,e,n,r,s,i,o)=>{t.fillStyle=e;const a=t.measureText(s).width,u=r-o-i/2,l=n-a/2;t.fillRect(l,u,a+o,i+o),t.fillStyle="#ffffff",t.fillText(s,l,u)},RY=(t,e)=>{const[n,r,s,i,o]=_D(t);ID(n,e,"blue",i,o)},Bo=11102230246251565e-32,Zn=134217729,PY=(3+8*Bo)*Bo;function Ty(t,e,n,r,s){let i,o,a,u,l=e[0],c=r[0],d=0,f=0;c>l==c>-l?(i=l,l=e[++d]):(i=c,c=r[++f]);let h=0;if(d<t&&f<n)for(c>l==c>-l?(o=l+i,a=i-(o-l),l=e[++d]):(o=c+i,a=i-(o-c),c=r[++f]),i=o,a!==0&&(s[h++]=a);d<t&&f<n;)c>l==c>-l?(o=i+l,u=o-i,a=i-(o-u)+(l-u),l=e[++d]):(o=i+c,u=o-i,a=i-(o-u)+(c-u),c=r[++f]),i=o,a!==0&&(s[h++]=a);for(;d<t;)o=i+l,u=o-i,a=i-(o-u)+(l-u),l=e[++d],i=o,a!==0&&(s[h++]=a);for(;f<n;)o=i+c,u=o-i,a=i-(o-u)+(c-u),c=r[++f],i=o,a!==0&&(s[h++]=a);return(i!==0||h===0)&&(s[h++]=i),h}function OY(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function jh(t){return new Float64Array(t)}const DY=(3+16*Bo)*Bo,LY=(2+12*Bo)*Bo,FY=(9+64*Bo)*Bo*Bo,Jl=jh(4),HC=jh(8),KC=jh(12),XC=jh(16),yr=jh(4);function $Y(t,e,n,r,s,i,o){let a,u,l,c,d,f,h,p,y,b,g,v,w,x,C,k,P,N;const $=t-s,U=n-s,K=e-i,Z=r-i;x=$*Z,f=Zn*$,h=f-(f-$),p=$-h,f=Zn*Z,y=f-(f-Z),b=Z-y,C=p*b-(x-h*y-p*y-h*b),k=K*U,f=Zn*K,h=f-(f-K),p=K-h,f=Zn*U,y=f-(f-U),b=U-y,P=p*b-(k-h*y-p*y-h*b),g=C-P,d=C-g,Jl[0]=C-(g+d)+(d-P),v=x+g,d=v-x,w=x-(v-d)+(g-d),g=w-k,d=w-g,Jl[1]=w-(g+d)+(d-k),N=v+g,d=N-v,Jl[2]=v-(N-d)+(g-d),Jl[3]=N;let ie=OY(4,Jl),ee=LY*o;if(ie>=ee||-ie>=ee||(d=t-$,a=t-($+d)+(d-s),d=n-U,l=n-(U+d)+(d-s),d=e-K,u=e-(K+d)+(d-i),d=r-Z,c=r-(Z+d)+(d-i),a===0&&u===0&&l===0&&c===0)||(ee=FY*o+PY*Math.abs(ie),ie+=$*c+Z*a-(K*l+U*u),ie>=ee||-ie>=ee))return ie;x=a*Z,f=Zn*a,h=f-(f-a),p=a-h,f=Zn*Z,y=f-(f-Z),b=Z-y,C=p*b-(x-h*y-p*y-h*b),k=u*U,f=Zn*u,h=f-(f-u),p=u-h,f=Zn*U,y=f-(f-U),b=U-y,P=p*b-(k-h*y-p*y-h*b),g=C-P,d=C-g,yr[0]=C-(g+d)+(d-P),v=x+g,d=v-x,w=x-(v-d)+(g-d),g=w-k,d=w-g,yr[1]=w-(g+d)+(d-k),N=v+g,d=N-v,yr[2]=v-(N-d)+(g-d),yr[3]=N;const j=Ty(4,Jl,4,yr,HC);x=$*c,f=Zn*$,h=f-(f-$),p=$-h,f=Zn*c,y=f-(f-c),b=c-y,C=p*b-(x-h*y-p*y-h*b),k=K*l,f=Zn*K,h=f-(f-K),p=K-h,f=Zn*l,y=f-(f-l),b=l-y,P=p*b-(k-h*y-p*y-h*b),g=C-P,d=C-g,yr[0]=C-(g+d)+(d-P),v=x+g,d=v-x,w=x-(v-d)+(g-d),g=w-k,d=w-g,yr[1]=w-(g+d)+(d-k),N=v+g,d=N-v,yr[2]=v-(N-d)+(g-d),yr[3]=N;const M=Ty(j,HC,4,yr,KC);x=a*c,f=Zn*a,h=f-(f-a),p=a-h,f=Zn*c,y=f-(f-c),b=c-y,C=p*b-(x-h*y-p*y-h*b),k=u*l,f=Zn*u,h=f-(f-u),p=u-h,f=Zn*l,y=f-(f-l),b=l-y,P=p*b-(k-h*y-p*y-h*b),g=C-P,d=C-g,yr[0]=C-(g+d)+(d-P),v=x+g,d=v-x,w=x-(v-d)+(g-d),g=w-k,d=w-g,yr[1]=w-(g+d)+(d-k),N=v+g,d=N-v,yr[2]=v-(N-d)+(g-d),yr[3]=N;const O=Ty(M,KC,4,yr,XC);return XC[O-1]}function zp(t,e,n,r,s,i){const o=(e-i)*(n-s),a=(t-s)*(r-i),u=o-a,l=Math.abs(o+a);return Math.abs(u)>=DY*l?u:-$Y(t,e,n,r,s,i,l)}const YC=Math.pow(2,-52),Wp=new Uint32Array(512);class v2{static from(e,n=zY,r=WY){const s=e.length,i=new Float64Array(s*2);for(let o=0;o<s;o++){const a=e[o];i[2*o]=n(a),i[2*o+1]=r(a)}return new v2(i)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:r,_hullTri:s,_hullHash:i}=this,o=e.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let $=0;$<o;$++){const U=e[2*$],K=e[2*$+1];U<a&&(a=U),K<u&&(u=K),U>l&&(l=U),K>c&&(c=K),this._ids[$]=$}const d=(a+l)/2,f=(u+c)/2;let h,p,y;for(let $=0,U=1/0;$<o;$++){const K=_y(d,f,e[2*$],e[2*$+1]);K<U&&(h=$,U=K)}const b=e[2*h],g=e[2*h+1];for(let $=0,U=1/0;$<o;$++){if($===h)continue;const K=_y(b,g,e[2*$],e[2*$+1]);K<U&&K>0&&(p=$,U=K)}let v=e[2*p],w=e[2*p+1],x=1/0;for(let $=0;$<o;$++){if($===h||$===p)continue;const U=VY(b,g,v,w,e[2*$],e[2*$+1]);U<x&&(y=$,x=U)}let C=e[2*y],k=e[2*y+1];if(x===1/0){for(let K=0;K<o;K++)this._dists[K]=e[2*K]-e[0]||e[2*K+1]-e[1];Ec(this._ids,this._dists,0,o-1);const $=new Uint32Array(o);let U=0;for(let K=0,Z=-1/0;K<o;K++){const ie=this._ids[K],ee=this._dists[ie];ee>Z&&($[U++]=ie,Z=ee)}this.hull=$.subarray(0,U),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(zp(b,g,v,w,C,k)<0){const $=p,U=v,K=w;p=y,v=C,w=k,y=$,C=U,k=K}const P=UY(b,g,v,w,C,k);this._cx=P.x,this._cy=P.y;for(let $=0;$<o;$++)this._dists[$]=_y(e[2*$],e[2*$+1],P.x,P.y);Ec(this._ids,this._dists,0,o-1),this._hullStart=h;let N=3;r[h]=n[y]=p,r[p]=n[h]=y,r[y]=n[p]=h,s[h]=0,s[p]=1,s[y]=2,i.fill(-1),i[this._hashKey(b,g)]=h,i[this._hashKey(v,w)]=p,i[this._hashKey(C,k)]=y,this.trianglesLen=0,this._addTriangle(h,p,y,-1,-1,-1);for(let $=0,U,K;$<this._ids.length;$++){const Z=this._ids[$],ie=e[2*Z],ee=e[2*Z+1];if($>0&&Math.abs(ie-U)<=YC&&Math.abs(ee-K)<=YC||(U=ie,K=ee,Z===h||Z===p||Z===y))continue;let j=0;for(let F=0,ue=this._hashKey(ie,ee);F<this._hashSize&&(j=i[(ue+F)%this._hashSize],!(j!==-1&&j!==r[j]));F++);j=n[j];let M=j,O;for(;O=r[M],zp(ie,ee,e[2*M],e[2*M+1],e[2*O],e[2*O+1])>=0;)if(M=O,M===j){M=-1;break}if(M===-1)continue;let D=this._addTriangle(M,Z,r[M],-1,-1,s[M]);s[Z]=this._legalize(D+2),s[M]=D,N++;let V=r[M];for(;O=r[V],zp(ie,ee,e[2*V],e[2*V+1],e[2*O],e[2*O+1])<0;)D=this._addTriangle(V,Z,O,s[Z],-1,s[V]),s[Z]=this._legalize(D+2),r[V]=V,N--,V=O;if(M===j)for(;O=n[M],zp(ie,ee,e[2*O],e[2*O+1],e[2*M],e[2*M+1])<0;)D=this._addTriangle(O,Z,M,-1,s[M],s[O]),this._legalize(D+2),s[O]=D,r[M]=M,N--,M=O;this._hullStart=n[Z]=M,r[M]=n[V]=Z,r[Z]=V,i[this._hashKey(ie,ee)]=Z,i[this._hashKey(e[2*M],e[2*M+1])]=M}this.hull=new Uint32Array(N);for(let $=0,U=this._hullStart;$<N;$++)this.hull[$]=U,U=r[U];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(BY(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:r,coords:s}=this;let i=0,o=0;for(;;){const a=r[e],u=e-e%3;if(o=u+(e+2)%3,a===-1){if(i===0)break;e=Wp[--i];continue}const l=a-a%3,c=u+(e+1)%3,d=l+(a+2)%3,f=n[o],h=n[e],p=n[c],y=n[d];if(MY(s[2*f],s[2*f+1],s[2*h],s[2*h+1],s[2*p],s[2*p+1],s[2*y],s[2*y+1])){n[e]=y,n[a]=f;const g=r[d];if(g===-1){let w=this._hullStart;do{if(this._hullTri[w]===d){this._hullTri[w]=e;break}w=this._hullPrev[w]}while(w!==this._hullStart)}this._link(e,g),this._link(a,r[o]),this._link(o,d);const v=l+(a+1)%3;i<Wp.length&&(Wp[i++]=v)}else{if(i===0)break;e=Wp[--i]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,r,s,i,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,s),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function BY(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function _y(t,e,n,r){const s=t-n,i=e-r;return s*s+i*i}function MY(t,e,n,r,s,i,o,a){const u=t-o,l=e-a,c=n-o,d=r-a,f=s-o,h=i-a,p=u*u+l*l,y=c*c+d*d,b=f*f+h*h;return u*(d*b-y*h)-l*(c*b-y*f)+p*(c*h-d*f)<0}function VY(t,e,n,r,s,i){const o=n-t,a=r-e,u=s-t,l=i-e,c=o*o+a*a,d=u*u+l*l,f=.5/(o*l-a*u),h=(l*c-a*d)*f,p=(o*d-u*c)*f;return h*h+p*p}function UY(t,e,n,r,s,i){const o=n-t,a=r-e,u=s-t,l=i-e,c=o*o+a*a,d=u*u+l*l,f=.5/(o*l-a*u),h=t+(l*c-a*d)*f,p=e+(o*d-u*c)*f;return{x:h,y:p}}function Ec(t,e,n,r){if(r-n<=20)for(let s=n+1;s<=r;s++){const i=t[s],o=e[i];let a=s-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=i}else{const s=n+r>>1;let i=n+1,o=r;uf(t,s,i),e[t[n]]>e[t[r]]&&uf(t,n,r),e[t[i]]>e[t[r]]&&uf(t,i,r),e[t[n]]>e[t[i]]&&uf(t,n,i);const a=t[i],u=e[a];for(;;){do i++;while(e[t[i]]<u);do o--;while(e[t[o]]>u);if(o<i)break;uf(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(Ec(t,e,i,r),Ec(t,e,n,o-1)):(Ec(t,e,n,o-1),Ec(t,e,i,r))}}function uf(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function zY(t){return t[0]}function WY(t){return t[1]}var jY={},GY=Object.create,kD=Object.defineProperty,qY=Object.getOwnPropertyDescriptor,HY=Object.getOwnPropertyNames,KY=Object.getPrototypeOf,XY=Object.prototype.hasOwnProperty,w2=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')}),x2=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),YY=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of HY(e))!XY.call(t,s)&&s!==n&&kD(t,s,{get:()=>e[s],enumerable:!(r=qY(e,s))||r.enumerable});return t},QY=(t,e,n)=>(n=t!=null?GY(KY(t)):{},YY(!t||!t.__esModule?kD(n,"default",{value:t,enumerable:!0}):n,t)),ZY=x2((t,e)=>{e.exports=function(n){return n&&typeof n=="object"&&typeof n.copy=="function"&&typeof n.fill=="function"&&typeof n.readUInt8=="function"}}),JY=x2((t,e)=>{typeof Object.create=="function"?e.exports=function(n,r){n.super_=r,n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(n,r){n.super_=r;var s=function(){};s.prototype=r.prototype,n.prototype=new s,n.prototype.constructor=n}}),eQ=x2(t=>{var e=/%[sdj%]/g;t.format=function(O){if(!w(O)){for(var D=[],V=0;V<arguments.length;V++)D.push(s(arguments[V]));return D.join(" ")}for(var V=1,F=arguments,ue=F.length,se=String(O).replace(e,function(be){if(be==="%%")return"%";if(V>=ue)return be;switch(be){case"%s":return String(F[V++]);case"%d":return Number(F[V++]);case"%j":try{return JSON.stringify(F[V++])}catch{return"[Circular]"}default:return be}}),he=F[V];V<ue;he=F[++V])b(he)||!P(he)?se+=" "+he:se+=" "+s(he);return se},t.deprecate=function(O,D){if(C(global.process))return function(){return t.deprecate(O,D).apply(this,arguments)};if(process.noDeprecation===!0)return O;var V=!1;function F(){if(!V){if(process.throwDeprecation)throw new Error(D);process.traceDeprecation?console.trace(D):console.error(D),V=!0}return O.apply(this,arguments)}return F};var n={},r;t.debuglog=function(O){if(C(r)&&(r=jY.NODE_DEBUG||""),O=O.toUpperCase(),!n[O])if(new RegExp("\\b"+O+"\\b","i").test(r)){var D=process.pid;n[O]=function(){var V=t.format.apply(t,arguments);console.error("%s %d: %s",O,D,V)}}else n[O]=function(){};return n[O]};function s(O,D){var V={seen:[],stylize:o};return arguments.length>=3&&(V.depth=arguments[2]),arguments.length>=4&&(V.colors=arguments[3]),y(D)?V.showHidden=D:D&&t._extend(V,D),C(V.showHidden)&&(V.showHidden=!1),C(V.depth)&&(V.depth=2),C(V.colors)&&(V.colors=!1),C(V.customInspect)&&(V.customInspect=!0),V.colors&&(V.stylize=i),u(V,O,V.depth)}t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function i(O,D){var V=s.styles[D];return V?"\x1B["+s.colors[V][0]+"m"+O+"\x1B["+s.colors[V][1]+"m":O}function o(O,D){return O}function a(O){var D={};return O.forEach(function(V,F){D[V]=!0}),D}function u(O,D,V){if(O.customInspect&&D&&U(D.inspect)&&D.inspect!==t.inspect&&!(D.constructor&&D.constructor.prototype===D)){var F=D.inspect(V,O);return w(F)||(F=u(O,F,V)),F}var ue=l(O,D);if(ue)return ue;var se=Object.keys(D),he=a(se);if(O.showHidden&&(se=Object.getOwnPropertyNames(D)),$(D)&&(se.indexOf("message")>=0||se.indexOf("description")>=0))return c(D);if(se.length===0){if(U(D)){var ae=D.name?": "+D.name:"";return O.stylize("[Function"+ae+"]","special")}if(k(D))return O.stylize(RegExp.prototype.toString.call(D),"regexp");if(N(D))return O.stylize(Date.prototype.toString.call(D),"date");if($(D))return c(D)}var be="",_e=!1,lt=["{","}"];if(p(D)&&(_e=!0,lt=["[","]"]),U(D)){var we=D.name?": "+D.name:"";be=" [Function"+we+"]"}if(k(D)&&(be=" "+RegExp.prototype.toString.call(D)),N(D)&&(be=" "+Date.prototype.toUTCString.call(D)),$(D)&&(be=" "+c(D)),se.length===0&&(!_e||D.length==0))return lt[0]+be+lt[1];if(V<0)return k(D)?O.stylize(RegExp.prototype.toString.call(D),"regexp"):O.stylize("[Object]","special");O.seen.push(D);var Hn;return _e?Hn=d(O,D,V,he,se):Hn=se.map(function(hr){return f(O,D,V,he,hr,_e)}),O.seen.pop(),h(Hn,be,lt)}function l(O,D){if(C(D))return O.stylize("undefined","undefined");if(w(D)){var V="'"+JSON.stringify(D).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return O.stylize(V,"string")}if(v(D))return O.stylize(""+D,"number");if(y(D))return O.stylize(""+D,"boolean");if(b(D))return O.stylize("null","null")}function c(O){return"["+Error.prototype.toString.call(O)+"]"}function d(O,D,V,F,ue){for(var se=[],he=0,ae=D.length;he<ae;++he)M(D,String(he))?se.push(f(O,D,V,F,String(he),!0)):se.push("");return ue.forEach(function(be){be.match(/^\d+$/)||se.push(f(O,D,V,F,be,!0))}),se}function f(O,D,V,F,ue,se){var he,ae,be;if(be=Object.getOwnPropertyDescriptor(D,ue)||{value:D[ue]},be.get?be.set?ae=O.stylize("[Getter/Setter]","special"):ae=O.stylize("[Getter]","special"):be.set&&(ae=O.stylize("[Setter]","special")),M(F,ue)||(he="["+ue+"]"),ae||(O.seen.indexOf(be.value)<0?(b(V)?ae=u(O,be.value,null):ae=u(O,be.value,V-1),ae.indexOf(`
`)>-1&&(se?ae=ae.split(`
`).map(function(_e){return"  "+_e}).join(`
`).substr(2):ae=`
`+ae.split(`
`).map(function(_e){return"   "+_e}).join(`
`))):ae=O.stylize("[Circular]","special")),C(he)){if(se&&ue.match(/^\d+$/))return ae;he=JSON.stringify(""+ue),he.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(he=he.substr(1,he.length-2),he=O.stylize(he,"name")):(he=he.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),he=O.stylize(he,"string"))}return he+": "+ae}function h(O,D,V){var F=0,ue=O.reduce(function(se,he){return F++,he.indexOf(`
`)>=0&&F++,se+he.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ue>60?V[0]+(D===""?"":D+`
 `)+" "+O.join(`,
  `)+" "+V[1]:V[0]+D+" "+O.join(", ")+" "+V[1]}function p(O){return Array.isArray(O)}t.isArray=p;function y(O){return typeof O=="boolean"}t.isBoolean=y;function b(O){return O===null}t.isNull=b;function g(O){return O==null}t.isNullOrUndefined=g;function v(O){return typeof O=="number"}t.isNumber=v;function w(O){return typeof O=="string"}t.isString=w;function x(O){return typeof O=="symbol"}t.isSymbol=x;function C(O){return O===void 0}t.isUndefined=C;function k(O){return P(O)&&Z(O)==="[object RegExp]"}t.isRegExp=k;function P(O){return typeof O=="object"&&O!==null}t.isObject=P;function N(O){return P(O)&&Z(O)==="[object Date]"}t.isDate=N;function $(O){return P(O)&&(Z(O)==="[object Error]"||O instanceof Error)}t.isError=$;function U(O){return typeof O=="function"}t.isFunction=U;function K(O){return O===null||typeof O=="boolean"||typeof O=="number"||typeof O=="string"||typeof O=="symbol"||typeof O>"u"}t.isPrimitive=K,t.isBuffer=ZY();function Z(O){return Object.prototype.toString.call(O)}function ie(O){return O<10?"0"+O.toString(10):O.toString(10)}var ee=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var O=new Date,D=[ie(O.getHours()),ie(O.getMinutes()),ie(O.getSeconds())].join(":");return[O.getDate(),ee[O.getMonth()],D].join(" ")}t.log=function(){console.log("%s - %s",j(),t.format.apply(t,arguments))},t.inherits=JY(),t._extend=function(O,D){if(!D||!P(D))return O;for(var V=Object.keys(D),F=V.length;F--;)O[V[F]]=D[V[F]];return O};function M(O,D){return Object.prototype.hasOwnProperty.call(O,D)}}),ec=32,RD=t=>t.reduce((e,n)=>e.concat(Array.isArray(n)?RD(n):n),[]),PD=t=>ArrayBuffer.isView(t)&&!(t instanceof DataView),OD=t=>t.reduce((e,n)=>e*n,1),DD=t=>Array.isArray(t)||PD(t)?[t.length].concat(DD(t[0])):[],S2=t=>[...t.slice(1).map((e,n)=>t.slice(n+1).reduce((r,s)=>r*s,1)),1],tQ=t=>{let{constructor:{name:e="Float32Array"}={}}=t||{};switch(e){case"Int8Array":return"int8";case"Uint8Array":return"uint8";case"Int16Array":return"int16";case"Uint16Array":return"uint16";case"Int32Array":return"int32";case"Uint32Array":return"uint32";case"Uint8ClampedArray":return"uint8c";case"Float32Array":return"float32";case"Float64Array":return"float64";default:return"float64"}},od=t=>{switch(t){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"uint8c":return Uint8ClampedArray;case"float32":return Float32Array;case"float64":return Float64Array;default:return Float64Array}},Pi=(...t)=>new _l(...t),Me=class{constructor(t){J(this,"x");J(this,"shape");J(this,"shapem1");J(this,"strides");J(this,"backstrides");J(this,"length");J(this,"lengthm1");J(this,"nd");J(this,"ndm1");J(this,"index");J(this,"coords");J(this,"pos");J(this,"factors");this.x=Pi(t);let{shape:e,strides:n,length:r}=this.x;this.length=r,this.lengthm1=r-1,this.nd=e.length,this.ndm1=this.nd-1,this.shape=Array(ec).fill(0),this.strides=Array(ec).fill(0),this.shapem1=Array(ec).fill(0),this.coords=Array(ec).fill(0),this.backstrides=Array(ec).fill(0),this.factors=Array(ec).fill(0),this.nd!==0&&(this.factors[this.nd-1]=1);let s;for(s=0;s<this.nd;s+=1)this.shape[s]=e[s],this.shapem1[s]=e[s]-1,this.strides[s]=n[s],this.backstrides[s]=n[s]*this.shapem1[s],this.coords[s]=0,s>0&&(this.factors[this.ndm1-s]=this.factors[this.nd-s]*e[this.nd-s]);this.index=0,this.pos=0}done(){return this.index>this.lengthm1}current(){let t=this.done();return{value:t?void 0:this.pos,done:t}}next(){let t=this.current();if(t.done)return t;let{ndm1:e,shapem1:n,strides:r,backstrides:s}=this,i;for(i=e;i>=0;i-=1){if(this.coords[i]<n[i]){this.coords[i]+=1,this.pos+=r[i];break}this.coords[i]=0,this.pos-=s[i]}return this.index+=1,t}[Symbol.iterator](){return this}},vd=class{constructor(...t){J(this,"iters");J(this,"shape");J(this,"nd");J(this,"length");J(this,"lengthm1");J(this,"numiter");J(this,"index");J(this,"pos");this.iters=t.map(a=>new Me(a)),this.numiter=t.length;let e,n;for(e=0,n=0;e<this.numiter;e+=1)n=Math.max(n,this.iters[e].x.shape.length);this.nd=n,this.shape=Array(n).fill(0);let r,s,i,o;for(e=0;e<n;e+=1)for(this.shape[e]=1,s=0;s<this.numiter;s+=1)if(r=this.iters[s],i=e+r.x.shape.length-n,i>=0){if(o=r.x.shape[i],o==1)continue;if(this.shape[e]==1)this.shape[e]=o;else if(this.shape[e]!==o)throw new Error("shape mismatch")}for(o=this.shape.reduce((a,u)=>a*u,1),this.length=o,this.lengthm1=o-1,e=0;e<this.numiter;e+=1)for(r=this.iters[e],r.nd=this.nd,r.ndm1=this.nd-1,r.length=o,r.lengthm1=o-1,n=r.x.shape.length,n!==0&&(r.factors[this.nd-1]=1),s=0;s<this.nd;s+=1)r.shape[s]=this.shape[s],r.shapem1[s]=this.shape[s]-1,i=s+n-this.nd,i<0||r.x.shape[i]!==this.shape[s]?r.strides[s]=0:r.strides[s]=r.x.strides[i],r.backstrides[s]=r.strides[s]*r.shapem1[s],s>0&&(r.factors[this.nd-s-1]=r.factors[this.nd-s]*this.shape[this.nd-s]);this.index=0,this.pos=Array(this.numiter).fill(0)}done(){return this.index>this.lengthm1}current(){let t=this.done();return{value:t?void 0:this.pos,done:t}}next(){let t=this.current();if(t.done)return t;this.index+=1;let{numiter:e}=this,n,r;for(r=0;r<e;r+=1)n=this.iters[r],this.pos[r]=n.pos,n.next();return t}[Symbol.iterator](){return this}},{abs:nQ}=Math;function rQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=nQ(t[n]);return this}var{acos:sQ}=Math;function iQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=sQ(t[n]);return this}var{acosh:oQ}=Math;function aQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=oQ(t[n]);return this}var ln;try{ln=w2("nblas")}catch{}var QC=ln&&ln.NoTrans;ln&&ln.Trans;function uQ(t,e,n,r,s,i,o){if(r.length/s!==e||i.length/o!==e)throw new Error("lengths do not match");switch(t){case"float64":return ln.daxpy(e,n,r,s,i,o);case"float32":return ln.saxpy(e,n,r,s,i,o);default:throw new Error("wrong dtype")}}function lQ(t,e,n,r,s,i){if(n.length/r!==e||s.length/i!==e)throw new Error("lengths do not match");switch(t){case"float64":return ln.ddot(e,n,r,s,i);case"float32":return ln.sdot(e,n,r,s,i);default:throw new Error("wrong dtype")}}function cQ(t,e,n,r){if(n.length/r!==e)throw new Error("lengths do not match");switch(t){case"float64":return ln.idamax(e,n,r);case"float32":return ln.isamax(e,n,r);default:throw new Error("wrong dtype")}}function dQ(t,e,n,r,s,i,o,a,u,l,c,d,f,h){let{length:p}=a,{length:y}=l,{length:b}=f;if(e===ln.NoTrans&&p!==u*r||e===ln.Trans&&p!==u*i)throw new Error("lengths do not match");if(n===ln.NoTrans&&y!==c*i||n===ln.Trans&&y!==c*s)throw new Error("lengths do not match");if(b!==h*r)throw new Error("lengths do not match");switch(t){case"float64":return ln.dgemm(e,n,r,s,i,o,a,u,l,c,d,f,h);case"float32":return ln.sgemm(e,n,r,s,i,o,a,u,l,c,d,f,h);default:throw new Error("wrong dtype")}}function fQ(t,e,n,r){if(n.length/r!==e)throw new Error("lengths do not match");switch(t){case"float64":return ln.dnrm2(e,n,r);case"float32":return ln.snrm2(e,n,r);default:throw new Error("wrong dtype")}}function hQ(t,e,n,r,s){if(r.length/s!==e)throw new Error("lengths do not match");switch(t){case"float64":return ln.dscal(e,n,r,s);case"float32":return ln.sscal(e,n,r,s);default:throw new Error("wrong dtype")}}function pQ(t,e=1){let{data:n,length:r,strides:s,dtype:i}=this,{data:o,strides:a}=Pi(t);try{let u=a[a.length-1],l=s[s.length-1];if(u!==l)throw new Error("inc_x and inc_y must be equal");uQ(i,r,e,o,u,n,l)}catch{let u=new vd(this,t);for(let[l,c]of u)n[l]+=e*o[c]}return this}var{acos:mQ}=Math;function gQ(t){return mQ(this.dot(Pi(t))/this.norm()/Pi(t).norm())}var{asin:yQ}=Math;function bQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=yQ(t[n]);return this}var{asinh:vQ}=Math;function wQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=vQ(t[n]);return this}var{atan:xQ}=Math;function SQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=xQ(t[n]);return this}var{atanh:AQ}=Math;function EQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=AQ(t[n]);return this}var Ji=(...t)=>new _l(new Float64Array(t.reduce((e,n)=>e*n,1)),{shape:t}).fill(0),CQ=(t,e)=>Pi(t).augment(Pi(e));function NQ(t){let[e,n]=this.shape,[r,s]=Pi(t).shape,{data:i}=this,{data:o}=Pi(t);if(r===0||s===0)return this;if(e!==r)throw new Error("rows do not match");let a=Ji(e,n+s),{data:u}=a,l,c;for(l=0;l<e;l+=1)for(c=0;c<n;c+=1)u[l*(n+s)+c]=i[l*n+c];for(l=0;l<r;l+=1)for(c=0;c<s;c+=1)u[l*(n+s)+(c+n)]=o[l*s+c];return a}function TQ(t,e){let{data:n}=this,{data:r}=Pi(t),s=new vd(this,t);for(let[i,o]of s)n[i]=e(n[i],r[o],i);return this}var{cbrt:_Q}=Math;function IQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=_Q(t[n]);return this}var{ceil:kQ}=Math;function RQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=kQ(t[n]);return this}function PQ(...t){let{shape:e,length:n}=this;if(t.length===1){let[r]=t;if(r<0||r>n-1||!Number.isFinite(r))throw new Error("index out of bounds")}else if(!e.every((r,s)=>r>t[s]&&Number.isFinite(t[s])&&t[s]>=0))throw new Error("index out of bounds")}function OQ(t){if(this.shape.length!==1&&t.shape.length!==1)throw new Error("combine operation not permitted for multidimensional arrays");let{length:e,data:n}=this,{length:r,data:s}=t;if(r===0)return this;if(e===0)return this.data=new(od(t.dtype))(s),this.length=r,this.dtype=t.dtype,this;let i=e+r,o=new(od(this.dtype))(i);return o.set(n),o.set(s,e),this.data=o,this.length=i,this.shape=[i],this}function DQ(){let t=Ji(...this.shape),{data:e}=this,{data:n}=t,r=new vd(this,t);for(let[s,i]of r)n[i]=e[s];return t}var{cos:LQ}=Math;function FQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=LQ(t[n]);return this}var{cosh:$Q}=Math;function BQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=$Q(t[n]);return this}function MQ(t){let{length:e}=this,{length:n}=t;if(e!==3||n!==3)throw new Error("vectors must have three components");let r=this.y*t.z-this.z*t.y,s=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return this.x=r,this.y=s,this.z=i,this}function VQ(){this.square();let[t]=this.shape,[e,n]=this.copy().lu_factor(),{data:r}=e,s=1,i=1,o;for(o=0;o<t;o+=1)s*=r[o*t+o],o!==n[o]-1&&(i*=-1);return i*s}function UQ(){this.square();let{length:t}=this,[e,n]=this.shape,r=Math.min(e,n);return this.reshape(t).slice(0,t,r+1)}function zQ(t){let{data:e,length:n,strides:r,dtype:s}=this,{data:i,strides:o}=t,a=0;try{let u=o[o.length-1],l=r[r.length-1];if(u!==l)throw new Error("inc_x and inc_y must be equal");a=lQ(s,n,i,u,e,l)}catch{let u=new vd(this,t);for(let[l,c]of u)a+=e[l]*i[c]}return a}var LD=t=>{let e=new _l(new Float64Array(t*t),{shape:[t,t]}),{data:n}=e,r;for(r=0;r<t;r+=1)n[r*t+r]=1;return e},_f;try{_f=w2("nlapack")}catch{}var jp=(t,e,n,r,s,i,o)=>{let[a]=t.shape,{data:u}=t,l=u[r*a+s],c=1/(e+n);u[r*a+s]=l-n*(u[i*a+o]+c*l),u[i*a+o]+=n*(l-c*u[i*a+o])};function WQ(){this.square();let[t]=this.shape;try{["float32","float64"].includes(this.dtype)||(this.dtype="float32",this.data=od(this.dtype).from(this.data));let e=_f.NoEigenvector,n=_f.Eigenvector,r=Ji(t),s=Ji(t),i=Ji(t,t),o=Ji(t,t),{data:a}=this,{data:u}=r,{data:l}=s,{data:c}=i,{data:d}=o;return this.dtype==="float64"&&_f.dgeev(e,n,t,a,t,u,l,c,t,d,t),this.dtype==="float32"&&_f.sgeev(e,n,t,a,t,u,l,c,t,d,t),[r,o]}catch{let{data:e}=this,n=LD(t),r=0,s=0,i=0,o=0,a=0;do{for(s=0;s<t;s+=1)for(i=s+1;i<t;i+=1)Math.abs(e[s*t+i])>=r&&(r=Math.abs(e[s*t+i]),o=s,a=i);let u;if(Math.abs(e[o*t+a])<Math.abs(e[a*t+a])*1e-36)u=e[o*t+a]/e[a*t+a];else{let f=e[a*t+a]/2*e[o*t+a];u=1/(Math.abs(f)+Math.sqrt(f*f+1))}let l=1/Math.sqrt(u*u+1),c=u*l,d=e[o*t+a];for(e[o*t+a]=0,e[o*t+o]-=u*d,e[a*t+a]+=u*d,s=0;s<o;s+=1)jp(this,l,c,s,o,s,a);for(s=o+1;s<a;s+=1)jp(this,l,c,o,s,s,a);for(s=a+1;s<t;s+=1)jp(this,l,c,o,s,a,s);for(s=0;s<t;s+=1)jp(n,l,c,s,o,s,a)}while(r>=1e-9);return[this.diagonal(),n]}}function jQ(t,e=1e-6){let{data:n}=this,{data:r}=t,s=new vd(this,t);for(let[i,o]of s)if(Math.abs(n[i]-r[o])>e)return!1;return!0}function GQ(t){let{shape:e}=this,{shape:n}=t;if(!e.every((r,s)=>r===n[s]))throw new Error(`shapes ${e} and ${n} do not match`)}function qQ(t){let{length:e}=this,{length:n}=t;if(e!==n)throw new Error(`lengths ${e} and ${n} do not match`)}var{exp:HQ}=Math;function KQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=HQ(t[n]);return this}var{expm1:XQ}=Math;function YQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=XQ(t[n]);return this}function QQ(t=0){let{data:e}=this,n=new Me(this);for(let r of n)e[r]=t instanceof Function?t(r):t;return this}var{floor:ZQ}=Math;function JQ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=ZQ(t[n]);return this}function eZ(t){let{data:e}=this,n=new Me(this);for(let r of n)t.call(this,e[r],r,e)}var{fround:tZ}=Math;function nZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=tZ(t[n]);return this}function rZ(){let{shape:[t,e],data:n}=this,r=0,s,i,o,a,u;for(o=0;o<t;o+=1){if(e<=r)return this;for(a=o;n[a*e+r]===0;)if(a+=1,t===a&&(a=o,r+=1,e===r))return this;if(o!==a&&this.swap(o,a),i=n[o*e+r],i!==0)for(u=0;u<e;u+=1)n[o*e+u]/=i;for(a=0;a<t;a+=1)if(s=n[a*e+r],a!==o)for(u=0;u<e;u+=1)n[a*e+u]-=n[o*e+u]*s;r+=1}for(o=0;o<t;o+=1){for(i=0,a=0;a<e;a+=1)i===0&&(i=n[o*e+a]);if(i!==0)for(u=0;u<e;u+=1)n[o*e+u]/=i}return this}function sZ(...t){this.check(...t);let{data:e,shape:n}=this,{length:r}=n,s=0,i;for(i=0;i<r;i+=1)s*=n[i],s+=t[i];return e[s]}var gl;try{gl=w2("nlapack")}catch{}function FD(t,e,n,r,s,i){if(r.length!==e*n)throw new Error("lengths do not match");switch(t){case"float64":return gl.dgetrf(e,n,r,s,i);case"float32":return gl.sgetrf(e,n,r,s,i);default:throw new Error("wrong dtype")}}function iZ(t,e,n,r,s){if(n.length!==e*e)throw new Error("lengths do not match");switch(t){case"float64":return gl.dgetri(e,n,r,s);case"float32":return gl.sgetri(e,n,r,s);default:throw new Error("wrong dtype")}}function oZ(t,e,n,r,s,i,o,a){if(r.length!==s*e||o.length!==a*n)throw new Error("lengths do not match");switch(t){case"float64":return gl.dgesv(e,n,r,s,i,o,a);case"float32":return gl.sgesv(e,n,r,s,i,o,a);default:throw new Error("wrong dtype")}}function aZ(){this.square();let{shape:[t],dtype:e}=this;try{let{data:n}=this,r=new Int32Array(t);return FD(e,t,t,n,t,r),iZ(e,t,n,t,r),this}catch{let n=LD(t),r=CQ(this,n).gauss(),s=Ji(t,t),i=Ji(t,t),{data:o}=r,{data:a}=s,{data:u}=i,l=new Me(r),[c,d]=l.coords;for(let f of l)d<t?a[c*t+d]=o[f]:u[c*t+(d-t)]=o[f],[c,d]=l.coords;if(!s.equals(n))throw new Error("matrix is not invertible");return i}}var{log:uZ}=Math;function lZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=uZ(t[n]);return this}var{log10:cZ}=Math;function dZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=cZ(t[n]);return this}var{log1p:fZ}=Math;function hZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=fZ(t[n]);return this}var{log2:pZ}=Math;function mZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=pZ(t[n]);return this}function gZ(){let[t,e]=this.copy().lu_factor(),n=t.copy(),r=t.copy(),{data:s}=n,{data:i}=r,o=new Me(t),[a,u]=o.coords;for(let l of o)u<a?i[l]=0:s[l]=a===u?1:0,[a,u]=o.coords;return[n,r,e]}function yZ(){let{data:t,shape:[e],dtype:n}=this,r=new Int32Array(e);try{FD(n,e,e,t,e,r)}catch{let s,i,o,a,u,l,c;for(c=0;c<e;c+=1){for(a=c,s=Math.abs(t[c*e+c]),l=c+1;l<e;l+=1)i=Math.abs(t[l*e+c]),s<i&&(s=i,a=l);for(r[c]=a+1,a!==c&&this.swap(c,a),o=t[c*e+c],u=c+1;u<e;u+=1)t[u*e+c]/=o;for(u=c+1;u<e;u+=1){for(l=c+1;l<e-1;l+=2)t[u*e+l]-=t[u*e+c]*t[c*e+l],t[u*e+l+1]-=t[u*e+c]*t[c*e+l+1];l===e-1&&(t[u*e+l]-=t[u*e+c]*t[c*e+l])}}}return[this,r]}function bZ(t){let{data:e}=this,n=new Me(this),r=t.bind(this),s=this.copy(),{data:i}=s;for(let o of n)i[o]=r(e[o],o,e);return s}function vZ(){let{data:t,length:e,strides:n,dtype:r}=this,s=Number.NEGATIVE_INFINITY;try{let i=n[n.length-1];s=t[cQ(r,e,t,i)]}catch{let i=new Me(this);for(let o of i){let a=t[o];s<a&&(s=a)}}return s}function wZ(){let{data:t,length:e}=this,n=new Me(this),r=0;for(let s of n)r+=t[s];return r/e}function xZ(){let{data:t}=this,e=new Me(this),n=Number.POSITIVE_INFINITY;for(let r of e){let s=t[r];n>s&&(n=s)}return n}var SZ=(t,e)=>new _l(new Float64Array(t*e),{shape:[t,e]});function AZ(t){let{shape:[e,n],data:r,dtype:s}=this.copy(),{shape:[i,o],data:a}=t.copy();if(n!==i)throw new Error("sizes do not match");let u=SZ(e,o),{data:l}=u;try{dQ(s,QC,QC,e,o,n,1,r,n,a,o,0,l,o)}catch{let c=new Me(u),d,[f,h]=c.coords;for(let p of c){let y=0;for(d=0;d<n;d+=1)y+=r[f*n+d]*a[d*o+h];l[p]=y,[f,h]=c.coords}}return u}var{sqrt:EZ}=Math;function CZ(){let{data:t,length:e,strides:n,dtype:r}=this,s=0;try{let i=n[n.length-1];s=fQ(r,e,t,i)}catch{s=EZ(this.dot(this))}return s}function NZ(){return this.scale(1/this.norm())}var{pow:TZ}=Math;function _Z(t){let{data:e}=this,n=new Me(this);for(let r of n)e[r]=TZ(e[r],t);return this}function IZ(){let{data:t}=this,e=new Me(this),n=1;for(let r of e)n*=t[r];return n}function kZ(t){let{data:e}=this,{data:n}=t,r=new vd(this,t);for(let[s,i]of r)e[s]*=n[i];return this}function RZ(t){return t.scale(this.dot(t)/t.dot(t))}function PZ(t){if(this.shape.length!==1)throw new Error("push operation not permitted for multidimensional arrays");let{data:e,length:n}=this,r=n+1,s=new(od(this.dtype))(r);return s.set(e),s[n]=t,this.data=s,this.length=r,this.shape=[r],this}function OZ(t=1e-6){let{data:e}=this.copy().gauss(),n=new Me(this),r=0,[s,i]=n.coords;for(let o of n)r<=s&&i>=s&&Math.abs(e[o])>t&&(r+=1),[s,i]=n.coords;return r}function DZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=1/t[n];return this}function LZ(t,e){let{data:n,length:r}=this;if(r===0&&typeof e>"u")throw new Error("Reduce of empty array with no initial value.");let s=new Me(this),i=t.bind(this),o;typeof e>"u"?(o=n[0],s.next()):o=e;for(let a of s)o=i(o,n[a],a,n);return o}function FZ(...t){let{length:e}=this;if(t.reduce((n,r)=>n*r,1)!==e)throw new Error(`shape ${t} does not match length ${e}`);return this.shape=t,this.strides=S2(t),this}var{round:$Z}=Math;function BZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=$Z(t[n]);return this}function MZ(t,e,n=1){this.check(t,0),this.check(e,0);let[,r]=this.shape,{data:s}=this,i;for(i=0;i<r;i+=1)s[t*r+i]+=s[e*r+i]*n;return this}function VZ(t){let{data:e,length:n,strides:r,dtype:s}=this;try{let i=r[r.length-1];hQ(s,n,t,e,i)}catch{let i=new Me(this);for(let o of i)e[o]*=t}return this}function UZ(...t){let e=t.slice(0,-1),n=t[t.length-1];this.check(...e);let{shape:r}=this,s=0,i;for(i=0;i<e.length;i+=1)s*=r[i],s+=e[i];this.data[s]=n}var{sign:zZ}=Math;function WZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=zZ(t[n]);return this}var{sin:jZ}=Math;function GZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=jZ(t[n]);return this}var{sinh:qZ}=Math;function HZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=qZ(t[n]);return this}function KZ(t=0,e=this.shape[0],n=1){let{data:r,shape:s}=this,i=s.length;if(t<0||e<0)return this.slice(t<0?s[s.length-1]+t:t,e<0?s[s.length-1]+e:e);if(t>e)return this.slice(e,t,n);if(n<=0)throw new Error("step argument has to be a positive integer");let o=[Math.ceil((e-t)/Math.abs(n)),...s.slice(1)],a=OD(o),u=S2(o),l=i>1?r.subarray(t*o[o.length-1],e*o[o.length-1]):r.subarray(t,e);return u[0]*=n,new _l(l,{shape:o,length:a,strides:u})}function XZ(t){let{data:e,dtype:n}=this,{data:r,shape:[s,i]}=t;try{let o=new Int32Array(s);oZ(n,s,i,e,s,o,r,i)}catch{let[o,a]=this.lu_factor(),{data:u}=o,{data:l}=t,c,d,f;for(c=0;c<a.length;c+=1)c!==a[c]-1&&t.swap(c,a[c]-1);for(f=0;f<i;f+=1){for(c=0;c<s;c+=1)for(d=0;d<c;d+=1)l[c*i+f]-=u[c*s+d]*l[d*i+f];for(c=s-1;c>=0;c-=1){for(d=c+1;d<s;d+=1)l[c*i+f]-=u[c*s+d]*l[d*i+f];l[c*i+f]/=u[c*s+c]}}}return t}var{sqrt:YZ}=Math;function QZ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=YZ(t[n]);return this}function ZZ(){let{length:t}=this.shape,[e,n]=this.shape;if(t!==2||e!==n)throw new Error("matrix is not square")}function JZ(t){return this.add(t,-1)}function eJ(){let{data:t}=this,e=new Me(this),n=0;for(let r of e)n+=t[r];return n}function tJ(t,e){this.check(t,0),this.check(e,0);let{data:n}=this,[,r]=this.shape,s=n.slice(t*r,(t+1)*r);return n.copyWithin(t*r,e*r,(e+1)*r),n.set(s,e*r),this}var{tan:nJ}=Math;function rJ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=nJ(t[n]);return this}var{tanh:sJ}=Math;function iJ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=sJ(t[n]);return this}function oJ(t=0,e=0){let{data:n,shape:r,strides:s}=this,{length:i}=r;if(e>=i)return n[t];let o=r[e],a=s[e],u=[];for(let l=0;l<o;l++){let c=this.toArray(t,e+1);if(c===null)return null;u[l]=c,t+=a}return u}var aJ=QY(eQ());function ZC(){return`array(${(0,aJ.inspect)(this.toArray(),{depth:10,breakLength:40})}, dtype=${this.dtype})`}function uJ(){let[t,e]=this.shape,{data:n}=this,r=Math.min(t,e),s=0,i;for(i=0;i<r;i+=1)s+=n[i*e+i];return s}function lJ(){if(this.shape.length<2)return this;let t=this.shape[0];return this.shape[0]=this.shape[1],this.shape[1]=t,t=this.strides[0],this.strides[0]=this.strides[1],this.strides[1]=t,this}var{trunc:cJ}=Math;function dJ(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=cJ(t[n]);return this}var fJ=Symbol.for("nodejs.util.inspect.custom"),r_,_l=(r_=fJ,class{constructor(t,e){J(this,"data",new Float64Array(0));J(this,"dtype","float64");J(this,"length",0);J(this,"shape",[0]);J(this,"strides",[0]);J(this,r_,ZC);J(this,"abs",rQ);J(this,"acos",iQ);J(this,"acosh",aQ);J(this,"add",pQ);J(this,"angle",gQ);J(this,"asin",bQ);J(this,"asinh",wQ);J(this,"atan",SQ);J(this,"atanh",EQ);J(this,"augment",NQ);J(this,"binOp",TQ);J(this,"cbrt",IQ);J(this,"ceil",RQ);J(this,"check",PQ);J(this,"combine",OQ);J(this,"copy",DQ);J(this,"cos",FQ);J(this,"cosh",BQ);J(this,"cross",MQ);J(this,"det",VQ);J(this,"diagonal",UQ);J(this,"dot",zQ);J(this,"eig",WQ);J(this,"equals",jQ);J(this,"equidimensional",GQ);J(this,"equilateral",qQ);J(this,"exp",KQ);J(this,"expm1",YQ);J(this,"fill",QQ);J(this,"floor",JQ);J(this,"forEach",eZ);J(this,"fround",nZ);J(this,"gauss",rZ);J(this,"get",sZ);J(this,"inv",aZ);J(this,"log",lZ);J(this,"log10",dZ);J(this,"log1p",hZ);J(this,"log2",mZ);J(this,"lu",gZ);J(this,"lu_factor",yZ);J(this,"map",bZ);J(this,"max",vZ);J(this,"mean",wZ);J(this,"min",xZ);J(this,"multiply",AZ);J(this,"norm",CZ);J(this,"normalize",NZ);J(this,"pow",_Z);J(this,"prod",IZ);J(this,"product",kZ);J(this,"project",RZ);J(this,"push",PZ);J(this,"rank",OZ);J(this,"reciprocal",DZ);J(this,"reduce",LZ);J(this,"reshape",FZ);J(this,"round",BZ);J(this,"row_add",MZ);J(this,"scale",VZ);J(this,"set",UZ);J(this,"sign",WZ);J(this,"sin",GZ);J(this,"sinh",HZ);J(this,"slice",KZ);J(this,"solve",XZ);J(this,"sqrt",QZ);J(this,"square",ZZ);J(this,"subtract",JZ);J(this,"sum",eJ);J(this,"swap",tJ);J(this,"tan",rJ);J(this,"tanh",iJ);J(this,"toArray",oJ);J(this,"toString",ZC);J(this,"trace",uJ);J(this,"transpose",lJ);J(this,"trunc",dJ);if(!t)return;if(t instanceof _l)return t;if(t instanceof Me){if(!e||!e.dtype)throw new Error("dtype is missing");t.shape&&(e.shape=t.shape);let o=t.length;t=new(od(e.dtype))(o)}let{shape:n=DD(t),length:r=OD(n),strides:s=S2(n),dtype:i=tQ(t)}=e||{};this.data=PD(t)?t:new(od(i))(RD(t)),this.shape=n,this.length=r,this.dtype=i,this.strides=s}get x(){return this.get(0)}set x(t){this.set(0,t)}get y(){return this.get(1)}set y(t){this.set(1,t)}get z(){return this.get(2)}set z(t){this.set(2,t)}get w(){return this.get(3)}set w(t){this.set(3,t)}get T(){return this.copy().transpose()}});try{window.v=_l}catch{}const Vg=(t,e)=>{t[0].length==2&&(t=t.map(s=>[s[0],s[1],1]));const n=Pi(t).multiply(e.T);for(let s=0;s<n.shape[0];s++){const i=n.get(s,0),o=n.get(s,1),a=n.get(s,2);n.set(s,0,i/a),n.set(s,1,o/a)}let r=n.toArray();return r=r.map(s=>s.slice(0,2)),r},$D=(t,e)=>{const n=Ji(8,8),r=Ji(8,1);for(let o=0;o<4;o++){const[a,u]=e[o],[l,c]=t[o];n.set(o*2,0,a),n.set(o*2,1,u),n.set(o*2,2,1),n.set(o*2,6,-l*a),n.set(o*2,7,-l*u),n.set(o*2+1,3,a),n.set(o*2+1,4,u),n.set(o*2+1,5,1),n.set(o*2+1,6,-c*a),n.set(o*2+1,7,-c*u),r.set(o*2,0,l),r.set(o*2+1,0,c)}const s=n.solve(r).toArray();return Pi([...s,1],{shape:[3,3]})},BD=t=>$D([[Up,Up],[0,Up],[0,0],[Up,0]],t).inv(),MD=t=>{const e=Array.from({length:8},(o,a)=>.5+a),r=Array.from({length:8},(o,a)=>7.5-a).map(o=>e.map(a=>[a*yi,o*yi,1])).flat(),s=Vg(r,t),i=qe(()=>ss(Xu(s),0));return[s,i]},VD=t=>{const e=[[-.5*yi,-.5*yi,1],[-.5*yi,8.5*yi,1],[8.5*yi,8.5*yi,1],[8.5*yi,-.5*yi,1]],n=Vg(e,t),r=qe(()=>ss(Xu(n),0));return[n,r]},A2=t=>{var e,n;if(t.current===null)return!0;if(t.current.autoplay){if(((e=t.current)==null?void 0:e.srcObject)===null)return!0}else{const r=(n=t.current)==null?void 0:n.src;if(r===null||!r.startsWith("blob"))return!0}return!1},hJ=t=>{const e=t.map(c=>c[0]),n=t.map(c=>c[1]),r=Math.min(...e),s=Math.max(...e),i=Math.min(...n),o=Math.max(...n),a=s-r,u=o-i;return{xmin:r,xmax:s,ymin:i,ymax:o,width:a,height:u}},E2=(t,e=null,n=12)=>{let r;const s=t.current.videoWidth,i=t.current.videoHeight;if(e!==null){const c=hJ(e);let d=Math.floor(c.width/n),f=Math.floor(c.width/n),h=Math.floor(c.height/n);const p=Math.floor(c.height/n),y=c.width+d+f,b=c.height+h+p,g=b/y,v=rr/nr;if(g>v){const x=b/v-y;d+=Math.floor(x/2),f+=x-Math.floor(x/2)}else{const w=y*v;h+=w-b}r=[Math.round(Math.max(s*(c.xmin-d)/nr,0)),Math.round(Math.max(i*(c.ymin-h)/rr,0)),Math.round(Math.min(s*(c.xmax+f)/nr,s)),Math.round(Math.min(i*(c.ymax+p)/rr,i))]}else r=[0,0,s,i];const[o,a,u,l]=qe(()=>{let c=uY(t.current);c=Le(c,[r[1],r[0],0],[r[3]-r[1],r[2]-r[0],3]);const d=c.shape[0],f=c.shape[1],h=d/f,p=rr/nr;let y=rr,b=nr;h>p?b=Math.round(rr/h):y=Math.round(nr*h),c=l2.resizeBilinear(c,[y,b]);const g=nr-c.shape[1],v=rr-c.shape[0],w=Math.floor(g/2),x=g-w,C=Math.floor(v/2),k=v-C,P=[x,w,k,C];return c=yd(c,[[k,C],[x,w],[0,0]],114),[ss(ut(c,255),0),f,d,P]});return{image4D:o,width:a,height:u,padding:l,roi:r}},C2=(t,e,n,r,s,i,o)=>{const{boxes:a,scores:u}=qe(()=>{const l=$0(t,[0,2,1]),c=Le(l,[0,0,2],[-1,-1,1]),d=Le(l,[0,0,3],[-1,-1,1]);let f=Oe(Le(l,[0,0,0],[-1,-1,1]),ut(c,2)),h=Oe(Le(l,[0,0,1],[-1,-1,1]),ut(d,2)),p=ke(f,c),y=ke(h,d);f=Oe(f,i[0]),p=Oe(p,i[0]),h=Oe(h,i[2]),y=Oe(y,i[2]),f=fe(f,e/(nr-i[0]-i[1])),p=fe(p,e/(nr-i[0]-i[1])),h=fe(h,n/(rr-i[2]-i[3])),y=fe(y,n/(rr-i[2]-i[3])),f=ke(f,o[0]),p=ke(p,o[0]),h=ke(h,o[1]),y=ke(y,o[1]),f=fe(f,nr/r),p=fe(p,nr/r),h=fe(h,rr/s),y=fe(y,rr/s);const b=Lo(dn([f,h,p,y],2)),g=Lo(Le(l,[0,0,4],[-1,-1,l.shape[2]-4]),[0]);return{boxes:b,scores:g}});return{boxes:a,scores:u}},pJ=t=>qe(()=>{const n=Le(t,[0,0],[-1,1]),r=Le(t,[0,1],[-1,1]),s=Le(t,[0,2],[-1,1]),i=Le(t,[0,3],[-1,1]),o=ut(ke(n,s),2),a=ut(ke(r,i),2);return dn([o,a],1)}),UD=(t,e,n)=>{const r=n/nr,s=e/rr;return[r*t[0],s*t[1]-e-Sa]},zD=(t,e,n)=>{const r=nr/n,s=rr/e;return[r*t[0],s*(t[1]+e+Sa)]},JC={h1:[50,-100],a1:[0,-100],a8:[0,-150],h8:[50,-150]},WD=Nx({name:"corners",initialState:JC,reducers:{cornersSet(t,e){t[e.payload.key]=e.payload.xy},cornersReset(){return JC}}}),jD=()=>_x(t=>t.corners),{cornersSet:N2,cornersReset:mJ}=WD.actions,gJ=WD.reducer,eN=(t,e,n)=>Math.max(e,Math.min(t,n)),GD=(t,e)=>Array.from(Array(t),n=>Array(e).fill(0)),yJ=Array.from({length:7},(t,e)=>e),bJ=Array.from({length:7},(t,e)=>e),vJ=bJ.map(t=>yJ.map(e=>[e,t])).flat(),wJ=[[0,1],[1,1],[1,0],[0,0]],qD=async(t,e)=>{const n=Ku(e,1),r=OO(e,1),s=await l2.nonMaxSuppressionAsync(t,n,100,.3,.1),i=qe(()=>{const a=pJ(R0(t,s,0)),u=ss(R0(r,s,0),1);return dn([a,u],1)}),o=i.arraySync();return rn([s,i,t,e,r,n]),o},xJ=async(t,e)=>{const n=t.current.videoWidth,r=t.current.videoHeight,{image4D:s,width:i,height:o,padding:a,roi:u}=E2(t),l=e.current.predict(s),c=C2(l,i,o,n,r,a,u),d=await qD(c.boxes,c.scores);return rn([l,s,c]),d},SJ=async(t,e,n)=>{const r=n.map(p=>[p[0],p[1]]),s=t.current.videoWidth,i=t.current.videoHeight,{image4D:o,width:a,height:u,padding:l,roi:c}=E2(t,r),d=e.current.predict(o),f=C2(d,a,u,s,i,l,c);rn([d,o]);let h=await qD(f.boxes,f.scores);return h=h.map(p=>[p[0],p[1]]),h},AJ=t=>{const e=t.flat().map(i=>Math.round(i)),r=new v2(e).triangles,s=[];for(let i=0;i<r.length;i+=3){const o=r[i],a=r[i+1],u=r[i+2],l=[o,a,u,-1];for(let c=0;c<r.length;c+=3){if(i===c)continue;const d=o===r[c]&&a===r[c+1]||o===r[c+1]&&a===r[c],f=a===r[c]&&u===r[c+1]||a===r[c+1]&&u===r[c],h=u===r[c]&&o===r[c+1]||u===r[c+1]&&o===r[c];if(d||f||h){l[3]=r[c+2];break}}l[3]!==-1&&s.push(l.map(c=>t[c]))}return s},EJ=(t,e)=>{const n=Array.from({length:t.length},()=>Array(e.length).fill(0));for(let r=0;r<t.length;r++)for(let s=0;s<e.length;s++){const i=t[r][0]-e[s][0],o=t[r][1]-e[s][1];n[r][s]=Math.sqrt(i*i+o*o)}return n},HD=(t,e)=>{const n=vJ.map(o=>[o[0]+e[0],o[1]+e[1]]),r=EJ(n,t);let s=0;for(let o=0;o<r.length;o++)s+=Math.min(...r[o]);return 1/(1+s)},CJ=t=>{const e=[0,0];for(let n=0;n<2;n++){let r=-7,s=1;const i={};for(;s-r>1;){const o=s+r>>1;[o,o+1].forEach(a=>{if(!(a in i)){const u=[0,0];u[n]=a,i[a]=HD(t,u)}}),i[o]>i[o+1]?s=o:r=o}e[n]=r+1}return e},tN=(t,e)=>{const n=$D(wJ,t),r=Vg(e,n),s=CJ(r);return[HD(r,s),n,s]},NJ=t=>{const e=AJ(t);if(e.length==0)return;let n,r,s;[n,r,s]=tN(e[0],t);for(let u=1;u<e.length;u++){const[l,c,d]=tN(e[u],t);l>n&&(n=l,r=c,s=d)}const i=r.inv(),o=[[s[0]-1,s[1]-1],[s[0]-1,s[1]+7],[s[0]+7,s[1]+7],[s[0]+7,s[1]-1]],a=Vg(o,i);for(let u=0;u<4;u++)a[u][0]=eN(a[u][0],0,nr),a[u][1]=eN(a[u][1],0,rr);return a},nN=t=>{let e=t.reduce((n,r)=>[n[0]+r[0],n[1]+r[1]],[0,0]);return e=e.map(n=>n/t.length),e},rN=(t,e)=>{const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},TJ=(t,e,n)=>{const r=nN(t),s=nN(e);let i=0,o=0;for(let u=0;u<4;u++){const l=[(n[u%4][0]+n[(u+1)%4][0])/2,(n[u%4][1]+n[(u+1)%4][1])/2],c=[(n[(u+2)%4][0]+n[(u+3)%4][0])/2,(n[(u+2)%4][1]+n[(u+3)%4][1])/2],d=1/(1+rN(s,l)+rN(r,c));d>o&&(o=d,i=u)}return{a1:n[i%4],h1:n[(i+1)%4],h8:n[(i+2)%4],a8:n[(i+3)%4]}},_J=async(t,e,n,r,s,i)=>{if(A2(n))return;const o=await xJ(n,t),a=o.filter(f=>f[2]<=5),u=o.filter(f=>f[2]>5);if(a.length==0||u.length==0){i(["No pieces to label corners"]);return}const l=await SJ(n,e,o);if(l.length<5){i(["Need 5 xCorners",`Detected ${l.length}`]);return}const c=NJ(l);if(c===void 0){i(["Failed to find corners"]);return}const d=TJ(a,u,c);b2.forEach(f=>{const h=d[f],p={xy:UD(h,r.current.height,r.current.width),key:f};s(N2(p))}),RY(r.current,l),i(["Found corners","Ready to record"])},IJ=async(t,e,n,r,s,i)=>{const o=sd().numTensors;await _J(t,e,n,r,s,i);const a=sd().numTensors;return o<a&&console.error(`Memory Leak! (${a} > ${o})`),()=>{Vx()}},Ug=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:s})=>{const i=Zs(),o=a=>{a.preventDefault(),IJ(t,e,n,r,i,s)};return _.jsx(lo,{onClick:o,children:"Find Corners"})},Il=({iconName:t})=>_.jsx("i",{className:`h4 bi ${t}`}),T2=({playing:t,setPlaying:e})=>{const n=r=>{r.preventDefault(),e(!t)};return _.jsx(lo,{onClick:n,children:_.jsx(Il,{iconName:t?"bi-pause":"bi-play"})})};/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const er="w",Ds="b",Nn="p",Vv="n",Pm="b",If="r",pa="q",bn="k",Iy="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Or=-1,kJ={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},Be={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},We={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},ky={b:[16,32,17,15],w:[-16,-32,-17,-15]},sN={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},RJ=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],PJ=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],OJ={p:1,n:2,b:4,r:8,q:16,k:32},DJ="pnbrqkPNBRQK",iN=[Vv,Pm,If,pa],LJ=7,FJ=6,$J=1,BJ=0,Gp={[bn]:Be.KSIDE_CASTLE,[pa]:Be.QSIDE_CASTLE},ia={w:[{square:We.a1,flag:Be.QSIDE_CASTLE},{square:We.h1,flag:Be.KSIDE_CASTLE}],b:[{square:We.a8,flag:Be.QSIDE_CASTLE},{square:We.h8,flag:Be.KSIDE_CASTLE}]},MJ={b:$J,w:FJ},VJ=["1-0","0-1","1/2-1/2","*"];function Yu(t){return t>>4}function Eh(t){return t&15}function KD(t){return"0123456789".indexOf(t)!==-1}function es(t){const e=Eh(t),n=Yu(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function lf(t){return t===er?Ds:er}function UJ(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(e[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const s=e[0].split("/");if(s.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<s.length;o++){let a=0,u=!1;for(let l=0;l<s[o].length;l++)if(KD(s[o][l])){if(u)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(s[o][l],10),u=!0}else{if(!/^[prnbqkPRNBQK]$/.test(s[o][l]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,u=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const i=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:a}of i){if(!a.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((e[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(s[0]+s[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function zJ(t,e){const n=t.from,r=t.to,s=t.piece;let i=0,o=0,a=0;for(let u=0,l=e.length;u<l;u++){const c=e[u].from,d=e[u].to,f=e[u].piece;s===f&&n!==c&&r===d&&(i++,Yu(n)===Yu(c)&&o++,Eh(n)===Eh(c)&&a++)}return i>0?o>0&&a>0?es(n):a>0?es(n).charAt(1):es(n).charAt(0):""}function oa(t,e,n,r,s,i=void 0,o=Be.NORMAL){const a=Yu(r);if(s===Nn&&(a===LJ||a===BJ))for(let u=0;u<iN.length;u++){const l=iN[u];t.push({color:e,from:n,to:r,piece:s,captured:i,promotion:l,flags:o|Be.PROMOTION})}else t.push({color:e,from:n,to:r,piece:s,captured:i,flags:o})}function oN(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:Nn:(e=e.toLowerCase(),e==="o"?bn:e)}function Ry(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Py(t){return t.split(" ").slice(0,4).join(" ")}class _2{constructor(e=Iy){J(this,"_board",new Array(128));J(this,"_turn",er);J(this,"_header",{});J(this,"_kings",{w:Or,b:Or});J(this,"_epSquare",-1);J(this,"_halfMoves",0);J(this,"_moveNumber",0);J(this,"_history",[]);J(this,"_comments",{});J(this,"_castling",{w:0,b:0});J(this,"_positionCount",{});this.load(e)}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:Or,b:Or},this._turn=er,this._castling={w:0,b:0},this._epSquare=Or,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._positionCount={},delete this._header.SetUp,delete this._header.FEN}removeHeader(e){e in this._header&&delete this._header[e]}load(e,{skipValidation:n=!1,preserveHeaders:r=!1}={}){let s=e.split(/\s+/);if(s.length>=2&&s.length<6){const a=["-","-","0","1"];e=s.concat(a.slice(-(6-s.length))).join(" ")}if(s=e.split(/\s+/),!n){const{ok:a,error:u}=UJ(e);if(!a)throw new Error(u)}const i=s[0];let o=0;this.clear({preserveHeaders:r});for(let a=0;a<i.length;a++){const u=i.charAt(a);if(u==="/")o+=8;else if(KD(u))o+=parseInt(u,10);else{const l=u<"a"?er:Ds;this._put({type:u.toLowerCase(),color:l},es(o)),o++}}this._turn=s[1],s[2].indexOf("K")>-1&&(this._castling.w|=Be.KSIDE_CASTLE),s[2].indexOf("Q")>-1&&(this._castling.w|=Be.QSIDE_CASTLE),s[2].indexOf("k")>-1&&(this._castling.b|=Be.KSIDE_CASTLE),s[2].indexOf("q")>-1&&(this._castling.b|=Be.QSIDE_CASTLE),this._epSquare=s[3]==="-"?Or:We[s[3]],this._halfMoves=parseInt(s[4],10),this._moveNumber=parseInt(s[5],10),this._updateSetup(e),this._incPositionCount(e)}fen(){var i,o;let e=0,n="";for(let a=We.a8;a<=We.h1;a++){if(this._board[a]){e>0&&(n+=e,e=0);const{color:u,type:l}=this._board[a];n+=u===er?l.toUpperCase():l.toLowerCase()}else e++;a+1&136&&(e>0&&(n+=e),a!==We.h1&&(n+="/"),e=0,a+=8)}let r="";this._castling[er]&Be.KSIDE_CASTLE&&(r+="K"),this._castling[er]&Be.QSIDE_CASTLE&&(r+="Q"),this._castling[Ds]&Be.KSIDE_CASTLE&&(r+="k"),this._castling[Ds]&Be.QSIDE_CASTLE&&(r+="q"),r=r||"-";let s="-";if(this._epSquare!==Or){const a=this._epSquare+(this._turn===er?16:-16),u=[a+1,a-1];for(const l of u){if(l&136)continue;const c=this._turn;if(((i=this._board[l])==null?void 0:i.color)===c&&((o=this._board[l])==null?void 0:o.type)===Nn){this._makeMove({color:c,from:l,to:this._epSquare,piece:Nn,captured:Nn,flags:Be.EP_CAPTURE});const d=!this._isKingAttacked(c);if(this._undoMove(),d){s=es(this._epSquare);break}}}}return[n,this._turn,r,s,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==Iy?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(Iy)}get(e){return this._board[We[e]]||!1}put({type:e,color:n},r){return this._put({type:e,color:n},r)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_put({type:e,color:n},r){if(DJ.indexOf(e.toLowerCase())===-1||!(r in We))return!1;const s=We[r];if(e==bn&&!(this._kings[n]==Or||this._kings[n]==s))return!1;const i=this._board[s];return i&&i.type===bn&&(this._kings[i.color]=Or),this._board[s]={type:e,color:n},e===bn&&(this._kings[n]=s),!0}remove(e){const n=this.get(e);return delete this._board[We[e]],n&&n.type===bn&&(this._kings[n.color]=Or),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),n}_updateCastlingRights(){var r,s,i,o,a,u,l,c,d,f,h,p;const e=((r=this._board[We.e1])==null?void 0:r.type)===bn&&((s=this._board[We.e1])==null?void 0:s.color)===er,n=((i=this._board[We.e8])==null?void 0:i.type)===bn&&((o=this._board[We.e8])==null?void 0:o.color)===Ds;(!e||((a=this._board[We.a1])==null?void 0:a.type)!==If||((u=this._board[We.a1])==null?void 0:u.color)!==er)&&(this._castling.w&=~Be.QSIDE_CASTLE),(!e||((l=this._board[We.h1])==null?void 0:l.type)!==If||((c=this._board[We.h1])==null?void 0:c.color)!==er)&&(this._castling.w&=~Be.KSIDE_CASTLE),(!n||((d=this._board[We.a8])==null?void 0:d.type)!==If||((f=this._board[We.a8])==null?void 0:f.color)!==Ds)&&(this._castling.b&=~Be.QSIDE_CASTLE),(!n||((h=this._board[We.h8])==null?void 0:h.type)!==If||((p=this._board[We.h8])==null?void 0:p.color)!==Ds)&&(this._castling.b&=~Be.KSIDE_CASTLE)}_updateEnPassantSquare(){var i,o;if(this._epSquare===Or)return;const e=this._epSquare+(this._turn===er?-16:16),n=this._epSquare+(this._turn===er?16:-16),r=[n+1,n-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((i=this._board[n])==null?void 0:i.color)!==lf(this._turn)||((o=this._board[n])==null?void 0:o.type)!==Nn){this._epSquare=Or;return}const s=a=>{var u,l;return!(a&136)&&((u=this._board[a])==null?void 0:u.color)===this._turn&&((l=this._board[a])==null?void 0:l.type)===Nn};r.some(s)||(this._epSquare=Or)}_attacked(e,n){for(let r=We.a8;r<=We.h1;r++){if(r&136){r+=7;continue}if(this._board[r]===void 0||this._board[r].color!==e)continue;const s=this._board[r],i=r-n;if(i===0)continue;const o=i+119;if(RJ[o]&OJ[s.type]){if(s.type===Nn){if(i>0){if(s.color===er)return!0}else if(s.color===Ds)return!0;continue}if(s.type==="n"||s.type==="k")return!0;const a=PJ[o];let u=r+a,l=!1;for(;u!==n;){if(this._board[u]!=null){l=!0;break}u+=a}if(!l)return!0}}return!1}_isKingAttacked(e){const n=this._kings[e];return n===-1?!1:this._attacked(lf(e),n)}isAttacked(e,n){return this._attacked(n,We[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let r=0,s=0;for(let i=We.a8;i<=We.h1;i++){if(s=(s+1)%2,i&136){i+=7;continue}const o=this._board[i];o&&(e[o.type]=o.type in e?e[o.type]+1:1,o.type===Pm&&n.push(s),r++)}if(r===2)return!0;if(r===3&&(e[Pm]===1||e[Vv]===1))return!0;if(r===e[Pm]+2){let i=0;const o=n.length;for(let a=0;a<o;a++)i+=n[a];if(i===0||i===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:n=void 0,piece:r=void 0}={}){const s=this._moves({square:n,piece:r});return e?s.map(i=>this._makePretty(i)):s.map(i=>this._moveToSan(i,s))}_moves({legal:e=!0,piece:n=void 0,square:r=void 0}={}){var h;const s=r?r.toLowerCase():void 0,i=n==null?void 0:n.toLowerCase(),o=[],a=this._turn,u=lf(a);let l=We.a8,c=We.h1,d=!1;if(s)if(s in We)l=c=We[s],d=!0;else return[];for(let p=l;p<=c;p++){if(p&136){p+=7;continue}if(!this._board[p]||this._board[p].color===u)continue;const{type:y}=this._board[p];let b;if(y===Nn){if(i&&i!==y)continue;b=p+ky[a][0],this._board[b]||(oa(o,a,p,b,Nn),b=p+ky[a][1],MJ[a]===Yu(p)&&!this._board[b]&&oa(o,a,p,b,Nn,void 0,Be.BIG_PAWN));for(let g=2;g<4;g++)b=p+ky[a][g],!(b&136)&&(((h=this._board[b])==null?void 0:h.color)===u?oa(o,a,p,b,Nn,this._board[b].type,Be.CAPTURE):b===this._epSquare&&oa(o,a,p,b,Nn,Nn,Be.EP_CAPTURE))}else{if(i&&i!==y)continue;for(let g=0,v=sN[y].length;g<v;g++){const w=sN[y][g];for(b=p;b+=w,!(b&136);){if(!this._board[b])oa(o,a,p,b,y);else{if(this._board[b].color===a)break;oa(o,a,p,b,y,this._board[b].type,Be.CAPTURE);break}if(y===Vv||y===bn)break}}}}if((i===void 0||i===bn)&&(!d||c===this._kings[a])){if(this._castling[a]&Be.KSIDE_CASTLE){const p=this._kings[a],y=p+2;!this._board[p+1]&&!this._board[y]&&!this._attacked(u,this._kings[a])&&!this._attacked(u,p+1)&&!this._attacked(u,y)&&oa(o,a,this._kings[a],y,bn,void 0,Be.KSIDE_CASTLE)}if(this._castling[a]&Be.QSIDE_CASTLE){const p=this._kings[a],y=p-2;!this._board[p-1]&&!this._board[p-2]&&!this._board[p-3]&&!this._attacked(u,this._kings[a])&&!this._attacked(u,p-1)&&!this._attacked(u,y)&&oa(o,a,this._kings[a],y,bn,void 0,Be.QSIDE_CASTLE)}}if(!e||this._kings[a]===-1)return o;const f=[];for(let p=0,y=o.length;p<y;p++)this._makeMove(o[p]),this._isKingAttacked(a)||f.push(o[p]),this._undoMove();return f}move(e,{strict:n=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,n);else if(typeof e=="object"){const i=this._moves();for(let o=0,a=i.length;o<a;o++)if(e.from===es(i[o].from)&&e.to===es(i[o].to)&&(!("promotion"in i[o])||e.promotion===i[o].promotion)){r=i[o];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const s=this._makePretty(r);return this._makeMove(r),this._incPositionCount(s.after),s}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const n=this._turn,r=lf(n);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&Be.EP_CAPTURE&&(this._turn===Ds?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:n}),this._board[e.to].type===bn){if(this._kings[n]=e.to,e.flags&Be.KSIDE_CASTLE){const s=e.to-1,i=e.to+1;this._board[s]=this._board[i],delete this._board[i]}else if(e.flags&Be.QSIDE_CASTLE){const s=e.to+1,i=e.to-2;this._board[s]=this._board[i],delete this._board[i]}this._castling[n]=0}if(this._castling[n]){for(let s=0,i=ia[n].length;s<i;s++)if(e.from===ia[n][s].square&&this._castling[n]&ia[n][s].flag){this._castling[n]^=ia[n][s].flag;break}}if(this._castling[r]){for(let s=0,i=ia[r].length;s<i;s++)if(e.to===ia[r][s].square&&this._castling[r]&ia[r][s].flag){this._castling[r]^=ia[r][s].flag;break}}e.flags&Be.BIG_PAWN?n===Ds?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=Or,e.piece===Nn?this._halfMoves=0:e.flags&(Be.CAPTURE|Be.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===Ds&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();if(e){const n=this._makePretty(e);return this._decPositionCount(n.after),n}return null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const n=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const r=this._turn,s=lf(r);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&Be.EP_CAPTURE){let i;r===Ds?i=n.to-16:i=n.to+16,this._board[i]={type:Nn,color:s}}else this._board[n.to]={type:n.captured,color:s};if(n.flags&(Be.KSIDE_CASTLE|Be.QSIDE_CASTLE)){let i,o;n.flags&Be.KSIDE_CASTLE?(i=n.to+1,o=n.to-1):(i=n.to-2,o=n.to+1),this._board[i]=this._board[o],delete this._board[o]}return n}pgn({newline:e=`
`,maxWidth:n=0}={}){const r=[];let s=!1;for(const f in this._header)r.push("["+f+' "'+this._header[f]+'"]'+e),s=!0;s&&this._history.length&&r.push(e);const i=f=>{const h=this._comments[this.fen()];if(typeof h<"u"){const p=f.length>0?" ":"";f=`${f}${p}{${h}}`}return f},o=[];for(;this._history.length>0;)o.push(this._undoMove());const a=[];let u="";for(o.length===0&&a.push(i(""));o.length>0;){u=i(u);const f=o.pop();if(!f)break;if(!this._history.length&&f.color==="b"){const h=`${this._moveNumber}. ...`;u=u?`${u} ${h}`:h}else f.color==="w"&&(u.length&&a.push(u),u=this._moveNumber+".");u=u+" "+this._moveToSan(f,this._moves({legal:!0})),this._makeMove(f)}if(u.length&&a.push(i(u)),typeof this._header.Result<"u"&&a.push(this._header.Result),n===0)return r.join("")+a.join(" ");const l=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},c=function(f,h){for(const p of h.split(" "))if(p){if(f+p.length>n){for(;l();)f--;r.push(e),f=0}r.push(p),f+=p.length,r.push(" "),f++}return l()&&f--,f};let d=0;for(let f=0;f<a.length;f++){if(d+a[f].length>n&&a[f].includes("{")){d=c(d,a[f]);continue}d+a[f].length>n&&f!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),d=0):f!==0&&(r.push(" "),d++),r.push(a[f]),d+=a[f].length}return r.join("")}header(...e){for(let n=0;n<e.length;n+=2)typeof e[n]=="string"&&typeof e[n+1]=="string"&&(this._header[e[n]]=e[n+1]);return this._header}loadPgn(e,{strict:n=!1,newlineChar:r=`\r?
`}={}){function s(w){return w.replace(/\\/g,"\\")}function i(w){const x={},C=w.split(new RegExp(s(r)));let k="",P="";for(let N=0;N<C.length;N++){const $=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;k=C[N].replace($,"$1"),P=C[N].replace($,"$2"),k.trim().length>0&&(x[k]=P)}return x}e=e.trim();const a=new RegExp("^(\\[((?:"+s(r)+")|.)*\\])((?:\\s*"+s(r)+"){2}|(?:\\s*"+s(r)+")*$)").exec(e),u=a&&a.length>=2?a[1]:"";this.reset();const l=i(u);let c="";for(const w in l)w.toLowerCase()==="fen"&&(c=l[w]),this.header(w,l[w]);if(!n)c&&this.load(c,{preserveHeaders:!0});else if(l.SetUp==="1"){if(!("FEN"in l))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(l.FEN,{preserveHeaders:!0})}function d(w){return Array.from(w).map(function(x){return x.charCodeAt(0)<128?x.charCodeAt(0).toString(16):encodeURIComponent(x).replace(/%/g,"").toLowerCase()}).join("")}function f(w){return w.length==0?"":decodeURIComponent("%"+(w.match(/.{1,2}/g)||[]).join("%"))}const h=function(w){return w=w.replace(new RegExp(s(r),"g")," "),`{${d(w.slice(1,w.length-1))}}`},p=function(w){if(w.startsWith("{")&&w.endsWith("}"))return f(w.slice(1,w.length-1))};let y=e.replace(u,"").replace(new RegExp(`({[^}]*})+?|;([^${s(r)}]*)`,"g"),function(w,x,C){return x!==void 0?h(x):" "+h(`{${C.slice(1)}}`)}).replace(new RegExp(s(r),"g")," ");const b=/(\([^()]+\))+?/g;for(;b.test(y);)y=y.replace(b,"");y=y.replace(/\d+\.(\.\.)?/g,""),y=y.replace(/\.\.\./g,""),y=y.replace(/\$\d+/g,"");let g=y.trim().split(new RegExp(/\s+/));g=g.filter(w=>w!=="");let v="";for(let w=0;w<g.length;w++){const x=p(g[w]);if(x!==void 0){this._comments[this.fen()]=x;continue}const C=this._moveFromSan(g[w],n);if(C==null)if(VJ.indexOf(g[w])>-1)v=g[w];else throw new Error(`Invalid move in PGN: ${g[w]}`);else v="",this._makeMove(C),this._incPositionCount(this.fen())}v&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",v)}_moveToSan(e,n){let r="";if(e.flags&Be.KSIDE_CASTLE)r="O-O";else if(e.flags&Be.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==Nn){const s=zJ(e,n);r+=e.piece.toUpperCase()+s}e.flags&(Be.CAPTURE|Be.EP_CAPTURE)&&(e.piece===Nn&&(r+=es(e.from)[0]),r+="x"),r+=es(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,n=!1){const r=Ry(e);let s=oN(r),i=this._moves({legal:!0,piece:s});for(let f=0,h=i.length;f<h;f++)if(r===Ry(this._moveToSan(i[f],i)))return i[f];if(n)return null;let o,a,u,l,c,d=!1;if(a=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(o=a[1],u=a[2],l=a[3],c=a[4],u.length==1&&(d=!0)):(a=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(o=a[1],u=a[2],l=a[3],c=a[4],u.length==1&&(d=!0))),s=oN(r),i=this._moves({legal:!0,piece:o||s}),!l)return null;for(let f=0,h=i.length;f<h;f++)if(u){if((!o||o.toLowerCase()==i[f].piece)&&We[u]==i[f].from&&We[l]==i[f].to&&(!c||c.toLowerCase()==i[f].promotion))return i[f];if(d){const p=es(i[f].from);if((!o||o.toLowerCase()==i[f].piece)&&We[l]==i[f].to&&(u==p[0]||u==p[1])&&(!c||c.toLowerCase()==i[f].promotion))return i[f]}}else if(r===Ry(this._moveToSan(i[f],i)).replace("x",""))return i[f];return null}ascii(){let e=`   +------------------------+
`;for(let n=We.a8;n<=We.h1;n++){if(Eh(n)===0&&(e+=" "+"87654321"[Yu(n)]+" |"),this._board[n]){const r=this._board[n].type,i=this._board[n].color===er?r.toUpperCase():r.toLowerCase();e+=" "+i+" "}else e+=" . ";n+1&136&&(e+=`|
`,n+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const n=this._moves({legal:!1});let r=0;const s=this._turn;for(let i=0,o=n.length;i<o;i++)this._makeMove(n[i]),this._isKingAttacked(s)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}_makePretty(e){const{color:n,piece:r,from:s,to:i,flags:o,captured:a,promotion:u}=e;let l="";for(const h in Be)Be[h]&o&&(l+=kJ[h]);const c=es(s),d=es(i),f={color:n,piece:r,from:c,to:d,san:this._moveToSan(e,this._moves({legal:!0})),flags:l,lan:c+d,before:this.fen(),after:""};return this._makeMove(e),f.after=this.fen(),this._undoMove(),a&&(f.captured=a),u&&(f.promotion=u,f.lan+=u),f}turn(){return this._turn}board(){const e=[];let n=[];for(let r=We.a8;r<=We.h1;r++)this._board[r]==null?n.push(null):n.push({square:es(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(n),n=[],r+=8);return e}squareColor(e){if(e in We){const n=We[e];return(Yu(n)+Eh(n))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const n=[],r=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const s=n.pop();if(!s)break;e?r.push(this._makePretty(s)):r.push(this._moveToSan(s,this._moves())),this._makeMove(s)}return r}_getPositionCount(e){const n=Py(e);return this._positionCount[n]||0}_incPositionCount(e){const n=Py(e);this._positionCount[n]===void 0&&(this._positionCount[n]=0),this._positionCount[n]+=1}_decPositionCount(e){const n=Py(e);this._positionCount[n]===1?delete this._positionCount[n]:this._positionCount[n]-=1}_pruneComments(){const e=[],n={},r=s=>{s in this._comments&&(n[s]=this._comments[s])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const s=e.pop();if(!s)break;this._makeMove(s),r(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const n=this._comments[e];return delete this._comments[e],{fen:e,comment:n}})}setCastlingRights(e,n){for(const s of[bn,pa])n[s]!==void 0&&(n[s]?this._castling[e]|=Gp[s]:this._castling[e]&=~Gp[s]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(n[bn]===void 0||n[bn]===r[bn])&&(n[pa]===void 0||n[pa]===r[pa])}getCastlingRights(e){return{[bn]:(this._castling[e]&Gp[bn])!==0,[pa]:(this._castling[e]&Gp[pa])!==0}}moveNumber(){return this._moveNumber}}const cf={moves:"",fen:Bv,start:Bv,lastMove:"",greedy:!1},XD=Nx({name:"game",initialState:cf,reducers:{gameSetMoves(t,e){t.moves=e.payload},gameSetFen(t,e){t.fen=e.payload},gameSetStart(t,e){t.start=e.payload},gameSetLastMove(t,e){t.lastMove=e.payload},gameResetMoves(t){t.moves=cf.moves},gameResetFen(t){t.fen=cf.fen},gameResetStart(t){t.start=cf.start},gameResetLastMove(t){t.lastMove=cf.lastMove},gameUpdate(t,e){return{start:t.start,moves:e.payload.moves,fen:e.payload.fen,lastMove:e.payload.lastMove,greedy:e.payload.greedy}}}}),WJ=t=>t.pgn().replace(/\[.*?\]/g,"").replace(/\r?\n|\r/g,""),wd=()=>_x(t=>t.game),I2=t=>`[FEN "${t.start}"]
 
`+t.moves,k2=(t,e=!1)=>{const n=t.history({verbose:!0}),r=WJ(t),s=t.fen(),i=n.length===0?"":n[n.length-1].lan;return{moves:r,fen:s,lastMove:i,greedy:e}},Uv=t=>{const e=new _2(t.start);return e.loadPgn(I2(t)),e},{gameSetMoves:$we,gameResetMoves:xd,gameSetFen:jJ,gameResetFen:Gh,gameSetStart:YD,gameResetStart:QD,gameSetLastMove:Bwe,gameResetLastMove:Mwe,gameUpdate:R2}=XD.actions,GJ=XD.reducer,ZD=({setPlaying:t,setText:e})=>{const n=Zs(),r=s=>{s.preventDefault(),t(!1),n(xd()),n(Gh()),e(["Reset to start position"])};return _.jsx(lo,{onClick:r,children:_.jsx(Il,{iconName:"bi-stop"})})},qJ=({setText:t,playing:e})=>{const n=I2(wd()),r=s=>{s.preventDefault(),navigator.clipboard.writeText(n),e||t(["Copied PGN"])};return _.jsx(lo,{onClick:r,children:"Copy PGN"})};var zg={exports:{}},JD={},eL={exports:{}},HJ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",KJ=HJ,XJ=KJ;function tL(){}function nL(){}nL.resetWarningCache=tL;var YJ=function(){function t(r,s,i,o,a,u){if(u!==XJ){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:nL,resetWarningCache:tL};return n.PropTypes=n,n};eL.exports=YJ();var P2=eL.exports;const pt=cd(P2);function rL(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=rL(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function aN(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=rL(t))&&(r&&(r+=" "),r+=e);return r}const QJ=Object.freeze(Object.defineProperty({__proto__:null,clsx:aN,default:aN},Symbol.toStringTag,{value:"Module"})),ZJ=s_(QJ);var sn={},fo={};Object.defineProperty(fo,"__esModule",{value:!0});fo.dontSetMe=ree;fo.findInArray=JJ;fo.int=nee;fo.isFunction=eee;fo.isNum=tee;function JJ(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function eee(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function tee(t){return typeof t=="number"&&!isNaN(t)}function nee(t){return parseInt(t,10)}function ree(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var kl={};Object.defineProperty(kl,"__esModule",{value:!0});kl.browserPrefixToKey=iL;kl.browserPrefixToStyle=see;kl.default=void 0;kl.getPrefix=sL;const Oy=["Moz","Webkit","O","ms"];function sL(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<Oy.length;r++)if(iL(e,Oy[r])in n)return Oy[r];return""}function iL(t,e){return e?"".concat(e).concat(iee(t)):t}function see(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function iee(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}kl.default=sL();Object.defineProperty(sn,"__esModule",{value:!0});sn.addClassName=uL;sn.addEvent=uee;sn.addUserSelectStyles=vee;sn.createCSSTransform=mee;sn.createSVGTransform=gee;sn.getTouch=yee;sn.getTouchIdentifier=bee;sn.getTranslation=O2;sn.innerHeight=fee;sn.innerWidth=hee;sn.matchesSelector=aL;sn.matchesSelectorAndParentsTo=aee;sn.offsetXYFromParent=pee;sn.outerHeight=cee;sn.outerWidth=dee;sn.removeClassName=lL;sn.removeEvent=lee;sn.removeUserSelectStyles=wee;var cs=fo,uN=oee(kl);function oL(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(oL=function(r){return r?n:e})(t)}function oee(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=oL(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}let qp="";function aL(t,e){return qp||(qp=(0,cs.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,cs.isFunction)(t[n])})),(0,cs.isFunction)(t[qp])?t[qp](e):!1}function aee(t,e,n){let r=t;do{if(aL(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function uee(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,s):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function lee(t,e,n,r){if(!t)return;const s={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,s):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function cee(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,cs.int)(n.borderTopWidth),e+=(0,cs.int)(n.borderBottomWidth),e}function dee(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,cs.int)(n.borderLeftWidth),e+=(0,cs.int)(n.borderRightWidth),e}function fee(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,cs.int)(n.paddingTop),e-=(0,cs.int)(n.paddingBottom),e}function hee(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,cs.int)(n.paddingLeft),e-=(0,cs.int)(n.paddingRight),e}function pee(t,e,n){const s=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-s.left)/n,o=(t.clientY+e.scrollTop-s.top)/n;return{x:i,y:o}}function mee(t,e){const n=O2(t,e,"px");return{[(0,uN.browserPrefixToKey)("transform",uN.default)]:n}}function gee(t,e){return O2(t,e,"")}function O2(t,e,n){let{x:r,y:s}=t,i="translate(".concat(r).concat(n,",").concat(s).concat(n,")");if(e){const o="".concat(typeof e.x=="string"?e.x:e.x+n),a="".concat(typeof e.y=="string"?e.y:e.y+n);i="translate(".concat(o,", ").concat(a,")")+i}return i}function yee(t,e){return t.targetTouches&&(0,cs.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,cs.findInArray)(t.changedTouches,n=>e===n.identifier)}function bee(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function vee(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&uL(t.body,"react-draggable-transparent-selection")}function wee(t){if(t)try{if(t.body&&lL(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function uL(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function lL(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var ho={};Object.defineProperty(ho,"__esModule",{value:!0});ho.canDragX=Aee;ho.canDragY=Eee;ho.createCoreData=Nee;ho.createDraggableData=Tee;ho.getBoundPosition=xee;ho.getControlPosition=Cee;ho.snapToGrid=See;var Jr=fo,Cc=sn;function xee(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:_ee(r);const s=D2(t);if(typeof r=="string"){const{ownerDocument:i}=s,o=i.defaultView;let a;if(r==="parent"?a=s.parentNode:a=i.querySelector(r),!(a instanceof o.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const u=a,l=o.getComputedStyle(s),c=o.getComputedStyle(u);r={left:-s.offsetLeft+(0,Jr.int)(c.paddingLeft)+(0,Jr.int)(l.marginLeft),top:-s.offsetTop+(0,Jr.int)(c.paddingTop)+(0,Jr.int)(l.marginTop),right:(0,Cc.innerWidth)(u)-(0,Cc.outerWidth)(s)-s.offsetLeft+(0,Jr.int)(c.paddingRight)-(0,Jr.int)(l.marginRight),bottom:(0,Cc.innerHeight)(u)-(0,Cc.outerHeight)(s)-s.offsetTop+(0,Jr.int)(c.paddingBottom)-(0,Jr.int)(l.marginBottom)}}return(0,Jr.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Jr.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Jr.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Jr.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function See(t,e,n){const r=Math.round(e/t[0])*t[0],s=Math.round(n/t[1])*t[1];return[r,s]}function Aee(t){return t.props.axis==="both"||t.props.axis==="x"}function Eee(t){return t.props.axis==="both"||t.props.axis==="y"}function Cee(t,e,n){const r=typeof e=="number"?(0,Cc.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const s=D2(n),i=n.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,Cc.offsetXYFromParent)(r||t,i,n.props.scale)}function Nee(t,e,n){const r=!(0,Jr.isNum)(t.lastX),s=D2(t);return r?{node:s,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:s,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function Tee(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function _ee(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function D2(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var Wg={},jg={};Object.defineProperty(jg,"__esModule",{value:!0});jg.default=Iee;function Iee(){}Object.defineProperty(Wg,"__esModule",{value:!0});Wg.default=void 0;var Dy=Ree(L),Dr=L2(P2),kee=L2(Lh),Jn=sn,aa=ho,Ly=fo,df=L2(jg);function L2(t){return t&&t.__esModule?t:{default:t}}function cL(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(cL=function(r){return r?n:e})(t)}function Ree(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=cL(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var o=s?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function vr(t,e,n){return e=Pee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=Oee(t,"string");return typeof e=="symbol"?e:String(e)}function Oee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hi={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let ua=hi.mouse,Gg=class extends Dy.Component{constructor(){super(...arguments),vr(this,"dragging",!1),vr(this,"lastX",NaN),vr(this,"lastY",NaN),vr(this,"touchIdentifier",null),vr(this,"mounted",!1),vr(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,Jn.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,Jn.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const s=(0,Jn.getTouchIdentifier)(e);this.touchIdentifier=s;const i=(0,aa.getControlPosition)(e,s,this);if(i==null)return;const{x:o,y:a}=i,u=(0,aa.createCoreData)(this,o,a);(0,df.default)("DraggableCore: handleDragStart: %j",u),(0,df.default)("calling",this.props.onStart),!(this.props.onStart(e,u)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,Jn.addUserSelectStyles)(r),this.dragging=!0,this.lastX=o,this.lastY=a,(0,Jn.addEvent)(r,ua.move,this.handleDrag),(0,Jn.addEvent)(r,ua.stop,this.handleDragStop))}),vr(this,"handleDrag",e=>{const n=(0,aa.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let a=r-this.lastX,u=s-this.lastY;if([a,u]=(0,aa.snapToGrid)(this.props.grid,a,u),!a&&!u)return;r=this.lastX+a,s=this.lastY+u}const i=(0,aa.createCoreData)(this,r,s);if((0,df.default)("DraggableCore: handleDrag: %j",i),this.props.onDrag(e,i)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(u)}return}this.lastX=r,this.lastY=s}),vr(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,aa.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:s}=n;if(Array.isArray(this.props.grid)){let u=r-this.lastX||0,l=s-this.lastY||0;[u,l]=(0,aa.snapToGrid)(this.props.grid,u,l),r=this.lastX+u,s=this.lastY+l}const i=(0,aa.createCoreData)(this,r,s);if(this.props.onStop(e,i)===!1||this.mounted===!1)return!1;const a=this.findDOMNode();a&&this.props.enableUserSelectHack&&(0,Jn.removeUserSelectStyles)(a.ownerDocument),(0,df.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,a&&((0,df.default)("DraggableCore: Removing handlers"),(0,Jn.removeEvent)(a.ownerDocument,ua.move,this.handleDrag),(0,Jn.removeEvent)(a.ownerDocument,ua.stop,this.handleDragStop))}),vr(this,"onMouseDown",e=>(ua=hi.mouse,this.handleDragStart(e))),vr(this,"onMouseUp",e=>(ua=hi.mouse,this.handleDragStop(e))),vr(this,"onTouchStart",e=>(ua=hi.touch,this.handleDragStart(e))),vr(this,"onTouchEnd",e=>(ua=hi.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,Jn.addEvent)(e,hi.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,Jn.removeEvent)(n,hi.mouse.move,this.handleDrag),(0,Jn.removeEvent)(n,hi.touch.move,this.handleDrag),(0,Jn.removeEvent)(n,hi.mouse.stop,this.handleDragStop),(0,Jn.removeEvent)(n,hi.touch.stop,this.handleDragStop),(0,Jn.removeEvent)(e,hi.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Jn.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:kee.default.findDOMNode(this)}render(){return Dy.cloneElement(Dy.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Wg.default=Gg;vr(Gg,"displayName","DraggableCore");vr(Gg,"propTypes",{allowAnyClick:Dr.default.bool,children:Dr.default.node.isRequired,disabled:Dr.default.bool,enableUserSelectHack:Dr.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Dr.default.arrayOf(Dr.default.number),handle:Dr.default.string,cancel:Dr.default.string,nodeRef:Dr.default.object,onStart:Dr.default.func,onDrag:Dr.default.func,onStop:Dr.default.func,onMouseDown:Dr.default.func,scale:Dr.default.number,className:Ly.dontSetMe,style:Ly.dontSetMe,transform:Ly.dontSetMe});vr(Gg,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=f(L),n=c(P2),r=c(Lh),s=c(ZJ),i=sn,o=ho,a=fo,u=c(Wg),l=c(jg);function c(v){return v&&v.__esModule?v:{default:v}}function d(v){if(typeof WeakMap!="function")return null;var w=new WeakMap,x=new WeakMap;return(d=function(C){return C?x:w})(v)}function f(v,w){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var x=d(w);if(x&&x.has(v))return x.get(v);var C={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in v)if(P!=="default"&&Object.prototype.hasOwnProperty.call(v,P)){var N=k?Object.getOwnPropertyDescriptor(v,P):null;N&&(N.get||N.set)?Object.defineProperty(C,P,N):C[P]=v[P]}return C.default=v,x&&x.set(v,C),C}function h(){return h=Object.assign?Object.assign.bind():function(v){for(var w=1;w<arguments.length;w++){var x=arguments[w];for(var C in x)Object.prototype.hasOwnProperty.call(x,C)&&(v[C]=x[C])}return v},h.apply(this,arguments)}function p(v,w,x){return w=y(w),w in v?Object.defineProperty(v,w,{value:x,enumerable:!0,configurable:!0,writable:!0}):v[w]=x,v}function y(v){var w=b(v,"string");return typeof w=="symbol"?w:String(w)}function b(v,w){if(typeof v!="object"||v===null)return v;var x=v[Symbol.toPrimitive];if(x!==void 0){var C=x.call(v,w||"default");if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(v)}class g extends e.Component{static getDerivedStateFromProps(w,x){let{position:C}=w,{prevPropsPosition:k}=x;return C&&(!k||C.x!==k.x||C.y!==k.y)?((0,l.default)("Draggable: getDerivedStateFromProps %j",{position:C,prevPropsPosition:k}),{x:C.x,y:C.y,prevPropsPosition:{...C}}):null}constructor(w){super(w),p(this,"onDragStart",(x,C)=>{if((0,l.default)("Draggable: onDragStart: %j",C),this.props.onStart(x,(0,o.createDraggableData)(this,C))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),p(this,"onDrag",(x,C)=>{if(!this.state.dragging)return!1;(0,l.default)("Draggable: onDrag: %j",C);const k=(0,o.createDraggableData)(this,C),P={x:k.x,y:k.y,slackX:0,slackY:0};if(this.props.bounds){const{x:$,y:U}=P;P.x+=this.state.slackX,P.y+=this.state.slackY;const[K,Z]=(0,o.getBoundPosition)(this,P.x,P.y);P.x=K,P.y=Z,P.slackX=this.state.slackX+($-P.x),P.slackY=this.state.slackY+(U-P.y),k.x=P.x,k.y=P.y,k.deltaX=P.x-this.state.x,k.deltaY=P.y-this.state.y}if(this.props.onDrag(x,k)===!1)return!1;this.setState(P)}),p(this,"onDragStop",(x,C)=>{if(!this.state.dragging||this.props.onStop(x,(0,o.createDraggableData)(this,C))===!1)return!1;(0,l.default)("Draggable: onDragStop: %j",C);const P={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:$,y:U}=this.props.position;P.x=$,P.y=U}this.setState(P)}),this.state={dragging:!1,dragged:!1,x:w.position?w.position.x:w.defaultPosition.x,y:w.position?w.position.y:w.defaultPosition.y,prevPropsPosition:{...w.position},slackX:0,slackY:0,isElementSVG:!1},w.position&&!(w.onDrag||w.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var w,x;return(w=(x=this.props)===null||x===void 0||(x=x.nodeRef)===null||x===void 0?void 0:x.current)!==null&&w!==void 0?w:r.default.findDOMNode(this)}render(){const{axis:w,bounds:x,children:C,defaultPosition:k,defaultClassName:P,defaultClassNameDragging:N,defaultClassNameDragged:$,position:U,positionOffset:K,scale:Z,...ie}=this.props;let ee={},j=null;const O=!!!U||this.state.dragging,D=U||k,V={x:(0,o.canDragX)(this)&&O?this.state.x:D.x,y:(0,o.canDragY)(this)&&O?this.state.y:D.y};this.state.isElementSVG?j=(0,i.createSVGTransform)(V,K):ee=(0,i.createCSSTransform)(V,K);const F=(0,s.default)(C.props.className||"",P,{[N]:this.state.dragging,[$]:this.state.dragged});return e.createElement(u.default,h({},ie,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(C),{className:F,style:{...C.props.style,...ee},transform:j}))}}t.default=g,p(g,"displayName","Draggable"),p(g,"propTypes",{...u.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),p(g,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(JD);const{default:dL,DraggableCore:Dee}=JD;zg.exports=dL;zg.exports.default=dL;zg.exports.DraggableCore=Dee;var Lee=zg.exports;const Fee=cd(Lee),Hp=({name:t,xy:e})=>{const n={height:Sa,width:Sa,backgroundColor:"red",borderRadius:"50%",textAlign:"center",position:"absolute",userSelect:"none",opacity:.5},r={display:"flex",height:"100%",width:"100%",textAlign:"center",justifyContent:"center",alignItems:"center"},s=_w.useRef(null),i=Zs();return _.jsx(Fee,{handle:"strong",bounds:"parent",position:{x:e[0],y:e[1]},defaultPosition:{x:e[0],y:e[1]},nodeRef:s,onStop:(o,a)=>{const u={xy:[a.x,a.y],key:t};console.log(u),i(N2(u))},children:_.jsx("div",{className:"box no-cursor",style:n,ref:s,children:_.jsx("strong",{className:"cursor",style:r,children:t})})})},$ee=()=>{const t=jD();return _.jsxs(_.Fragment,{children:[_.jsx(Hp,{name:"a8",xy:t.a8}),_.jsx(Hp,{name:"h8",xy:t.h8}),_.jsx(Hp,{name:"h1",xy:t.h1}),_.jsx(Hp,{name:"a1",xy:t.a1})]})},Bee=()=>{const t=wg(),e=()=>{t("/")};return _.jsx(lo,{onClick:e,children:_.jsx(Il,{iconName:"bi-house"})})};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */var Er;(function(t){t.LINE="line {0}",t.INVALID_FEN_ERROR_TITLE="Invalid FEN string.",t.INVALID_NOTATION_ERROR_TITLE="Invalid move notation.",t.TOOLTIP_GO_FIRST="Go to the beginning of the game",t.TOOLTIP_GO_PREVIOUS="Go to the previous move",t.TOOLTIP_GO_NEXT="Go to the next move",t.TOOLTIP_GO_LAST="Go to the end of the game",t.TOOLTIP_PLAY_STOP="Play/stop the game",t.TOOLTIP_FLIP="Flip the board",t.PIECE_SYMBOLS={K:"K",Q:"Q",R:"R",B:"B",N:"N",P:"P"},t.ANNOTATED_BY="Annotated by {0}",t.INVALID_PGN_ERROR_TITLE="Invalid PGN string."})(Er||(Er={}));/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */let ht=class{constructor(e,n){this.functionOrComponentName=e,this.argumentName=n}toString(){return`Illegal argument '${this.argumentName}' in function or component ${this.functionOrComponentName}`}};var et={},xs={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(xs,"__esModule",{value:!0});xs.i18n=void 0;var lN;(function(t){t.WRONG_NUMBER_OF_FEN_FIELDS="A FEN string must contain exactly 6 space-separated fields.",t.WRONG_NUMBER_OF_SUBFIELDS_IN_BOARD_FIELD="The 1st field of a FEN string must contain exactly 8 `/`-separated subfields.",t.UNEXPECTED_CHARACTER_IN_BOARD_FIELD="Unexpected character in the 1st field of the FEN string: `{0}`.",t.UNEXPECTED_END_OF_SUBFIELD_IN_BOARD_FIELD="Subfield {0} of the FEN string 1st field is unexpectedly short.",t.INVALID_TURN_FIELD="The 2nd field of a FEN string must be either `w` or `b`.",t.INVALID_CASTLING_FIELD="The 3rd field of a FEN string must be either `-` or a list of characters among `K`, `Q`, `k` and `q` (in this order).",t.INVALID_EN_PASSANT_FIELD="The 4th field of a FEN string must be either `-` or a square from the 3rd or 6th rank where en-passant is allowed.",t.WRONG_RANK_IN_EN_PASSANT_FIELD="The rank number indicated in the FEN string 4th field is inconsistent with respect to the 2nd field.",t.INEFFECTIVE_EN_PASSANT_FIELD="No en-passant capture can happen on file {0} in the position defined in the FEN string.",t.INVALID_HALF_MOVE_COUNT_FIELD="The 5th field of a FEN string must be a number, indicating the number of half-move since the last pawn move or capture.",t.INVALID_MOVE_NUMBER_FIELD="The 6th field of a FEN string must be a number, indicating the move number of the game.",t.INVALID_VARIANT_PREFIX="Invalid variant prefix: `{0}`.",t.INVALID_UCI_NOTATION_SYNTAX="The syntax of the UCI notation is invalid.",t.ILLEGAL_UCI_MOVE="The UCI move is not legal.",t.INVALID_MOVE_NOTATION_SYNTAX="The syntax of the move notation is invalid.",t.ILLEGAL_POSITION="The position is not legal.",t.ILLEGAL_NO_KING_CASTLING="Castling is not legal in the considered position as it has no king.",t.ILLEGAL_QUEEN_SIDE_CASTLING="Queen-side castling is not legal in the considered position.",t.ILLEGAL_KING_SIDE_CASTLING="King-side castling is not legal in the considered position.",t.NO_PIECE_CAN_MOVE_TO="No {0} can move to {1}.",t.NO_PIECE_CAN_MOVE_TO_DISAMBIGUATION="No {0} on the specified rank/file can move to {1}.",t.REQUIRE_DISAMBIGUATION="Cannot determine uniquely which {0} is supposed to move to {1}.",t.WRONG_DISAMBIGUATION_SYMBOL="Wrong disambiguation symbol (expected: `{0}`, observed: `{1}`).",t.CASTLING_MOVE_ENCODED_WITH_ZERO="Capital O must be used for castling moves (instead of digit 0).",t.TRYING_TO_CAPTURE_YOUR_OWN_PIECES="Capturing its own pieces is not legal.",t.CAPTURE_IS_MANDATORY="Capture is mandatory.",t.INVALID_PIECE_SYMBOL="Character `{0}` is not a valid piece symbol.",t.INVALID_PIECE_SYMBOL_COLOR="Invalid color for piece symbol `{0}`.",t.INVALID_CAPTURING_PAWN_MOVE="Invalid capturing pawn move.",t.INVALID_NON_CAPTURING_PAWN_MOVE="Invalid non-capturing pawn move.",t.NOT_SAFE_FOR_WHITE_KING="This move would let the white king in check.",t.NOT_SAFE_FOR_BLACK_KING="This move would let the black king in check.",t.MISSING_PROMOTION="A promoted piece must be specified for this move.",t.MISSING_PROMOTION_SYMBOL="Character `=` is required to specify a promoted piece.",t.INVALID_PROMOTED_PIECE="{0} cannot be specified as a promoted piece.",t.ILLEGAL_PROMOTION="Specifying a promoted piece is illegal for this move.",t.ILLEGAL_NULL_MOVE="Cannot play a null-move in this position.",t.MISSING_CAPTURE_SYMBOL="Capture symbol `x` is missing.",t.INVALID_CAPTURE_SYMBOL="This move is not a capture move.",t.WRONG_CHECK_CHECKMATE_SYMBOL="Wrong check/checkmate symbol (expected: `{0}`, observed: `{1}`).",t.INVALID_PGN_TOKEN="Unrecognized character or group of characters.",t.INVALID_MOVE_IN_PGN_TEXT="Invalid move ({0}). {1}",t.INVALID_FEN_IN_PGN_TEXT="Invalid FEN string in the initial position header. {0}",t.UNEXPECTED_PGN_HEADER="Unexpected PGN game header.",t.MISSING_PGN_HEADER_ID="Missing or invalid PGN game header ID.",t.MISSING_PGN_HEADER_VALUE="Missing or invalid PGN game header value.",t.MISSING_END_OF_PGN_HEADER="Missing or invalid end of PGN game header.",t.UNEXPECTED_BEGIN_OF_VARIATION="Unexpected begin of variation.",t.UNEXPECTED_END_OF_VARIATION="Unexpected end of variation.",t.UNEXPECTED_END_OF_GAME="Unexpected end of game: there are pending variations.",t.INVALID_GAME_INDEX="Game index {0} is invalid (only {1} game(s) found in the PGN data).",t.UNKNOWN_VARIANT="Unknown chess game variant ({0}).",t.VARIANT_WITHOUT_FEN="For game variant {0}, the FEN header is mandatory.",t.POJO_MUST_BE_AN_OBJECT="Unexpected non-object value passed as POJO.",t.INVALID_POJO_STRING_FIELD="Invalid value (must be a string).",t.INVALID_POJO_NUMBER_FIELD="Invalid value (must be a number).",t.INVALID_POJO_BOOLEAN_FIELD="Invalid value (must be a boolean).",t.INVALID_POJO_OBJECT_FIELD="Invalid value (must be an object).",t.INVALID_POJO_ARRAY_FIELD="Invalid value (must be an array).",t.INVALID_ELO_IN_POJO="Ill-formed elo.",t.INVALID_ROUND_IN_POJO="Ill-formed round, sub-round or sub-sub-round.",t.INVALID_DATE_IN_POJO="Ill-formed date.",t.INVALID_ECO_CODE_IN_POJO="Ill-formed ECO code.",t.INVALID_RESULT_IN_POJO="Ill-formed result.",t.INVALID_VARIANT_IN_POJO="Ill-formed variant.",t.INVALID_NAG_IN_POJO="Invalid NAG ({0}).",t.INVALID_TAG_IN_POJO="Invalid tag ({0}).",t.INVALID_MOVE_IN_POJO="Invalid move ({0}). {1}",t.INVALID_FEN_IN_POJO="Invalid initial position FEN. {0}",t.MISSING_INITIAL_POSITION_IN_POJO="For game variant {0}, the initial position field is mandatory.",t.INVALID_OR_MISSING_NODE_ARRAY="Invalid or missing node POJO array.",t.INVALID_OR_MISSING_NOTATION_FIELD="Invalid or missing node POJO.",t.NOT_A_NODE_POJO="A node POJO must be either a string or an object.",t.NOT_A_VARIATION_POJO="A variation POJO must be either an array or an object."})(lN||(xs.i18n=lN={}));var Lt={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Lt,"__esModule",{value:!0});Lt.InvalidPOJO=Lt.InvalidPGN=Lt.InvalidNotation=Lt.InvalidFEN=Lt.IllegalArgument=void 0;class Mee{constructor(e){this.functionName=e}toString(){return`Illegal argument in function ${this.functionName}`}}Lt.IllegalArgument=Mee;class Vee{constructor(e,n,...r){this.fen=e,this.message=qg(n,r)}toString(){return Hg("InvalidFEN",this.message)}}Lt.InvalidFEN=Vee;class Uee{constructor(e,n,r,...s){this.fen=e,this.notation=n,this.message=qg(r,s)}toString(){return Hg("InvalidNotation",this.message)}}Lt.InvalidNotation=Uee;class zee{constructor(e,n,r,s,...i){this.pgn=e,this.index=n,this.lineNumber=r,this.message=qg(s,i)}toString(){return Hg("InvalidPGN",`[character=${this.index} line=${this.lineNumber}] ${this.message}`)}}Lt.InvalidPGN=zee;class Wee{constructor(e,n,r,...s){this.pojo=e,this.fieldName=n,this.message=qg(r,s)}toString(){return Hg("InvalidPOJO",this.message)}}Lt.InvalidPOJO=Wee;function qg(t,e){return t.replace(/{(\d+)}/g,(n,r)=>{const s=Number(r);return s<e.length?String(e[s]):n})}function Hg(t,e){return t+" -> "+e}var Bt={},xt={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(xt,"__esModule",{value:!0});xt.colorToString=jee;xt.pieceToString=Gee;xt.fileToString=qee;xt.rankToString=Hee;xt.resultToString=Kee;xt.variantToString=Xee;xt.colorFromString=Yee;xt.pieceFromString=Qee;xt.fileFromString=Zee;xt.rankFromString=Jee;xt.resultFromString=ete;xt.variantFromString=tte;xt.squareToString=nte;xt.squareFromString=rte;xt.coloredPieceToString=ste;xt.coloredPieceFromString=ite;xt.figurineToString=ote;xt.figurineFromString=ate;xt.squareColorImpl=ute;const Kg=[..."wb"],Xg=[..."kqrbnp"],Yg=[..."abcdefgh"],Qg=[..."12345678"],fL=["1-0","0-1","1/2-1/2","*"],hL=["regular","chess960","no-king","white-king-only","black-king-only","antichess","horde"],pL=[...""];function jee(t){return Kg[t]}function Gee(t){return Xg[t]}function qee(t){return Yg[t]}function Hee(t){return Qg[t]}function Kee(t){return fL[t]}function Xee(t){return hL[t]}function Yee(t){return typeof t=="string"?Kg.indexOf(t):-1}function Qee(t){return typeof t=="string"?Xg.indexOf(t):-1}function Zee(t){return typeof t=="string"?Yg.indexOf(t):-1}function Jee(t){return typeof t=="string"?Qg.indexOf(t):-1}function ete(t){return typeof t=="string"?fL.indexOf(t):-1}function tte(t){return typeof t=="string"?hL.indexOf(t):-1}function nte(t){return Yg[t%16]+Qg[Math.trunc(t/16)]}function rte(t){if(typeof t!="string"||!/^[a-h][1-8]$/.test(t))return-1;const e=Yg.indexOf(t[0]);return Qg.indexOf(t[1])*16+e}function ste(t){return Kg[t%2]+Xg[Math.trunc(t/2)]}function ite(t){if(typeof t!="string"||!/^[wb][kqrbnp]$/.test(t))return-1;const e=Kg.indexOf(t[0]);return Xg.indexOf(t[1])*2+e}function ote(t){return pL[t]}function ate(t){return pL.indexOf(String(t))}function ute(t){return(~t^t>>4)&1}var po={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(po,"__esModule",{value:!0});po.hasCanonicalStartPosition=dte;po.makeEmpty=fte;po.makeInitial=hte;po.make960FromScharnagl=pte;po.makeCopy=gte;const lte=[-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1],cN=[4,8,6,2,0,6,8,4,-2,-2,-2,-2,-2,-2,-2,-2,10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,11,11,11,11,11,11,11,11,-2,-2,-2,-2,-2,-2,-2,-2,5,9,7,3,1,7,9,5],cte=[10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,-1,10,10,-1,-1,10,10,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,11,11,11,11,11,11,11,11,-2,-2,-2,-2,-2,-2,-2,-2,5,9,7,3,1,7,9,5],mL=[{board:cN,castling:[129,129],king:[4,116]},null,null,null,null,{board:cN,castling:[0,0],king:[-1,-1]},{board:cte,castling:[0,129],king:[-1,116]}];function dte(t){return mL[t]!==null}function fte(t){return{board:lte.slice(),turn:0,castling:[0,0],enPassant:-1,variant:t,legal:t===2,king:[-1,-1],effectiveCastling:[0,0],effectiveEnPassant:-1}}function hte(t){const e=mL[t];return{board:e.board.slice(),turn:0,castling:e.castling.slice(),enPassant:-1,variant:t,legal:!0,king:e.king.slice(),effectiveCastling:e.castling.slice(),effectiveEnPassant:-1}}function pte(t){const e=mte(t),n=e.pieceScheme.map(s=>s*2+0),r=e.pieceScheme.map(s=>s*2+1);return{board:[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],-2,-2,-2,-2,-2,-2,-2,-2,10,10,10,10,10,10,10,10,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-2,-2,-2,-2,-2,-2,-2,-2,11,11,11,11,11,11,11,11,-2,-2,-2,-2,-2,-2,-2,-2,r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]],turn:0,castling:[e.castling,e.castling],enPassant:-1,variant:1,legal:!0,king:[0+e.kingFile,112+e.kingFile],effectiveCastling:[e.castling,e.castling],effectiveEnPassant:-1}}function mte(t){const e=[-1,-1,-1,-1,-1,-1,-1,-1];let n=0,r=-1;function s(o){let a=0;for(let u=0;u<8;++u)e[u]>=0||(o(u,a),++a)}function i(o,a,u){s((l,c)=>{(c===a||c===u)&&(e[l]=o)})}switch(e[t%4*2+1]=3,t=Math.trunc(t/4),e[t%4*2]=3,t=Math.trunc(t/4),i(1,t%6,-1),t=Math.trunc(t/6),t){case 0:i(4,0,1);break;case 1:i(4,0,2);break;case 2:i(4,0,3);break;case 3:i(4,0,4);break;case 4:i(4,1,2);break;case 5:i(4,1,3);break;case 6:i(4,1,4);break;case 7:i(4,2,3);break;case 8:i(4,2,4);break;case 9:i(4,3,4);break}return s((o,a)=>{a===1?(e[o]=0,r=o):(e[o]=2,n|=1<<o)}),{pieceScheme:e,castling:n,kingFile:r}}function gte(t){return{board:t.board.slice(),turn:t.turn,castling:t.castling.slice(),enPassant:t.enPassant,variant:t.variant,legal:t.legal,king:t.king.slice(),effectiveCastling:t.effectiveCastling===null?null:t.effectiveCastling.slice(),effectiveEnPassant:t.effectiveEnPassant}}var mo={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(mo,"__esModule",{value:!0});mo.trimAndCollapseSpaces=yte;mo.isValidNag=bte;mo.isValidElo=vte;mo.isValidRound=wte;function yte(t){return t.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")}function bte(t){return Number.isInteger(t)&&t>=0}function vte(t){return Number.isInteger(t)&&t>=0}function wte(t){return Number.isInteger(t)&&t>=0}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Bt,"__esModule",{value:!0});Bt.isColor=Ate;Bt.isPiece=Ete;Bt.isColoredPiece=Cte;Bt.isFile=Nte;Bt.isRank=Tte;Bt.isSquare=_te;Bt.isSquareCouple=Ite;Bt.isCastle=kte;Bt.isCastle960=Rte;Bt.isGameResult=Pte;Bt.isGameVariant=Ote;Bt.forEachSquare=Dte;Bt.squareColor=Lte;Bt.squareToCoordinates=Fte;Bt.coordinatesToSquare=$te;Bt.oppositeColor=Bte;Bt.variantWithCanonicalStartPosition=Mte;Bt.nagSymbol=Vte;Bt.isValidECO=Ute;const Sd=Lt,Ln=xt,xte=po,Ste=mo;function Ate(t){return(0,Ln.colorFromString)(t)>=0}function Ete(t){return(0,Ln.pieceFromString)(t)>=0}function Cte(t){return(0,Ln.coloredPieceFromString)(t)>=0}function Nte(t){return(0,Ln.fileFromString)(t)>=0}function Tte(t){return(0,Ln.rankFromString)(t)>=0}function _te(t){return(0,Ln.squareFromString)(t)>=0}function Ite(t){return typeof t=="string"&&/^[a-h][1-8][a-h][1-8]$/.test(t)}function kte(t){return typeof t=="string"&&/^[wb][kq]$/.test(t)}function Rte(t){return typeof t=="string"&&/^[wb][a-h]$/.test(t)}function Pte(t){return(0,Ln.resultFromString)(t)>=0}function Ote(t){return(0,Ln.variantFromString)(t)>=0}function Dte(t){for(let e=0;e<8;++e)for(let n=0;n<8;++n)t((0,Ln.squareToString)(e*16+n))}function Lte(t){const e=(0,Ln.squareFromString)(t);if(e<0)throw new Sd.IllegalArgument("squareColor()");return(0,Ln.colorToString)((0,Ln.squareColorImpl)(e))}function Fte(t){const e=(0,Ln.squareFromString)(t);if(e<0)throw new Sd.IllegalArgument("squareToCoordinates()");return{rank:Math.trunc(e/16),file:e%16}}function $te(t,e){const n=typeof t=="number"?t:t.file,r=typeof t=="number"?e:t.rank;if(!Number.isInteger(n)||!Number.isInteger(r)||n<0||n>=8||r<0||r>=8)throw new Sd.IllegalArgument("coordinatesToSquare()");return(0,Ln.fileToString)(n)+(0,Ln.rankToString)(r)}function Bte(t){const e=(0,Ln.colorFromString)(t);if(e<0)throw new Sd.IllegalArgument("oppositeColor()");return(0,Ln.colorToString)(1-e)}function Mte(t){const e=(0,Ln.variantFromString)(t);if(e<0)throw new Sd.IllegalArgument("variantWithCanonicalStartPosition()");return(0,xte.hasCanonicalStartPosition)(e)}const it=new Map;it.set(1,"!");it.set(2,"?");it.set(3,"!!");it.set(4,"??");it.set(5,"!?");it.set(6,"?!");it.set(7,"");it.set(8,"");it.set(9,"");it.set(10,"=");it.set(11,"=");it.set(13,"");it.set(14,"");it.set(15,"");it.set(16,"");it.set(17,"");it.set(18,"+");it.set(19,"+");it.set(20,"+");it.set(21,"+");it.set(22,"");it.set(32,"");it.set(36,"");it.set(40,"");it.set(44,"");it.set(132,"");it.set(138,"");it.set(140,"");it.set(141,"");it.set(142,"");it.set(143,"");it.set(145,"RR");it.set(146,"N");function Vte(t){if(!(0,Ste.isValidNag)(t))throw new Sd.IllegalArgument("nagSymbol()");return it.get(t)??"$"+t}function Ute(t){return typeof t=="string"&&/^[A-E][0-9][0-9]$/.test(t)}var Ad={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */var la=Ot&&Ot.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Wt=Ot&&Ot.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},lc,pi,Ls,mi;Object.defineProperty(Ad,"__esModule",{value:!0});Ad.DateValue=void 0;const ff=Lt;class Hi{constructor(e,n,r){if(lc.set(this,void 0),pi.set(this,void 0),Ls.set(this,void 0),mi.set(this,void 0),e instanceof Date)la(this,lc,"ymd","f"),la(this,pi,e.getFullYear(),"f"),la(this,Ls,e.getMonth()+1,"f"),la(this,mi,e.getDate(),"f");else{const s=hN(e,n,r);if(!s)throw new ff.IllegalArgument("DateValue()");la(this,lc,s,"f"),la(this,pi,e,"f"),la(this,Ls,n??void 0,"f"),la(this,mi,r??void 0,"f")}}type(){return Wt(this,lc,"f")}year(){return Wt(this,pi,"f")}month(){if(Wt(this,Ls,"f")===void 0)throw new ff.IllegalArgument("DateValue.month()");return Wt(this,Ls,"f")}day(){if(Wt(this,mi,"f")===void 0)throw new ff.IllegalArgument("DateValue.day()");return Wt(this,mi,"f")}toDate(){const e=Wt(this,Ls,"f")===void 0?0:Wt(this,Ls,"f")-1,n=Wt(this,mi,"f")===void 0?1:Wt(this,mi,"f");return new Date(Wt(this,pi,"f"),e,n)}toString(){return dN(Wt(this,pi,"f"),Wt(this,Ls,"f"),Wt(this,mi,"f"),"-","**")}static fromString(e){if(typeof e!="string")throw new ff.IllegalArgument("DateValue.fromString()");return fN(e,/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/,/^([0-9]{4})-([0-9]{2})-\*\*$/,/^([0-9]{4})-\*\*-\*\*$/,!1)}toPGNString(){return dN(Wt(this,pi,"f"),Wt(this,Ls,"f"),Wt(this,mi,"f"),".","??")}static fromPGNString(e){if(typeof e!="string")throw new ff.IllegalArgument("DateValue.fromPGNString()");return fN(e,/^([0-9]{4})\.([0-9]{2})\.([0-9]{2})$/,/^([0-9]{4})\.([0-9]{2})\.\?\?$/,/^([0-9]{4})(?:\.\?\?\.\?\?)?$/,!0)}toHumanReadableString(e){switch(Wt(this,lc,"f")){case"ymd":{const n=new Date(Wt(this,pi,"f"),Wt(this,Ls,"f")-1,Wt(this,mi,"f"));return new Intl.DateTimeFormat(e,{dateStyle:"long"}).format(n)}case"ym":{const n=new Date(Wt(this,pi,"f"),Wt(this,Ls,"f")-1,1);return new Intl.DateTimeFormat(e,{month:"long",year:"numeric"}).format(n)}default:return String(Wt(this,pi,"f"))}}static isValid(e,n,r){return!!hN(e,n,r)}}Ad.DateValue=Hi;lc=new WeakMap,pi=new WeakMap,Ls=new WeakMap,mi=new WeakMap;function dN(t,e,n,r,s){const i=String(t).padStart(4,"0"),o=e===void 0?s:String(e).padStart(2,"0"),a=n===void 0?s:String(n).padStart(2,"0");return i+r+o+r+a}function fN(t,e,n,r,s){if(e.test(t)){const i=RegExp.$1,o=RegExp.$2,a=RegExp.$3,u=parseInt(i,10),l=parseInt(o,10),c=parseInt(a,10);return Hi.isValid(u,l,c)?new Hi(u,l,c):s?Hi.isValid(u,l)?new Hi(u,l):new Hi(u):void 0}else if(n.test(t)){const i=RegExp.$1,o=RegExp.$2,a=parseInt(i,10),u=parseInt(o,10);return Hi.isValid(a,u)?new Hi(a,u):s?new Hi(a):void 0}else if(r.test(t)){const i=parseInt(RegExp.$1,10);return new Hi(i)}else return}function hN(t,e,n){return n!=null?Fy(t)&&pN(e)&&Number.isInteger(n)&&n>=1&&n<=zte(t,e)?"ymd":!1:e!=null?Fy(t)&&pN(e)?"ym":!1:Fy(t)?"y":!1}function Fy(t){return Number.isInteger(t)&&t>=0}function pN(t){return Number.isInteger(t)&&t>=1&&t<=12}function zte(t,e){return new Date(t,e,0).getDate()}var Ed={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Ed,"__esModule",{value:!0});Ed.MoveDescriptor=void 0;Ed.isMoveDescriptor=Wte;class gL{constructor(){}toString(){let e=this.from()+this.to();return this.isPromotion()?e+=this.promotion().toUpperCase():this.isCastling()&&(e+="O"),e}}Ed.MoveDescriptor=gL;function Wte(t){return t instanceof gL}var eu={},qh={};(function(t){/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(t,"__esModule",{value:!0}),t.ATTACK_DIRECTIONS=void 0,t.isAttacked=e,t.getAttacks=s,t.ATTACK_DIRECTIONS=[[-17,-16,-15,-1,1,15,16,17],[-17,-16,-15,-1,1,15,16,17],[-17,-16,-15,-1,1,15,16,17],[-17,-16,-15,-1,1,15,16,17],[-16,-1,1,16],[-16,-1,1,16],[-17,-15,15,17],[-17,-15,15,17],[-33,-31,-18,-14,14,18,31,33],[-33,-31,-18,-14,14,18,31,33],[15,17],[-17,-15]];function e(a,u,l){return n(a,u,0*2+l)||n(a,u,4*2+l)||n(a,u,5*2+l)||r(a,u,2*2+l,1*2+l)||r(a,u,3*2+l,1*2+l)}function n(a,u,l){const c=t.ATTACK_DIRECTIONS[l];for(let d=0;d<c.length;++d){const f=u-c[d];if(!(f&136)&&a.board[f]===l)return!0}return!1}function r(a,u,l,c){const d=t.ATTACK_DIRECTIONS[l];for(let f=0;f<d.length;++f){let h=u;for(;;){if(h-=d[f],!(h&136)){const p=a.board[h];if(p===-1)continue;if(p===l||p===c)return!0}break}}return!1}function s(a,u,l){const c=[];return i(a,u,c,0*2+l),i(a,u,c,4*2+l),i(a,u,c,5*2+l),o(a,u,c,2*2+l,1*2+l),o(a,u,c,3*2+l,1*2+l),c}function i(a,u,l,c){const d=t.ATTACK_DIRECTIONS[c];for(let f=0;f<d.length;++f){const h=u-d[f];!(h&136)&&a.board[h]===c&&l.push(h)}}function o(a,u,l,c,d){const f=t.ATTACK_DIRECTIONS[c];for(let h=0;h<f.length;++h){let p=u;for(;;){if(p-=f[h],!(p&136)){const y=a.board[p];if(y===-1)continue;(y===c||y===d)&&l.push(p)}break}}}})(qh);var Rl={},ni={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(ni,"__esModule",{value:!0});ni.isLegal=jte;ni.refreshLegalFlagAndKingSquares=Zg;ni.isKingSafeAfterMove=zv;ni.refreshEffectiveCastling=Wv;ni.refreshEffectiveEnPassant=jv;ni.isEqual=Gte;const yL=qh;function jte(t){return Zg(t),t.legal}function Zg(t){if(t.legal!==null)return;t.legal=!1;const e=mN(t,0),n=mN(t,1);if(!e||!n)return;if(t.variant===5){if(!gN(t,1-t.turn))return}else if(t.variant===6&&t.turn===1&&!gN(t,0))return;if(t.king[1-t.turn]>=0&&(0,yL.isAttacked)(t,t.king[1-t.turn],t.turn))return;const r=t.variant===6?-2:10;for(let s=0;s<8;++s){const i=t.board[0+s],o=t.board[112+s];if(i===r||o===10||i===11||o===11)return}t.legal=!0}function mN(t,e){const n=0+e;if(t.king[e]=-1,t.variant===5)return!0;if(t.variant===2||t.variant===4-e||t.variant===6&&e===0){for(let r=0;r<120;r+=(r&7)===7?9:1)if(t.board[r]===n)return!1;return!0}else{for(let r=0;r<120;r+=(r&7)===7?9:1)if(t.board[r]===n)if(t.king[e]<0)t.king[e]=r;else return t.king[e]=-1,!1;return t.king[e]>=0}}function gN(t,e){for(let n=0;n<120;n+=(n&7)===7?9:1)if(t.board[n]!==-1&&t.board[n]%2===e)return!0;return!1}function zv(t,e,n,r=-1){if(t.king[t.turn]<0)return!0;const s=t.board[e],i=t.board[n],o=Math.trunc(s/2);t.board[n]=s,t.board[e]=-1,r>=0&&(t.board[r]=-1);try{return!(0,yL.isAttacked)(t,o===0?n:t.king[t.turn],1-t.turn)}finally{t.board[e]=s,t.board[n]=i,r>=0&&(t.board[r]=5*2+1-t.turn)}}function Wv(t){t.effectiveCastling===null&&(Zg(t),t.effectiveCastling=t.variant===1?[bN(t,0),bN(t,1)]:[yN(t,0),yN(t,1)])}function yN(t,e){const n=112*e;if(t.king[e]!==n+4||t.castling[e]===0)return 0;const r=2*2+e;let s=0;return t.castling[e]&1&&t.board[n]===r&&(s|=1),t.castling[e]&128&&t.board[n+7]===r&&(s|=128),s}function bN(t,e){const n=112*e;if(t.king[e]<=n||t.king[e]>=n+7||t.castling[e]===0)return 0;const r=2*2+e;let s=0,i=-1;for(let a=t.king[e]%16-1;a>=0;--a)if(!(!(t.castling[e]&1<<a)||t.board[n+a]!==r))if(i<0)i=a;else{i=-1;break}i>=0&&(s|=1<<i);let o=-1;for(let a=t.king[e]%16+1;a<8;++a)if(!(!(t.castling[e]&1<<a)||t.board[n+a]!==r))if(o<0)o=a;else{o=-1;break}return o>=0&&(s|=1<<o),s}function jv(t){if(t.effectiveEnPassant!==null||(t.effectiveEnPassant=-1,t.enPassant<0))return;const e=(6-t.turn*5)*16+t.enPassant,n=(5-t.turn*3)*16+t.enPassant,r=(4-t.turn)*16+t.enPassant,s=5*2+t.turn,i=5*2+1-t.turn;if(t.board[e]!==-1||t.board[n]!==-1||t.board[r]!==i)return;const o=(r-1&136)===0&&t.board[r-1]===s,a=(r+1&136)===0&&t.board[r+1]===s;!o&&!a||(Zg(t),!(!(o&&zv(t,r-1,n,r))&&!(a&&zv(t,r+1,n,r)))&&(t.effectiveEnPassant=t.enPassant))}function Gte(t,e){if(t.turn!==e.turn||t.variant!==e.variant)return!1;for(let n=0;n<120;n+=(n&7)===7?9:1)if(t.board[n]!==e.board[n])return!1;return Wv(t),Wv(e),t.effectiveCastling[0]!==e.effectiveCastling[0]||t.effectiveCastling[1]!==e.effectiveCastling[1]?!1:(jv(t),jv(e),t.effectiveEnPassant===e.effectiveEnPassant)}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Rl,"__esModule",{value:!0});Rl.ascii=Hte;Rl.getFEN=Kte;Rl.parseFEN=Xte;const ao=xt,qte=po,F2=ni,ci=Lt,di=xs,$2=[..."KkQqRrBbNnPp"],bL=["6","3"];function Hte(t){let e=`+---+---+---+---+---+---+---+---+
`;for(let n=7;n>=0;--n){for(let r=0;r<8;++r){const s=t.board[n*16+r];e+="| "+(s===-1?" ":$2[s])+" "}e+=`|
`,e+=`+---+---+---+---+---+---+---+---+
`}return e+=(0,ao.colorToString)(t.turn)+" "+vL(t)+" "+wL(t),t.variant!==0&&(e+=" ("+(0,ao.variantToString)(t.variant)+")"),e}function Kte(t,e=0,n=1,r=!1){let s="";for(let i=7;i>=0;--i){let o=0;for(let a=0;a<8;++a){const u=t.board[i*16+a];u===-1?++o:(o>0&&(s+=o,o=0),s+=$2[u])}o>0&&(s+=o),i>0&&(s+="/")}return s+=" "+(0,ao.colorToString)(t.turn)+" "+vL(t,r)+" "+wL(t),s+=" "+e+" "+n,s}function vL(t,e=!1){if((0,F2.refreshEffectiveCastling)(t),t.variant===1){if(e){const s=vN(t,0),i=vN(t,1);if(s!==!1&&i!==!1)return s===""&&i===""?"-":s.toUpperCase()+i}let n="",r="";for(let s=0;s<8;++s)t.effectiveCastling[0]&1<<s&&(n+=(0,ao.fileToString)(s)),t.effectiveCastling[1]&1<<s&&(r+=(0,ao.fileToString)(s));return n===""&&r===""?"-":n.toUpperCase()+r}else{let n="";return t.effectiveCastling[0]&128&&(n+="K"),t.effectiveCastling[0]&1&&(n+="Q"),t.effectiveCastling[1]&128&&(n+="k"),t.effectiveCastling[1]&1&&(n+="q"),n===""?"-":n}}function vN(t,e){const n=1<<t.king[e]%16,r=t.effectiveCastling[e]&~(n|n-1),s=t.effectiveCastling[e]&n-1;let i="";const o=112*e,a=112*e+7,u=2*2+e;if(r!==0){let l=!1;for(let c=t.king[e]+1;c<=a;++c)if(t.board[c]===u){if(l)return!1;l=!0}i+="k"}if(s!==0){let l=!1;for(let c=t.king[e]-1;c>=o;--c)if(t.board[c]===u){if(l)return!1;l=!0}i+="q"}return i}function wL(t){return(0,F2.refreshEffectiveEnPassant)(t),t.effectiveEnPassant<0?"-":(0,ao.fileToString)(t.effectiveEnPassant)+bL[t.turn]}function Xte(t,e,n){const r=n?e.split(" "):e.replace(/^\s+|\s+$/g,"").split(/\s+/);if(r.length!==6)throw new ci.InvalidFEN(e,di.i18n.WRONG_NUMBER_OF_FEN_FIELDS);const s=r[0].split("/");if(s.length!==8)throw new ci.InvalidFEN(e,di.i18n.WRONG_NUMBER_OF_SUBFIELDS_IN_BOARD_FIELD);const i=(0,qte.makeEmpty)(t);i.legal=null,i.effectiveCastling=null,i.effectiveEnPassant=null;for(let l=7;l>=0;--l){const c=s[7-l];let d=0,f=0;for(;d<c.length&&f<8;){const h=c[d],p=$2.indexOf(h);if(/^[1-8]$/.test(h))f+=parseInt(h,10);else if(p>=0)i.board[l*16+f]=p,++f;else throw new ci.InvalidFEN(e,di.i18n.UNEXPECTED_CHARACTER_IN_BOARD_FIELD,h);++d}if(d!==c.length||f!==8)throw new ci.InvalidFEN(e,di.i18n.UNEXPECTED_END_OF_SUBFIELD_IN_BOARD_FIELD,8-l)}if(i.turn=(0,ao.colorFromString)(r[1]),i.turn<0)throw new ci.InvalidFEN(e,di.i18n.INVALID_TURN_FIELD);const o=t===1?Qte(r[2],n,i.board):Yte(r[2],n);if(o===null)throw new ci.InvalidFEN(e,di.i18n.INVALID_CASTLING_FIELD);i.castling=o;const a=r[3];if(a!=="-"){if(!/^[a-h][36]$/.test(a))throw new ci.InvalidFEN(e,di.i18n.INVALID_EN_PASSANT_FIELD);if(i.enPassant=(0,ao.fileFromString)(a[0]),n){if(a[1]!==bL[i.turn])throw new ci.InvalidFEN(e,di.i18n.WRONG_RANK_IN_EN_PASSANT_FIELD);if((0,F2.refreshEffectiveEnPassant)(i),i.enPassant!==i.effectiveEnPassant)throw new ci.InvalidFEN(e,di.i18n.INEFFECTIVE_EN_PASSANT_FIELD,(0,ao.fileToString)(i.enPassant))}}const u=n?/^(?:0|[1-9][0-9]*)$/:/^[0-9]+$/;if(!u.test(r[4]))throw new ci.InvalidFEN(e,di.i18n.INVALID_HALF_MOVE_COUNT_FIELD);if(!u.test(r[5]))throw new ci.InvalidFEN(e,di.i18n.INVALID_MOVE_NUMBER_FIELD);return{position:i,fiftyMoveClock:parseInt(r[4],10),fullMoveNumber:parseInt(r[5],10)}}function Yte(t,e){const n=[0,0];return t==="-"?n:(e?/^K?Q?k?q?$/:/^[KQkq]*$/).test(t)?(t.indexOf("K")>=0&&(n[0]|=128),t.indexOf("Q")>=0&&(n[0]|=1),t.indexOf("k")>=0&&(n[1]|=128),t.indexOf("q")>=0&&(n[1]|=1),n):null}function Qte(t,e,n){const r=[0,0];if(t==="-")return r;if(!(e?/^[A-H]{0,2}[a-h]{0,2}$/:/^[A-Ha-h]*|[KQkq]*$/).test(t))return null;function s(o){const a=4+o,u=0*2+o;for(let l=112*o;l<112*o+8;++l){if(n[l]===a)return l%8;if(n[l]===u)break}return 0}function i(o){const a=4+o,u=0*2+o;for(let l=112*o+7;l>=112*o;--l){if(n[l]===a)return l%8;if(n[l]===u)break}return 7}e||(t.indexOf("K")>=0&&(r[0]|=1<<i(0)),t.indexOf("Q")>=0&&(r[0]|=1<<s(0)),t.indexOf("k")>=0&&(r[1]|=1<<i(1)),t.indexOf("q")>=0&&(r[1]|=1<<s(1)));for(let o=0;o<8;++o){const a=(0,ao.fileToString)(o);t.indexOf(a.toUpperCase())>=0&&(r[0]|=1<<o),t.indexOf(a)>=0&&(r[1]|=1<<o)}return r}var Cd={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Cd,"__esModule",{value:!0});Cd.MoveDescriptorImpl=void 0;const Rs=xt,wu=Lt,Zte=Ed,wN=1,xN=2,Kp=4,SN=8;class Nc extends Zte.MoveDescriptor{static make(e,n,r,s){const i=s===-1?0:Kp;return new Nc(i,e,n,r,r,s,-1,-1)}static makeCastling(e,n,r,s,i){const o=0+i,a=2*2+i;return new Nc(wN,e,n,o,o,a,r,s)}static makeEnPassant(e,n,r,s){const i=xN|Kp,o=5*2+s,a=5*2+1-s;return new Nc(i,e,n,o,o,a,r,-1)}static makePromotion(e,n,r,s,i){const o=SN|(s===-1?0:Kp),a=5*2+r,u=i*2+r;return new Nc(o,e,n,a,u,s,-1,-1)}constructor(e,n,r,s,i,o,a,u){super(),this._flags=e,this._from=n,this._to=r,this._movingColoredPiece=s,this._finalColoredPiece=i,this._optionalColoredPiece=o,this._optionalSquare1=a,this._optionalSquare2=u}isCastling(){return(this._flags&wN)!==0}isEnPassant(){return(this._flags&xN)!==0}isCapture(){return(this._flags&Kp)!==0}isPromotion(){return(this._flags&SN)!==0}from(){return(0,Rs.squareToString)(this._from)}to(){return(0,Rs.squareToString)(this._to)}color(){return(0,Rs.colorToString)(this._movingColoredPiece%2)}movingPiece(){return(0,Rs.pieceToString)(Math.trunc(this._movingColoredPiece/2))}movingColoredPiece(){return(0,Rs.coloredPieceToString)(this._movingColoredPiece)}capturedPiece(){if(!this.isCapture())throw new wu.IllegalArgument("MoveDescriptor.capturedPiece()");return(0,Rs.pieceToString)(Math.trunc(this._optionalColoredPiece/2))}capturedColoredPiece(){if(!this.isCapture())throw new wu.IllegalArgument("MoveDescriptor.capturedColoredPiece()");return(0,Rs.coloredPieceToString)(this._optionalColoredPiece)}rookFrom(){if(!this.isCastling())throw new wu.IllegalArgument("MoveDescriptor.rookFrom()");return(0,Rs.squareToString)(this._optionalSquare1)}rookTo(){if(!this.isCastling())throw new wu.IllegalArgument("MoveDescriptor.rookTo()");return(0,Rs.squareToString)(this._optionalSquare2)}enPassantSquare(){if(!this.isEnPassant())throw new wu.IllegalArgument("MoveDescriptor.enPassantSquare()");return(0,Rs.squareToString)(this._optionalSquare1)}promotion(){if(!this.isPromotion())throw new wu.IllegalArgument("MoveDescriptor.promotion()");return(0,Rs.pieceToString)(Math.trunc(this._finalColoredPiece/2))}coloredPromotion(){if(!this.isPromotion())throw new wu.IllegalArgument("MoveDescriptor.coloredPromotion()");return(0,Rs.coloredPieceToString)(this._finalColoredPiece)}}Cd.MoveDescriptorImpl=Nc;var dr={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(dr,"__esModule",{value:!0});dr.isCheck=tne;dr.isCheckmate=nne;dr.isStalemate=rne;dr.isDead=sne;dr.hasMove=B2;dr.moves=ane;dr.isCaptureMandatory=M2;dr.isCastlingMoveLegal=EL;dr.isMoveLegal=une;dr.play=cne;dr.isNullMoveLegal=NL;dr.playNullMove=dne;const Mc=qh,xL=xt,an=ni,ar=Cd,Jte=[204,0,0,0,0,0,0,60,0,0,0,0,0,0,204,0,0,204,0,0,0,0,0,60,0,0,0,0,0,204,0,0,0,0,204,0,0,0,0,60,0,0,0,0,204,0,0,0,0,0,0,204,0,0,0,60,0,0,0,204,0,0,0,0,0,0,0,0,204,0,0,60,0,0,204,0,0,0,0,0,0,0,0,0,0,204,768,60,768,204,0,0,0,0,0,0,0,0,0,0,0,768,2255,2111,2255,768,0,0,0,0,0,0,60,60,60,60,60,60,63,0,63,60,60,60,60,60,60,0,0,0,0,0,0,768,1231,1087,1231,768,0,0,0,0,0,0,0,0,0,0,0,204,768,60,768,204,0,0,0,0,0,0,0,0,0,0,204,0,0,60,0,0,204,0,0,0,0,0,0,0,0,204,0,0,0,60,0,0,0,204,0,0,0,0,0,0,204,0,0,0,0,60,0,0,0,0,204,0,0,0,0,204,0,0,0,0,0,60,0,0,0,0,0,204,0,0,204,0,0,0,0,0,0,60,0,0,0,0,0,0,204,0],ene=[-17,0,0,0,0,0,0,-16,0,0,0,0,0,0,-15,0,0,-17,0,0,0,0,0,-16,0,0,0,0,0,-15,0,0,0,0,-17,0,0,0,0,-16,0,0,0,0,-15,0,0,0,0,0,0,-17,0,0,0,-16,0,0,0,-15,0,0,0,0,0,0,0,0,-17,0,0,-16,0,0,-15,0,0,0,0,0,0,0,0,0,0,-17,0,-16,0,-15,0,0,0,0,0,0,0,0,0,0,0,0,-17,-16,-15,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,15,16,17,0,0,0,0,0,0,0,0,0,0,0,0,15,0,16,0,17,0,0,0,0,0,0,0,0,0,0,15,0,0,16,0,0,17,0,0,0,0,0,0,0,0,15,0,0,0,16,0,0,0,17,0,0,0,0,0,0,15,0,0,0,0,16,0,0,0,0,17,0,0,0,0,15,0,0,0,0,0,16,0,0,0,0,0,17,0,0,15,0,0,0,0,0,0,16,0,0,0,0,0,0,17,0];function SL(t,e){for(let n=0;n<120;n+=(n&7)===7?9:1)if(t.board[n]!==-1&&t.board[n]%2===e)return!0;return!1}function Jg(t){return t.king[t.turn]>=0&&(0,Mc.isAttacked)(t,t.king[t.turn],1-t.turn)}function tne(t){return(0,an.isLegal)(t)&&Jg(t)}function nne(t){return!(0,an.isLegal)(t)||B2(t)?!1:t.variant===5?!0:t.variant===6&&t.turn===0?!SL(t,0):Jg(t)}function rne(t){return!(0,an.isLegal)(t)||B2(t)?!1:t.variant===5?!0:t.variant===6&&t.turn===0?SL(t,0):!Jg(t)}function sne(t,e){return(0,an.isLegal)(t)&&(t.variant===0||t.variant===1)?e?one(t):ine(t):!1}function ine(t){let e=!1,n=-1;for(let r=0;r<120;r+=(r&7)===7?9:1){const s=t.board[r];if(s===-1)continue;const i=Math.trunc(s/2);if(i===3){const o=(0,xL.squareColorImpl)(r);if(n===o)continue;n=o}if(i===3||i===4){if(e)return!1;e=!0}else if(i!==0)return!1}return!0}function one(t){const e=[0,0],n=[-1,-1];for(let r=0;r<120;r+=(r&7)===7?9:1){const s=t.board[r];if(s===-1)continue;const i=s%2,o=Math.trunc(s/2);if(o===3){const a=(0,xL.squareColorImpl)(r);if(n[i]===a)continue;n[i]=a}if(o===3||o===4){if(e[i]+=o===3?2:1,e[i]>=3)return!1}else if(o!==0)return!1}return!0}function B2(t){class e{}try{return AL(t,()=>{throw new e}),!1}catch(n){if(n instanceof e)return!0;throw n}}function ane(t){const e=[];return AL(t,n=>{e.push(n)}),e}function AL(t,e){if(!(0,an.isLegal)(t))return;const n=!M2(t);if((0,an.refreshEffectiveCastling)(t),n&&t.effectiveCastling[t.turn]!==0){const r=112*t.turn;for(let s=0;s<8;++s)if(t.effectiveCastling[t.turn]&1<<s){const i=r+s,o=r+(i<t.king[t.turn]?3:5),a=r+(i<t.king[t.turn]?2:6);CL(t,t.king[t.turn],a,i,o)&&e(ar.MoveDescriptorImpl.makeCastling(t.king[t.turn],a,i,o,t.turn))}}if((0,an.refreshEffectiveEnPassant)(t),t.effectiveEnPassant>=0){const r=(5-t.turn*3)*16+t.effectiveEnPassant,s=(4-t.turn)*16+t.effectiveEnPassant,i=5*2+t.turn;!(s-1&136)&&t.board[s-1]===i&&(0,an.isKingSafeAfterMove)(t,s-1,r,s)&&e(ar.MoveDescriptorImpl.makeEnPassant(s-1,r,s,t.turn)),!(s+1&136)&&t.board[s+1]===i&&(0,an.isKingSafeAfterMove)(t,s+1,r,s)&&e(ar.MoveDescriptorImpl.makeEnPassant(s+1,r,s,t.turn))}for(let r=0;r<120;r+=(r&7)===7?9:1){const s=t.board[r],i=Math.trunc(s/2);if(!(s===-1||s%2!==t.turn))if(i===5){const o=Mc.ATTACK_DIRECTIONS[s];for(let a=0;a<o.length;++a){const u=r+o[a];!(u&136)&&t.board[u]!==-1&&t.board[u]%2!==t.turn&&(0,an.isKingSafeAfterMove)(t,r,u)&&AN(t,r,u,e)}if(n){const a=16-t.turn*32;let u=r+a;if(t.board[u]===-1){(0,an.isKingSafeAfterMove)(t,r,u)&&AN(t,r,u,e);const l=t.turn*96;r>=l&&r<l+24&&(u+=a,t.board[u]===-1&&(0,an.isKingSafeAfterMove)(t,r,u)&&e(ar.MoveDescriptorImpl.make(r,u,s,-1)))}}}else if(i===4||i===0){const o=Mc.ATTACK_DIRECTIONS[s];for(let a=0;a<o.length;++a){const u=r+o[a];if(!(u&136)){const l=t.board[u];(l===-1?n:l%2!==t.turn)&&(0,an.isKingSafeAfterMove)(t,r,u)&&e(ar.MoveDescriptorImpl.make(r,u,s,l))}}}else{const o=Mc.ATTACK_DIRECTIONS[s];for(let a=0;a<o.length;++a)for(let u=r+o[a];!(u&136);u+=o[a]){const l=t.board[u];if((l===-1?n:l%2!==t.turn)&&(0,an.isKingSafeAfterMove)(t,r,u)&&e(ar.MoveDescriptorImpl.make(r,u,s,l)),l!==-1)break}}}}function AN(t,e,n,r){const s=t.board[n];n<8||n>=112?(r(ar.MoveDescriptorImpl.makePromotion(e,n,t.turn,s,1)),r(ar.MoveDescriptorImpl.makePromotion(e,n,t.turn,s,2)),r(ar.MoveDescriptorImpl.makePromotion(e,n,t.turn,s,3)),r(ar.MoveDescriptorImpl.makePromotion(e,n,t.turn,s,4)),t.variant===5&&r(ar.MoveDescriptorImpl.makePromotion(e,n,t.turn,s,0))):r(ar.MoveDescriptorImpl.make(e,n,5*2+t.turn,s))}function M2(t){if(t.variant!==5)return!1;for(let e=0;e<120;e+=(e&7)===7?9:1){const n=t.board[e];if(n!==-1&&n%2!==t.turn&&(0,Mc.isAttacked)(t,e,t.turn))return!0}return(0,an.refreshEffectiveEnPassant)(t),t.effectiveEnPassant>=0}function EL(t,e,n){let r=-1,s=-1;if(t.variant===1){const i=n%16;if(Math.trunc(n/16)!==t.turn*7||!(t.effectiveCastling[t.turn]&1<<i))return!1;r=n,s=(e>n?3:5)+112*t.turn,n=(e>n?2:6)+112*t.turn}else if(n===2+t.turn*112){if(!(t.effectiveCastling[t.turn]&1))return!1;r=112*t.turn,s=3+112*t.turn}else if(n===6+t.turn*112){if(!(t.effectiveCastling[t.turn]&128))return!1;r=7+112*t.turn,s=5+112*t.turn}else return!1;return CL(t,e,n,r,s)?ar.MoveDescriptorImpl.makeCastling(e,n,r,s,t.turn):!1}function CL(t,e,n,r,s){t.board[e]=-1,t.board[r]=-1;try{for(let o=Math.min(e,n,r,s);o<=Math.max(e,n,r,s);++o)if(t.board[o]!==-1)return!1;const i=1-t.turn;for(let o=Math.min(e,n);o<=Math.max(e,n);++o)if((0,Mc.isAttacked)(t,o,i))return!1;return!0}finally{t.board[e]=0*2+t.turn,t.board[r]=2*2+t.turn}}function une(t,e,n){if(!(0,an.isLegal)(t))return!1;const r=t.board[e],s=t.board[n],i=Math.trunc(r/2);if(r===-1||r%2!==t.turn)return!1;const o=n-e+119;let a=-1,u=!1;const l=i===5&&(n<8||n>=112),c=M2(t);if(i===0&&!c&&((0,an.refreshEffectiveCastling)(t),t.effectiveCastling[t.turn]!==0)){const d=EL(t,e,n);if(d)return{type:"regular",moveDescriptor:d}}if(!(Jte[o]&1<<r))if(i===5&&o===151-t.turn*64){const d=t.turn*96;if(e<d||e>=d+24)return!1;u=!0}else return!1;if(i===5){if((0,an.refreshEffectiveEnPassant)(t),o===135-t.turn*32||u){if(c||s!==-1)return!1}else if(s===-1){if(n!==(5-t.turn*3)*16+t.effectiveEnPassant)return!1;a=(4-t.turn)*16+t.effectiveEnPassant}else if(s%2===t.turn)return!1}else if(s===-1?c:s%2===t.turn)return!1;if(i===3||i===2||i===1){const d=ene[o];for(let f=e+d;f!==n;f+=d)if(t.board[f]!==-1)return!1}else if(u&&t.board[(e+n)/2]!==-1)return!1;return(0,an.isKingSafeAfterMove)(t,e,n,a)?l?{type:"promotion",moveDescriptorFactory:lne(e,n,t.variant,t.turn,s)}:{type:"regular",moveDescriptor:a>=0?ar.MoveDescriptorImpl.makeEnPassant(e,n,a,t.turn):ar.MoveDescriptorImpl.make(e,n,r,s)}:!1}function lne(t,e,n,r,s){return i=>i===5||i===0&&n!==5?!1:ar.MoveDescriptorImpl.makePromotion(t,e,r,s,i)}function cne(t,e){(0,an.refreshEffectiveCastling)(t),t.board[e._from]=-1,e.isEnPassant()?t.board[e._optionalSquare1]=-1:e.isCastling()&&(t.board[e._optionalSquare1]=-1,t.board[e._optionalSquare2]=e._optionalColoredPiece),t.board[e._to]=e._finalColoredPiece;const n=Math.trunc(e._movingColoredPiece/2);if(n===0&&(t.effectiveCastling[t.turn]=0),e._from<8&&(t.effectiveCastling[0]&=~(1<<e._from)),e._to<8&&(t.effectiveCastling[0]&=~(1<<e._to)),e._from>=112&&(t.effectiveCastling[1]&=~(1<<e._from%16)),e._to>=112&&(t.effectiveCastling[1]&=~(1<<e._to%16)),t.castling[0]=t.effectiveCastling[0],t.castling[1]=t.effectiveCastling[1],t.enPassant=-1,t.effectiveEnPassant=-1,n===5&&Math.abs(e._from-e._to)===32){const r=(1+5*t.turn)*16;if(e._from>=r&&e._from<r+8){const s=e._movingColoredPiece^1;(!(e._to-1&136)&&t.board[e._to-1]===s||!(e._to+1&136)&&t.board[e._to+1]===s)&&(t.enPassant=e._to%16,t.effectiveEnPassant=null)}}n===0&&t.king[t.turn]>=0&&(t.king[t.turn]=e._to),t.turn=1-t.turn}function NL(t){return(0,an.isLegal)(t)&&!Jg(t)}function dne(t){return NL(t)?(t.turn=1-t.turn,t.enPassant=-1,t.effectiveEnPassant=-1,!0):!1}var e1={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(e1,"__esModule",{value:!0});e1.getNotation=hne;e1.parseNotation=mne;const TL=qh,Tr=xt,dt=Rl,fne=po,Ch=ni,Om=Cd,Vc=dr,ft=Lt,Je=xs;function hne(t,e,n){let r="";return e.isCastling()?r=e._to%16===6?"O-O":"O-O-O":Math.trunc(e._movingColoredPiece/2)===5?(e.isCapture()&&(r+=(0,Tr.fileToString)(e._from%16)+"x"),r+=(0,Tr.squareToString)(e._to),e.isPromotion()&&(r+="="+EN(e._finalColoredPiece,n))):(r+=EN(e._movingColoredPiece,n),r+=IL(t,e._from,e._to),e.isCapture()&&(r+="x"),r+=(0,Tr.squareToString)(e._to)),r+=_L(t,e),r}function EN(t,e){switch(e){case"figurine":return(0,Tr.figurineToString)(t);case"standard":return(0,Tr.pieceToString)(Math.trunc(t/2)).toUpperCase()}}function _L(t,e){const n=(0,fne.makeCopy)(t);return(0,Vc.play)(n,e),(0,Vc.isCheckmate)(n)?"#":(0,Vc.isCheck)(n)?"+":""}function IL(t,e,n){const r=(0,TL.getAttacks)(t,n,t.turn).filter(l=>t.board[l]===t.board[e]);if(r.length<2)return"";let s=!1,i=!1,o=!1;const a=Math.trunc(e/16),u=e%16;for(let l=0;l<r.length;++l){const c=r[l];c===e||pne(t,c,n)||(s=!0,a===Math.trunc(c/16)&&(i=!0),u===c%16&&(o=!0))}return o?i?(0,Tr.squareToString)(e):(0,Tr.rankToString)(a):s?(0,Tr.fileToString)(u):""}function pne(t,e,n){const r=t.king[t.turn];if(r<0)return!1;const s=Math.abs(r-e),i=Math.abs(n-e),o=1*2+1-t.turn,a=2*2+1-t.turn,u=3*2+1-t.turn;return s<8?i>=8&&Xp(t,r,e,r<e?1:-1,a,o):s%16===0?i%16!==0&&Xp(t,r,e,r<e?16:-16,a,o):s%15===0?i%15!==0&&Xp(t,r,e,r<e?15:-15,u,o):s%17===0?i%17!==0&&Xp(t,r,e,r<e?17:-17,u,o):!1}function Xp(t,e,n,r,s,i){for(let o=e+r;o!==n;o+=r)if(t.board[o]!==-1)return!1;for(let o=n+r;!(o&136);o+=r)if(t.board[o]!==-1)return t.board[o]===s||t.board[o]===i;return!1}function mne(t,e,n,r){const s=/^(?:(O-O-O|0-0-0)|(O-O|0-0)|([A-Z\u2654-\u265f])([a-h])?([1-8])?(x)?([a-h][1-8])|(?:([a-h])(x)?)?([a-h][1-8])(?:(=)?([A-Z\u2654-\u265f]))?)([+#])?$/.exec(e);if(s===null)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_MOVE_NOTATION_SYNTAX);if(!(0,Ch.isLegal)(t))throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.ILLEGAL_POSITION);let i=!1;if(s[1]!==void 0||s[2]!==void 0?i=gne(t,e,n,s[1],s[2]):s[3]!==void 0?i=bne(t,e,n,r,s[3],s[4],s[5],s[7]):i=vne(t,e,n,r,s[8],s[10],s[11],s[12]),n){const o=s[6]!==void 0||s[9]!==void 0;if(i.isCapture()!==o){const l=i.isCapture()?Je.i18n.MISSING_CAPTURE_SYMBOL:Je.i18n.INVALID_CAPTURE_SYMBOL;throw new ft.InvalidNotation((0,dt.getFEN)(t),e,l)}const a=_L(t,i),u=s[13]??"";if(a!==u)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.WRONG_CHECK_CHECKMATE_SYMBOL,a,u)}return i}function gne(t,e,n,r,s){const i=t.king[t.turn];if(i<0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.ILLEGAL_NO_KING_CASTLING);(0,Ch.refreshEffectiveCastling)(t);const o=s!==void 0,a=yne(t,o),u=a>=0?(0,Vc.isCastlingMoveLegal)(t,i,a+112*t.turn):!1;if(!u){const l=o?Je.i18n.ILLEGAL_KING_SIDE_CASTLING:Je.i18n.ILLEGAL_QUEEN_SIDE_CASTLING;throw new ft.InvalidNotation((0,dt.getFEN)(t),e,l)}if(n&&(o?s:r).charAt(0)==="0")throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.CASTLING_MOVE_ENCODED_WITH_ZERO);return u}function yne(t,e){if(t.variant===1){if(t.effectiveCastling[t.turn]!==0){const n=0+t.turn;for(let r=e?7:0;t.board[r+112*t.turn]!==n;r+=e?-1:1)if(t.effectiveCastling[t.turn]&1<<r)return r}return-1}else return e?6:2}function bne(t,e,n,r,s,i,o,a){const u=kL(t,e,s,n,r)*2+t.turn,l=(0,Tr.squareFromString)(a),c=t.board[l];if(c!==-1&&c%2===t.turn)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.TRYING_TO_CAPTURE_YOUR_OWN_PIECES);if(c===-1&&(0,Vc.isCaptureMandatory)(t))throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.CAPTURE_IS_MANDATORY);let d=(0,TL.getAttacks)(t,l,t.turn).filter(h=>t.board[h]===u);if(i!==void 0){const h=(0,Tr.fileFromString)(i);d=d.filter(p=>p%16===h)}if(o!==void 0){const h=(0,Tr.rankFromString)(o);d=d.filter(p=>Math.trunc(p/16)===h)}if(d.length===0){const h=i===void 0&&o===void 0?Je.i18n.NO_PIECE_CAN_MOVE_TO:Je.i18n.NO_PIECE_CAN_MOVE_TO_DISAMBIGUATION;throw new ft.InvalidNotation((0,dt.getFEN)(t),e,h,s,a)}let f=!1;for(let h=0;h<d.length;++h)if((0,Ch.isKingSafeAfterMove)(t,d[h],l)){if(f)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.REQUIRE_DISAMBIGUATION,s,a);f=Om.MoveDescriptorImpl.make(d[h],l,u,c)}if(!f){const h=t.turn===0?Je.i18n.NOT_SAFE_FOR_WHITE_KING:Je.i18n.NOT_SAFE_FOR_BLACK_KING;throw new ft.InvalidNotation((0,dt.getFEN)(t),e,h)}if(n){const h=IL(t,f._from,l),p=(i??"")+(o??"");if(h!==p)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.WRONG_DISAMBIGUATION_SYMBOL,h,p)}return f}function vne(t,e,n,r,s,i,o,a){const u=10+t.turn,l=(0,Tr.squareFromString)(i),c=t.board[l],d=16-t.turn*32;let f=l-d,h=-1;if(s!==void 0){if(f&136)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_CAPTURING_PAWN_MOVE);const p=(0,Tr.fileFromString)(s),y=l%16;if(y-p===1)f-=1;else if(y-p===-1)f+=1;else throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_CAPTURING_PAWN_MOVE);if(t.board[f]!==u)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_CAPTURING_PAWN_MOVE);if(c===-1){if((0,Ch.refreshEffectiveEnPassant)(t),l!==(5-t.turn*3)*16+t.effectiveEnPassant)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_CAPTURING_PAWN_MOVE);h=(4-t.turn)*16+t.effectiveEnPassant}else if(c%2===t.turn)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_CAPTURING_PAWN_MOVE)}else{if((0,Vc.isCaptureMandatory)(t))throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.CAPTURE_IS_MANDATORY);if(f&136)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_NON_CAPTURING_PAWN_MOVE);if(c!==-1)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_NON_CAPTURING_PAWN_MOVE);if(t.board[f]===-1){f-=d;const p=t.turn*96;if(f<p||f>=p+24||t.board[f]!==u)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_NON_CAPTURING_PAWN_MOVE)}else if(t.board[f]!==u)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_NON_CAPTURING_PAWN_MOVE)}if(!(0,Ch.isKingSafeAfterMove)(t,f,l,h)){const p=t.turn===0?Je.i18n.NOT_SAFE_FOR_WHITE_KING:Je.i18n.NOT_SAFE_FOR_BLACK_KING;throw new ft.InvalidNotation((0,dt.getFEN)(t),e,p)}if(l<8||l>=112){if(a===void 0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.MISSING_PROMOTION);const p=kL(t,e,a,n,r);if(p===5||p===0&&t.variant!==5)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_PROMOTED_PIECE,a);if(n&&o===void 0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.MISSING_PROMOTION_SYMBOL);return Om.MoveDescriptorImpl.makePromotion(f,l,t.turn,c,p)}else{if(a!==void 0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.ILLEGAL_PROMOTION);return h>=0?Om.MoveDescriptorImpl.makeEnPassant(f,l,h,t.turn):Om.MoveDescriptorImpl.make(f,l,u,c)}}function kL(t,e,n,r,s){switch(s){case"figurine":{const i=(0,Tr.figurineFromString)(n);if(i<0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_PIECE_SYMBOL,n);if(r&&i%2!==t.turn)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_PIECE_SYMBOL_COLOR,n);return Math.trunc(i/2)}case"standard":{const i=(0,Tr.pieceFromString)(n.toLowerCase());if(i<0)throw new ft.InvalidNotation((0,dt.getFEN)(t),e,Je.i18n.INVALID_PIECE_SYMBOL,n);return i}}}var t1={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(t1,"__esModule",{value:!0});t1.getUCINotation=Sne;t1.parseUCINotation=Ane;const $y=xt,xu=Rl,wne=ni,xne=dr,Su=Lt,Au=xs;function Sne(t,e,n){let r=e.from();return e.isCastling()?r+=n||t.variant===1?e.rookFrom():e.to():r+=e.to(),e.isPromotion()&&(r+=e.promotion()),r}function Ane(t,e,n){const r=/^([a-h][1-8])([a-h][1-8])([kqrbnp]?)$/.exec(e);if(r===null)throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.INVALID_UCI_NOTATION_SYNTAX);if(!(0,wne.isLegal)(t))throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_POSITION);const s=(0,$y.squareFromString)(r[1]);let i=(0,$y.squareFromString)(r[2]),o=!1,a=-1;if(t.variant!==1&&!n&&t.board[s]!==-1&&t.board[i]!==-1&&t.board[s]%2===t.board[i]%2){const c=Math.trunc(t.board[s]/2),d=Math.trunc(t.board[i]/2);c===0&&d===2&&(o=!0,a=i,i=t.turn*112+(s<i?6:2))}const u=(0,xne.isMoveLegal)(t,s,i);let l=!1;if(!u)throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_UCI_MOVE);if(u.type==="promotion"){if(r[3]==="")throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_UCI_MOVE);if(l=u.moveDescriptorFactory((0,$y.pieceFromString)(r[3])),!l)throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_UCI_MOVE)}else{if(r[3]!=="")throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_UCI_MOVE);l=u.moveDescriptor}if(o&&(!l.isCastling()||a!==l._optionalSquare1))throw new Su.InvalidNotation((0,xu.getFEN)(t),e,Au.i18n.ILLEGAL_UCI_MOVE);return l}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(eu,"__esModule",{value:!0});eu.Position=void 0;const Nt=Lt,Yp=Bt,Ene=xs,CN=qh,Et=xt,ca=Rl,br=po,hf=ni,pf=Cd,fi=dr,Eu=e1,Qp=t1;class qf{constructor(e,n){switch(arguments.length){case 0:this._impl=(0,br.makeInitial)(0);break;case 1:{if(e==="start")this._impl=(0,br.makeInitial)(0);else if(e==="empty")this._impl=(0,br.makeEmpty)(0);else if(e instanceof qf)this._impl=(0,br.makeCopy)(e._impl);else{const r=(0,Et.variantFromString)(e);if(r>=0){if(!(0,br.hasCanonicalStartPosition)(r))throw new Nt.IllegalArgument("Position()");this._impl=(0,br.makeInitial)(r)}else if(typeof e=="string"){const s=e.indexOf(":");if(s<0)this._impl=(0,ca.parseFEN)(0,e,!1).position;else{const i=e.substring(0,s),o=(0,Et.variantFromString)(i);if(o<0)throw new Nt.InvalidFEN(e,Ene.i18n.INVALID_VARIANT_PREFIX,i);this._impl=(0,ca.parseFEN)(o,e.substring(s+1),!1).position}}else throw new Nt.IllegalArgument("Position()")}break}default:{const r=(0,Et.variantFromString)(e);if(r<0)throw new Nt.IllegalArgument("Position()");if(n==="start"){if(!(0,br.hasCanonicalStartPosition)(r))throw new Nt.IllegalArgument("Position()");this._impl=(0,br.makeInitial)(r)}else if(n==="empty")this._impl=(0,br.makeEmpty)(r);else if(typeof n=="number"){if(r!==1||!NN(n))throw new Nt.IllegalArgument("Position()");this._impl=(0,br.make960FromScharnagl)(n)}else if(typeof n=="string")this._impl=(0,ca.parseFEN)(r,n,!1).position;else throw new Nt.IllegalArgument("Position()");break}}}clear(e="regular"){const n=(0,Et.variantFromString)(e);if(n<0)throw new Nt.IllegalArgument("Position.clear()");this._impl=(0,br.makeEmpty)(n)}reset(){this._impl=(0,br.makeInitial)(0)}reset960(e){if(!NN(e))throw new Nt.IllegalArgument("Position.reset960()");this._impl=(0,br.make960FromScharnagl)(e)}resetAntichess(){this._impl=(0,br.makeInitial)(5)}resetHorde(){this._impl=(0,br.makeInitial)(6)}static isEqual(e,n){return e instanceof qf&&n instanceof qf&&(0,hf.isEqual)(e._impl,n._impl)}ascii(){return(0,ca.ascii)(this._impl)}fen(e,n){if(arguments.length===0)return(0,ca.getFEN)(this._impl);if(arguments.length===1&&typeof e=="object"){const r=Cne(e,"Position.fen()"),s=r("fiftyMoveClock",0,u=>Number.isInteger(u)),i=r("fullMoveNumber",1,u=>Number.isInteger(u)),o=r("withVariant",!1,u=>typeof u=="boolean"),a=r("regularFENIfPossible",!1,u=>typeof u=="boolean");return(o?(0,Et.variantToString)(this._impl.variant)+":":"")+(0,ca.getFEN)(this._impl,s,i,a)}else if(arguments.length===1&&typeof e=="string"){const r=(0,ca.parseFEN)(this._impl.variant,e,!1);return this._impl=r.position,{fiftyMoveClock:r.fiftyMoveClock,fullMoveNumber:r.fullMoveNumber}}else if(arguments.length>=2&&typeof e=="string"&&typeof n=="boolean"){const r=(0,ca.parseFEN)(this._impl.variant,e,n);return this._impl=r.position,{fiftyMoveClock:r.fiftyMoveClock,fullMoveNumber:r.fullMoveNumber}}else throw new Nt.IllegalArgument("Position.fen()")}variant(){return(0,Et.variantToString)(this._impl.variant)}square(e,n){const r=(0,Et.squareFromString)(e);if(r<0)throw new Nt.IllegalArgument("Position.square()");if(arguments.length===1){const s=this._impl.board[r];return s===-1?"-":(0,Et.coloredPieceToString)(s)}else if(n==="-")this._impl.board[r]=-1,this._impl.legal=null,this._impl.effectiveCastling=null,this._impl.effectiveEnPassant=null;else{const s=(0,Et.coloredPieceFromString)(n);if(s<0)throw new Nt.IllegalArgument("Position.square()");this._impl.board[r]=s,this._impl.legal=null,this._impl.effectiveCastling=null,this._impl.effectiveEnPassant=null}}turn(e){if(arguments.length===0)return(0,Et.colorToString)(this._impl.turn);{const n=(0,Et.colorFromString)(e);if(n<0)throw new Nt.IllegalArgument("Position.turn()");this._impl.turn=n,this._impl.legal=null,this._impl.effectiveEnPassant=null}}castling(e,n){if(!(this._impl.variant===1?(0,Yp.isCastle960)(e):(0,Yp.isCastle)(e)))throw new Nt.IllegalArgument("Position.castling()");const r=(0,Et.colorFromString)(e[0]),s=this._impl.variant===1?(0,Et.fileFromString)(e[1]):e[1]==="k"?7:0;if(arguments.length===1)return(this._impl.castling[r]&1<<s)!==0;if(typeof n=="boolean")n?this._impl.castling[r]|=1<<s:this._impl.castling[r]&=~(1<<s),this._impl.effectiveCastling=null;else throw new Nt.IllegalArgument("Position.castling()")}effectiveCastling(e){if(!(this._impl.variant===1?(0,Yp.isCastle960)(e):(0,Yp.isCastle)(e)))throw new Nt.IllegalArgument("Position.effectiveCastling()");const n=(0,Et.colorFromString)(e[0]),r=this._impl.variant===1?(0,Et.fileFromString)(e[1]):e[1]==="k"?7:0;return(0,hf.refreshEffectiveCastling)(this._impl),(this._impl.effectiveCastling[n]&1<<r)!==0}enPassant(e){if(arguments.length===0)return this._impl.enPassant<0?"-":(0,Et.fileToString)(this._impl.enPassant);if(e==="-")this._impl.enPassant=-1,this._impl.effectiveEnPassant=-1;else{const n=(0,Et.fileFromString)(e);if(n<0)throw new Nt.IllegalArgument("Position.enPassant()");this._impl.enPassant=n,this._impl.effectiveEnPassant=null}}effectiveEnPassant(){return(0,hf.refreshEffectiveEnPassant)(this._impl),this._impl.effectiveEnPassant<0?"-":(0,Et.fileToString)(this._impl.effectiveEnPassant)}isAttacked(e,n){const r=(0,Et.squareFromString)(e),s=(0,Et.colorFromString)(n);if(r<0||s<0)throw new Nt.IllegalArgument("Position.isAttacked()");return(0,CN.isAttacked)(this._impl,r,s)}getAttacks(e,n){const r=(0,Et.squareFromString)(e),s=(0,Et.colorFromString)(n);if(r<0||s<0)throw new Nt.IllegalArgument("Position.getAttacks()");return(0,CN.getAttacks)(this._impl,r,s).map(Et.squareToString)}isLegal(){return(0,hf.isLegal)(this._impl)}kingSquare(e){const n=(0,Et.colorFromString)(e);if(n<0)throw new Nt.IllegalArgument("Position.kingSquare()");(0,hf.refreshLegalFlagAndKingSquares)(this._impl);const r=this._impl.king[n];return r<0?!1:(0,Et.squareToString)(r)}isCheck(){return(0,fi.isCheck)(this._impl)}isCheckmate(){return(0,fi.isCheckmate)(this._impl)}isStalemate(){return(0,fi.isStalemate)(this._impl)}isDead(e=!1){return(0,fi.isDead)(this._impl,e)}hasMove(){return(0,fi.hasMove)(this._impl)}moves(){return(0,fi.moves)(this._impl)}isMoveLegal(e,n){const r=(0,Et.squareFromString)(e),s=(0,Et.squareFromString)(n);if(r<0||s<0)throw new Nt.IllegalArgument("Position.isMoveLegal()");const i=(0,fi.isMoveLegal)(this._impl,r,s);if(!i)return!1;switch(i.type){case"promotion":{const o=a=>{const u=(0,Et.pieceFromString)(a);if(u>=0){const l=i.moveDescriptorFactory(u);if(l)return l}throw new Nt.IllegalArgument("Position.isMoveLegal()")};return o.status="promotion",o}case"regular":{const o=()=>i.moveDescriptor;return o.status="regular",o}}}play(e){if(typeof e=="string")try{return(0,fi.play)(this._impl,(0,Eu.parseNotation)(this._impl,e,!1,"standard")),!0}catch(n){if(n instanceof Nt.InvalidNotation)return!1;throw n}else{if(e instanceof pf.MoveDescriptorImpl)return(0,fi.play)(this._impl,e),!0;throw new Nt.IllegalArgument("Position.play()")}}isNullMoveLegal(){return(0,fi.isNullMoveLegal)(this._impl)}playNullMove(){return(0,fi.playNullMove)(this._impl)}notation(e,n){if(arguments.length===1&&e instanceof pf.MoveDescriptorImpl)return(0,Eu.getNotation)(this._impl,e,"standard");if(arguments.length===1&&typeof e=="string")return(0,Eu.parseNotation)(this._impl,e,!1,"standard");if(arguments.length>=2&&typeof e=="string"&&typeof n=="boolean")return(0,Eu.parseNotation)(this._impl,e,n,"standard");throw new Nt.IllegalArgument("Position.notation()")}figurineNotation(e,n){if(arguments.length===1&&e instanceof pf.MoveDescriptorImpl)return(0,Eu.getNotation)(this._impl,e,"figurine");if(arguments.length===1&&typeof e=="string")return(0,Eu.parseNotation)(this._impl,e,!1,"figurine");if(arguments.length>=2&&typeof e=="string"&&typeof n=="boolean")return(0,Eu.parseNotation)(this._impl,e,n,"figurine");throw new Nt.IllegalArgument("Position.figurineNotation()")}uci(e,n){if(arguments.length===1&&e instanceof pf.MoveDescriptorImpl)return(0,Qp.getUCINotation)(this._impl,e,!1);if(arguments.length>=2&&e instanceof pf.MoveDescriptorImpl&&typeof n=="boolean")return(0,Qp.getUCINotation)(this._impl,e,n);if(arguments.length===1&&typeof e=="string")return(0,Qp.parseUCINotation)(this._impl,e,!1);if(arguments.length>=2&&typeof e=="string"&&typeof n=="boolean")return(0,Qp.parseUCINotation)(this._impl,e,n);throw new Nt.IllegalArgument("Position.uci()")}}eu.Position=qf;function NN(t){return Number.isInteger(t)&&t>=0&&t<960}function Cne(t,e){return function(n,r,s){if(t[n]===void 0)return r;{const i=t[n];if(!s(i))throw new Nt.IllegalArgument(e);return i}}}var ki={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(ki,"__esModule",{value:!0});ki.Variation=ki.Node=ki.AbstractNode=void 0;class V2{constructor(){}}ki.AbstractNode=V2;let Nne=class extends V2{constructor(){super()}isVariation(){return!1}toString(){return`${this.id()}[${this.notation()}]`}};ki.Node=Nne;class Tne extends V2{constructor(){super()}isVariation(){return!0}toString(){return this.id()}}ki.Variation=Tne;var Nd={},n1={},go={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */var _ne=Ot&&Ot.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Zp=Ot&&Ot.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Dm,kf;Object.defineProperty(go,"__esModule",{value:!0});go.POJOExceptionBuilder=void 0;go.decodeStringField=Rne;go.decodeNumberField=Pne;go.decodeBooleanField=One;go.decodeArrayField=Dne;go.decodeObjectField=Lne;const Ine=Lt,Hh=xs;class kne{constructor(e){Dm.set(this,void 0),kf.set(this,[]),_ne(this,Dm,e,"f")}push(e){Zp(this,kf,"f").push(e)}pop(){Zp(this,kf,"f").pop()}build(e,...n){let r="",s=!0;for(const i of Zp(this,kf,"f"))typeof i=="number"?r+=`[${i}]`:r+=s?i:"."+i,s=!1;return new Ine.InvalidPOJO(Zp(this,Dm,"f"),r,e,...n)}}go.POJOExceptionBuilder=kne;Dm=new WeakMap,kf=new WeakMap;function Rne(t,e,n,r){if(!(e in t))return;n.push(e);const s=t[e];if(typeof s=="string")r(s);else if(s!==void 0)throw n.build(Hh.i18n.INVALID_POJO_STRING_FIELD);n.pop()}function Pne(t,e,n,r){if(!(e in t))return;n.push(e);const s=t[e];if(typeof s=="number")r(s);else if(s!==void 0)throw n.build(Hh.i18n.INVALID_POJO_NUMBER_FIELD);n.pop()}function One(t,e,n,r){if(!(e in t))return;n.push(e);const s=t[e];if(typeof s=="boolean")r(s);else if(s!==void 0)throw n.build(Hh.i18n.INVALID_POJO_BOOLEAN_FIELD);n.pop()}function Dne(t,e,n,r){if(!(e in t))return;n.push(e);const s=t[e];if(Array.isArray(s))r(s);else if(s!==void 0)throw n.build(Hh.i18n.INVALID_POJO_ARRAY_FIELD);n.pop()}function Lne(t,e,n,r){if(!(e in t))return;n.push(e);const s=t[e];if(typeof s=="object"&&s!==null)r(s);else if(s!==void 0)throw n.build(Hh.i18n.INVALID_POJO_OBJECT_FIELD);n.pop()}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(n1,"__esModule",{value:!0});n1.MoveTreeRoot=void 0;const $r=Lt,TN=Bt,Ks=xs,RL=ki,In=eu,Qu=mo,Aa=go,Fne=xt;class $a{constructor(){this._position=new In.Position,this._fullMoveNumber=1,this._mainVariationData=Zu(this,!0)}clearTree(){this._mainVariationData=Zu(this,!0)}mainVariation(){return new zc(this._mainVariationData,this._position)}findById(e,n){const r=e.split("-");if(r.length%2!==1)return;const s=new In.Position(this._position);let i=this._mainVariationData;for(let a=0;a+1<r.length;a+=2){const u=_N(i,r[a],s);if(u===void 0)return;const l=/^v(\d+)$/.exec(r[a+1]);if(!l)return;const c=parseInt(l[1]);if(c>=u.variations.length)return;i=u.variations[c]}const o=r[r.length-1];if(o==="start")return new zc(i,s);if(n&&o==="end"){if(i.child===void 0)return new zc(i,s);{let a=i.child;for(;a.child!==void 0;)js(s,a),a=a.child;return new eo(a,s)}}else{const a=_N(i,o,s);return a===void 0?void 0:new eo(a,s)}}getPojo(e){const n=this._position.variant();n!=="regular"&&(e.variant=n),(0,TN.variantWithCanonicalStartPosition)(n)&&In.Position.isEqual(this._position,new In.Position(n))&&this._fullMoveNumber===1||(e.initialPosition=this._position.fen({fullMoveNumber:this._fullMoveNumber}));const s=PL(new In.Position(this._position),this._mainVariationData,!0);(!Array.isArray(s)||s.length>0)&&(e.mainVariation=s)}setPojo(e,n){let r="regular",s=!1;if((0,Aa.decodeStringField)(e,"variant",n,i=>{if((0,Fne.variantFromString)(i)<0)throw n.build(Ks.i18n.INVALID_VARIANT_IN_POJO);r=i}),(0,Aa.decodeStringField)(e,"initialPosition",n,i=>{this._position=new In.Position(r,"empty");try{const{fullMoveNumber:o}=this._position.fen(i);this._fullMoveNumber=o,s=!0}catch(o){throw o instanceof $r.InvalidFEN?n.build(Ks.i18n.INVALID_FEN_IN_POJO,o.message):o}}),r!=="regular"&&!s){if(!(0,TN.variantWithCanonicalStartPosition)(r))throw n.push("initialPosition"),n.build(Ks.i18n.MISSING_INITIAL_POSITION_IN_POJO,r);this._position=new In.Position(r),this._fullMoveNumber=1}"mainVariation"in e&&e.mainVariation!==void 0?(n.push("mainVariation"),this._mainVariationData=DL(e.mainVariation,this,this._position,0,this._fullMoveNumber,!0,n),n.pop()):this.clearTree()}}n1.MoveTreeRoot=$a;function _N(t,e,n){let r=t.child;for(;r!==void 0;){if(e===r.fullMoveNumber+r.moveColor)return r;js(n,r),r=r.child}}function PL(t,e,n){const r=[];let s=e.child;for(;s!==void 0;)r.push($ne(t,s)),js(t,s),s=s.child;const i={nodes:r};let o=!0;return e.isLongVariation!==n&&(i.isLongVariation=e.isLongVariation,o=!1),OL(i,e)&&(o=!1),o?i.nodes:i}function $ne(t,e){const n={notation:e.moveDescriptor===null?"--":t.notation(e.moveDescriptor)};let r=!0;return e.variations.length>0&&(n.variations=e.variations.map(s=>PL(new In.Position(t),s,!1)),r=!1),OL(n,e)&&(r=!1),r?n.notation:n}function OL(t,e){let n=!1;return e.comment!==void 0&&(t.comment=e.comment,e.isLongComment&&(t.isLongComment=!0),n=!0),e.nags.size>0&&(t.nags=W2(e),n=!0),e.tags.size>0&&(t.tags=Mne(e),n=!0),n}function DL(t,e,n,r,s,i,o){let a,u;if(Array.isArray(t))a=Zu(e,i),u=t;else if(typeof t=="object"&&t!==null){let c=i;if((0,Aa.decodeBooleanField)(t,"isLongVariation",o,d=>{c=d}),a=Zu(e,c),LL(t,a,o),o.push("nodes"),!("nodes"in t)||!Array.isArray(t.nodes))throw o.build(Ks.i18n.INVALID_OR_MISSING_NODE_ARRAY);u=t.nodes}else throw o.build(Ks.i18n.NOT_A_VARIATION_POJO);let l=a;n=new In.Position(n);for(let c=0;c<u.length;++c)o.push(c),l.child=Bne(u[c],a,n,r,s,o),o.pop(),l=l.child,js(n,l),r=Uc(l),n.turn()==="w"&&++s;return Array.isArray(t)||o.pop(),a}function Bne(t,e,n,r,s,i){let o;if(typeof t=="string")o=IN(n,t,i);else if(typeof t=="object"&&t!==null){if(i.push("notation"),!("notation"in t)||typeof t.notation!="string")throw i.build(Ks.i18n.INVALID_OR_MISSING_NOTATION_FIELD);o=IN(n,t.notation,i),i.pop()}else throw i.build(Ks.i18n.NOT_A_NODE_POJO);const a=U2(e,n.turn(),r,s,o);return typeof t=="object"&&t!==null&&(LL(t,a,i),(0,Aa.decodeArrayField)(t,"variations",i,u=>{for(let l=0;l<u.length;++l)i.push(l),a.variations.push(DL(u[l],a,n,r,s,!1,i)),i.pop()})),a}function IN(t,e,n){try{return z2(t,e)}catch(r){throw r instanceof $r.InvalidNotation?n.build(Ks.i18n.INVALID_MOVE_IN_POJO,e,r.message):r}}function LL(t,e,n){(0,Aa.decodeStringField)(t,"comment",n,r=>{e.comment=r}),(0,Aa.decodeBooleanField)(t,"isLongComment",n,r=>{e.isLongComment=r}),(0,Aa.decodeArrayField)(t,"nags",n,r=>{for(let s=0;s<r.length;++s){const i=r[s];if(i!==void 0){if(!(0,Qu.isValidNag)(i))throw n.push(s),n.build(Ks.i18n.INVALID_NAG_IN_POJO,i);e.nags.add(i)}}}),(0,Aa.decodeObjectField)(t,"tags",n,r=>{for(const s in r){if(!j2(s))throw n.push(`[${s}]`),n.build(Ks.i18n.INVALID_TAG_IN_POJO,s);const i=r[s];if(i!==void 0){if(typeof i!="string")throw n.push(s),n.build(Ks.i18n.INVALID_TAG_IN_POJO,s);e.tags.set(s,i)}}})}function U2(t,e,n,r,s){return{parentVariation:t,child:void 0,variations:[],moveColor:e,fiftyMoveClock:n,fullMoveNumber:r,moveDescriptor:s,nags:new Set,tags:new Map,comment:void 0,isLongComment:!1}}function Zu(t,e){return{parent:t,child:void 0,isLongVariation:e,nags:new Set,tags:new Map,comment:void 0,isLongComment:!1}}function z2(t,e){if(e==="--"){if(!t.isNullMoveLegal())throw new $r.InvalidNotation(t.fen(),"--",Ks.i18n.ILLEGAL_NULL_MOVE);return null}else return t.notation(e)}function js(t,e){e.moveDescriptor===null?t.playNullMove():t.play(e.moveDescriptor)}function Uc(t){return t.moveDescriptor===null?t.fiftyMoveClock:t.moveDescriptor.isCapture()||t.moveDescriptor.movingPiece()==="p"?0:t.fiftyMoveClock+1}function Gv(t){return t.moveColor==="w"?t.fullMoveNumber:t.fullMoveNumber+1}function qv(t){if(t.parent instanceof $a)return new In.Position(t.parent._position);{let e=t.parent.parentVariation.child;const n=qv(t.parent.parentVariation);for(;e!==t.parent;)js(n,e),e=e.child;return n}}function FL(t){return $L(t.parentVariation)+t.fullMoveNumber+t.moveColor}function $L(t){if(t.parent instanceof $a)return"";{const e=FL(t.parent),n=t.parent.variations.indexOf(t);return`${e}-v${n}-`}}function Hv(t){for(;;){if(!t.isLongVariation)return!1;if(t.parent instanceof $a)return!0;t=t.parent.parentVariation}}function Jp(t,e){return Number.isInteger(t)&&t>=0&&t<e.variations.length}function W2(t){const e=[];for(const n of t.nags)e.push(n);return e.sort((n,r)=>n-r)}function BL(t,e){const n=new Set;for(const r of t.nags)e(r)&&n.add(r);t.nags=n}function j2(t){return typeof t=="string"&&/^\w+$/.test(t)}function ML(t){const e=[];for(const n of t.tags.keys())e.push(n);return e.sort()}function VL(t,e){const n=new Map;for(const[r,s]of t.tags.entries())e(r,s)&&n.set(r,s);t.tags=n}function Mne(t){const e={};for(const[n,r]of t.tags.entries())e[n]=r;return e}class eo extends RL.Node{constructor(e,n){super(),this._data=e,this._positionBefore=n}id(){return FL(this._data)}nags(){return W2(this._data)}hasNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Node.hasNag()");return this._data.nags.has(e)}addNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Node.addNag()");return this._data.nags.add(e)}removeNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Node.removeNag()");return this._data.nags.delete(e)}clearNags(){this._data.nags.clear()}filterNags(e){BL(this._data,e)}tags(){return ML(this._data)}tag(e,n){if(!j2(e))throw new $r.IllegalArgument("Node.tag()");if(arguments.length===1)return this._data.tags.get(e);n==null?this._data.tags.delete(e):this._data.tags.set(e,String(n))}clearTags(){this._data.tags.clear()}filterTags(e){VL(this._data,e)}comment(e,n){if(arguments.length===0)return this._data.comment;e==null?(this._data.comment=void 0,this._data.isLongComment=!1):(this._data.comment=String(e),this._data.isLongComment=!!n)}isLongComment(){return this._data.isLongComment&&Hv(this._data.parentVariation)}parentVariation(){const e=qv(this._data.parentVariation);return new zc(this._data.parentVariation,e)}previous(){let e=this._data.parentVariation.child;if(e===this._data)return;const n=qv(this._data.parentVariation);for(;e.child!==this._data;)js(n,e),e=e.child;return new eo(e,n)}next(){if(this._data.child===void 0)return;const e=new In.Position(this._positionBefore);return js(e,this._data),new eo(this._data.child,e)}notation(){return this._data.moveDescriptor===null?"--":this._positionBefore.notation(this._data.moveDescriptor)}figurineNotation(){return this._data.moveDescriptor===null?"--":this._positionBefore.figurineNotation(this._data.moveDescriptor)}positionBefore(){return new In.Position(this._positionBefore)}position(){const e=new In.Position(this._positionBefore);return js(e,this._data),e}fen(){return this.position().fen({fiftyMoveClock:Uc(this._data),fullMoveNumber:Gv(this._data)})}fiftyMoveClock(){return Uc(this._data)}fullMoveNumber(){return this._data.fullMoveNumber}moveColor(){return this._data.moveColor}variations(){return this._data.variations.map(e=>new zc(e,this._positionBefore))}play(e){const n=new In.Position(this._positionBefore);js(n,this._data);const r=n.turn(),s=Uc(this._data),i=Gv(this._data);return this._data.child=U2(this._data.parentVariation,r,s,i,z2(n,e)),new eo(this._data.child,n)}removePrecedingMoves(){const e=Vne(this._data);e._position=this._positionBefore,e._fullMoveNumber=this._data.fullMoveNumber,e._mainVariationData=Zu(e,!0),e._mainVariationData.child=this._data,By(this._data,e._mainVariationData),UL(this._data,0)}removeFollowingMoves(){this._data.child=void 0}addVariation(e){const n=Zu(this._data,e??!1);return this._data.variations.push(n),new zc(n,this._positionBefore)}removeVariation(e){if(!Jp(e,this._data))throw new $r.IllegalArgument("Node.removeVariation()");this._data.variations=this._data.variations.slice(0,e).concat(this._data.variations.slice(e+1))}swapVariations(e,n){if(!Jp(e,this._data)||!Jp(n,this._data))throw new $r.IllegalArgument("Node.swapVariations()");const r=this._data.variations[e];this._data.variations[e]=this._data.variations[n],this._data.variations[n]=r}promoteVariation(e){if(!Jp(e,this._data)||this._data.variations[e].child===void 0)throw new $r.IllegalArgument("Node.promoteVariation()");const n=this._data,r=this._data.variations[e].child,s=n.variations;n.variations=[],s[e]=Zu(r,!1),s[e].child=n,this._data=r,r.variations=s.concat(r.variations),Une(n).child=r,By(r,n.parentVariation),By(n,s[e]);for(const i of r.variations)i.parent=r}}function Vne(t){let e=t;for(;!(e instanceof $a);)e=e.parentVariation.parent;return e}function Une(t){let e=t.parentVariation;for(;e.child!==t;)e=e.child;return e}function By(t,e){let n=t;for(;n!==void 0;)n.parentVariation=e,n=n.child}function UL(t,e){let n=t;for(;n!==void 0;){n.fiftyMoveClock=e;for(const r of n.variations)UL(r.child,e);e=Uc(n),n=n.child}}class zc extends RL.Variation{constructor(e,n){super(),this._data=e,this._initialPosition=n}id(){return $L(this._data)+"start"}nags(){return W2(this._data)}hasNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Variation.hasNag()");return this._data.nags.has(e)}addNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Variation.addNag()");return this._data.nags.add(e)}removeNag(e){if(!(0,Qu.isValidNag)(e))throw new $r.IllegalArgument("Variation.removeNag()");return this._data.nags.delete(e)}clearNags(){this._data.nags.clear()}filterNags(e){BL(this._data,e)}tags(){return ML(this._data)}tag(e,n){if(!j2(e))throw new $r.IllegalArgument("Variation.tag()");if(arguments.length===1)return this._data.tags.get(e);n==null?this._data.tags.delete(e):this._data.tags.set(e,String(n))}clearTags(){this._data.tags.clear()}filterTags(e){VL(this._data,e)}comment(e,n){if(arguments.length===0)return this._data.comment;e==null?(this._data.comment=void 0,this._data.isLongComment=!1):(this._data.comment=String(e),this._data.isLongComment=!!n)}isLongComment(){return this._data.isLongComment&&Hv(this._data)}parentNode(){return this._data.parent instanceof $a?void 0:new eo(this._data.parent,this._initialPosition)}first(){return this._data.child===void 0?void 0:new eo(this._data.child,this._initialPosition)}nodes(){const e=[];let n=this._data.child,r,s=this._initialPosition;for(;n!==void 0;)s=new In.Position(s),r!==void 0&&js(s,r),e.push(new eo(n,s)),r=n,n=n.child;return e}plyCount(){let e=0,n=this._data.child;for(;n!==void 0;)++e,n=n.child;return e}isLongVariation(){return Hv(this._data)}initialPosition(){return new In.Position(this._initialPosition)}initialFEN(){return this._initialPosition.fen({fiftyMoveClock:this.initialFiftyMoveClock(),fullMoveNumber:this.initialFullMoveNumber()})}initialFiftyMoveClock(){return this._data.parent instanceof $a?0:this._data.parent.fiftyMoveClock}initialFullMoveNumber(){return this._data.parent instanceof $a?this._data.parent._fullMoveNumber:this._data.parent.fullMoveNumber}finalPosition(){const e=new In.Position(this._initialPosition);for(let n=this._data.child;n!==void 0;n=n.child)js(e,n);return e}finalFEN(){if(this._data.child===void 0)return this.initialFEN();const e=new In.Position(this._initialPosition);let n=this._data.child;for(;js(e,n),n.child!==void 0;)n=n.child;return e.fen({fiftyMoveClock:Uc(n),fullMoveNumber:Gv(n)})}play(e){const n=this._initialPosition.turn(),r=this.initialFiftyMoveClock(),s=this.initialFullMoveNumber();return this._data.child=U2(this._data,n,r,s,z2(this._initialPosition,e)),new eo(this._data.child,this._initialPosition)}clearMoves(){this._data.child=void 0}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Game=void 0;const Cu=Ad,Ps=Lt,Lm=Bt,tc=xs,mf=eu,Tc=mo,zne=n1,yn=go,Nu=xt;class G2{constructor(){this._playerName=[void 0,void 0],this._playerElo=[void 0,void 0],this._playerTitle=[void 0,void 0],this._round=[void 0,void 0,void 0],this._result=3,this._moveTreeRoot=new zne.MoveTreeRoot}clearHeaders(){this._playerName=[void 0,void 0],this._playerElo=[void 0,void 0],this._playerTitle=[void 0,void 0],this._event=void 0,this._round=[void 0,void 0,void 0],this._date=void 0,this._site=void 0,this._annotator=void 0,this._eco=void 0,this._opening=void 0,this._openingVariation=void 0,this._openingSubVariation=void 0,this._termination=void 0,this._result=3}playerName(e,n){const r=(0,Nu.colorFromString)(e);if(r<0)throw new Ps.IllegalArgument("Game.playerName()");if(arguments.length===1)return this._playerName[r];this._playerName[r]=qi(n)}playerElo(e,n){const r=(0,Nu.colorFromString)(e);if(r<0)throw new Ps.IllegalArgument("Game.playerElo()");if(arguments.length===1)return this._playerElo[r];if(n=kN(n),n===void 0||(0,Tc.isValidElo)(n))this._playerElo[r]=n;else throw new Ps.IllegalArgument("Game.playerElo()")}playerTitle(e,n){const r=(0,Nu.colorFromString)(e);if(r<0)throw new Ps.IllegalArgument("Game.playerTitle()");if(arguments.length===1)return this._playerTitle[r];this._playerTitle[r]=qi(n)}event(e){if(arguments.length===0)return this._event;this._event=qi(e)}round(e){if(arguments.length===0)return this._round[0];this._setRoundPart(0,e,"Game.round()")}subRound(e){if(arguments.length===0)return this._round[1];this._setRoundPart(1,e,"Game.subRound()")}subSubRound(e){if(arguments.length===0)return this._round[2];this._setRoundPart(2,e,"Game.subSubRound()")}_setRoundPart(e,n,r){if(n=kN(n),n===void 0||(0,Tc.isValidRound)(n))this._round[e]=n;else throw new Ps.IllegalArgument(r)}fullRound(){return zL(this._round[0],this._round[1],this._round[2],"?")}date(e,n,r){switch(arguments.length){case 0:return this._date;case 1:if(e==null)this._date=void 0;else if(e instanceof Cu.DateValue)this._date=e;else if(e instanceof Date)this._date=new Cu.DateValue(e);else if(Cu.DateValue.isValid(e))this._date=new Cu.DateValue(e);else throw new Ps.IllegalArgument("Game.date()");break;default:if(Cu.DateValue.isValid(e,n,r))this._date=new Cu.DateValue(e,n,r);else throw new Ps.IllegalArgument("Game.date()");break}}dateAsDate(){return this._date===void 0?void 0:this._date.toDate()}dateAsString(e){return this._date===void 0?void 0:this._date.toHumanReadableString(e)}site(e){if(arguments.length===0)return this._site;this._site=qi(e)}annotator(e){if(arguments.length===0)return this._annotator;this._annotator=qi(e)}eco(e){if(arguments.length===0)return this._eco;if(e=qi(e),e!==void 0&&!(0,Lm.isValidECO)(e))throw new Ps.IllegalArgument("Game.eco()");this._eco=e}opening(e){if(arguments.length===0)return this._opening;this._opening=qi(e)}openingVariation(e){if(arguments.length===0)return this._openingVariation;this._openingVariation=qi(e)}openingSubVariation(e){if(arguments.length===0)return this._openingSubVariation;this._openingSubVariation=qi(e)}termination(e){if(arguments.length===0)return this._termination;this._termination=qi(e)}result(e){if(arguments.length===0)return(0,Nu.resultToString)(this._result);{const n=(0,Nu.resultFromString)(e);if(n<0)throw new Ps.IllegalArgument("Game.result()");this._result=n}}variant(){return this._moveTreeRoot._position.variant()}initialPosition(e,n){if(arguments.length===0)return new mf.Position(this._moveTreeRoot._position);if(!(e instanceof mf.Position))throw new Ps.IllegalArgument("Game.initialPosition()");if(arguments.length>=2){if(!Number.isInteger(n))throw new Ps.IllegalArgument("Game.initialPosition()");this._moveTreeRoot._fullMoveNumber=n}else this._moveTreeRoot._fullMoveNumber=1;this._moveTreeRoot._position=new mf.Position(e),this._moveTreeRoot.clearTree()}initialFEN(){return this._moveTreeRoot._position.fen({fiftyMoveClock:0,fullMoveNumber:this._moveTreeRoot._fullMoveNumber})}initialFullMoveNumber(){return this._moveTreeRoot._fullMoveNumber}finalPosition(){return this._moveTreeRoot.mainVariation().finalPosition()}finalFEN(){return this._moveTreeRoot.mainVariation().finalFEN()}mainVariation(){return this._moveTreeRoot.mainVariation()}nodes(e=!1){if(!e)return this.mainVariation().nodes();const n=[];function r(s){for(const i of s.nodes()){for(const o of i.variations())r(o);n.push(i)}}return r(this.mainVariation()),n}plyCount(){return this._moveTreeRoot.mainVariation().plyCount()}findById(e,n=!0){return this._moveTreeRoot.findById(e,n)}pojo(){const e={};function n(s,i){return s._playerName[i]===void 0&&s._playerElo[i]===void 0&&s._playerTitle[i]===void 0}function r(s,i){const o={};return s._playerName[i]!==void 0&&(o.name=s._playerName[i]),s._playerElo[i]!==void 0&&(o.elo=s._playerElo[i]),s._playerTitle[i]!==void 0&&(o.title=s._playerTitle[i]),o}return n(this,0)||(e.white=r(this,0)),n(this,1)||(e.black=r(this,1)),this._event!==void 0&&(e.event=this._event),this._round[0]!==void 0&&(e.round=this._round[0]),this._round[1]!==void 0&&(e.subRound=this._round[1]),this._round[2]!==void 0&&(e.subSubRound=this._round[2]),this._date!==void 0&&(e.date=this._date.toString()),this._site!==void 0&&(e.site=this._site),this._annotator!==void 0&&(e.annotator=this._annotator),this._eco!==void 0&&(e.eco=this._eco),this._opening!==void 0&&(e.opening=this._opening),this._openingVariation!==void 0&&(e.openingVariation=this._openingVariation),this._openingSubVariation!==void 0&&(e.openingSubVariation=this._openingSubVariation),this._termination!==void 0&&(e.termination=this._termination),this._result!==3&&(e.result=this.result()),this._moveTreeRoot.getPojo(e),e}static fromPOJO(e){if(typeof e!="object"||e===null)throw new Ps.InvalidPOJO(e,"",tc.i18n.POJO_MUST_BE_AN_OBJECT);const n=new G2,r=new yn.POJOExceptionBuilder(e);function s(o,a){(0,yn.decodeStringField)(o,"name",r,u=>{n._playerName[a]=u}),(0,yn.decodeNumberField)(o,"elo",r,u=>{if(!(0,Tc.isValidElo)(u))throw r.build(tc.i18n.INVALID_ELO_IN_POJO);n._playerElo[a]=u}),(0,yn.decodeStringField)(o,"title",r,u=>{n._playerTitle[a]=u})}function i(o,a){if(!(0,Tc.isValidRound)(o))throw r.build(tc.i18n.INVALID_ROUND_IN_POJO);n._round[a]=o}return(0,yn.decodeObjectField)(e,"white",r,o=>{s(o,0)}),(0,yn.decodeObjectField)(e,"black",r,o=>{s(o,1)}),(0,yn.decodeStringField)(e,"event",r,o=>{n._event=o}),(0,yn.decodeNumberField)(e,"round",r,o=>{i(o,0)}),(0,yn.decodeNumberField)(e,"subRound",r,o=>{i(o,1)}),(0,yn.decodeNumberField)(e,"subSubRound",r,o=>{i(o,2)}),(0,yn.decodeStringField)(e,"date",r,o=>{const a=Cu.DateValue.fromString(o);if(a===void 0)throw r.build(tc.i18n.INVALID_DATE_IN_POJO);n._date=a}),(0,yn.decodeStringField)(e,"site",r,o=>{n._site=o}),(0,yn.decodeStringField)(e,"annotator",r,o=>{n._annotator=o}),(0,yn.decodeStringField)(e,"eco",r,o=>{if(!(0,Lm.isValidECO)(o))throw r.build(tc.i18n.INVALID_ECO_CODE_IN_POJO);n._eco=o}),(0,yn.decodeStringField)(e,"opening",r,o=>{n._opening=o}),(0,yn.decodeStringField)(e,"openingVariation",r,o=>{n._openingVariation=o}),(0,yn.decodeStringField)(e,"openingSubVariation",r,o=>{n._openingSubVariation=o}),(0,yn.decodeStringField)(e,"termination",r,o=>{n._termination=o}),(0,yn.decodeStringField)(e,"result",r,o=>{const a=(0,Nu.resultFromString)(o);if(a<0)throw r.build(tc.i18n.INVALID_RESULT_IN_POJO);n._result=a}),n._moveTreeRoot.setPojo(e,r),n}ascii(){const e=[];function n(a){a!==void 0&&e.push(a)}n(Wne(this._event,this._round[0],this._round[1],this._round[2])),n(gf("Site",this._site)),n(gf("Date",this.dateAsString("en-us"))),n(RN("White",this._playerName[0],this._playerElo[0],this._playerTitle[0])),n(RN("Black",this._playerName[1],this._playerElo[1],this._playerTitle[1])),n(gf("Annotator",this._annotator)),n(gf("ECO",this._eco)),n(jne(this._opening,this._openingVariation,this._openingSubVariation)),n(gf("Termination",this._termination));const r=this._moveTreeRoot._position.variant();r!=="regular"&&e.push("Variant: "+r),(!(0,Lm.variantWithCanonicalStartPosition)(r)||!mf.Position.isEqual(this._moveTreeRoot._position,new mf.Position(r)))&&e.push(this._moveTreeRoot._position.ascii());function s(a){return a.first()!==void 0||a.nags().length>0||a.tags().length>0||a.comment()!==void 0}function i(a,u,l){const c=u+a.fullMoveNumber()+(a.moveColor()==="w"?".":"...")+a.notation(),d=PN(a);e.push(d.length===0?c:c+" "+d.join(" "));let f=!1;for(const h of a.variations())s(h)&&(e.push(u+" |"),o(h,u+(l?" |  ":"    "),u+" +- "),f=!0);return f}function o(a,u,l,c){const d=PN(a);d.length>0&&e.push(l+d.join(" "));let f=a.first(),h=!1,p=!0;for(;f!==void 0;){h&&e.push(u+" |");const y=f.next();h=i(f,p&&d.length===0?l:u,y!==void 0),p=!1,f=y}}return o(this._moveTreeRoot.mainVariation(),"",""),e.push((0,Nu.resultToString)(this._result)),e.join(`
`)}}Nd.Game=G2;function qi(t){return t==null?void 0:String(t)}function kN(t){return t==null?void 0:Number(t)}function to(t){return t=(0,Tc.trimAndCollapseSpaces)(t),t===""?"<empty>":t}function gf(t,e){return e===void 0?void 0:`${t}: ${to(e)}`}function Wne(t,e,n,r){if(t===void 0&&e===void 0&&n===void 0&&r===void 0)return;let s=t===void 0?"Event: <undefined>":`Event: ${to(t)}`;const i=zL(e,n,r,"*");return i!==void 0&&(s+=` (${i})`),s}function zL(t,e,n,r){if(t===void 0&&e===void 0&&n===void 0)return;let s=t===void 0?r:String(t);return(e!==void 0||n!==void 0)&&(s+="."+(e??r)),n!==void 0&&(s+="."+n),s}function RN(t,e,n,r){if(e===void 0&&n===void 0&&r===void 0)return;let s=e===void 0?`${t}: <undefined>`:`${t}: ${to(e)}`;return n!==void 0&&r!==void 0?s+=` (${to(r)} ${n})`:n!==void 0?s+=` (${n})`:r!==void 0&&(s+=` (${to(r)})`),s}function jne(t,e,n){if(t===void 0&&e===void 0&&n===void 0)return;let r=t===void 0?"Opening: <undefined>":`Opening: ${to(t)}`;return n!==void 0?r+=` (${e===void 0?"<undefined>":to(e)}, ${to(n)})`:e!==void 0&&(r+=` (${to(e)})`),r}function PN(t){const e=[];for(const r of t.nags())e.push((0,Lm.nagSymbol)(r));for(const r of t.tags())e.push(`${r}={${(0,Tc.trimAndCollapseSpaces)(t.tag(r))}}`);const n=t.comment();return n!==void 0&&e.push(to(n)),e}var Pl={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(Pl,"__esModule",{value:!0});Pl.Database=void 0;Pl.isValidGameIndex=jL;const WL=Lt;function jL(t){return Number.isInteger(t)&&t>=0}class Gne{constructor(){}gameCount(){return this.doGameCount()}game(e){if(!jL(e))throw new WL.IllegalArgument("Database.game()");return this.doGame(e)}games(){const e=this.doGameCount(),n=r=>this.doGame(r);return{[Symbol.iterator](){return new qne(e,n)}}}}Pl.Database=Gne;class qne{constructor(e,n){this.gameIndex=0,this.gameCount=e,this.gameLoader=n}next(){for(;this.gameIndex<this.gameCount;)try{return{done:!1,value:this.gameLoader(this.gameIndex++)}}catch(e){if(!(e instanceof WL.InvalidPGN))throw e}return{done:!0,value:void 0}}}var r1={},s1={},i1={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(i1,"__esModule",{value:!0});i1.TokenStream=void 0;const My=Lt,Vy=xs,Kv=mo;function Bn(t,e){const n=t;return n.needIncrementLineIndex=e!==void 0&&e,n.matchedIndex=-1,n.matched=null,n}const Hne=5,Kne=11,mn=new Map;mn.set("!!",3);mn.set("!",1);mn.set("!?",5);mn.set("?!",6);mn.set("?",2);mn.set("??",4);mn.set("+-",18);mn.set("+/-",16);mn.set("+/=",14);mn.set("+=",14);mn.set("=",10);mn.set("~",13);mn.set("inf",13);mn.set("=/+",15);mn.set("=+",15);mn.set("-/+",17);mn.set("-+",19);mn.set("RR",145);mn.set("N",146);class Xne{constructor(e,n){this._pos=0,this._lineIndex=1,this._token=0,this._tokenValue=null,this._tokenCharacterIndex=-1,this._tokenLineIndex=-1,this._emptyLineBeforeToken=!1,this._emptyLineAfterToken=!1,this._matchSpaces=Bn(/[ \f\t\v]+/g),this._matchLineBreak=Bn(/\r?\n|\r/g,!0),this._matchFastAdvance=Bn(/[^ \f\t\v\r\n"{][^ \f\t\v\r\n"{10*]*/g),this._matchBeginHeader=Bn(/\[/g),this._matchEndHeader=Bn(/\]/g),this._matchHeaderId=Bn(/(\w+)/g),this._matchEnterHeaderValue=Bn(/"/g),this._matchMoveNumber=Bn(/[0-9]+\.(?:\.\.)?/g),this._matchMove=Bn(/(?:O-O(?:-O)?|0-0(?:-0)?|[KQRBN][a-h]?[1-8]?x?[a-h][1-8]|(?:[a-h]x?)?[a-h][1-8](?:=?[KQRBNP])?)[+#]?|--/g),this._matchNag=Bn(/([!?][!?]?|\+\/?[-=]|[-=]\/?\+|=|inf|~|RR|N)|\$([1-9][0-9]*)/g),this._matchEnterComment=Bn(/\{/g),this._matchBeginVariation=Bn(/\(/g),this._matchEndVariation=Bn(/\)/g),this._matchEndOfGame=Bn(/1-0|0-1|1\/2-1\/2|\*/g),this._headerValueMode=Bn(/((?:[^\\"\f\t\v\r\n]|\\[^\f\t\v\r\n])*)"/g),this._headerValueDegradedMode=Bn(/[^\r\n]*/g),this._commentMode=Bn(/((?:[^\\}]|\\(?:.|[\r\n]))*)\}/g,!0),e.codePointAt(0)===65279&&(e=e.substring(1)),this._text=e,n!==void 0&&(this._pos=n.pos,this._lineIndex=n.lineIndex)}text(){return this._text}currentLocation(){return{pos:this._pos,lineIndex:this._lineIndex}}emptyLineBeforeToken(){return this._emptyLineBeforeToken}emptyLineAfterToken(){return this._emptyLineAfterToken}token(){return this._token}tokenValue(){return this._tokenValue}tokenCharacterIndex(){return this._tokenCharacterIndex}tokenLineIndex(){return this._tokenLineIndex}isMoveTextSection(){return this._token>=Hne&&this._token<=Kne}consumeToken(){if(this._emptyLineBeforeToken=this._token===0||this._token===11?this.skipBlanks():this._emptyLineAfterToken,this._pos>=this._text.length)return this._tokenCharacterIndex=this._text.length,this._tokenLineIndex=this._lineIndex,!1;if(this._tokenCharacterIndex=this._pos,this._tokenLineIndex=this._lineIndex,this.testAtPos(this._matchMoveNumber))this._token=5,this._tokenValue=null;else if(this.testAtPos(this._matchMove))this._token=6,this._tokenValue=this._matchMove.matched[0];else if(this.testAtPos(this._matchNag))this._token=7,this._tokenValue=this._matchNag.matched[2]===void 0?mn.get(this._matchNag.matched[1]):parseInt(this._matchNag.matched[2],10);else if(this.testAtPos(this._matchEnterComment)){if(!this.testAtPos(this._commentMode))throw new My.InvalidPGN(this._text,this._pos,this._lineIndex,Vy.i18n.INVALID_PGN_TOKEN);this._token=8,this._tokenValue=Qne(this._commentMode.matched[1])}else if(this.testAtPos(this._matchBeginVariation))this._token=9,this._tokenValue=null;else if(this.testAtPos(this._matchEndVariation))this._token=10,this._tokenValue=null;else if(this.testAtPos(this._matchEndOfGame))this._token=11,this._tokenValue=this._matchEndOfGame.matched[0];else if(this.testAtPos(this._matchBeginHeader))this._token=1,this._tokenValue=null;else if(this.testAtPos(this._matchEndHeader))this._token=2,this._tokenValue=null;else if(this.testAtPos(this._matchHeaderId))this._token=3,this._tokenValue=this._matchHeaderId.matched[1];else if(this.testAtPos(this._matchEnterHeaderValue)){if(!this.testAtPos(this._headerValueMode))throw new My.InvalidPGN(this._text,this._pos,this._lineIndex,Vy.i18n.INVALID_PGN_TOKEN);this._token=4,this._tokenValue=Yne(this._headerValueMode.matched[1])}else throw new My.InvalidPGN(this._text,this._pos,this._lineIndex,Vy.i18n.INVALID_PGN_TOKEN);return this._emptyLineAfterToken=this._token===11?!1:this.skipBlanks(),!0}skipGame(){let e=!1;for(this._token=0;;){if(this.skipBlanks(),this._pos>=this._text.length)return e;if(e=!0,this.testAtPos(this._matchEnterComment)){if(!this.testAtPos(this._commentMode))return this._pos=this._text.length,!0}else if(this.testAtPos(this._matchEnterHeaderValue))this.testAtPos(this._headerValueMode)||this.testAtPos(this._headerValueDegradedMode);else{if(this.testAtPos(this._matchEndOfGame))return!0;this.testAtPos(this._matchFastAdvance)}}}skipBlanks(){let e=0;for(;this._pos<this._text.length;)if(!this.testAtPos(this._matchSpaces))if(this.testAtPos(this._matchLineBreak))++e;else break;return e>=2}testAtPos(e){if(e.matchedIndex<this._pos&&(e.lastIndex=this._pos,e.matched=e.exec(this._text),e.matchedIndex=e.matched===null?this._text.length:e.matched.index),e.matchedIndex===this._pos){if(this._pos=e.lastIndex,e.needIncrementLineIndex){const n=/\r?\n|\r/g;for(;n.exec(e.matched[0]);)++this._lineIndex}return!0}else return!1}}i1.TokenStream=Xne;function Yne(t){return(0,Kv.trimAndCollapseSpaces)(t.replace(/\\([\\"])/g,"$1"))}function Qne(t){t=t.replace(/\\([\\}])/g,"$1");const e=new Map;let n=t.replace(/\[%(\w+)\s([^[\]]*)\]/g,(r,s,i)=>(i=(0,Kv.trimAndCollapseSpaces)(i),i!==""&&e.set(s,i)," "));return n=(0,Kv.trimAndCollapseSpaces)(n),n===""&&(n=void 0),{comment:n,tags:e}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(s1,"__esModule",{value:!0});s1.readDatabase=are;s1.readOneGame=ure;const Zne=Pl,Jne=Ad,zn=Lt,ere=Nd,GL=Bt,Ar=xs,ON=ki,Uy=eu,Xv=i1;function em(t){return t==="?"?void 0:t}function DN(t){if(/^\d+$/.test(t)){const e=Number(t);if(Number.isInteger(e))return e}}function tre(t){if(/^(\?|\d+)(?:\.(\?|\d+)(?:\.(\?|\d+)(?:\.(?:\?|\d+))*)?)?$/.test(t)){const e=Number(RegExp.$1),n=RegExp.$2?Number(RegExp.$2):void 0,r=RegExp.$3?Number(RegExp.$3):void 0;return{round:Number.isInteger(e)?e:void 0,subRound:Number.isInteger(n)?n:void 0,subSubRound:Number.isInteger(r)?r:void 0}}return{round:void 0,subRound:void 0,subSubRound:void 0}}function nre(t){return(0,GL.isValidECO)(t)?t:void 0}function rre(t){return t=t.toLowerCase(),t==="regular"||t==="standard"?"regular":t==="fischerandom"||/^chess[ -]?960$/.test(t)?"chess960":/^no[ -]king$/.test(t)?"no-king":/^white[ -]king[ -]only$/.test(t)?"white-king-only":/^black[ -]king[ -]only$/.test(t)?"black-king-only":/^anti[ -]?chess/.test(t)?"antichess":t==="horde"?"horde":void 0}function sre(t,e,n,r,s,i,o){switch(s=s.trim(),r){case"White":e.playerName("w",em(s));break;case"Black":e.playerName("b",em(s));break;case"WhiteElo":e.playerElo("w",DN(s));break;case"BlackElo":e.playerElo("b",DN(s));break;case"WhiteTitle":e.playerTitle("w",s);break;case"BlackTitle":e.playerTitle("b",s);break;case"Event":e.event(em(s));break;case"Round":{const{round:a,subRound:u,subSubRound:l}=tre(s);e.round(a),e.subRound(u),e.subSubRound(l);break}case"Date":e.date(Jne.DateValue.fromPGNString(s));break;case"Site":e.site(em(s));break;case"Annotator":e.annotator(s);break;case"ECO":e.eco(nre(s));break;case"Opening":e.opening(s);break;case"Variation":e.openingVariation(s);break;case"SubVariation":e.openingSubVariation(s);break;case"Termination":e.termination(s);break;case"FEN":n.fen=s,n.fenTokenCharacterIndex=i,n.fenTokenLineIndex=o;break;case"Variant":if(n.variant=rre(s),n.variant===void 0)throw new zn.InvalidPGN(t.text(),i,o,Ar.i18n.UNKNOWN_VARIANT,s);n.variantTokenCharacterIndex=i,n.variantTokenLineIndex=o;break}}function ire(t,e,n){if(n.fen!==void 0)try{const r=n.variant===void 0?new Uy.Position:new Uy.Position(n.variant,"empty"),s=r.fen(n.fen);e.initialPosition(r,s.fullMoveNumber)}catch(r){throw r instanceof zn.InvalidFEN?new zn.InvalidPGN(t.text(),n.fenTokenCharacterIndex,n.fenTokenLineIndex,Ar.i18n.INVALID_FEN_IN_PGN_TEXT,r.message):r}else if(n.variant!==void 0)if((0,GL.variantWithCanonicalStartPosition)(n.variant)){const r=new Uy.Position(n.variant,"start");e.initialPosition(r,1)}else throw new zn.InvalidPGN(t.text(),n.variantTokenCharacterIndex,n.variantTokenLineIndex,Ar.i18n.VARIANT_WITHOUT_FEN,n.variant)}function qL(t){const e=new ere.Game;let n=!1,r=!1,s=null;const i=[],o={};for(;!n&&t.consumeToken();)switch(r=!0,t.isMoveTextSection()&&s===null&&(ire(t,e,o),s=e.mainVariation()),t.token()){case 1:{if(s!==null)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.UNEXPECTED_PGN_HEADER);if(!t.consumeToken()||t.token()!==3)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.MISSING_PGN_HEADER_ID);const a=t.tokenValue();if(!t.consumeToken()||t.token()!==4)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.MISSING_PGN_HEADER_VALUE);const u=t.tokenValue(),l=t.tokenCharacterIndex(),c=t.tokenLineIndex();if(!t.consumeToken()||t.token()!==2)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.MISSING_END_OF_PGN_HEADER);sre(t,e,o,a,u,l,c);break}case 5:break;case 6:try{s=s.play(t.tokenValue())}catch(a){throw a instanceof zn.InvalidNotation?new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.INVALID_MOVE_IN_PGN_TEXT,a.notation,a.message):a}break;case 7:s.addNag(t.tokenValue());break;case 8:{const{comment:a,tags:u}=t.tokenValue();for(const[l,c]of u)s.tag(l,c);if(a!==void 0)if(s.comment()===void 0){const l=s instanceof ON.Variation?t.emptyLineAfterToken():t.emptyLineBeforeToken();s.comment(a,l)}else{const l=s.isLongComment();s.comment(s.comment()+" "+a,l)}break}case 9:if(s instanceof ON.Variation)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.UNEXPECTED_BEGIN_OF_VARIATION);i.push(s),s=s.addVariation(t.emptyLineBeforeToken());break;case 10:if(i.length===0)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.UNEXPECTED_END_OF_VARIATION);s=i.pop();break;case 11:n=!0,e.result(t.tokenValue());break;default:throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.INVALID_PGN_TOKEN)}if(i.length!==0)throw new zn.InvalidPGN(t.text(),t.tokenCharacterIndex(),t.tokenLineIndex(),Ar.i18n.UNEXPECTED_END_OF_GAME);return{game:e,atLeastOneTokenFound:r}}class ore extends Zne.Database{constructor(e){for(super(),this._currentGameIndex=-1,this._text=e,this._gameLocations=[],this._stream=new Xv.TokenStream(e);;){const n=this._stream.currentLocation();if(!this._stream.skipGame())break;this._gameLocations.push(n)}}doGameCount(){return this._gameLocations.length}doGame(e){if(e>=this._gameLocations.length)throw new zn.InvalidPGN(this._text,-1,-1,Ar.i18n.INVALID_GAME_INDEX,e,this._gameLocations.length);this._currentGameIndex!==e&&(this._stream=new Xv.TokenStream(this._text,this._gameLocations[e])),this._currentGameIndex=-1;const{game:n}=qL(this._stream);return this._currentGameIndex=e+1,n}}function are(t){return new ore(t)}function ure(t,e){const n=new Xv.TokenStream(t);let r=0;for(;r!==e;){if(!n.skipGame())throw new zn.InvalidPGN(t,-1,-1,Ar.i18n.INVALID_GAME_INDEX,e,r);++r}const{game:s,atLeastOneTokenFound:i}=qL(n);if(!i)throw new zn.InvalidPGN(t,-1,-1,Ar.i18n.INVALID_GAME_INDEX,e,r);return s}var o1={};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(o1,"__esModule",{value:!0});o1.writeGame=YL;o1.writeGames=mre;const lre=Bt,cre=ki,LN=eu,M0=mo;function HL(t){return t.replace(/([\\"])/g,"\\$1")}function FN(t){return t.replace(/([\\}])/g,"\\$1")}function tm(t){return t!==void 0&&(t=(0,M0.trimAndCollapseSpaces)(t)),t?HL(t):"?"}function dre(t){return t??"?"}function fre(t){return t===void 0?"????.??.??":t.toPGNString()}function hre(t){switch(t){case"regular":return;case"chess960":return"Fischerandom";case"antichess":return"Antichess";case"horde":return"Horde";default:return t}}function Co(t,e){return e!==void 0&&(e=(0,M0.trimAndCollapseSpaces)(e)),e?`[${t} "${HL(e)}"]
`:""}function $N(t,e){return e===void 0?"":`[${t} "${e}"]
`}function KL(t,e,n,r){for(const u of t.nags())n("$"+u,!1,!1);let s=t.comment();s!==void 0&&(s=(0,M0.trimAndCollapseSpaces)(s));const i=t.tags(),o=new Map;let a=!1;for(const u of i){const l=(0,M0.trimAndCollapseSpaces)(t.tag(u).replace(/[[\]]/g,""));l&&(o.set(u,l),a=!0)}if(a||s){s&&t.isLongComment()&&t instanceof cre.Node&&r(),n("{",!1,!0);for(const u of i){const l=o.get(u);l&&n(`[%${u} ${FN(l)}]`,!0,!1)}if(s)for(const u of FN(s).split(" "))n(u,!1,!1);return n("}",!0,!1),s&&t.isLongComment()&&e&&r(),!0}else return!1}function pre(t,e,n,r,s){t.moveColor()==="w"?r(t.fullMoveNumber()+".",!1,!1):e&&r(t.fullMoveNumber()+"...",!1,!1),r(t.notation(),!1,!1);const i=t.variations();let o=-1;for(let u=i.length-1;u>=0;--u)if(i[u].first()!==void 0){o=u;break}let a=KL(t,(n||t.next()!==void 0)&&o<0,r,s);for(let u=0;u<i.length;++u){const l=i[u];l.first()!==void 0&&(l.isLongVariation()&&s(),r("(",!1,!0),XL(l,!1,r,s),r(")",!0,!1),u===o&&l.isLongVariation()&&s(),a=!0)}return a}function XL(t,e,n,r){KL(t,!0,n,r);let s=t.first(),i=!0;for(;s!==void 0;)i=pre(s,i,e,n,r),s=s.next()}function YL(t,e){let n="";n+=`[Event "${tm(t.event())}"]
`,n+=`[Site "${tm(t.site())}"]
`,n+=`[Date "${fre(t.date())}"]
`,n+=`[Round "${dre(t.fullRound())}"]
`,n+=`[White "${tm(t.playerName("w"))}"]
`,n+=`[Black "${tm(t.playerName("b"))}"]
`,n+=`[Result "${t.result()}"]
`;const r=t.variant(),s=t.initialPosition(),i=!(0,lre.variantWithCanonicalStartPosition)(r)||!LN.Position.isEqual(s,new LN.Position(r))||t.initialFullMoveNumber()!==1;n+=Co("Annotator",t.annotator()),n+=$N("BlackElo",t.playerElo("b")),n+=Co("BlackTitle",t.playerTitle("b")),n+=Co("ECO",t.eco()),i&&(n+=`[FEN "${s.fen({fullMoveNumber:t.initialFullMoveNumber(),regularFENIfPossible:!0})}"]
`),n+=Co("Opening",t.opening()),e.withPlyCount&&(n+=`[PlyCount "${t.plyCount()}"]
`),i&&(n+=`[SetUp "1"]
`),n+=Co("SubVariation",t.openingSubVariation()),n+=Co("Termination",t.termination()),n+=Co("Variant",hre(r)),n+=Co("Variation",t.openingVariation()),n+=$N("WhiteElo",t.playerElo("w")),n+=Co("WhiteTitle",t.playerTitle("w")),n+=`
`;let o="",a=!1;function u(c,d,f){o.length===0?o=c:o.length+c.length+(a||d?0:1)<=80?o+=(a||d?"":" ")+c:(n+=o+`
`,o=c),a=f}function l(){n+=o+`
`,n+=`
`,o="",a=!1}return XL(t.mainVariation(),!0,u,l),u(t.result(),!1,!1),n+=o+`
`,n}function mre(t,e){return t.map(n=>YL(n,e)).join(`

`)}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(r1,"__esModule",{value:!0});r1.pgnRead=yre;r1.pgnWrite=bre;const gre=Pl,Yv=Lt,BN=Nd,MN=s1,VN=o1;function yre(t,e){if(typeof t!="string")throw new Yv.IllegalArgument("pgnRead()");if(arguments.length===1)return(0,MN.readDatabase)(t);if(!(0,gre.isValidGameIndex)(e))throw new Yv.IllegalArgument("pgnRead()");return(0,MN.readOneGame)(t,e)}function bre(t,e){if(e==null&&(e={}),t instanceof BN.Game)return(0,VN.writeGame)(t,e);if(Array.isArray(t)&&t.every(n=>n instanceof BN.Game))return(0,VN.writeGames)(t,e);throw new Yv.IllegalArgument("pgnWrite()")}(function(t){/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu - A JavaScript/TypeScript chess library.                         *
 *    <https://www.npmjs.com/package/kokopu>                                  *
 *    Copyright (C) 2018-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu is free software: you can redistribute it and/or                 *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu is distributed in the hope that it will be useful,               *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */Object.defineProperty(t,"__esModule",{value:!0}),t.pgnWrite=t.pgnRead=t.Database=t.Game=t.Variation=t.Node=t.AbstractNode=t.Position=t.isMoveDescriptor=t.MoveDescriptor=t.DateValue=t.isValidECO=t.nagSymbol=t.variantWithCanonicalStartPosition=t.oppositeColor=t.coordinatesToSquare=t.squareToCoordinates=t.squareColor=t.forEachSquare=t.isGameVariant=t.isGameResult=t.isCastle960=t.isCastle=t.isSquareCouple=t.isSquare=t.isRank=t.isFile=t.isColoredPiece=t.isPiece=t.isColor=t.exception=t.i18n=void 0;var e=xs;Object.defineProperty(t,"i18n",{enumerable:!0,get:function(){return e.i18n}}),t.exception=Lt;var n=Bt;Object.defineProperty(t,"isColor",{enumerable:!0,get:function(){return n.isColor}}),Object.defineProperty(t,"isPiece",{enumerable:!0,get:function(){return n.isPiece}}),Object.defineProperty(t,"isColoredPiece",{enumerable:!0,get:function(){return n.isColoredPiece}}),Object.defineProperty(t,"isFile",{enumerable:!0,get:function(){return n.isFile}}),Object.defineProperty(t,"isRank",{enumerable:!0,get:function(){return n.isRank}}),Object.defineProperty(t,"isSquare",{enumerable:!0,get:function(){return n.isSquare}}),Object.defineProperty(t,"isSquareCouple",{enumerable:!0,get:function(){return n.isSquareCouple}}),Object.defineProperty(t,"isCastle",{enumerable:!0,get:function(){return n.isCastle}}),Object.defineProperty(t,"isCastle960",{enumerable:!0,get:function(){return n.isCastle960}}),Object.defineProperty(t,"isGameResult",{enumerable:!0,get:function(){return n.isGameResult}}),Object.defineProperty(t,"isGameVariant",{enumerable:!0,get:function(){return n.isGameVariant}}),Object.defineProperty(t,"forEachSquare",{enumerable:!0,get:function(){return n.forEachSquare}}),Object.defineProperty(t,"squareColor",{enumerable:!0,get:function(){return n.squareColor}}),Object.defineProperty(t,"squareToCoordinates",{enumerable:!0,get:function(){return n.squareToCoordinates}}),Object.defineProperty(t,"coordinatesToSquare",{enumerable:!0,get:function(){return n.coordinatesToSquare}}),Object.defineProperty(t,"oppositeColor",{enumerable:!0,get:function(){return n.oppositeColor}}),Object.defineProperty(t,"variantWithCanonicalStartPosition",{enumerable:!0,get:function(){return n.variantWithCanonicalStartPosition}}),Object.defineProperty(t,"nagSymbol",{enumerable:!0,get:function(){return n.nagSymbol}}),Object.defineProperty(t,"isValidECO",{enumerable:!0,get:function(){return n.isValidECO}});var r=Ad;Object.defineProperty(t,"DateValue",{enumerable:!0,get:function(){return r.DateValue}});var s=Ed;Object.defineProperty(t,"MoveDescriptor",{enumerable:!0,get:function(){return s.MoveDescriptor}}),Object.defineProperty(t,"isMoveDescriptor",{enumerable:!0,get:function(){return s.isMoveDescriptor}});var i=eu;Object.defineProperty(t,"Position",{enumerable:!0,get:function(){return i.Position}});var o=ki;Object.defineProperty(t,"AbstractNode",{enumerable:!0,get:function(){return o.AbstractNode}}),Object.defineProperty(t,"Node",{enumerable:!0,get:function(){return o.Node}}),Object.defineProperty(t,"Variation",{enumerable:!0,get:function(){return o.Variation}});var a=Nd;Object.defineProperty(t,"Game",{enumerable:!0,get:function(){return a.Game}});var u=Pl;Object.defineProperty(t,"Database",{enumerable:!0,get:function(){return u.Database}});var l=r1;Object.defineProperty(t,"pgnRead",{enumerable:!0,get:function(){return l.pgnRead}}),Object.defineProperty(t,"pgnWrite",{enumerable:!0,get:function(){return l.pgnWrite}})})(et);/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const ma=12,_c=96;function vre(t){return typeof t!="object"||t===null?!1:typeof t.K=="string"&&typeof t.Q=="string"&&typeof t.R=="string"&&typeof t.B=="string"&&typeof t.N=="string"&&typeof t.P=="string"}function wre(t){return typeof t=="string"&&/^(?:[A-Za-z0-9]|plus|times|dot|circle)$/.test(t)}function Rf(t){return t==="b"||t==="g"||t==="r"||t==="y"}function xre(t){if(typeof t!="string")throw new ht("parseSquareMarkers()","markers");return q2(t,e=>/^([BGRY])([a-h][1-8])$/.test(e)?{key:RegExp.$2,value:RegExp.$1.toLowerCase()}:void 0)}function Sre(t){if(typeof t!="string")throw new ht("parseTextMarkers()","markers");return q2(t,e=>/^([BGRY])(?:([A-Za-z0-9])|\((plus|times|dot|circle)\))([a-h][1-8])$/.test(e)?{key:RegExp.$4,value:{symbol:RegExp.$2||RegExp.$3,color:RegExp.$1.toLowerCase()}}:void 0)}function Are(t){if(typeof t!="string")throw new ht("parseArrowMarkers()","markers");return q2(t,e=>/^([BGRY])([a-h][1-8][a-h][1-8])$/.test(e)?{key:RegExp.$2,value:RegExp.$1.toLowerCase()}:void 0)}function q2(t,e){const n={};return t.split(",").map(r=>e(r.trim())).forEach(r=>{r&&(n[r.key]=r.value)}),n}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function Mo(t){return String(t)}function Xt(t){return!!t}function V0(t,e){if(t==null)return{};if(typeof t!="object")throw e();return t}function U0(t,e){if(typeof t!="number"||!Number.isFinite(t))throw e();return Math.round(t)}function z0(t,e,n,r){return Math.min(Math.max(U0(t,r),e),n)}function Br(t,e){return t==null?void 0:e(t)}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function QL(){const t=new Uint32Array(8);crypto.getRandomValues(t);let e="";for(let n=0;n<t.length;++n)e+=t[n].toString(16);return e}function ZL(t,...e){return t.replace(/{(\d+)}/g,(n,r)=>{const s=Number(r);return s<e.length?String(e[s]):n})}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const UN=5,zN=36,zy=4;function W0({title:t,message:e,text:n,errorIndex:r,lineNumber:s}){t=Mo(t),e=Mo(e),n=Br(n,Mo),r=Number.isInteger(r)?r:void 0,s=Number.isInteger(s)?s:void 0;let i;return n&&r!==void 0&&r>=0&&r<n.length&&(i=L.createElement("div",{className:"kokopu-errorExcerpt"},Ere(n,r,s))),L.createElement("div",{className:"kokopu-errorBox"},L.createElement("div",{className:"kokopu-errorTitle"},t),L.createElement("div",{className:"kokopu-errorMessage"},e),i)}function Ere(t,e,n){let r=e-UN,s=!0;for(let l=0;l<=UN+zy;++l){const c=e-l-1;if(c<0||t.charAt(c)===`
`||t.charAt(c)==="\r"){r=c+1,s=!1;break}}let i=e+zN,o=!0;for(let l=0;l<=zN+zy;++l){const c=e+l+1;if(c>=t.length||t.charAt(c)===`
`||t.charAt(c)==="\r"){i=c-1,o=!1;break}}let a=(s?"... ":"")+t.substring(r,i+1)+(o?" ...":"");a=a.replace(/\s/g," ");let u=" ".repeat(e-r+(s?zy:0))+"^";return n&&n>=1&&(u+=` (${ZL(Er.LINE,n)})`),a+`
`+u}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const Cre=.1,Nre=.15,Tre=.425;function _re({x:t,y:e,size:n,symbol:r,color:s}){if(r==="dot")return L.createElement("circle",{cx:t,cy:e,r:n*Nre,fill:s});if(r==="circle"){const i=n*Cre;return L.createElement("circle",{className:"kokopu-symbolCircle",cx:t,cy:e,r:n*Tre,stroke:s,strokeWidth:i})}else{const i=r==="plus"?"+":r==="times"?"":r;return L.createElement("text",{className:"kokopu-symbolText",x:t,y:e,fill:s,fontSize:n},i)}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function JL({id:t,color:e}){return L.createElement("marker",{id:t,markerWidth:4,markerHeight:4,refX:2.5,refY:2,orient:"auto"},L.createElement("path",{fill:e,d:"M 4,2 L 0,4 L 1,2 L 0,0 Z"}))}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const Ire=.2;class kre extends L.Component{constructor(){super(...arguments),this.arrowTipId=QL()}render(){const e=z0(this.props.size,ma,_c,()=>new ht("ArrowMarkerIcon","size")),n=Mo(this.props.color),r=e*Ire/2,s=`0 0 ${e} ${e}`;return L.createElement("svg",{className:"kokopu-arrowMarkerIcon",viewBox:s,width:e,height:e},L.createElement("defs",null,L.createElement(JL,{id:this.arrowTipId,color:this.props.color})),L.createElement("line",{className:"kokopu-arrow",x1:r,y1:e/2,x2:e-r*3,y2:e/2,stroke:n,strokeWidth:r*2,markerEnd:`url(#${this.arrowTipId})`}))}}kre.defaultProps={color:"currentcolor"};const Rre="data:image/png;base64,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",Pre="data:image/png;base64,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",Ore="data:image/png;base64,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",Dre="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAffwAAH38BPlrE4wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAOGSURBVHic7Z07axRRGIaf3aBBRfFC1JhENGgTES8YUTGiVoIIBiUoYmOhiAr5C/ba6B+wimChYGehhYKgIgiCicTClYAXiFpE10tiLIaBkGySvZzvfGfOfA+87Xd7Z2fOnJ3ZBcMwDMMwDMMwDMMwDMMwDMMwDMOImYJ2ATXSDfQCO4E2YAIYAZ4C94BBvdLiZgfwCJicQ/+AO8BGpRqj5QxQZu7hT9UocFil0gg5SXJkVzv8VGVgt0K9UdEJjFH78FONAEu9Vx0RA9Q//FRXvVcdCauBcRo34AvQ5Ln2mihqFzALR3EzuBZgr4M4YoRqQJfDWFscxnJOqAasdRir1WEs54RqQDnQWM4J1YCSw1jvHcbKDT00vgJKtyfWea49CorAMI0b8MB34bUS6ikI4EUgMXLHYpKtZRenoEngJoHfjIXEIuAJ7oaf6jZhf9qDoIDbI3+6rvlrJZtcQm746YroiLduMkYrjW09V6sS0Oypp0xxA/nhp7riqafMsAQ/R3+qt37ayg6n8Tf8VN1eOquCEJZmh3KSsyIhGLArJzkrEoIBbQo52xVyViQEA5Yr5FyhkLMiIRgwoZDzj0LOioRgwKhCzq8KOSsSggFDOclZkRAMeK6Q85lCzmDZh9+bsHFgjZfOMkIBeIM/A+77aStbnMOfAQc89ZQpmoBXyA//rq+Gssg24Bdyw/+M2yfuouQs9b2QMZ/KBHrqCWEZmlIkuSB/E4j9EVgmEDca2oGHyF8DBtDZewqaEyRbA75WQSVgv5fOMsB5ks04X8NP9Rs47qG/oOlH5oJbiwm94l0GSj96g5+qv+Twk3AMndPObBojuQfJBRuA7+gPfbrekYN3iovAY/SHPZtuiXUeCBfRH/J8ivbZ0Rb8rvXr1SCwUGgGqlxHf7jV6oLQDNRoBX6iP9hq9QGPT1D72Iy7TPLmS1boAE5pF+GKZuAT+kd1rXopMQwN+tAfZr3aLjCPGUifgvqE40uS5dqB5HXTH+gfyfVq2P1IZiL5CeghMSGrbCL52TRRJA2I4ZcLD0onkDQghm+deqQTSBlQALYKxfaJ+Da1lAGdxLG92wUskEwgZcBmobi+aQbWSyaQMqBDKK4Gou+TSRmg8eKdFKK9SBmwUiiuBqskg0sZENMPYoj2ImVATN8qmQHKiBog9Rcme4hnJTQEvNYuwjAMwzAMwzAMwzDi4D/jOTUZCN0IJAAAAABJRU5ErkJggg==",Lre="data:image/png;base64,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",Fre="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAffwAAH38BPlrE4wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAOGSURBVHic7d2/axNhHMfxd1oN2hYrtBCpKVIdunSoCCr5AyoOVrI4BxfBRdyy6uaiOLg7uDkUOigWBeliCg4dutwUJFIo9CwHbSVN4zk0BbGtl7vec19TPi94hnLX59enz5Pc5UdBREREREREREREREREnMo5rHsMuA30R5z3DfgQcc4QUAbOdtn2T2AO2Iw47xZwKeKcNvAeWO2y7f9CHvgOhF2W+xH1vYtR1355F1Hn/Rh1fe+MKXV9LioFisDFGOdfjzh+I0Efon4nqs0/XWRvTKlzFUDcrS3q/CRbZdp1OtmuT7moNIFzwOV/HE/yh9IXUee5BHX2jCvE37P/93Il1RnqcLUFSZcUgDEFYEwBGFMAxpw9Dc3lckxNTZHPO7mAzMzOzg4rKyuEYWjdlViuVqvV8KSoVqshcNXFRLlaAXXP88K1tbXcSVgBnueFQN26L3HdATawv4A6btnojKUnjQKL2E9i0vIFuJD6rGTsDPAG+8mMW950+u6Uyxdk/vYIeD4wMNA3Pz/PxMREhk1Hq9frzM7Osr29HQJPgSfsBXGilIvF4m6r1bJ+YnNAq9UKi8XiLnuvvGUmyxWwb2lycvL6+Pi4QdNHazQaeJ63BNy07otrH7Hf348qHx2O+1C6FWFMARhTAMYUgDEFYEwBGFMAxhSAMQVgTAEYUwDGFIAxBWBMARhTAMYUgDEFYEwBGFMAxhSAMQVgTAEYUwDGLD4nfHp4eJiRkRGDpo/m+z5BEJy27odzhUJhIwgC63ciHhAEQVgoFDayno+st6B7zWbzvO/7GTcbzfd9ms3meeCedV9cGQIa2L/9MKo0On09cZ5hP7ndlmeO5uCALN4dPQBUxsbGXs7NzZ0aHR3NoMnk1tfXKZfLu6urq4+A18C2cZeO7RMQlkol68fZrpVKpf2V8Mn15GSxAtp0Huynp6fphRWwvLy8/+Mvor9y7ViyCKDXP+bjdI50JWxMARhTAMYUgDHnN+P6+/uZmZlhaKi3Li43NzdZWFig3W5bd6UreeAV8PXvUqlUrJ/WJ1apVMLDxtQZayrfQpLWCrgLPDzsQK1WY3FxkcHBwZSaysbW1ha1Wg3g2iGHrwGfgbdZ9ulfHmB//ybr8iCNidODsDEFYEwBGFMAxhSAsbQC+JFSPb0klTGndas1D7wg2T9a6EVLwGNgx7ojIiIiIiIiIiIx/AaF7IxaEEuv8gAAAABJRU5ErkJggg==",$re="data:image/png;base64,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",Bre="data:image/png;base64,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",Mre="data:image/png;base64,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",Vre="data:image/png;base64,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",Ure="/assets/cburnett-wq-BOZYs3_w.png",zre="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAffwAAH38BPlrE4wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATCSURBVHic7ZxNSCNnGMd/+TC2KlZtoNAtClVPUvyItCkeiqe23nrYpScpe3DP3aseV8KeehUv9iJ7szfbCov01LqJoAdB0EJjl0LRjjaoDdE4PeSjY4xOojPzTOzzgxecyeMzz/v+533eD2YGFEVRFEVRFEVRFEVRFEVRFEVRFFcJuOj7XeBzIGRjlwZ+tLFpA74A3qzx2v8A3wHHNnafAj02Nnnge+CPGq/tCyLAa8CssTy28bdch69SWbbx+bgOX6+LdXKcoBtOgfeAB3XYf2jz+0e3iMHuf+yuaeUBhTo5TtgNp1SktqGhIUKhy5konU5zcHBQ1f4mf/39/bS3t1c1ymQy7Ozs1O0zGo3S03M5E+XzeTY2NqraNwK9WLqwYRhmJVNTU9Yu/gJ4/4ZyVLJdWVm54qvEysqK1eeRjc8XJdupqakrvgzDqExDvW40lFs9oF6+LBYneQv41WGfjuPWGGBLJHK7Ma25uflWv7kRi5+xTUHJZNKMRqN1zWzGxsbMbDZ7bQrKZrPm2NhYXT6j0aiZTCbFUpBbA0svsFs6MAyDzs7OK0ZnZ2ccH9tN1QsEAgE6Ojpqsj06OsI0zZps29raaGpqunL+8PCQrq4u66k+XEhpomNAU1NTVWHuSq1C+QGxMUAp4EkP2NjYuHbu7lcymYx0CHfiA+CC+rcP/FouinVyHLcG4TeAP4Hybd/a2tow071cLsfJyYn1VAZ4B8jKRHQ7YoBB8S4KBALm3NzctVNIv7CwsGAGg0Hr3f83EBdsxzvRUCLct8Yv0RAiSDW+Vzt8HwM/UBwTgsEgz549o6+vz6PL38zu7i4zMzNcXFyUTmWAz4Cf5aJynjiFu0p6RmNXPE07Xu9xx4GfIpFIZGBggImJCcbHxz0O4TKrq6ssLy+ztbVFLpfLAZ8Av4gG5TKvKN5tiURCOvWbiUTCeve/8roxJLYi/LzE9Dw23QsSRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRgUQRuIVpfIz6ouLi6yvrwuE8B/b29vWQ8+fn5d4+/svoAv88c5AxbsABvC2YDiu8wjLc5hLS0vSD8aZS0tLlc+GPhJsH1dpAX6jWNHR0VEzn89Lt7+Zz+fNeDxuFeB3Cp/HuXc8p1jJYDBorq2tSbd9mVQqZYZCIasIz71qFC8G4RbgK+Bp6cTIyAjpdJp0Ou3B5WtjeHiYVCpVOnxK4UNS3wKnUjE5xUvkn/m/bXnpQntcwotZUJ7GXW9cYP/JtTvhhQBm6Y9wOEwg4O/vHpmmyfn5ufWUvwOugXKXrvZVEr+RTCYr05CrNGpquDeoAMKoAMKoAMI4tRCLAN9g863OyclJWlpaHLqkO5yeXll3paqYrQFfAznXA6qRh8gvmrwuD51oOKdSUJe9yb3DkTo7vhfU3d3N9PR0+fj09JTNzc3KxY3vCYfDDA4OXkqZs7Oz7O3tCUZ1PU8ods1YLCa9lnKNWCxmTUFPnGg4nQUJ43gK2t/fZ35+3mm3vmB/f186hGspp6D/UfFVCjIc8tNIOFJnp7Zaa1qI3SN8txBTFEVRFEVRFEVRFEWpgX8BnjZU4/kAAugAAAAASUVORK5CYII=",Wre="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAffwAAH38BPlrE4wAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAN4SURBVHic7ZxNS5RRGIavGm1cWLQoKyhlMLQ2UeofaBMktak/EUgf+wrqB0QU0ReVRLgxbNO6Fm2ztZOQWRFpm4RSZ0KoxRkhpMmZ8T7vOe/pueDe3pxzP+f9Oh8vGIZhGIZhGIZhGIZhGIZhGIZhGEbKbArdgAbpBYaAfuAA0AVsBzqBX8Ai8A34CpSBt8Ab4F2IxqZAO3ASGAU+4EJuRbPAI+AE0JZlB/JKD3AdN5JbDb2e5oFrQHdmvckRvbjR/hN98GtVBR4CpUx6FjkdwBVgGf/Br9UScBko+u5krAwC02Qf/FqVgSOe+xod54AK4cNfVQUY8drjSCgA9wgfeD3drrUxSYrABOFDXk9PSfC5UCAf4f9ZhKSuhJuED7VZ3fWSRADOEj7MVpX7B/Mgcb3tNKsKMCBPJSM6iOM9f6Mq4/Gh7PNBcwk45dE/K3bgpkhehW5IM/QSZnrBl5bI2dzRKOFDU+uBNCGP9JDNrGbWquJhKnuz2hC4gFtQSY0twHm1qXpJsh34DOwU+8bCPLAXWFEZqq+A46QbPsAu4JjSUF2AFF471+N06Ab8i40soOdF72VpidlP+HCykuybQHkLGhR6xc6QykhZgANCr9jpVxkpC9An9IqdKAuwW+gVO3tURsoCbBN6xc5WlZGyAJ1Cr9iJsgBGCygL8EPoFTvfVUbKAsgalQOiLMAXoVfsyPqqLMC00Ct2yiojZQFkjcoBssGmLMCk0Ct2XoduQD1mCT9T6VszqrBA/x3wUuwXIy+UZuoCPBP7xciE0ky9KN+GW5TvEvvGQvSL8ivAmNgzJsYQhu+LbtLdmLVPmBPgZzLuI/DEg29oHgOfQjeiUUq4Da2hR61Ki7gtl3J8bU9fqHkf9eSfNVeB56Eb0SwduL+WhB69G9UUOT41eYh834oqJHCKfoTwQbaqMx7yCMINwofZrO54SSIQBdzh59ChNqpxElwvL5KPIoyT44fuehRwl3bokOvpFgmO/L8xQlwHuJdJ6IHbKAPE8Z0wBRz23NdoKeJ+GxbiW2ERuEjC9/tmKOHO4VbxH3wVuI+nuZ280437teQc+uDnat7yKeUUaQOGcVfFDK2HPlPzGCbSH7fm5dfFJdyxoD7gIO646Oqvi8HtS13AjfIybt/OJBEfqDMMwzAMwzAMwzAMwzAMwzAMwzCM/4PfntmsabVQe94AAAAASUVORK5CYII=",jre="data:image/png;base64,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",Gre="/assets/celtic-bb-BNuWCExM.png",qre="/assets/celtic-bk-DzOiCqm4.png",Hre="/assets/celtic-bn-B0pkp6ee.png",Kre="/assets/celtic-bp-DnVFTGGa.png",Xre="/assets/celtic-bq-bYDhVnAn.png",Yre="/assets/celtic-br-maGpI-mF.png",Qre="/assets/celtic-wb-CTTF5Kh0.png",Zre="/assets/celtic-wk-DAXL8Qbm.png",Jre="/assets/celtic-wn-CD5lFyOW.png",ese="/assets/celtic-wp-DuDco3p6.png",tse="/assets/celtic-wq-CpWmX6Kj.png",nse="/assets/celtic-wr-B1kWKByO.png",rse="/assets/eyes-bb-BO9ue2xq.png",sse="/assets/eyes-bk-ER7WYIf6.png",ise="/assets/eyes-bn-B6O4hcom.png",ose="/assets/eyes-bp-rBv7A9K1.png",ase="/assets/eyes-bq-Dwa62kgf.png",use="/assets/eyes-br-DG_EgEXC.png",lse="/assets/eyes-wb-Bh4VOqb0.png",cse="/assets/eyes-wk-B4Jaecrm.png",dse="/assets/eyes-wn-Ct2FNrdk.png",fse="/assets/eyes-wp-Bop0WEEb.png",hse="/assets/eyes-wq-IJbNxRSP.png",pse="/assets/eyes-wr-BzvE_8j_.png",mse="/assets/fantasy-bb-CzulAa2x.png",gse="/assets/fantasy-bk-vJNH5mBr.png",yse="/assets/fantasy-bn-BJIqqBoD.png",bse="data:image/png;base64,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",vse="/assets/fantasy-bq-R2Cyi1oU.png",wse="/assets/fantasy-br-D4FHN6Yq.png",xse="/assets/fantasy-wb-B-ryC1HY.png",Sse="/assets/fantasy-wk-D0f-Nlcm.png",Ase="/assets/fantasy-wn-BtyWgNKa.png",Ese="data:image/png;base64,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",Cse="/assets/fantasy-wq-gFVhZNxo.png",Nse="/assets/fantasy-wr-wAbnUmva.png",Tse="/assets/skulls-bb-BCqwDo2I.png",_se="/assets/skulls-bk-BZnnjK9o.png",Ise="/assets/skulls-bn-BASMjBs9.png",kse="data:image/png;base64,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",Rse="/assets/skulls-bq-Zm5G8a0d.png",Pse="/assets/skulls-br-CryCKCT3.png",Ose="/assets/skulls-wb-DF3bXQA6.png",Dse="/assets/skulls-wk-BBSgJneI.png",Lse="/assets/skulls-wn-Bq3Eo93h.png",Fse="data:image/png;base64,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",$se="/assets/skulls-wq-BGd-GTWF.png",Bse="/assets/skulls-wr-BnYBfSp7.png",Mse="/assets/spatial-bb-Ch2H-WGw.png",Vse="/assets/spatial-bk-BHKdheab.png",Use="/assets/spatial-bn-O3ijmuF_.png",zse="data:image/png;base64,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",Wse="/assets/spatial-bq-C-vFxqI2.png",jse="data:image/png;base64,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",Gse="/assets/spatial-wb-i3zfExl6.png",qse="/assets/spatial-wk-Bc5iu__l.png",Hse="/assets/spatial-wn-D5IsQjKG.png",Kse="data:image/png;base64,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",Xse="/assets/spatial-wq-DqjKl4f7.png",Yse="data:image/png;base64,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",Qse="data:image/png;base64,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",Zse="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAHFgAABxYB45pq/gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAxPSURBVHic7ZxrbBzVGYafXa/vzsVxgu0QJwETO/fEmCSAKSLcEaVUalGLxC0q/KCFNlWhqgpVq4pLgZZyKYVyaSFUQa2g9EcRIMKlBJpAnMZ2iOUkdpyQGMeJb0ls79rJzumPs7NzZnZmdk1n1m41r2R5tMc+3573Pd/7nZ2dcyBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgP9nhCb6DWSIEmAlUAvUALOBYmBKov0EMAR0A3uA3UBT4rUAXxJ1wH3Ax8BJQIzz52Tif+9DijcpMdkyYApwG3ALsMzaGAqFqJhVRsVpZRQU5FOYnwcIRqKjRGMxDh/t50jvAEIIu753An8CnkdmzKTAZBGgFFgP3Jm4BqCosIBVdctYtXIJdUtrmDenkrzcCJoWR2gaQmjJa03TECJOLBqj81A3La3t7Ghtp7m1g2hsTI3VDzwBPA4MZnOQdphoAULAzcDDwCyQs3xN/XKuvfJi1l6wmvzcSIJoDaHFk0QnSdfiaEKTgiTbDWGi0RibG3ey6aMdNLXuU2MfAX4MbEBa1oRgIgWYC7wMXAgQDoe47KILuO3G66itnpcgV0NLkC0Jj5vEUNuTr6WIZVy37+/iL29sZsuO3apN/RO4ETg4ESRMlADXIP24DGBRTTU/u+sOViypSRJvzOy48ZowrnUxktealvx7Z7Hkdfv+L3j6lbfZu79bfz99yEx8I9tE5GQ7IHA38AJQFIlEuOuOW7n/3h9RedpMhNBAyEWMfi1nqnItNATyt9ou29R24dCfRum0Yi45dyn5eTnsaj+EEKIIuB5ZnLdkk4xsChACHgF+DoROryznucce5MpLLiSEmdzktUKeTrBQxBBCwyqWsBHLrj8QLDyjkmW1VTS3HSAaGwsBVyA/X2zKFinZFOAR4C6AmuozePmZR6meX2Uh0iBKn+XjFQYbYazCocQrm1bM+XUL+GzvQQZPjAA0AIVkSYRsCXA3cuazqm45Lz39KDOmTzVsQ7EQnTzVQsyWYxYLi1hWSxKKZaliqe0FeRHOW1FNW2c3fYNDIEXIih1lQ4BrkJ4fWly7gBd//xumFBe5zGyFSIufmywkxXIMMaz1w70/+Ts3J8zqJfNo2n2QY0NRgMuBbcBeP8nxW4C5wFtA0emVFWx8/kmmT52ShkizRajCpBZiG29PsZzMC3skEqZ+URVbWzqJjp7Ua8IrwHG/CAr71TGy6P4ZmBGJRHjy4V8yc0Zp4iOPPnCRJM8gQyhZIRRyMbUbhVik9CdM/eHQn7Dtb1pJId/79oWEwyGAmcgPar4t1/3MgHXA9wF+sv67XHXZReOwiHR+7mQ5RubY1w+nJavyGhqlU4uIhMO07jsMcAbQDrT4QZJfGVAKPASwdFEt6274Fol5qFiEeeaq7SKRJaaZrd/kVGdxSn849JcaT9jEUzPlyoZFVFVM18fza2CaH0T5JcB6YFY4HOa+e+8mJxxKcKKTYVw7W47ZQnSi0luO3p8SAxwtJ7U/GS8cghuvPkf3nnIS2ew1/BBgKvKuJlddupblSxelzGLTwMEsjOMsNWa1SRgS145ZYc0yTMK4ZVn1nDJWLjxdH9d6jC+APIMfAtwKlIZCIW6/9aaEk6TO0vSFGINIy9+7z2JcssKtEGPb39UNtfq4ZgDf8ZosPwRYB9Cw5hyW1C6wkIGDRVjJsJKrrIBMlpSOXJT+SCHXTkws8eZWlLJw/ix9bLd4TZbXApwNLAX45rVfdbAcu8KIYjmYs8K1EBtiqJbkVIjJIJ6wibdmaZU+vhXAci8J81qAbwAUFxdx2cVfUWYVpLccZUYKg6hsrP3VeHb9nV1TQV5ujmmMXsFrAS4GOH91PUUFBQ4WAfYWkY5cVQwyItcab3z1yIiRlxehpqpMH+NaLwnzUoASoB7g3FX1KZajpvRkXfu7WWbN3KQAa5C3rD2BlwKsBHJB3vFMTWnjOjUrrLMYE1HZWvsnhbF5fwuqks8K5CFrgSfwUoBakF+qV585L82swiyM4yy1Fkaj0KIKkzbLMAmTeZYZ8cpnlKg3hGq8Is1zAWZXllOYXzAOr1XJQPFuC5GusxiXrHCrFWRQe+R1XiTM9CkF+lgXekWalwJUAMyuKLe8eRwswkqGlVwUMhgHuSj9kRG52MRLnRyCUkOASq9I81KAqQAlxcU4FTLntb8lK1wtwhBDtYjxrP1lJ3YWZ2eZRrz8vORS1LNbEl6vgiguKkzaQnrLUYgUBlGTYe1vl2UFeRF9rJNSAEDn3frmZcv/0trfrh7pVuUlvBRgCGB4eNjBcuwsAtJbjoVczH7tbHHKLLbEc7ccu/5kvNjYKX2snn1F6aUAxwGGh0dMfu2W0uZZjImoTAqnsFiIDJfOcpQYqjAO70+NFxuL62P1bN+BlwJ0A3R19zjMKhQiwUSGTeE0yCDZn6lWpGSFNcswCZN5lqH0Z443cCKmj/ULr0jzUoA9AN09R4hGY2m8ViWDFK9N/q/rLMYlK9xqBS5Z4dzf2FicY0Oj+lh3e0WalwK0gSSlo/OAg0VYybCSqxRBk0WkIxelPzIm1xovdXIYE6G7bxhhjHVSCtCM3BZE444Wh8KIo+W4WwQmMuwtx64/HPqziJlimWbxBYKOrgF9nGN4+ISE16ugRoCtjU0ulqN4rTCIyqxwWrw9kSWZLE+FJV46yzGJLwR7DyU302wFhr0izevPAe+BFGBkJIa9RaTzX1UMMiTXsBBdGGs7NvGwiYdNvNHRU3R0JQV430vCvBbgNYCRaJRNH37sYBGQ3nLM/pugJgPLUWaxJZ675VjEtMRr7jjK2CnNNEav4LUAO0j44+tvvJOmcBoWkmoRzoVTWCwEcMkKa3/meE7vzxpvW1uPOr6dXhLmx1MRLwJ8sr2Z1j0dZu92nKXWwoiSFeCcFRZ7AVN9sLecVLHc6tHBnuO0G/7/ktdk+SHAs0CvEILnNvzVYeDYei0WYv6rtT+WeGktx25ywDvbDujj6gP+6DVZfggwDDwF8O6HW2je1ZbGItRCS2bkWiwkKUwGFmaN55wVgn1fDPLZvj59XL/Fhw3efj0b+hhwRBOCBx57Fi0et7Uc90KMiQx7y7HrD4f+rFlhLcRm8eOaxqsf7ElkD93Ak34Q5dfj6THgKPD13v5BCgvzWbG4JjE4u0fI7TbeCez3i8m/V9vl36fbyKf2l34j36Zt+/n3niP6eG4n8RnHa/i5P6AFuAiYv725ldV1yzhtZilePe9vzNz0z/ur8bCJZ91/1tE1wMZ32nTHehe5o94X+LlDRiB3oPedOhXnpw88QW//gIvlmP03WTrTWo61cBre7m45doUYBodibHhzF5omQGbxzYlgvsBPAUBu/78ZEIeP9HLnPQ8xNBQ1ETWZ1v4jsZM883oTg/Kup4acQF1+EpSNXZJ7kauHK/oHj9O0azdrzzub3EgEJ+82W4Td/l/FNhwtR1PITbefWDASG+MPf9/B5z3JL7vWAxv9Jidb+4S3AEVAQ8/Rfj76tJkL1qygqCDflkirt2ey19e9VrgX9mNDMX73aqNK/oPAA9kgJps75d9F7kBvGDx2gvc/3s7iBfOZVVaKV3t9nQo7Nv3p7R2H+nnqtUaODozo7/NXwD3ZIiXbh3VsQtrR5cMjsdBbH2wlEslh8VnzEs0KaeMi0rwCykS4eFzj7U/a2fBmC9HRU8jO+CFwfzYJmYjTUrYgz3K7QghRsn3nbj7atpMz51Yya8a0rKz9D3T388zfPuXTXV0kanovcB1yX3NWMZEHNs1BboJeC/Kh3ob6JVz/tbWcNb/S9pwfu3ODxnOuUGdXL//Y3EbL3m51XfkecBM+r3acMBmOLLsBeZJKuf7iysVncun5dZxXXyuPLMvogCaVeKM9Gh2lsfVz/tXcSdv+o2rsw8jTWzbi4zo/HSZaAB3TgB8g9+Imd0Lk5+WyfOF8ltXOY8lZc5hdXkp+JMd0Tpz1AL9YbIxDPf20dR6mtaObtv09jJ2Mq7H6kPeqnsDHMyAyxWQRQEcJcivoOhw2QcwsncLM0qkU5EcoyMsFBNHYGLHRk/QOnKDvmOPXtU3I7ypeIDjQNSMsA34BbEY+iSDG+TMKfJjoI+UM0smCyZYBTihGbg9diNwIUonMlqmJ9uPI5a1+dHEb8magZ08vBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQ4MvgP/Qh9B6ByP0KAAAAAElFTkSuQmCC",eF="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAHFgAABxYB45pq/gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAskSURBVHic7ZxbbBzVGcf/35nL7vqycbxJsBM7ToJwUK6kKqVViOKVWlohnkpfKqEmon2kILWEgGSWWUdqu/SlKK8UAZW4iMtjXwJ4LDUlEAkSgqw4CWkSE3yPnV17vZfZ+fqwa2wn3t3Z3TNrq52fZO36fOO5/P/nfOdb75wBPDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDz+l6HVPgEnxGKx5nQ6/QAzd9u23Q1gMxE1AmgCAGZOAEgC+E4IcYmZhwCcMwxjdhVP2xFr1oC+vr4Dtm0/DqAHwI8AKBXuwgLwOTObRPSBYRjnZJ+jDNaUAYZhBIUQv7Nt+wiAPQBg2zaPjU3QyMgYZmZu4/btBObmkshmLViWBSKCrvug6zqamhrR0rIO69Y1o61tI0KhVhbi+2u8IIR43efz/f348eOJ1bvK5awJAwzDaGXmZwA8RUQtlpXja9eu09DQZQwPjyCbzYKIQCTueF2pbTGm6z60t2/Cvfd2YsuWTawoCgGYtm37pBDiFcMwZlb72lfbAIpGo0eZOQYglEwm+csvz9OFC4NIpzMVC16qzefzYefObeju3sZ+v48ATAghnotEIv8AwKsmwGod2DCMrQDeBHAom83yp59+TufOXUAul6tCaOcxTdPQ3d2F3bt3sKqqBGBAVdUjvb29w6uhw6oYcOLEicdyudzrANZfvnwFn3wygNnZ5DLBhHDWs6uNNTY24MCB+7Fly0YAmFIU5eiLL774z3prUWllUTN9fX1P27b9mmVZAdMcINP8V4kc754JlpXDt9+OI5lMoa2tNQDg1+FweN40zX/XU496GkCGYbzMzNF4PI533nmPvvnmWk2iyhgl8XgSo6O3qL09BFVVfnb48OHGgYGBj+slSt0MMAzjZQB/nJyc4nfffZ9mZm67ll4qHUHptIWbNydo06b17PfrB3t6egKmaX5UD13qYkBfX9+zzByZnJzit956l+bmklKEKxcTwsnfAUSEXI4xOjpFbW0h1nXtYDgcTpimecZtbVw34MSJE4/Ztv1qPB7H22+/R8nkXN16dqWxXI4xPj5N7e0hVlXlkXA4fNY0zStu6iPc3LlhGFtzudzr2WwW77//ISUScSwWXktfV2qrNuZ8+3zvxxJzgPn5DM6eHaJczgYzv2EYRkcVl+4YNw0g5Ov89adOfUzj45NYFKG4OAtCLH9dqa1UjMrE8u+LnUM8Po/BwRsEIFS4BtfKddcMiEajRwEcGhq6hK++uuBYOBk92/koEUVjN25MYGxsBgAOR6PRJ6qQwBGuGFD4304sk8nwqVMLFZ0c4Zz0bFkjaHBwGJaVY9u2XzYMo8UNrVwxoPCPtdDp06dpdnbWcUpwEssjY5SIsn+XSmVx9eo4EdEmIvq9BGnuQroBhmEEATyVTM7zF1+cL7TKFK50zJnZcNwRhocnkclkmZmficVizTULdAfSDSCi3xJRy2efnaVMJoO8KPImznIxZ2aLErHlbZaVw40bUwRgfSqVelK2XtINYOajlmXx+fPnioiy8FrNxFn7CFre+511hJs3b8G2wcx8pCpRSiDVAMMwfgBgz5Ur39D8fAqVCCdr4qy29Cx1fplMDlNTcQKw3zCMfTI1kz0CfgkAg4ODFQvn9tyw8uR79/bFznl09DYAgJkfr1iVEsg2IGzbNl+7dr3wqzzh6lN6Fj+vW7fmwMwgoh45UuWRZkAsFmtm5h+OjIxQJpOVLo6M/F++9Cx+HMuykUikwMw/NgyjqTa1FpFmQDqdfoCI1OHhm4UWeROnk1Eis/QsFpuZmQcRqQCkzQPSDGDmbgCYmprCymnDvdJz+eRazDTnpWexWDKZAQAIIbolSJbfl6wdMfNOAJienq6p4nCaEirbFxx0hPJmz8/nDcjlcjsrU6c4MifhNgCIx2fhVDhZE6e8D2ilzzmdzuVbiNolaSZ1BDQDQDabcSycrPxf3uzSpSfgJMXlv7BZeq0ykDkCmgAgm7UKv9YuXL1KT6fp0rbthfNakwYAgFRx5OT/6kvPpe+FWBqTh0wDZgFA03TIEa78CKpH6bl0dKhqXq7C7fBSkGYAESUAwOfzORj29So972yrNpb/URSx7FplIHMSHgGA5uYm1H6xlWxfLAYsvxuiOrMBFG5vAfx+bdm1ykCaAUKISwDQ2tpaaCkuTr0+oDnt2U7NDgR0AICiKEO16rWAzBEwBAChUEhKxVE65kQ4OaVnvvfn2xoa8iPAtu1LFQtUBJmT8DlmtrZsaUetPa72ibPc6KquIwSDfgDINjY2LnzXWjPSDDAMY5aIzra13cM+n16DODLmBielZ/l9CbF4fpqmoKlJB4Azx44dm6tGo5WQ+jmAmfuFELR169ZCi8xJdbFNTulZep6589gtLYGFdrNmoZYg1QBFUT4EgF27ul1NIbX2bGex5cfZtOn7rwA+rEmkO5BqQCQS+RLAhe3bt3Eg4Ec1+b+2GADILT2JCLquoqWlgZFfe/xV9QrdjRu3pbyhKArt3btnoWWhvaaUUMkoWTxu+Z7txOz29iDya0HoTclyyTfA7/e/yswzBw7sY13Xq644Vm4rJ1z50hMoZ97yyVdVFbS3NzMz3/L7/a9Vo0kppBtw/PjxBBGdDAT8tH//HjjtcbXPDStNvitvX4nZmzcHoWkKCSH+5sYCb1fuDfX5fK8AmHjwwQMcDDY7SD1A7flfAA7NLhdbOKdAQENHxzoGMMbMJ6uQoiyuGPDCCy9MCyGe0zSNDh36CWSkl3qVnkIsHnvHjhAURZAQ4lnDMOJuaOXa+oDCCvSBHTu6sGfP/TWmFzk9u7LUsw6trQ0A0B+JRN6WIsoKuLlChlVVPcLMtx5++CHesKEV7ggHyC49g0E/tm9fz8yYVFX1CFx8lIGra8R6e3uHVVU9oigKHn30pxwMNlWUEioZJXlqHyV+v4Zdu+5hIQQLQb/p7e1duNHJFVxfJdnf3385HA4nNE37eWfnZr569QZZll0Qz/0V8QuvpZasAvn/evp8Gvbu3cx+v0ZCiD+89NJLb7mtT13WCZumeaanp6fB7/cf3Latk4eHF29fXFztXo3gqHD7lWOAQCCgY9++LdzQoBMz/8UwjD/XQ5u6rZQ3TfPjnp6egN/vO7h9eyePjo5RKpWpSThZI6i52Y/9+zs4ENAIQCwajfbWS5e6PqzDNM2PCunokfvu2450OkNTUzMlxVmeOpbG5KSsjo5W7N7dzpqmcCHt/KmemtT9aSmmaZ4Jh8NniegXnZ2bG0KhFkxMTBceP1aJmKhplAQCOnbt2ozOzvUAMKWq6q8ikYjrOf9OqPwm7lBYgf4mgMPZrMVff32JLl78D3I5JxP04vu755DSJiiKgq6uELq6NrCiCALQX3hgk6vVTjFWzYCF40ej0SeY+a8ANqbTGb548SpduTKM/CRdTFSASKko/2uahq6uDejoaGVdVwnAGBEdK1Q6/3+PLFtKYRH004Wf9bZt83ffTdD16yMYH59GNmuV7dkrxXRdxcaN69DW1oING9axECBmvqUoyiu6rp98/vnnb6/ypa8NAxaIxWLNqVTqSWY+isIiCNtmzMwkMDk5g0Qiibm5eaRSGVgWI5ezAeS/MNE0HYGAjqamAJqaAmhtbUYw+P3XiABwTgjxhm3br62lB7quKQOWYhjGPmZ+nIjCzPwQ5VemOIaZLSI6A6BfCPFBJBK54NKp1sSaNWAphTVZ+4hoJzPvZOZ2yj+6OFjYJF64X3NUUZQh27YvNTY2npd594KHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh0c1/BeAGZfPY0oVeAAAAABJRU5ErkJggg==",tF="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAHFgAABxYB45pq/gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAwLSURBVHic7Zx7cFTVGcB/hzzIbrJ5AIGAFiEgICBQpKDGFANB0wo6FVpfCEiZqWMrHSsy1bEPW8cW7R91mDrTh4xABR8ViqhYBaKIgiCgCCgBAXlHhDw2m0Syydc/7m5y7+69+0juTdLO/c0sOfeccw/3fN93vvPds+csuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLj8P6O6+gESxAeMA4aFPgOATCArVO4H6oHTQAVwEPgYqOv0J02S7qyAbwMzgeuBiUBKkvcHgR3AO8AraArpdnQ3BWQDC4C5wGiAlJQUGXflKDVp/FiGFF7GkEEDKcjPx+fLJNPrARHqAgH8/jpOV1byxdHjHDl2nA9372XvgYPS3Nwc7uOnwHPAs2gjplvQXRTQC/i5UupnIpKbnpYmpSXFataM73PdNRPJytQELSKAGNJmedplC4FAgC3bd7H2jbfZvPVDaWoKKqVUlYgsBZ4Gqruwz0DXK0AB85RSS0Skd6+8XPnJPbPVnNtnkZudTauARZCQkPV5VmkBkBbDfdU1taz813qWrV4jVdW1Sil1TkQWAytBu6WrBNBVDARWAMVej0cWLbxX3XPnbXgyerYKzWDdYQXo0rGsHzAdKfX1DSx/6VWWPvu8NDR+o4B30Vzeia4QQrITm11MV0ptAIbfdGMpz//9L2pKcRFpaakh6zW5Q3R/JDo/nJbWREhR+o8IaWkpTBg7klu/N0WdOHOWI1+eHKSUuhvYDxyyt5vx6QoFLASWpaenex57eJH63SMPkZWViUFQ6OQqxjQmaYnKN2pQTOr6Mr1ML/0uAy/px5btuzzB5uY7gAbgg/Z3LXk6UwEKeBJ4rH9BP9Y9/5y6sbTEUEEMUjdaLkTMA5F1WoXeYl4ekQ6PjiuGDqKkaILatHUHgfqGaWjvF5sclIOBzlTAk8CDlw8plLWrnlOFgy8DEnUp1nWiR4pY17XI79M7lxmlxeq9HXvkfFVNEeABNibWrY7RWQpYBPz68iGFsv7FFapv3z5EWqVYpC1HQlQ5WuQTY9REtacrz/RmUFZSpDZv3SlVNf4itHeF7U4LpjMUMB34x4CCAv79wnLVL79PwhMq1pcxJl+LUWN2a0Qbnox0plw7Qb1R/r4E6htvAHYCh606ZgdOh6EDlVK709PTc/+z9gU1cvgw03DSMrRMuG7YvbSYhp7WIWtE3VD6QMVRfnjvw9IUDF4QkfHASacE5OQIUMA6YPhTj/9WTb2+WMs1sXKTwMWy3HrU6F68TF2UcfKNTOvr9OmdQ16OT5Vv2+UFxqO9rzhCD6caBuYBxdPLpjH7tpnWnTeTfCKTr9lEHNGGWd14BhAuvuOWaUwtmgAwGZht9l/YgVMuqJdS6nNPRkavDzZtUAMK+lq6l/a6ieg33/hLFPp0vKUNQThz9hxlcx6Uby5ePCciV+DA2pFTLuiXQNkjDz2gpk4uNp9QY1ilWKSjiJh8zdozewmLfhiTcgFflpceSqltu/dlor2kbTFpoUM4MQKylVJHc3NzcvZs3ay8nowkJ9RkRkqb9cccKRGjpi2PuHXrGxqZcvv9Ul1bVy0ig7F5KduJOeDHIpJ734L5yuvxtOUmNaEmUJ7MSMGiPIH3EE/PdObMLFMikgfMN2+9/TihgHnpaWky984fES/aMO18wnUhUiFRWUlMvlF1dJd33FxKamqKoK2a2ordChgPjL6htETl5uS05cYRlIGkRop9oWeUAeg+ub5MJk8aq4CxwJjExREfuxVwK8CsW2YQs/NhYrgUszpOh55RFy1tWTOmFoVzZ5r91+3FbgWUpKSkSPG1V7flmEgq6XWfiPUbrZHoVc9EV0BNPxHlkSPl2qtG0aNHD9A2CdiGnQrwKaUmjB83RvmysqIKY/rbCOs3HQnxyq1GikUbpuUW1o9o3x+MGjYIBVfTth2mw9ipgHEikjrxqvEk7G+trNXEHxsn3/aueoZup60pItP6y4j8CaOHI5CKjfOAnQoYBjBsaGFbjpW/jdd5O0YKZuXWBmAwhhYTYxBh8MACQ1/twE4FDAcYMviypK0/sbohTJRjyIqhvNY/iVi/Sd3CS/sb+moHdiqgAGBA/9BDxhGUgYRGSviic0JPM2MpyO8VfppWTXQUWydhgCyv16TzOmK4FLM6XRl6RraR6c0IX/nMHqU92KmALIDMTK+JpGL4224cehotBLye7q2AKGL62wjrNx0J8cqtRopFG6blcazfGIm1mDTcMexUQB1AXSBATH/rZOgZ1Zbudl2ayLT+MoYBBOobwzm2rYjaqQA/QJ1f25KfdOcdGSmxDUBiKM/MWAINDYa+2oGdCjgDcOrMmYSsP37oqWvZJG3ISqRuPAOIMfm2drDygqGvdmCnAioAvjj6pXZlIigDJsIxdl50ku260FOfPnayVe4Hk5aOBXYq4CDAoS+ORAs9hksxq2N76GnWlv4iAetH4MiJs+GrCrPHag92KuBjpQju2LWHuP62s0PPGOXRI6XtT0SSXfsqUIom4BO7hGZrFCTCzj1794nfH2jLjWH9piMhXrnVSLFow7Q8pvVHKDCkGH+gngOHjyPCdkDXwY5h93tAeXNzs9rywTZLf+ps6Gl0IzFdiv4yAQN4f/d+WlpaQDv0Zxt2K2ANwJpX30is8zH8bftGirmiOxJ6htOvbdpm6KNd2K2APcCnb21+V6qqa4jqfIw5AGK4iWjX3GmhJwIXaut476N9gnbUdS824sRSxPKmYFCtWP1ydImJcMTwj+gkq5t8TXxyOO106AnCi+vLCQabFQ7sEXViY5ZPKXUsJ9uX81H569reINH5bou0cTMWRJ5ytKxrko673RFBWnR1xTpd39jItLsXS01dfZWIFPI/sDHLLyJLq2tq1bJ/voiV5bZaZJeHniHMk6xcu5Fqf0CJyJ9x4IC3U5tz85RSn2X07Nlny+svqwH9+0Vbv4XFtdv6E60by/oj6p6u/JrpCx6Vi03Br0RkBFBrt6CcWo6uEpHFDY2N6ldP/MnEyq38LSQXeoZuQXc7hiJjWn8ZkR/O05c//swqvrnYpERkEQ4IH5w9oLEXmHz46JeD+ub3YeyoEbGF09p5iRJEFIa65m4nZugZcW0Weq5ev5mVa98GKAcWd0wU1jh9ROlbSqndaWmpea+telaNHDFU5yYwcRNg1zEj013RSOuOh1h191cc464HnpBgc/P50BGlU04JyNFvxIATIjL34sUm5tz3oJw8pS1mhYVvtDroDqHnqcpz/PQ3T0tTMCgiMgcHhQ+dc0ryEOCvC9TfWL51m9xcVqo8oe9Wo4MQve/BkE7qJQ2LizgvXhdq/Mxf/JScrjyvgF8Aq2L0yxY665zwdsBbVV1TtGHjOzK1+BqVm+PDMJl2Rugp1go+VXme+YuflGMnzyrgj8AfHJRHK515Un4T4Kmp9Re9/vY7UjRpvMrv3Stq8m3FwvoNIyFOXXPrj1AwwoHDx5i/eImc0ix/CfBo8t1rH539Yx0bAX+gvv6Gl9ZtoFdujhozcjiJh55t6N2IlUsxqxvJqnWbeOD3z4g/0CBobueJDvQvabri11K2AztbWqRs05Zt3v2fH2LCuNH4MjPbZGRh5XEn3Hihpy7v5NlzPLzkr6xY8xYich6YRSf4/Ei68gebLkVb3Jrsyegp9y+Yrebd9gO8np6Ohp719Q0sX/Mmf1u1Xhq/uajQ4vy5OBztWNEdfrJstlLqKRHJz8vJlvl33qrumnkTednaJB11rtcqbVZXp4Cq6lpWv7qR5a+8KTX+gFJKVYrIQ2hWb+GgOkcA3YFcYKFSaqGI5KWlpkpJ0UR1S1kJ100chy/Ta239MUaHvy7A1p17Wb9xK+9++LEEg81KKXVBRJ4GlgI1Xddlje6igDA+tKOg8wgdgujRowdXjhjKd8aNonDgJQweOID++b3x+bx4MzJQCHX1DdT66zj71dccOX6aI8dP8dEnn7Gv4mj4a0TQvkxZDiyjG/2ga3dTgJ4xaAfiShRMEu1kSjIE0Sb8crQfbv3U5uezhe6sAD1ZaAoZHvr0R/tpsexQeS3aWv1ZtP1JFWhbR2zbveDi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4tIe/gsqJxCMeOULTwAAAABJRU5ErkJggg==",Jse="data:image/png;base64,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",eie="data:image/png;base64,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",tie="data:image/png;base64,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",nie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAHFgAABxYB45pq/gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAk+SURBVHic7ZxtbFvVGcd/T1w5fombpF1L2kwdFTGu1IaRUl6XoWRqGhALMHUSEhJsZC1aJSqGBB+mgaaivZQxoWof+LKNZl2LAKnANKmiAlKSNnEiGjWBAiFN144saRZonNSu7Ta2zz7cuksCXfNyrn3Dzk/yBx+f63PP//+cx/den3PAYDAYDAaDwWAwGAwGg8FgMBgMBoPBYPg6I/k+gRkSAG4EQsD1wErADxRd+jwKxIEhoA/oBbqBWM7P9GtEFfBroB1IAWqWrwmgDfgVlnmOxGkjYDGwFfgxsA7A5XKpm266SW6//XaCwSAVFRWUlZURCATw+/0opYhGo4yPjzM0NER/fz/9/f10dnbS09Oj0ul0to8fAruBP2GNGEfgFAOWAD8Tke1KqRK3263uvvtueeCBB6itrcXv95PJZFBKTXlNL5v+PhaL0dLSwptvvklzc7OamJgQEYkopf4A7ALG8tzvvBsgwCMi8jul1NKlS5eq7du3y5YtWygpKbmqwDMty2QyjI2NsW/fPpqamlQkEhER+Vwp9RSwBytl5U2AfLEK2At81+fzqaeffloeffRRPB7PnASeaZ14PM7evXt58cUXVTKZFKAFeAgYyIcIrnw0CjSIyEEgdN999/HGG29IXV0dixYtmrPAMz3O5XJRVVVFQ0ODDA4OcurUqWtF5GHgI+BEroXIhwGPA7sLCwu9O3fulOeee45AIDCvqJ5LHb/fT319PeXl5bS1tXnT6fSDQALryiln5NIAAZ4Hni0vL+fgwYNyzz33zFvg+RoTDAaprq6W1tZW4vF4Hdb9xTu5EiWXBjwPPBkKhdRbb70lFRUV2qN6ruYtWbKETZs2SWdnp4pEIt8BvOTIhFwZ8BTwy1AopN5++2255ppr8ib6lep4vV5qa2vl8OHDanx8vBrrXiFstzC5uApqAP5WXl5Oc3OzlJeXOybyv+r9mTNn2LZtm/riiy8Avg8csFMcuw1YJSLdhYWFJe+9956sXbvWcZH/VWUnTpxg27ZtKpVKjSqlbgT+ZZdAdqYgAf4OhHbt2iV1dXV5i+rZ1ikpKaG4uFg6Ojp8wHqsmzVbsNOARmD7vffey44dOxZE5E9+HwwGOXnyJAMDA9cC/wB67BDJrhS0RET6vF7vkq6uLlm5cuWCiPzpZcPDw2zdulVdvHjxc6VUCBueHdk1An4O3PXMM8/Ixo0bF1TkT37v8/kQEenu7vZj3aS16BbKjhGwWET+WVpaWnz8+HGx69lOrsxLJBI0NjaqaDQ6ppT6FpofZRfo/LJLbFFKlTz22GOXxc9kMpdfkzs5uWy2da503EzqzKZ9t9tNQ0ODKKVKgZ/oFsuOEfCh2+1e+/HHH0tJScmCjfzJZefOnaOxsVGlUqkP0Pzvmu4RsB5YV19fL9nn+Qs18ieX+f1+qqqqBPg2cINOwXQbsBlg8+bNjhFPV/t33nlnto8/1CnYIp1fBnzP5XKp6upqudrwzmVq0fHd69ato6CggEwmU6tTMJ0jICAiG9avXy9FRUVfm8jPlnk8HlavXg1wG/+dDjNvdBpwo1Jq0c033+w48XS1HwqFwMoa2n4HdKagEEBFRcVVh3uu0obu9svKyib3tV2HaNoNWL16tSPF01FnxYoVU/qqA50GlAGUlZVNGbZOEU9H+6Wlpdm+rriyDLNDpwEBAJ/P96X86gTxdNRxu91T+qoDnQYUwZcNcIp4OtovLCzM9tWRBgCQyWQQEceJp6NOOp3WLZdWA2IA0WiUxYsXO048HcclEolsX7U9EdVpQBQsA4qKihwnno468Xh8Sl91oNOAMwBDQ0NMn3biBPF0HDc6OjqlrzrQeSfcB3Dq1KkpJz+TO8zZ3JnqqnOl4/5XneHh4WxfP9Ulms4R0AvQ39+ft8tQu9OW0w3oBlLHjh1btBDy+VyOO3nyJFhLn7TNkNB9FfT+8ePHb4vFYuL1eh0l3nzrJBIJBgYGADqA87pE0/2HTHM6nZZwODzjnPtVZbnI57Nt/5NPPkEpBXBIp2C6DdgPcODAAUeJp6P9rq6uKX3UhW4DjgEftra2qkgk4hjx5tt+NBqlt7dXYf3OfaBTMDumpTSlUil5/fXXHSGejvbb29u5tNz1L7rFssOAP4rI2Msvv6zi8XjexZtv+8lkkiNHjigRGQX+rFssO6YmXgR8Fy5cqPF6vVRWVk7pmNOvdqaXtbS00NvbK8BvsGHVjF2Tc0tF5FO32/2NPXv2yPLly/Mi3nyPi0QivPDCCyqVSo0opa4HzukWyq7JuUlgJJ1O/2B4eJiampoFF/lKKV577TVGRkYE+Clw1A6h7Fwf8AFQ89lnn11bWlpKMBhcMJGvlCIcDtPe3g7QjLXGzRbsXqT3roj8qKury3PLLbfMeq5oviJ/cHCQV155RQFngXpsSD1Z7DbgHPBRJpN5sLOzkzvuuEN8Pp+jI390dJTdu3erZDKpsKYhHrNToFwsUz0BRBOJRP3Ro0dVdXW1uN1uR0Z+LBbjpZdeUmNjYwI8AeyzW5xcrRMOA75oNFodDofVhg0brjoS8hX5Z8+eFeC3WJedtpPLlfLvAt5YLFbd1tamKisrpbi42BGRPzQ0RFNTUzbydwK/yJUoud6s4x0gmkwmNx06dIhAICDZmXT5ivyOjg5effXVbM5/AmubtJyRj91SwsD7Sqm7urq6fKdPnyYYDNq+T9D0skgkwv79+wmHw2Bd7WwmBzl/OvncsOmbwF+BGrfbre6//37ZuHEjk3+g7Yj8Cxcu0N7eTmtrq5qYmBCs6/yHgcF8iOCELcseEpHfK6WWFRUVqbq6Oqmpqbm8IZ+uyD9//jwdHR2Ew2GVSCRERP6tlHoSK+r/L7csm0wJ8LiIPK6UKnW5XKqyslJuvfVW1qxZg8fjmZPoiUSCvr4+enp66OvrU+l0WkRkVCm1C/gDMJ7nfjvGgCwBrKWgj3BpEURBQQGrVq3iuuuuY/ny5Sxbtozi4mI8Hs/ldJVMJonH44yNjTEyMsLIyAinT59mcHAQpS4HdzfQhPVI2WzoOgNuAJ4FjmDNRJjLxq2HgR1AZY7PfcY4bQRciSIsQ9ZgLY5YgbW12OJLn5/Dmi44jDVn51OsqSPaZi8YDAaDwWAwGAwGg8FgMBgMBoPBYDAYDIa58B8Q+q4CZLsyAgAAAABJRU5ErkJggg==";/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const rie="cburnett",qa={};qa.cburnett={bb:Rre,bk:Pre,bn:Ore,bp:Dre,bq:Lre,br:Fre,bx:Wre,wb:$re,wk:Bre,wn:Mre,wp:Vre,wq:Ure,wr:zre,wx:jre};qa.celtic={bb:Gre,bk:qre,bn:Hre,bp:Kre,bq:Xre,br:Yre,bx:Qse,wb:Qre,wk:Zre,wn:Jre,wp:ese,wq:tse,wr:nse,wx:Zse};qa.eyes={bb:rse,bk:sse,bn:ise,bp:ose,bq:ase,br:use,bx:eF,wb:lse,wk:cse,wn:dse,wp:fse,wq:hse,wr:pse,wx:tF};qa.fantasy={bb:mse,bk:gse,bn:yse,bp:bse,bq:vse,br:wse,bx:Jse,wb:xse,wk:Sse,wn:Ase,wp:Ese,wq:Cse,wr:Nse,wx:eie};qa.skulls={bb:Tse,bk:_se,bn:Ise,bp:kse,bq:Rse,br:Pse,bx:tie,wb:Ose,wk:Dse,wn:Lse,wp:Fse,wq:$se,wr:Bse,wx:nie};qa.spatial={bb:Mse,bk:Vse,bn:Use,bp:zse,bq:Wse,br:jse,bx:eF,wb:Gse,wk:qse,wn:Hse,wp:Kse,wq:Xse,wr:Yse,wx:tF};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const sie="original",ps={};ps.original={b:"#b5876b",w:"#f0dec7",cb:"#04f",cg:"#0e0",cr:"#d00",cy:"#db0"};ps.gray={b:"#bbbbbb",w:"#f8f8f8",cb:"#04f",cg:"#0a0",cr:"#d00",cy:"#a90"};ps.scid={b:"#7389b6",w:"#f3f3f3",cb:"#04f",cg:"#0e0",cr:"#d00",cy:"#db0"};ps.wikipedia={b:"#d18b47",w:"#ffce9e",cb:"#04f",cg:"#0e0",cr:"#d00",cy:"#db0"};ps.xboard={b:"#77a26d",w:"#c8c365",cb:"#04f",cg:"#0f0",cr:"#d00",cy:"#ff0"};ps.coral={b:"rgb(112,162,163)",w:"rgb(177,228,185)",cb:"#04f",cg:"#080",cr:"#d00",cy:"#ff0"};ps.dusk={b:"rgb(112,102,119)",w:"rgb(204,183,174)",cb:"#04f",cg:"#3f3",cr:"#f20",cy:"#ff0"};ps.emerald={b:"rgb(111,143,114)",w:"rgb(173,189,143)",cb:"#04f",cg:"#6f6",cr:"#d00",cy:"#ff0"};ps.marine={b:"rgb(111,115,210)",w:"rgb(157,172,255)",cb:"#04f",cg:"#6f6",cr:"#f50",cy:"#ff0"};ps.sandcastle={b:"rgb(184,139,74)",w:"rgb(227,193,111)",cb:"#04f",cg:"#0c3",cr:"#d02",cy:"#ff0"};ps.wheat={b:"rgb(187,190,100)",w:"rgb(234,240,206)",cb:"#04f",cg:"#0c3",cr:"#d00",cy:"#ff3"};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const nF=40;function iie(){return{squareSize:nF,coordinateVisible:!0,turnVisible:!0,colorset:sie,pieceset:rie}}function rF(){return{...iie(),moveArrowVisible:!0,moveArrowColor:"b",animated:!1}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */class oie extends L.Component{constructor(){super(...arguments),this.innerRef=L.createRef(),this.mouseDownListener=e=>this.handleMouseDown(e),this.mouseMoveListener=e=>this.handleMouseMove(e),this.mouseUpListener=e=>this.handleMouseUp(e),this.touchStartListener=e=>this.handleTouchStart(e),this.touchMoveListener=e=>this.handleTouchMove(e),this.touchEndListener=e=>this.handleTouchEnd(e),this.touchCancelListener=e=>this.handleTouchCancel(e)}componentDidMount(){this.innerRef.current.addEventListener("mousedown",this.mouseDownListener),window.addEventListener("mousemove",this.mouseMoveListener),window.addEventListener("mouseup",this.mouseUpListener),this.innerRef.current.addEventListener("touchstart",this.touchStartListener,{passive:!1}),window.addEventListener("touchmove",this.touchMoveListener,{passive:!1}),window.addEventListener("touchend",this.touchEndListener),window.addEventListener("touchcancel",this.touchCancelListener)}componentWillUnmount(){this.innerRef.current.removeEventListener("mousedown",this.mouseDownListener),window.removeEventListener("mousemove",this.mouseMoveListener),window.removeEventListener("mouseup",this.mouseUpListener),this.innerRef.current.removeEventListener("touchstart",this.touchStartListener),window.removeEventListener("touchmove",this.touchMoveListener),window.removeEventListener("touchend",this.touchEndListener),window.removeEventListener("touchcancel",this.touchCancelListener)}render(){const e=["kokopu-handle",this.props.isArrowHandle?"kokopu-arrowDraggable":"kokopu-pieceDraggable"];return L.createElement("rect",{ref:this.innerRef,className:e.join(" "),x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height})}handleTouchStart(e){this.dragData||e.touches.length!==1||(e.preventDefault(),this.doInitDrag(e.target,e.touches[0]))}handleTouchMove(e){this.dragData&&(e.preventDefault(),e.touches.length===1?this.doUpdateDrag(e.touches[0]):this.doCancelDrag())}handleTouchEnd(e){this.dragData&&(e.preventDefault(),e.touches.length===0&&e.changedTouches.length===1?this.doEndDrag(e.changedTouches[0]):this.doCancelDrag())}handleTouchCancel(e){this.dragData&&(e.preventDefault(),this.doCancelDrag())}handleMouseDown(e){this.dragData||e.button!==0||(e.preventDefault(),this.doInitDrag(e.target,e))}handleMouseMove(e){this.dragData&&(e.preventDefault(),this.doUpdateDrag(e))}handleMouseUp(e){this.dragData&&(e.preventDefault(),this.doEndDrag(e))}doInitDrag(e,{pageX:n,pageY:r,clientX:s,clientY:i}){this.dragData={originX:n,originY:r};const o=e.getBoundingClientRect(),a=s-o.left,u=i-o.top;this.props.onDragStart&&this.props.onDragStart(a,u)}doUpdateDrag({pageX:e,pageY:n}){const{originX:r,originY:s}=this.dragData;this.props.onDrag&&this.props.onDrag(e-r,n-s)}doEndDrag({pageX:e,pageY:n}){const{originX:r,originY:s}=this.dragData;this.dragData=void 0,this.props.onDragStop&&this.props.onDragStop(e-r,n-s)}doCancelDrag(){this.props.onDragCanceled&&this.props.onDragCanceled()}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const aie="__kokopu_debug_freeze_motion";class uie extends L.Component{constructor(e){super(e),this.state={cursor:0},this.cursorStop=1;const n=window[aie];typeof n=="number"&&n>=0&&n<=1&&(this.cursorStop=n)}componentDidMount(){this.animationFrameId=window.requestAnimationFrame(e=>this.handleAnimationStep(e))}componentWillUnmount(){this.animationFrameId!==void 0&&(window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0)}handleAnimationStep(e){this.initialTimestamp===void 0&&(this.initialTimestamp=e);let n=(e-this.initialTimestamp)/this.props.duration;n<0?n=0:n>this.cursorStop&&(n=this.cursorStop),this.setState({cursor:n}),n===this.cursorStop?this.animationFrameId=void 0:this.animationFrameId=window.requestAnimationFrame(r=>this.handleAnimationStep(r))}render(){return this.props.children(this.state.cursor)}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const Qv=.1,Zv=1,Jv=1.4,lie=.1,Wy=.15,nm=.3,cie=150,die="12345678",fie="abcdefgh";class hie extends L.Component{constructor(e){super(e),this.arrowTipIdSuffix=QL(),this.state={}}render(){let e=0;const n=[];et.forEachSquare(c=>n.push(this.renderSquare(c)));const r=[],s=[];if(this.props.coordinateVisible){e=sF(this.props.squareSize);for(let c=0;c<8;++c)r.push(this.renderRankCoordinate(e,c)),s.push(this.renderFileCoordinate(e,c))}const i=Math.round(-Zv*e),o=0,a=this.props.turnVisible?9*this.props.squareSize+Math.round(Qv*this.props.squareSize):8*this.props.squareSize,u=8*this.props.squareSize+Math.round(Jv*e),l=`${i} ${o} ${a-i} ${u-o}`;return L.createElement("svg",{className:"kokopu-chessboard",viewBox:l,width:a-i,height:u-o},L.createElement("defs",null,this.renderArrowTip("b"),this.renderArrowTip("g"),this.renderArrowTip("r"),this.renderArrowTip("y")),n,r,s,this.renderBoardContent())}renderBoardContent(){return this.props.move&&this.props.animated?L.createElement(uie,{duration:cie},e=>e===1?this.renderBoardContentStill():this.renderBoardContentAnimated(e)):this.renderBoardContentStill()}renderBoardContentAnimated(e){const n=[];return et.forEachSquare(r=>n.push(this.renderPieceAnimated(e,r))),L.createElement(L.Fragment,null,n,this.renderMoveArrow(e),this.renderTurnFlag(et.oppositeColor(this.props.position.turn())))}renderBoardContentStill(){const e=this.getPositionStill(),n=[],r=[];return et.forEachSquare(s=>{n.push(this.renderPiece(e,s)),this.props.interactionMode&&r.push(this.renderSquareHandle(e,s))}),L.createElement(L.Fragment,null,this.renderSquareMarkers(),this.renderHoveredSquare(),n,this.renderTextMarkers(),this.renderArrowMarkers(),this.renderMoveArrow(1),r,this.renderPromotionDrawer(e),this.renderDraggedPiece(e),this.renderDraggedArrow(),this.renderTurnFlag(e.turn()))}renderSquare(e){const{x:n,y:r}=this.getSquareCoordinates(e);return L.createElement("rect",{key:e,x:n,y:r,width:this.props.squareSize,height:this.props.squareSize,fill:this.props.colorset[et.squareColor(e)]})}renderHoveredSquare(){if(!this.state.hoveredSquare)return;const{x:e,y:n}=this.getSquareCoordinates(this.state.hoveredSquare),r=Math.max(2,Math.round(lie*this.props.squareSize)),s=this.props.squareSize-r,i=this.getColorForAnnotation(this.props.interactionMode==="editArrows"?this.props.editedArrowColor:this.props.moveArrowColor);return L.createElement("rect",{className:"kokopu-hoveredSquare",x:e+r/2,y:n+r/2,width:s,height:s,stroke:i,strokeWidth:r})}renderPiece(e,n){const r=e.square(n);if(r==="-"||this.state.inhibitedSquare===n)return;const{x:s,y:i}=this.getSquareCoordinates(n);return L.createElement("image",{key:"piece-"+n,x:s,y:i,width:this.props.squareSize,height:this.props.squareSize,href:this.props.pieceset[r]})}renderPieceAnimated(e,n){const r=this.props.move;let s=this.props.position.square(n);if(s==="-"||r.to()===n||r.isEnPassant()&&r.enPassantSquare()===n)return;let{x:i,y:o}=this.getSquareCoordinates(n);if(n===r.from()){const{x:a,y:u}=this.getSquareCoordinates(r.to());i=a*e+i*(1-e),o=u*e+o*(1-e),r.isPromotion()&&e>.8&&(s=r.coloredPromotion())}else if(r.isCastling()&&n===r.rookFrom()){const{x:a,y:u}=this.getSquareCoordinates(r.rookTo());i=a*e+i*(1-e),o=u*e+o*(1-e)}return L.createElement("image",{key:"piece-"+n,x:i,y:o,width:this.props.squareSize,height:this.props.squareSize,href:this.props.pieceset[s]})}renderDraggedPiece(e){if(this.props.interactionMode!=="movePieces"&&this.props.interactionMode!=="playMoves"||!this.state.draggedSquare)return;const n=e.square(this.state.draggedSquare);let{x:r,y:s}=this.getSquareCoordinates(this.state.draggedSquare);return r=Math.min(Math.max(r+this.state.dragPosition.x,0),7*this.props.squareSize),s=Math.min(Math.max(s+this.state.dragPosition.y,0),7*this.props.squareSize),L.createElement("image",{className:"kokopu-pieceDraggable kokopu-dragging",x:r,y:s,width:this.props.squareSize,height:this.props.squareSize,href:this.props.pieceset[n]})}renderDraggedArrow(){if(this.props.interactionMode!=="editArrows"||!this.state.draggedSquare)return;const{x:e,y:n}=this.getSquareCoordinates(this.state.draggedSquare),r=e+this.props.squareSize/2,s=n+this.props.squareSize/2,i=Math.min(Math.max(e+this.state.dragPosition.x+this.state.cursorOffset.x,this.props.squareSize/2),15*this.props.squareSize/2),o=Math.min(Math.max(n+this.state.dragPosition.y+this.state.cursorOffset.y,this.props.squareSize/2),15*this.props.squareSize/2);if(r===i&&s===o)return;const a=this.props.squareSize*Wy,u=this.props.editedArrowColor;return L.createElement("line",{className:"kokopu-annotation kokopu-arrow kokopu-arrowDraggable kokopu-dragging",x1:r,y1:s,x2:i,y2:o,strokeWidth:a,stroke:this.getColorForAnnotation(u),markerEnd:`url(#${this.getArrowTipId(u)})`})}renderPromotionDrawer(e){if(!this.state.promotionDrawer)return;const{x:n,y:r}=this.getSquareCoordinates(this.state.promotionDrawer.origin),s=e.turn()===(this.props.flipped?"w":"b"),i=s?r-this.props.squareSize*(this.state.promotionDrawer.buttons.length-1):r,o=this.state.promotionDrawer.buttons.map((a,u)=>{const l=e.turn()+a;return L.createElement("image",{key:"drawer-piece-"+a,className:"kokopu-clickable",x:n,y:r+u*(s?-this.props.squareSize:this.props.squareSize),width:this.props.squareSize,height:this.props.squareSize,href:this.props.pieceset[l],onClick:()=>this.handleDrawerButtonClicked(a)})});return L.createElement(L.Fragment,null,L.createElement("rect",{className:"kokopu-handle",x:0,y:0,width:this.props.squareSize*8,height:this.props.squareSize*8,onClick:()=>this.handleDrawerCancelButtonClicked()}),L.createElement("rect",{x:n,y:i,width:this.props.squareSize,height:this.props.squareSize*this.state.promotionDrawer.buttons.length,fill:this.props.colorset.b}),L.createElement("rect",{x:n,y:i,width:this.props.squareSize,height:this.props.squareSize*this.state.promotionDrawer.buttons.length,className:"kokopu-drawerMask",fill:this.props.colorset.w}),o)}renderSquareHandle(e,n){const{x:r,y:s}=this.getSquareCoordinates(n),i=this.props.interactionMode==="movePieces"&&e.square(n)!=="-",o=this.props.interactionMode==="editArrows",a=this.props.interactionMode==="playMoves"&&!this.state.promotionDrawer&&e.isLegal()&&e.square(n).startsWith(e.turn());return i||o||a?L.createElement(oie,{key:"handle-"+n,x:r,y:s,width:this.props.squareSize,height:this.props.squareSize,isArrowHandle:o,onDragStart:(u,l)=>this.handleDragStart(n,u,l),onDrag:(u,l)=>this.handleDrag(n,u,l),onDragStop:(u,l)=>this.handleDragStop(n,u,l),onDragCanceled:()=>this.handleDragCanceled()}):this.props.interactionMode==="clickSquares"?L.createElement("rect",{key:"handle-"+n,className:"kokopu-handle kokopu-clickable",x:r,y:s,width:this.props.squareSize,height:this.props.squareSize,onClick:()=>this.handleSquareClicked(n)}):void 0}renderSquareMarkers(){if(this.props.squareMarkers)return Object.entries(this.props.squareMarkers).map(([e,n])=>{const{x:r,y:s}=this.getSquareCoordinates(e);return L.createElement("rect",{key:"sqm-"+e,className:"kokopu-annotation",x:r,y:s,width:this.props.squareSize,height:this.props.squareSize,fill:this.getColorForAnnotation(n)})})}renderTextMarkers(){if(this.props.textMarkers)return Object.entries(this.props.textMarkers).map(([e,n])=>{let{x:r,y:s}=this.getSquareCoordinates(e);return r+=this.props.squareSize/2,s+=this.props.squareSize/2,L.createElement("g",{key:"txtm-"+e,className:"kokopu-annotation"},L.createElement(_re,{x:r,y:s,size:this.props.squareSize,symbol:n.symbol,color:this.getColorForAnnotation(n.color)}))})}renderArrowMarkers(){if(!this.props.arrowMarkers)return;const e=this.props.squareSize*Wy;return Object.entries(this.props.arrowMarkers).map(([n,r])=>{const s=n.substring(0,2),i=n.substring(2,4);if(s===i)return;let{x:o,y:a}=this.getSquareCoordinates(s),{x:u,y:l}=this.getSquareCoordinates(i);return o+=this.props.squareSize/2,a+=this.props.squareSize/2,u+=this.props.squareSize/2,l+=this.props.squareSize/2,u+=Math.sign(o-u)*nm*this.props.squareSize,l+=Math.sign(a-l)*nm*this.props.squareSize,L.createElement("line",{key:"arm-"+n,className:"kokopu-annotation kokopu-arrow",x1:o,y1:a,x2:u,y2:l,strokeWidth:e,stroke:this.getColorForAnnotation(r),markerEnd:`url(#${this.getArrowTipId(r)})`})})}renderMoveArrow(e){if(!this.props.move||e<.1||!this.props.moveArrowVisible||this.props.move.from()===this.props.move.to())return;const n=this.props.squareSize*Wy;let{x:r,y:s}=this.getSquareCoordinates(this.props.move.from());r+=this.props.squareSize/2,s+=this.props.squareSize/2;let{x:i,y:o}=this.getSquareCoordinates(this.props.move.to());i+=this.props.squareSize/2,o+=this.props.squareSize/2,i+=Math.sign(r-i)*nm*this.props.squareSize,o+=Math.sign(s-o)*nm*this.props.squareSize;const a=i*e+r*(1-e),u=o*e+s*(1-e);return L.createElement("line",{className:"kokopu-annotation kokopu-arrow",x1:r,y1:s,x2:a,y2:u,strokeWidth:n,stroke:this.getColorForAnnotation(this.props.moveArrowColor),markerEnd:`url(#${this.getArrowTipId(this.props.moveArrowColor)})`})}renderArrowTip(e){return L.createElement(JL,{id:this.getArrowTipId(e),color:this.getColorForAnnotation(e)})}renderTurnFlag(e){if(!this.props.turnVisible)return;const n=8*this.props.squareSize+Math.round(Qv*this.props.squareSize),r=e===(this.props.flipped?"b":"w")?7*this.props.squareSize:0;return L.createElement("image",{key:"turn-"+e,x:n,y:r,width:this.props.squareSize,height:this.props.squareSize,href:this.getURLForTurnFlag(e)})}renderRankCoordinate(e,n){const r=Math.round(-Zv*e)/2,s=(this.props.flipped?n+.5:7.5-n)*this.props.squareSize,i=die[n];return L.createElement("text",{key:"rank-"+i,className:"kokopu-coordinate",x:r,y:s,fontSize:e},i)}renderFileCoordinate(e,n){const r=(this.props.flipped?7.5-n:.5+n)*this.props.squareSize,s=8*this.props.squareSize+Math.round(Jv*e)/2,i=fie[n];return L.createElement("text",{key:"file-"+i,className:"kokopu-coordinate",x:r,y:s,fontSize:e},i)}handleDragStart(e,n,r){this.setState({inhibitedSquare:this.props.interactionMode==="movePieces"||this.props.interactionMode==="playMoves"?e:void 0,draggedSquare:e,hoveredSquare:e,cursorOffset:{x:n,y:r},dragPosition:{x:0,y:0}})}handleDrag(e,n,r){const{x:s,y:i}=this.getSquareCoordinates(e),o=this.getSquareAt(s+n+this.state.cursorOffset.x,i+r+this.state.cursorOffset.y);this.setState({hoveredSquare:o,dragPosition:{x:n,y:r}})}handleDragStop(e,n,r){const{x:s,y:i}=this.getSquareCoordinates(e),o=this.getSquareAt(s+n+this.state.cursorOffset.x,i+r+this.state.cursorOffset.y);if(this.setState({inhibitedSquare:void 0,draggedSquare:void 0,hoveredSquare:void 0}),!(e===o||!o)){if(this.props.interactionMode==="movePieces"&&this.props.onPieceMoved)this.props.onPieceMoved(e,o);else if(this.props.interactionMode==="editArrows"&&this.props.onArrowEdited)this.props.onArrowEdited(e,o);else if(this.props.interactionMode==="playMoves"){const a=this.getPositionStill(),u=a.isMoveLegal(e,o);if(!u)return;switch(u.status){case"regular":this.props.onMovePlayed&&this.props.onMovePlayed(a.notation(u()));break;case"promotion":this.setState({inhibitedSquare:e,promotionDrawer:{origin:o,buttons:a.variant()==="antichess"?["q","r","b","n","k"]:["q","r","b","n"],builder:l=>a.notation(u(l))}});break}}}}handleDragCanceled(){this.setState({inhibitedSquare:void 0,draggedSquare:void 0,hoveredSquare:void 0})}handleDrawerCancelButtonClicked(){this.setState({inhibitedSquare:void 0,promotionDrawer:void 0})}handleDrawerButtonClicked(e){const n=this.state.promotionDrawer.builder;this.setState({inhibitedSquare:void 0,promotionDrawer:void 0}),this.props.onMovePlayed&&this.props.onMovePlayed(n(e))}handleSquareClicked(e){this.props.onSquareClicked&&this.props.onSquareClicked(e)}getPositionStill(){if(!this.props.move)return this.props.position;const e=new et.Position(this.props.position);return e.play(this.props.move),e}getSquareCoordinates(e){const{file:n,rank:r}=et.squareToCoordinates(e),s=this.props.flipped?(7-n)*this.props.squareSize:n*this.props.squareSize,i=this.props.flipped?r*this.props.squareSize:(7-r)*this.props.squareSize;return{x:s,y:i}}getSquareAt(e,n){const r=this.props.flipped?7-Math.floor(e/this.props.squareSize):Math.floor(e/this.props.squareSize),s=this.props.flipped?Math.floor(n/this.props.squareSize):7-Math.floor(n/this.props.squareSize);return r>=0&&r<8&&s>=0&&s<8?et.coordinatesToSquare(r,s):void 0}getArrowTipId(e){return`kokopu-arrowTip-${e}-${this.arrowTipIdSuffix}`}getColorForAnnotation(e){return this.props.colorset["c"+e]}getURLForTurnFlag(e){return this.props.pieceset[e+"x"]}}function pie(t,e,n){let r=8*t,s=8*t;if(n&&(r+=t+Math.round(Qv*t)),e){const i=sF(t);r+=Math.round(Zv*i),s+=Math.round(Jv*i)}return{width:r,height:s}}function sF(t){return t<=32?8:8+(t-32)*.2}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function mie(t,e){if(t instanceof et.Position)return{error:!1,position:t};if(t==="start"||t==="empty")return{error:!1,position:new et.Position(t)};if(typeof t=="string")try{const{variant:n,fen:r}=gie(t),s=new et.Position(n,"empty");return s.fen(r),{error:!1,position:s}}catch(n){if(n instanceof et.exception.InvalidFEN)return{error:!0,errorBox:L.createElement(W0,{title:Er.INVALID_FEN_ERROR_TITLE,message:n.message})};throw n}else throw new ht(e,"position")}function gie(t){const e=t.indexOf(":");if(e<0)return{variant:"regular",fen:t};const n=t.substring(0,e);return et.isGameVariant(n)?{variant:n,fen:t.substring(e+1)}:{variant:"regular",fen:t}}function yie(t,e,n){if(e==null)return{error:!1,type:"none"};if(e instanceof et.MoveDescriptor)return{error:!1,type:"regular",move:e};if(typeof e=="string"){if(e==="--")return t.isNullMoveLegal()?{error:!1,type:"null-move"}:{error:!0,errorBox:L.createElement(W0,{title:Er.INVALID_NOTATION_ERROR_TITLE,message:et.i18n.ILLEGAL_NULL_MOVE})};try{return{error:!1,type:"regular",move:t.notation(e)}}catch(r){if(r instanceof et.exception.InvalidNotation)return{error:!0,errorBox:L.createElement(W0,{title:Er.INVALID_NOTATION_ERROR_TITLE,message:r.message})};throw r}}else throw new ht(n,"move")}function iF(t,e,n){if(t instanceof et.Game)return{error:!1,game:t};if(t instanceof et.Database||typeof t=="string"){if(!Number.isInteger(e)||e<0)throw new ht(n,"gameIndex");try{return{error:!1,game:t instanceof et.Database?t.game(e):et.pgnRead(t,e)}}catch(r){if(r instanceof et.exception.InvalidPGN)return{error:!0,errorBox:L.createElement(W0,{title:Er.INVALID_PGN_ERROR_TITLE,message:r.message,text:r.pgn,errorIndex:r.index,lineNumber:r.lineNumber})};throw r}}else throw new ht(n,"game")}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */class Wc extends L.Component{constructor(e){super(e),this.windowResizeListener=()=>this.handleWindowResize(),this.state={windowWidth:window.innerWidth}}componentDidMount(){window.addEventListener("resize",this.windowResizeListener)}componentWillUnmount(){window.removeEventListener("resize",this.windowResizeListener)}handleWindowResize(){this.setState({windowWidth:window.innerWidth})}render(){const e=mie(this.props.position,"Chessboard");if(e.error)return e.errorBox;let n=e.position;const r=yie(n,this.props.move,"Chessboard");if(r.error)return r.errorBox;const s=r.type==="regular"?r.move:void 0;r.type==="null-move"&&(n=new et.Position(n),n.playNullMove());const i=Hy(this.props.squareMarkers,"squareMarkers",xre,et.isSquare,Rf),o=Hy(this.props.textMarkers,"textMarkers",Sre,et.isSquare,bie),a=Hy(this.props.arrowMarkers,"arrowMarkers",Are,et.isSquareCouple,Rf),u=Xt(this.props.flipped),l=z0(this.props.squareSize,ma,_c,()=>new ht("Chessboard","squareSize")),c=Xt(this.props.coordinateVisible),d=Xt(this.props.turnVisible),f=Xt(this.props.moveArrowVisible);if(!Rf(this.props.moveArrowColor))throw new ht("Chessboard","moveArrowColor");const h=Xt(this.props.animated),p=ps[this.props.colorset];if(!p)throw new ht("Chessboard","colorset");const y=qa[this.props.pieceset];if(!y)throw new ht("Chessboard","pieceset");const b=Ky(this.props.smallScreenLimits,()=>new ht("Chessboard","smallScreenLimits")),g=jy(l,b,this.state.windowWidth),v=Gy(c,b,this.state.windowWidth),w=qy(d,b,this.state.windowWidth),x={squareSize:g,coordinateVisible:v,turnVisible:w},C=this.getInteractionModeAndValidateEditedArrowColor(),{onPieceMoved:k,onSquareClicked:P,onArrowEdited:N,onMovePlayed:$}=this.props,U=`${n.variant()}|${n.fen()}|${s?n.notation(s):""}`;return L.createElement(L.Fragment,null,this.props.topComponent?this.props.topComponent(x):void 0,L.createElement(hie,{key:U,position:n,move:s,squareMarkers:i,textMarkers:o,arrowMarkers:a,flipped:u,squareSize:g,coordinateVisible:v,turnVisible:w,moveArrowVisible:f,moveArrowColor:this.props.moveArrowColor,animated:h,colorset:p,pieceset:y,interactionMode:C,editedArrowColor:this.props.editedArrowColor,onPieceMoved:k,onSquareClicked:P,onArrowEdited:N,onMovePlayed:$}),this.props.bottomComponent?this.props.bottomComponent(x):void 0)}getInteractionModeAndValidateEditedArrowColor(){const e=Br(this.props.interactionMode,Mo);if(e===void 0||e==="movePieces"||e==="clickSquares"||e==="playMoves")return e;if(e==="editArrows"){if(!Rf(this.props.editedArrowColor))throw new ht("Chessboard","editedArrowColor");return e}else throw new ht("Chessboard","interactionMode")}static size(e){const{squareSize:n,coordinateVisible:r,turnVisible:s,smallScreenLimits:i,topComponent:o,bottomComponent:a}=V0(e,()=>new ht("Chessboard.size()","attr"));let u=n===void 0?nF:z0(n,ma,_c,()=>new ht("Chessboard.size()","squareSize")),l=r===void 0?!0:Xt(r),c=s===void 0?!0:Xt(s);const d=Ky(i,()=>new ht("Chessboard.size()","smallScreenLimits"));return typeof window<"u"&&(u=jy(u,d,window.innerWidth),l=Gy(l,d,window.innerWidth),c=qy(c,d,window.innerWidth)),WN(u,l,c,o,a)}static adaptSquareSize(e,n,r){const{coordinateVisible:s,turnVisible:i,smallScreenLimits:o,topComponent:a,bottomComponent:u}=V0(r,()=>new ht("Chessboard.adaptSquareSize()","attr"));e=U0(e,()=>new ht("Chessboard.adaptSquareSize()","width")),n=U0(n,()=>new ht("Chessboard.adaptSquareSize()","height"));let l=s===void 0?!0:Xt(s),c=i===void 0?!0:Xt(i);const d=Ky(o,()=>new ht("Chessboard.adaptSquareSize()","smallScreenLimits"));let f=_c;typeof window<"u"&&(f=jy(f,d,window.innerWidth),l=Gy(l,d,window.innerWidth),c=qy(c,d,window.innerWidth));function h(b){const{width:g,height:v}=WN(b,l,c,a,u);return g<=e&&v<=n}if(h(f))return f;if(!h(ma))return ma;let p=ma,y=f;for(;p+1<y;){const b=Math.floor((p+y)/2);h(b)?p=b:y=b}return p}static minSquareSize(){return ma}static maxSquareSize(){return _c}static colorsets(){return ps}static piecesets(){return qa}}Wc.defaultProps={...rF(),position:"start",flipped:!1};function WN(t,e,n,r,s){let{width:i,height:o}=pie(t,e,n);const a={squareSize:t,coordinateVisible:e,turnVisible:n};if(r){const{width:u,height:l}=r(a);i=Math.max(i,u),o+=l}if(s){const{width:u,height:l}=s(a);i=Math.max(i,u),o+=l}return{width:i,height:o}}function jy(t,e,n){const r=H2(e,n,s=>s.squareSize);return r===void 0?t:Math.min(t,r)}function Gy(t,e,n){const r=H2(e,n,s=>s.coordinateVisible);return r===void 0?t:t&&r}function qy(t,e,n){const r=H2(e,n,s=>s.turnVisible);return r===void 0?t:t&&r}function H2(t,e,n){let r=1/0,s;for(const i of t)e>i.width||n(i)===void 0||i.width<r&&(r=i.width,s=n(i));return s}function Hy(t,e,n,r,s){if(t!=null){if(typeof t=="string")return n(t);if(typeof t=="object"){const i={};return Object.entries(t).forEach(([o,a])=>{r(o)&&s(a)&&(i[o]=a)}),i}else throw new ht("Chessboard",e)}}function bie(t){return typeof t!="object"||t===null?!1:wre(t.symbol)&&Rf(t.color)}function Ky(t,e){if(t==null)return[];if(Array.isArray(t))return t.map(n=>{if(typeof n!="object"||n===null)throw e();return{width:U0(n.width,e),squareSize:Br(n.squareSize,r=>z0(r,ma,_c,e)),coordinateVisible:Br(n.coordinateVisible,Xt),turnVisible:Br(n.turnVisible,Xt)}});throw e()}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function vie(t){if(t==="native")return e=>e;if(t==="localized"){const e=Er.PIECE_SYMBOLS;return n=>jN(e,n)}else{if(t==="figurines")return e=>wie("alpha",e);if(vre(t))return e=>jN(t,e);throw new ht("moveFormatter","pieceSymbols")}}function jN(t,e){return e.replace(/[KQRBNP]/g,n=>t[n])}function wie(t,e){const n=[];let r=0,s=0;for(let i=0;i<e.length;++i){const o=e.charAt(i);if(o==="K"||o==="Q"||o==="R"||o==="B"||o==="N"||o==="P"){i>r&&n.push(e.substring(r,i)),r=i+1;const a="symbol-"+s++;n.push(L.createElement("span",{className:"kokopu-font-"+t,key:a},o))}}return r<e.length&&n.push(e.substring(r)),L.createElement(L.Fragment,null,n)}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */class oF extends L.Component{constructor(){super(...arguments),this.focusFieldRef=L.createRef()}render(){return L.createElement("div",{className:"kokopu-focusFieldContainer"},L.createElement("a",{className:"kokopu-focusField",href:"#",ref:this.focusFieldRef,onKeyDown:e=>this.handleKeyDown(e)}))}handleKeyDown(e){yf(e,"Home",this.props.onFirstPressed)||yf(e,"ArrowLeft",this.props.onPreviousPressed)||yf(e,"ArrowRight",this.props.onNextPressed)||yf(e,"End",this.props.onLastPressed)||yf(e,"Escape",this.props.onExitPressed)}focus(){const e=this.focusFieldRef.current;e&&e.focus()}}function yf(t,e,n){return t.key!==e?!1:(n&&(t.preventDefault(),n()),!0)}function j0(t,e){if(t.findById(e))return e==="start"?void 0:"start"}function G0(t,e){let n=t.findById(e);if(n&&!(n instanceof et.Variation&&(n=n.parentNode(),!n))){for(;n;){const r=n.previous();if(r)return r.id();n=n.parentVariation().parentNode()}return"start"}}function Hf(t,e){const n=t.findById(e);if(!n)return;const r=n instanceof et.Variation?n.first():n.next();return r?r.id():void 0}function q0(t,e){let n=t.findById(e);if(!n||(n=n instanceof et.Variation?n.first():n.next(),!n))return;let r=n;for(;;){const s=r.next();if(!s)return r.id();r=s}}const aF=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),uF=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var Xy;const xie=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),ew=(Xy=String.fromCodePoint)!==null&&Xy!==void 0?Xy:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function Sie(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=xie.get(t))!==null&&e!==void 0?e:t}var kn;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(kn||(kn={}));const Aie=32;var Ea;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Ea||(Ea={}));function tw(t){return t>=kn.ZERO&&t<=kn.NINE}function Eie(t){return t>=kn.UPPER_A&&t<=kn.UPPER_F||t>=kn.LOWER_A&&t<=kn.LOWER_F}function Cie(t){return t>=kn.UPPER_A&&t<=kn.UPPER_Z||t>=kn.LOWER_A&&t<=kn.LOWER_Z||tw(t)}function Nie(t){return t===kn.EQUALS||Cie(t)}var Tn;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(Tn||(Tn={}));var Yi;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Yi||(Yi={}));class lF{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=Tn.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Yi.Strict}startEntity(e){this.decodeMode=e,this.state=Tn.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case Tn.EntityStart:return e.charCodeAt(n)===kn.NUM?(this.state=Tn.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=Tn.NamedEntity,this.stateNamedEntity(e,n));case Tn.NumericStart:return this.stateNumericStart(e,n);case Tn.NumericDecimal:return this.stateNumericDecimal(e,n);case Tn.NumericHex:return this.stateNumericHex(e,n);case Tn.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|Aie)===kn.LOWER_X?(this.state=Tn.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=Tn.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(e.substr(n,i),s),this.consumed+=i}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const s=e.charCodeAt(n);if(tw(s)||Eie(s))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const s=e.charCodeAt(n);if(tw(s))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===kn.SEMI)this.consumed+=1;else if(this.decodeMode===Yi.Strict)return 0;return this.emitCodePoint(Sie(this.result),this.consumed),this.errors&&(e!==kn.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&Ea.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const o=e.charCodeAt(n);if(this.treeIndex=Tie(r,s,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return this.result===0||this.decodeMode===Yi.Attribute&&(i===0||Nie(o))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&Ea.VALUE_LENGTH)>>14,i!==0){if(o===kn.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Yi.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,s=(r[n]&Ea.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[e]&~Ea.VALUE_LENGTH:s[e+1],r),n===3&&this.emitCodePoint(s[e+2],r),r}end(){var e;switch(this.state){case Tn.NamedEntity:return this.result!==0&&(this.decodeMode!==Yi.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Tn.NumericDecimal:return this.emitNumericEntity(0,2);case Tn.NumericHex:return this.emitNumericEntity(0,3);case Tn.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Tn.EntityStart:return 0}}}function cF(t){let e="";const n=new lF(t,r=>e+=ew(r));return function(s,i){let o=0,a=0;for(;(a=s.indexOf("&",a))>=0;){e+=s.slice(o,a),n.startEntity(i);const l=n.write(s,a+1);if(l<0){o=a+n.end();break}o=a+l,a=l===0?o+1:o}const u=e+s.slice(o);return e="",u}}function Tie(t,e,n,r){const s=(e&Ea.BRANCH_LENGTH)>>7,i=e&Ea.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const u=r-i;return u<0||u>=s?-1:t[n+u]-1}let o=n,a=o+s-1;for(;o<=a;){const u=o+a>>>1,l=t[u];if(l<r)o=u+1;else if(l>r)a=u-1;else return t[u+s]}return-1}cF(aF);cF(uF);var De;(function(t){t[t.Tab=9]="Tab",t[t.NewLine=10]="NewLine",t[t.FormFeed=12]="FormFeed",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.ExclamationMark=33]="ExclamationMark",t[t.Number=35]="Number",t[t.Amp=38]="Amp",t[t.SingleQuote=39]="SingleQuote",t[t.DoubleQuote=34]="DoubleQuote",t[t.Dash=45]="Dash",t[t.Slash=47]="Slash",t[t.Zero=48]="Zero",t[t.Nine=57]="Nine",t[t.Semi=59]="Semi",t[t.Lt=60]="Lt",t[t.Eq=61]="Eq",t[t.Gt=62]="Gt",t[t.Questionmark=63]="Questionmark",t[t.UpperA=65]="UpperA",t[t.LowerA=97]="LowerA",t[t.UpperF=70]="UpperF",t[t.LowerF=102]="LowerF",t[t.UpperZ=90]="UpperZ",t[t.LowerZ=122]="LowerZ",t[t.LowerX=120]="LowerX",t[t.OpeningSquareBracket=91]="OpeningSquareBracket"})(De||(De={}));var oe;(function(t){t[t.Text=1]="Text",t[t.BeforeTagName=2]="BeforeTagName",t[t.InTagName=3]="InTagName",t[t.InSelfClosingTag=4]="InSelfClosingTag",t[t.BeforeClosingTagName=5]="BeforeClosingTagName",t[t.InClosingTagName=6]="InClosingTagName",t[t.AfterClosingTagName=7]="AfterClosingTagName",t[t.BeforeAttributeName=8]="BeforeAttributeName",t[t.InAttributeName=9]="InAttributeName",t[t.AfterAttributeName=10]="AfterAttributeName",t[t.BeforeAttributeValue=11]="BeforeAttributeValue",t[t.InAttributeValueDq=12]="InAttributeValueDq",t[t.InAttributeValueSq=13]="InAttributeValueSq",t[t.InAttributeValueNq=14]="InAttributeValueNq",t[t.BeforeDeclaration=15]="BeforeDeclaration",t[t.InDeclaration=16]="InDeclaration",t[t.InProcessingInstruction=17]="InProcessingInstruction",t[t.BeforeComment=18]="BeforeComment",t[t.CDATASequence=19]="CDATASequence",t[t.InSpecialComment=20]="InSpecialComment",t[t.InCommentLike=21]="InCommentLike",t[t.BeforeSpecialS=22]="BeforeSpecialS",t[t.BeforeSpecialT=23]="BeforeSpecialT",t[t.SpecialStartSequence=24]="SpecialStartSequence",t[t.InSpecialTag=25]="InSpecialTag",t[t.InEntity=26]="InEntity"})(oe||(oe={}));function To(t){return t===De.Space||t===De.NewLine||t===De.Tab||t===De.FormFeed||t===De.CarriageReturn}function rm(t){return t===De.Slash||t===De.Gt||To(t)}function _ie(t){return t>=De.LowerA&&t<=De.LowerZ||t>=De.UpperA&&t<=De.UpperZ}var Qi;(function(t){t[t.NoValue=0]="NoValue",t[t.Unquoted=1]="Unquoted",t[t.Single=2]="Single",t[t.Double=3]="Double"})(Qi||(Qi={}));const Mn={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97])};class Iie{constructor({xmlMode:e=!1,decodeEntities:n=!0},r){this.cbs=r,this.state=oe.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=oe.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=e,this.decodeEntities=n,this.entityDecoder=new lF(e?uF:aF,(s,i)=>this.emitCodePoint(s,i))}reset(){this.state=oe.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=oe.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(e){e===De.Lt||!this.decodeEntities&&this.fastForwardTo(De.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=oe.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===De.Amp&&this.startEntity()}stateSpecialStartSequence(e){const n=this.sequenceIndex===this.currentSequence.length;if(!(n?rm(e):(e|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!n){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=oe.InTagName,this.stateInTagName(e)}stateInSpecialTag(e){if(this.sequenceIndex===this.currentSequence.length){if(e===De.Gt||To(e)){const n=this.index-this.currentSequence.length;if(this.sectionStart<n){const r=this.index;this.index=n,this.cbs.ontext(this.sectionStart,n),this.index=r}this.isSpecial=!1,this.sectionStart=n+2,this.stateInClosingTagName(e);return}this.sequenceIndex=0}(e|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Mn.TitleEnd?this.decodeEntities&&e===De.Amp&&this.startEntity():this.fastForwardTo(De.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(e===De.Lt)}stateCDATASequence(e){e===Mn.Cdata[this.sequenceIndex]?++this.sequenceIndex===Mn.Cdata.length&&(this.state=oe.InCommentLike,this.currentSequence=Mn.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=oe.InDeclaration,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Mn.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=oe.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(e){return this.xmlMode?!rm(e):_ie(e)}startSpecial(e,n){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=n,this.state=oe.SpecialStartSequence}stateBeforeTagName(e){if(e===De.ExclamationMark)this.state=oe.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===De.Questionmark)this.state=oe.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){const n=e|32;this.sectionStart=this.index,this.xmlMode?this.state=oe.InTagName:n===Mn.ScriptEnd[2]?this.state=oe.BeforeSpecialS:n===Mn.TitleEnd[2]?this.state=oe.BeforeSpecialT:this.state=oe.InTagName}else e===De.Slash?this.state=oe.BeforeClosingTagName:(this.state=oe.Text,this.stateText(e))}stateInTagName(e){rm(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=oe.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateBeforeClosingTagName(e){To(e)||(e===De.Gt?this.state=oe.Text:(this.state=this.isTagStartChar(e)?oe.InClosingTagName:oe.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(e){(e===De.Gt||To(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=oe.AfterClosingTagName,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){(e===De.Gt||this.fastForwardTo(De.Gt))&&(this.state=oe.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(e){e===De.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=oe.InSpecialTag,this.sequenceIndex=0):this.state=oe.Text,this.sectionStart=this.index+1):e===De.Slash?this.state=oe.InSelfClosingTag:To(e)||(this.state=oe.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===De.Gt?(this.cbs.onselfclosingtag(this.index),this.state=oe.Text,this.sectionStart=this.index+1,this.isSpecial=!1):To(e)||(this.state=oe.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateInAttributeName(e){(e===De.Eq||rm(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=oe.AfterAttributeName,this.stateAfterAttributeName(e))}stateAfterAttributeName(e){e===De.Eq?this.state=oe.BeforeAttributeValue:e===De.Slash||e===De.Gt?(this.cbs.onattribend(Qi.NoValue,this.sectionStart),this.sectionStart=-1,this.state=oe.BeforeAttributeName,this.stateBeforeAttributeName(e)):To(e)||(this.cbs.onattribend(Qi.NoValue,this.sectionStart),this.state=oe.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(e){e===De.DoubleQuote?(this.state=oe.InAttributeValueDq,this.sectionStart=this.index+1):e===De.SingleQuote?(this.state=oe.InAttributeValueSq,this.sectionStart=this.index+1):To(e)||(this.sectionStart=this.index,this.state=oe.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))}handleInAttributeValue(e,n){e===n||!this.decodeEntities&&this.fastForwardTo(n)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(n===De.DoubleQuote?Qi.Double:Qi.Single,this.index+1),this.state=oe.BeforeAttributeName):this.decodeEntities&&e===De.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(e){this.handleInAttributeValue(e,De.DoubleQuote)}stateInAttributeValueSingleQuotes(e){this.handleInAttributeValue(e,De.SingleQuote)}stateInAttributeValueNoQuotes(e){To(e)||e===De.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Qi.Unquoted,this.index),this.state=oe.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===De.Amp&&this.startEntity()}stateBeforeDeclaration(e){e===De.OpeningSquareBracket?(this.state=oe.CDATASequence,this.sequenceIndex=0):this.state=e===De.Dash?oe.BeforeComment:oe.InDeclaration}stateInDeclaration(e){(e===De.Gt||this.fastForwardTo(De.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=oe.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===De.Gt||this.fastForwardTo(De.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=oe.Text,this.sectionStart=this.index+1)}stateBeforeComment(e){e===De.Dash?(this.state=oe.InCommentLike,this.currentSequence=Mn.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=oe.InDeclaration}stateInSpecialComment(e){(e===De.Gt||this.fastForwardTo(De.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=oe.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){const n=e|32;n===Mn.ScriptEnd[3]?this.startSpecial(Mn.ScriptEnd,4):n===Mn.StyleEnd[3]?this.startSpecial(Mn.StyleEnd,4):(this.state=oe.InTagName,this.stateInTagName(e))}stateBeforeSpecialT(e){const n=e|32;n===Mn.TitleEnd[3]?this.startSpecial(Mn.TitleEnd,4):n===Mn.TextareaEnd[3]?this.startSpecial(Mn.TextareaEnd,4):(this.state=oe.InTagName,this.stateInTagName(e))}startEntity(){this.baseState=this.state,this.state=oe.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?Yi.Strict:this.baseState===oe.Text||this.baseState===oe.InSpecialTag?Yi.Legacy:Yi.Attribute)}stateInEntity(){const e=this.entityDecoder.write(this.buffer,this.index-this.offset);e>=0?(this.state=this.baseState,e===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===oe.Text||this.state===oe.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===oe.InAttributeValueDq||this.state===oe.InAttributeValueSq||this.state===oe.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case oe.Text:{this.stateText(e);break}case oe.SpecialStartSequence:{this.stateSpecialStartSequence(e);break}case oe.InSpecialTag:{this.stateInSpecialTag(e);break}case oe.CDATASequence:{this.stateCDATASequence(e);break}case oe.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(e);break}case oe.InAttributeName:{this.stateInAttributeName(e);break}case oe.InCommentLike:{this.stateInCommentLike(e);break}case oe.InSpecialComment:{this.stateInSpecialComment(e);break}case oe.BeforeAttributeName:{this.stateBeforeAttributeName(e);break}case oe.InTagName:{this.stateInTagName(e);break}case oe.InClosingTagName:{this.stateInClosingTagName(e);break}case oe.BeforeTagName:{this.stateBeforeTagName(e);break}case oe.AfterAttributeName:{this.stateAfterAttributeName(e);break}case oe.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(e);break}case oe.BeforeAttributeValue:{this.stateBeforeAttributeValue(e);break}case oe.BeforeClosingTagName:{this.stateBeforeClosingTagName(e);break}case oe.AfterClosingTagName:{this.stateAfterClosingTagName(e);break}case oe.BeforeSpecialS:{this.stateBeforeSpecialS(e);break}case oe.BeforeSpecialT:{this.stateBeforeSpecialT(e);break}case oe.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(e);break}case oe.InSelfClosingTag:{this.stateInSelfClosingTag(e);break}case oe.InDeclaration:{this.stateInDeclaration(e);break}case oe.BeforeDeclaration:{this.stateBeforeDeclaration(e);break}case oe.BeforeComment:{this.stateBeforeComment(e);break}case oe.InProcessingInstruction:{this.stateInProcessingInstruction(e);break}case oe.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===oe.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length+this.offset;this.sectionStart>=e||(this.state===oe.InCommentLike?this.currentSequence===Mn.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===oe.InTagName||this.state===oe.BeforeAttributeName||this.state===oe.BeforeAttributeValue||this.state===oe.AfterAttributeName||this.state===oe.InAttributeName||this.state===oe.InAttributeValueSq||this.state===oe.InAttributeValueDq||this.state===oe.InAttributeValueNq||this.state===oe.InClosingTagName||this.cbs.ontext(this.sectionStart,e))}emitCodePoint(e,n){this.baseState!==oe.Text&&this.baseState!==oe.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+n,this.index=this.sectionStart-1,this.cbs.onattribentity(e)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+n,this.index=this.sectionStart-1,this.cbs.ontextentity(e,this.sectionStart))}}const nc=new Set(["input","option","optgroup","select","button","datalist","textarea"]),Ct=new Set(["p"]),GN=new Set(["thead","tbody"]),qN=new Set(["dd","dt"]),HN=new Set(["rt","rp"]),kie=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",Ct],["h1",Ct],["h2",Ct],["h3",Ct],["h4",Ct],["h5",Ct],["h6",Ct],["select",nc],["input",nc],["output",nc],["button",nc],["datalist",nc],["textarea",nc],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",qN],["dt",qN],["address",Ct],["article",Ct],["aside",Ct],["blockquote",Ct],["details",Ct],["div",Ct],["dl",Ct],["fieldset",Ct],["figcaption",Ct],["figure",Ct],["footer",Ct],["form",Ct],["header",Ct],["hr",Ct],["main",Ct],["nav",Ct],["ol",Ct],["pre",Ct],["section",Ct],["table",Ct],["ul",Ct],["rt",HN],["rp",HN],["tbody",GN],["tfoot",GN]]),Rie=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),KN=new Set(["math","svg"]),XN=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),Pie=/\s|\//;class Oie{constructor(e,n={}){var r,s,i,o,a,u;this.options=n,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(r=n.lowerCaseTags)!==null&&r!==void 0?r:this.htmlMode,this.lowerCaseAttributeNames=(s=n.lowerCaseAttributeNames)!==null&&s!==void 0?s:this.htmlMode,this.recognizeSelfClosing=(i=n.recognizeSelfClosing)!==null&&i!==void 0?i:!this.htmlMode,this.tokenizer=new((o=n.Tokenizer)!==null&&o!==void 0?o:Iie)(this.options,this),this.foreignContext=[!this.htmlMode],(u=(a=this.cbs).onparserinit)===null||u===void 0||u.call(a,this)}ontext(e,n){var r,s;const i=this.getSlice(e,n);this.endIndex=n-1,(s=(r=this.cbs).ontext)===null||s===void 0||s.call(r,i),this.startIndex=n}ontextentity(e,n){var r,s;this.endIndex=n-1,(s=(r=this.cbs).ontext)===null||s===void 0||s.call(r,ew(e)),this.startIndex=n}isVoidElement(e){return this.htmlMode&&Rie.has(e)}onopentagname(e,n){this.endIndex=n;let r=this.getSlice(e,n);this.lowerCaseTagNames&&(r=r.toLowerCase()),this.emitOpenTag(r)}emitOpenTag(e){var n,r,s,i;this.openTagStart=this.startIndex,this.tagname=e;const o=this.htmlMode&&kie.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[0]);){const a=this.stack.shift();(r=(n=this.cbs).onclosetag)===null||r===void 0||r.call(n,a,!0)}this.isVoidElement(e)||(this.stack.unshift(e),this.htmlMode&&(KN.has(e)?this.foreignContext.unshift(!0):XN.has(e)&&this.foreignContext.unshift(!1))),(i=(s=this.cbs).onopentagname)===null||i===void 0||i.call(s,e),this.cbs.onopentag&&(this.attribs={})}endOpenTag(e){var n,r;this.startIndex=this.openTagStart,this.attribs&&((r=(n=this.cbs).onopentag)===null||r===void 0||r.call(n,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1}onclosetag(e,n){var r,s,i,o,a,u,l,c;this.endIndex=n;let d=this.getSlice(e,n);if(this.lowerCaseTagNames&&(d=d.toLowerCase()),this.htmlMode&&(KN.has(d)||XN.has(d))&&this.foreignContext.shift(),this.isVoidElement(d))this.htmlMode&&d==="br"&&((o=(i=this.cbs).onopentagname)===null||o===void 0||o.call(i,"br"),(u=(a=this.cbs).onopentag)===null||u===void 0||u.call(a,"br",{},!0),(c=(l=this.cbs).onclosetag)===null||c===void 0||c.call(l,"br",!1));else{const f=this.stack.indexOf(d);if(f!==-1)for(let h=0;h<=f;h++){const p=this.stack.shift();(s=(r=this.cbs).onclosetag)===null||s===void 0||s.call(r,p,h!==f)}else this.htmlMode&&d==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=n+1}onselfclosingtag(e){this.endIndex=e,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)}closeCurrentTag(e){var n,r;const s=this.tagname;this.endOpenTag(e),this.stack[0]===s&&((r=(n=this.cbs).onclosetag)===null||r===void 0||r.call(n,s,!e),this.stack.shift())}onattribname(e,n){this.startIndex=e;const r=this.getSlice(e,n);this.attribname=this.lowerCaseAttributeNames?r.toLowerCase():r}onattribdata(e,n){this.attribvalue+=this.getSlice(e,n)}onattribentity(e){this.attribvalue+=ew(e)}onattribend(e,n){var r,s;this.endIndex=n,(s=(r=this.cbs).onattribute)===null||s===void 0||s.call(r,this.attribname,this.attribvalue,e===Qi.Double?'"':e===Qi.Single?"'":e===Qi.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(e){const n=e.search(Pie);let r=n<0?e:e.substr(0,n);return this.lowerCaseTagNames&&(r=r.toLowerCase()),r}ondeclaration(e,n){this.endIndex=n;const r=this.getSlice(e,n);if(this.cbs.onprocessinginstruction){const s=this.getInstructionName(r);this.cbs.onprocessinginstruction(`!${s}`,`!${r}`)}this.startIndex=n+1}onprocessinginstruction(e,n){this.endIndex=n;const r=this.getSlice(e,n);if(this.cbs.onprocessinginstruction){const s=this.getInstructionName(r);this.cbs.onprocessinginstruction(`?${s}`,`?${r}`)}this.startIndex=n+1}oncomment(e,n,r){var s,i,o,a;this.endIndex=n,(i=(s=this.cbs).oncomment)===null||i===void 0||i.call(s,this.getSlice(e,n-r)),(a=(o=this.cbs).oncommentend)===null||a===void 0||a.call(o),this.startIndex=n+1}oncdata(e,n,r){var s,i,o,a,u,l,c,d,f,h;this.endIndex=n;const p=this.getSlice(e,n-r);!this.htmlMode||this.options.recognizeCDATA?((i=(s=this.cbs).oncdatastart)===null||i===void 0||i.call(s),(a=(o=this.cbs).ontext)===null||a===void 0||a.call(o,p),(l=(u=this.cbs).oncdataend)===null||l===void 0||l.call(u)):((d=(c=this.cbs).oncomment)===null||d===void 0||d.call(c,`[CDATA[${p}]]`),(h=(f=this.cbs).oncommentend)===null||h===void 0||h.call(f)),this.startIndex=n+1}onend(){var e,n;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let r=0;r<this.stack.length;r++)this.cbs.onclosetag(this.stack[r],!0)}(n=(e=this.cbs).onend)===null||n===void 0||n.call(e)}reset(){var e,n,r,s;(n=(e=this.cbs).onreset)===null||n===void 0||n.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(s=(r=this.cbs).onparserinit)===null||s===void 0||s.call(r,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(e){this.reset(),this.end(e)}getSlice(e,n){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let r=this.buffers[0].slice(e-this.bufferOffset,n-this.bufferOffset);for(;n-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),r+=this.buffers[0].slice(0,n-this.bufferOffset);return r}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(e){var n,r;if(this.ended){(r=(n=this.cbs).onerror)===null||r===void 0||r.call(n,new Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)}end(e){var n,r;if(this.ended){(r=(n=this.cbs).onerror)===null||r===void 0||r.call(n,new Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(e){this.write(e)}done(e){this.end(e)}}var mt;(function(t){t.Root="root",t.Text="text",t.Directive="directive",t.Comment="comment",t.Script="script",t.Style="style",t.Tag="tag",t.CDATA="cdata",t.Doctype="doctype"})(mt||(mt={}));function Die(t){return t.type===mt.Tag||t.type===mt.Script||t.type===mt.Style}mt.Root;mt.Text;mt.Directive;mt.Comment;mt.Script;mt.Style;mt.Tag;mt.CDATA;mt.Doctype;let dF=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(e){this.parent=e}get previousSibling(){return this.prev}set previousSibling(e){this.prev=e}get nextSibling(){return this.next}set nextSibling(e){this.next=e}cloneNode(e=!1){return gF(this,e)}};class K2 extends dF{constructor(e){super(),this.data=e}get nodeValue(){return this.data}set nodeValue(e){this.data=e}}class nw extends K2{constructor(){super(...arguments),this.type=mt.Text}get nodeType(){return 3}}class fF extends K2{constructor(){super(...arguments),this.type=mt.Comment}get nodeType(){return 8}}class hF extends K2{constructor(e,n){super(n),this.name=e,this.type=mt.Directive}get nodeType(){return 1}}class X2 extends dF{constructor(e){super(),this.children=e}get firstChild(){var e;return(e=this.children[0])!==null&&e!==void 0?e:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(e){this.children=e}}class pF extends X2{constructor(){super(...arguments),this.type=mt.CDATA}get nodeType(){return 4}}class rw extends X2{constructor(){super(...arguments),this.type=mt.Root}get nodeType(){return 9}}let mF=class extends X2{constructor(e,n,r=[],s=e==="script"?mt.Script:e==="style"?mt.Style:mt.Tag){super(r),this.name=e,this.attribs=n,this.type=s}get nodeType(){return 1}get tagName(){return this.name}set tagName(e){this.name=e}get attributes(){return Object.keys(this.attribs).map(e=>{var n,r;return{name:e,value:this.attribs[e],namespace:(n=this["x-attribsNamespace"])===null||n===void 0?void 0:n[e],prefix:(r=this["x-attribsPrefix"])===null||r===void 0?void 0:r[e]}})}};function Lie(t){return Die(t)}function Fie(t){return t.type===mt.CDATA}function $ie(t){return t.type===mt.Text}function Bie(t){return t.type===mt.Comment}function Mie(t){return t.type===mt.Directive}function Vie(t){return t.type===mt.Root}function gF(t,e=!1){let n;if($ie(t))n=new nw(t.data);else if(Bie(t))n=new fF(t.data);else if(Lie(t)){const r=e?Yy(t.children):[],s=new mF(t.name,{...t.attribs},r);r.forEach(i=>i.parent=s),t.namespace!=null&&(s.namespace=t.namespace),t["x-attribsNamespace"]&&(s["x-attribsNamespace"]={...t["x-attribsNamespace"]}),t["x-attribsPrefix"]&&(s["x-attribsPrefix"]={...t["x-attribsPrefix"]}),n=s}else if(Fie(t)){const r=e?Yy(t.children):[],s=new pF(r);r.forEach(i=>i.parent=s),n=s}else if(Vie(t)){const r=e?Yy(t.children):[],s=new rw(r);r.forEach(i=>i.parent=s),t["x-mode"]&&(s["x-mode"]=t["x-mode"]),n=s}else if(Mie(t)){const r=new hF(t.name,t.data);t["x-name"]!=null&&(r["x-name"]=t["x-name"],r["x-publicId"]=t["x-publicId"],r["x-systemId"]=t["x-systemId"]),n=r}else throw new Error(`Not implemented yet: ${t.type}`);return n.startIndex=t.startIndex,n.endIndex=t.endIndex,t.sourceCodeLocation!=null&&(n.sourceCodeLocation=t.sourceCodeLocation),n}function Yy(t){const e=t.map(n=>gF(n,!0));for(let n=1;n<e.length;n++)e[n].prev=e[n-1],e[n-1].next=e[n];return e}const YN={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class Uie{constructor(e,n,r){this.dom=[],this.root=new rw(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof n=="function"&&(r=n,n=YN),typeof e=="object"&&(n=e,e=void 0),this.callback=e??null,this.options=n??YN,this.elementCB=r??null}onparserinit(e){this.parser=e}onreset(){this.dom=[],this.root=new rw(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(e){this.handleCallback(e)}onclosetag(){this.lastNode=null;const e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)}onopentag(e,n){const r=this.options.xmlMode?mt.Tag:void 0,s=new mF(e,n,void 0,r);this.addNode(s),this.tagStack.push(s)}ontext(e){const{lastNode:n}=this;if(n&&n.type===mt.Text)n.data+=e,this.options.withEndIndices&&(n.endIndex=this.parser.endIndex);else{const r=new nw(e);this.addNode(r),this.lastNode=r}}oncomment(e){if(this.lastNode&&this.lastNode.type===mt.Comment){this.lastNode.data+=e;return}const n=new fF(e);this.addNode(n),this.lastNode=n}oncommentend(){this.lastNode=null}oncdatastart(){const e=new nw(""),n=new pF([e]);this.addNode(n),e.parent=n,this.lastNode=e}oncdataend(){this.lastNode=null}onprocessinginstruction(e,n){const r=new hF(e,n);this.addNode(r)}handleCallback(e){if(typeof this.callback=="function")this.callback(e,this.dom);else if(e)throw e}addNode(e){const n=this.tagStack[this.tagStack.length-1],r=n.children[n.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),n.children.push(e),r&&(e.prev=r,r.next=e),e.parent=n,this.lastNode=null}}function zie(t,e){const n=new Uie(void 0,e);return new Oie(n,e).end(t),n.root}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */var Qy=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},sm=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Fm,Pf,$m;const Wie=new Set(["br","hr","img"]);function QN(t){let e=["span","a","b","strong","i","em","del","ins","s","u","sub","sup","abbr","q","cite","mark","small"];const n={"*":["class","id","title"],a:["href","target"]};t==="comment"&&(e=e.concat(["div","h1","h2","h3","h4","h5","h6","p","br","blockquote","img","pre","ul","ol","li"]),Object.assign(n,{img:["alt","src","height","width"]}));const r=new jie({allowedTags:e,allowedAttributes:n});return s=>r.parse(s)}class jie{constructor({allowedTags:e,allowedAttributes:n}){Fm.set(this,void 0),Pf.set(this,void 0),$m.set(this,0),Qy(this,Fm,e?new Set(e):new Set,"f"),Qy(this,Pf,n?new Map(Object.entries(n).map(([r,s])=>[r,new Set(s)])):new Map,"f")}parse(e){const n=zie(e);if(n.type!=="root")return;const r=[];if(n.children.forEach(s=>{const i=this.processNode(s);i&&r.push(i)}),r.length!==0)return r.length===1?r[0]:L.createElement(L.Fragment,{key:this.allocateKey()},r)}processNode(e){if(e.type==="text")return e.data;if(e.type==="tag"){const n=Wie.has(e.name)?void 0:e.children.map(r=>this.processNode(r));if(sm(this,Fm,"f").has(e.name)){const r=this.filterAttributes(e.name,e.attribs);return r.key=this.allocateKey(),L.createElement(e.name,r,n)}else return n?L.createElement(L.Fragment,{key:this.allocateKey()},n):void 0}else return}filterAttributes(e,n){const r={};for(const[s,i]of Object.entries(n))this.isAttributeAllowed(e,s)&&(r[s==="class"?"className":s]=i);return r}isAttributeAllowed(e,n){if(n==="key"||n==="ref"||n==="className")return!1;const r=sm(this,Pf,"f").get(e);if(r&&r.has(n))return!0;const s=sm(this,Pf,"f").get("*");return!!(s&&s.has(n))}allocateKey(){var e,n;return"auto-"+(Qy(this,$m,(n=sm(this,$m,"f"),e=n++,n),"f"),e)}}Fm=new WeakMap,Pf=new WeakMap,$m=new WeakMap;/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */class Gie extends L.Component{constructor(){super(...arguments),this.navigationFieldRef=L.createRef()}render(){return L.createElement("div",{className:"kokopu-movetext"},this.renderHeaders(),this.renderBody(),this.renderNavigationField())}renderHeaders(){if(!this.props.headerVisible)return;const e=QN("header"),n=[];return n.push(this.renderPlayerHeaders(e,"w")),n.push(this.renderPlayerHeaders(e,"b")),n.push(this.renderEventRoundHeaders(e)),n.push(this.renderDateSiteHeaders(e)),n.push(this.renderAnnotatorHeader(e)),n.some(r=>r!==void 0)?L.createElement("div",{className:"kokopu-headers"},n):void 0}renderPlayerHeaders(e,n){const r=this.props.game.playerName(n);if(r===void 0)return;const s=this.props.game.playerTitle(n),i=this.props.game.playerElo(n),o=["kokopu-headerGroup-player",n==="w"?"kokopu-headerGroup-whitePlayer":"kokopu-headerGroup-blackPlayer"],a=L.createElement("span",{className:"kokopu-colorTag"}),u=L.createElement("span",{className:"kokopu-header-playerName"},e(r)),l=s===void 0?void 0:L.createElement("span",{className:"kokopu-header-playerTitle"},e(s)),c=i===void 0?void 0:L.createElement("span",{className:"kokopu-header-playerRating"},i),d=s===void 0||i===void 0?void 0:"",f=s===void 0&&i===void 0?void 0:L.createElement("span",{className:"kokopu-headerGroup-titleRating"},l,d,c);return L.createElement("div",{className:o.join(" "),key:"player-"+n},a,u,f)}renderEventRoundHeaders(e){const n=this.props.game.event();if(n===void 0)return;const r=this.props.game.fullRound(),s=r===void 0?void 0:L.createElement("span",{className:"kokopu-header-round"},r),i=L.createElement("span",{className:"kokopu-header-event"},e(n));return L.createElement("div",{className:"kokopu-headerGroup-eventRound",key:"event-round"},i,s)}renderDateSiteHeaders(e){const n=this.props.game.dateAsString(),r=this.props.game.site();if(n===void 0&&r===void 0)return;const s=n===void 0?void 0:L.createElement("span",{className:"kokopu-header-date"},qie(n)),i=r===void 0?void 0:L.createElement("span",{className:"kokopu-header-site"},e(r)),o=n===void 0||r===void 0?void 0:"";return L.createElement("div",{className:"kokopu-headerGroup-dateSite",key:"date-site"},s,o,i)}renderAnnotatorHeader(e){const n=this.props.game.annotator();if(n!==void 0)return L.createElement("div",{className:"kokopu-header-annotator",key:"annotator"},e(ZL(Er.ANNOTATED_BY,n)))}renderNavigationField(){if(this.props.interactionMode==="selectMove")return L.createElement(oF,{ref:this.navigationFieldRef,onFirstPressed:()=>this.handleNavigationPressed(j0,"key-first"),onPreviousPressed:()=>this.handleNavigationPressed(G0,"key-previous"),onNextPressed:()=>this.handleNavigationPressed(Hf,"key-next"),onLastPressed:()=>this.handleNavigationPressed(q0,"key-last"),onExitPressed:()=>this.handleExitPressed()})}renderBody(){const e=QN("comment");return this.renderVariation(e,this.props.game.mainVariation(),!0,this.props.game.result())}renderVariation(e,n,r,s){const i=[];let o=[];function a(){!n.isLongVariation()||o.length===0||(i.push(L.createElement("div",{className:"kokopu-moveGroup",key:"group-"+i.length},o)),o=[])}const u=this.extractComment(n);u!==void 0&&(n.isLongComment()?i.push(this.renderComment(e,n,u)):o.push(this.renderComment(e,n,u)));let l=!0,c=n.first();for(;c!==void 0;){o.push(this.renderMove(c,l));const f=this.extractComment(c);f!==void 0&&(c.isLongComment()?(a(),i.push(this.renderComment(e,c,f))):o.push(this.renderComment(e,c,f)));let h=!1;for(const p of c.variations()){const y=this.renderVariation(e,p,!1);y&&(p.isLongVariation()?(a(),i.push(y)):o.push(y),h=!0)}l=f!==void 0||h,c=c.next()}r&&s!=="*"&&o.push(L.createElement("span",{className:"kokopu-gameResult",key:"game-result"},Hie(s))),a();const d=n.isLongVariation()?i:o;if(d.length!==0)return r?L.createElement("div",{className:"kokopu-variation kokopu-mainVariation",key:n.id()},d):n.isLongVariation()?L.createElement("div",{className:"kokopu-variation kokopu-subVariation",key:n.id()},d):L.createElement("span",{className:"kokopu-variation kokopu-subVariation",key:n.id()},d)}renderMove(e,n){let r;if(n||e.moveColor()==="w"){const l=e.fullMoveNumber()+(e.moveColor()==="w"?".":"");r=L.createElement("span",{className:"kokopu-moveNumber"},l)}const s=this.props.moveFormatter(e.notation()),i=e.nags().map(l=>L.createElement("span",{className:"kokopu-nag",key:l},et.nagSymbol(l))),o=e.id(),a=["kokopu-move"];let u;return this.props.selection&&this.props.selection===o&&a.push("kokopu-selectedMove"),this.props.interactionMode==="selectMove"&&(a.push("kokopu-clickableMove"),u=()=>this.handleNodeClicked(o)),L.createElement("span",{className:a.join(" "),key:e.id()},L.createElement("span",{className:"kokopu-moveContent",onClick:u},r,L.createElement("span",{className:"kokopu-moveNotation"},s),i.length===0?void 0:i))}renderComment(e,n,r){let s;if(this.props.diagramVisible&&r.includes("[#]")){const o=[];let a=!0,u=0;for(let l of r.split("[#]")){if(!a){const c=n instanceof et.Variation?n.initialPosition():n.position(),d=L.createElement(Wc,{position:c,squareMarkers:n.tag("csl"),arrowMarkers:n.tag("cal"),textMarkers:n.tag("ctl"),flipped:this.props.diagramOptions.flipped,squareSize:this.props.diagramOptions.squareSize,coordinateVisible:this.props.diagramOptions.coordinateVisible,turnVisible:this.props.diagramOptions.turnVisible,colorset:this.props.diagramOptions.colorset,pieceset:this.props.diagramOptions.pieceset,smallScreenLimits:this.props.diagramOptions.smallScreenLimits});o.push(L.createElement("div",{className:"kokopu-diagram",key:"diagram-"+u++},d))}a=!1,l=l.trim(),l.length!==0&&o.push(e(l))}s=o}else s=e(r);const i=n.id()+"-comment";return n.isLongComment()?L.createElement("div",{className:"kokopu-comment",key:i},s):L.createElement("span",{className:"kokopu-comment",key:i},s)}extractComment(e){let n=e.comment();return n&&(this.props.diagramVisible||(n=n.replace(/\[#\]/g," ")),n=n.replace(/\s+/g," ").trim()),n||void 0}handleNavigationPressed(e,n){this.props.selection&&this.fireMoveSelected(e(this.props.game,this.props.selection),n)}handleExitPressed(){this.props.selection&&this.props.game.findById(this.props.selection)&&this.fireMoveSelected(void 0,"key-exit")}fireMoveSelected(e,n){(e||n==="key-exit")&&this.props.onMoveSelected&&this.props.onMoveSelected(e,n)}handleNodeClicked(e){this.focus(),this.props.onMoveSelected&&this.props.onMoveSelected(e===this.props.selection?void 0:e,"click")}focus(){const e=this.navigationFieldRef.current;e&&e.focus()}}function qie(t){return t.length===0?"":t.charAt(0).toUpperCase()+t.slice(1)}function Hie(t){switch(t){case"1/2-1/2":return"";case"1-0":return"10";case"0-1":return"01"}}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */class Kie extends L.Component{constructor(){super(...arguments),this.implRef=L.createRef()}render(){const e=iF(this.props.game,this.props.gameIndex,"Movetext");if(e.error)return e.errorBox;if(typeof this.props.diagramOptions!="object"||this.props.diagramOptions===null)throw new ht("Movetext","diagramOptions");const n=vie(this.props.pieceSymbols),r=Xt(this.props.diagramVisible),s=Xt(this.props.headerVisible),i=Br(this.props.selection,Mo),o=this.getInteractionMode(),{onMoveSelected:a}=this.props;return L.createElement(Gie,{ref:this.implRef,game:e.game,diagramOptions:this.props.diagramOptions,moveFormatter:n,diagramVisible:r,headerVisible:s,selection:i,interactionMode:o,onMoveSelected:a})}getInteractionMode(){const e=Br(this.props.interactionMode,Mo);if(e===void 0||e==="selectMove")return e;throw new ht("Movetext","interactionMode")}focus(){const e=this.implRef.current;e&&e.focus()}static firstNodeId(e,n){return j0(e,n)}static previousNodeId(e,n){return G0(e,n)}static nextNodeId(e,n){return Hf(e,n)}static lastNodeId(e,n){return q0(e,n)}}Kie.defaultProps={game:new et.Game,gameIndex:0,diagramOptions:{},pieceSymbols:"native",diagramVisible:!0,headerVisible:!0};/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function Xie(t){return typeof t!="object"||t===null?!1:typeof t.iconPath=="string"&&(t.tooltip===void 0||typeof t.tooltip=="string")&&(t.enabled===void 0||typeof t.enabled=="boolean")&&(t.onClick===void 0||typeof t.onClick=="function")}function Yie(t){if(Array.isArray(t)){for(const e of t)if(!(Xie(e)||e==="spacer"))return!1;return!0}else return!1}function ZN(t){if(Array.isArray(t)){for(const e of t)if(!(e==="button"||e==="spacer"))return!1;return!0}else return!1}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const Wn=2,rc=7,sc=5,Qie=16;function ad(t,e,n){const r=t-n*Wn*Math.sqrt(2)/2,s=t-n*(rc+Wn/Math.sqrt(2)/2),i=t-n*(rc-Wn/Math.sqrt(2)/2),o=t+n*Wn*Math.sqrt(2)/2,a=e-n*(rc-Wn/Math.sqrt(2)/2),u=e-n*(rc+Wn/Math.sqrt(2)/2),l=e+n*(rc+Wn/Math.sqrt(2)/2),c=e+n*(rc-Wn/Math.sqrt(2)/2);return`M ${r} ${e} L ${s} ${a} L ${i} ${u} L ${o} ${e} L ${i} ${l} L ${s} ${c} Z`}function JN(t,e,n){const r=t-n*(sc+Wn/Math.sqrt(2)/2),s=t-n*(sc-Wn/Math.sqrt(2)/2),i=t-n*Wn/2,o=t+n*Wn/2,a=t+n*(sc-Wn/Math.sqrt(2)/2),u=t+n*(sc+Wn/Math.sqrt(2)/2),l=e-n*Wn*Math.sqrt(2)/2,c=l-n*(sc-Wn/Math.sqrt(2)/2),d=l-n*(sc+Wn/Math.sqrt(2)/2),f=d+(i-s),h=e-n*Qie;return`M ${t} ${e} L ${r} ${c} L ${s} ${d} L ${i} ${f} V ${h} H ${o} V ${f} L ${a} ${d} L ${u} ${c} Z`}const Zie=ad(14,16,-1)+" "+ad(10,16,-1),Jie=ad(12,16,-1),eoe=ad(20,16,1),toe=ad(18,16,1)+" "+ad(22,16,1),noe="M 23 16 L 12 23 V 9 Z",roe="M 11 11 H 21 V 21 H 11 Z",soe=JN(11,25,1)+" "+JN(21,7,-1);/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */function ioe({squareSize:t,buttons:e}){const n=yF(t),r=bF(t),s=[];let i=!1;for(let o=0;o<e.length;++o){const a=e[o];a!=="spacer"&&(i&&e[o-1]==="spacer"&&s.push(L.createElement("div",{key:s.length,className:"kokopu-navigationSpacer",style:{width:r}})),i=!0,s.push(L.createElement(ooe,{key:s.length,tooltip:a.tooltip,iconPath:a.iconPath,enabled:a.enabled,onClick:a.onClick,size:n,spaceOnLeft:o===0||e[o-1]==="spacer",spaceOnRight:o===e.length-1||e[o+1]==="spacer"})))}return L.createElement("div",{className:"kokopu-navigationToolbar",style:{marginTop:vF(t)}},s)}function ooe({size:t,spaceOnLeft:e,spaceOnRight:n,iconPath:r,tooltip:s,enabled:i,onClick:o}){const a=e?"A 16 16 0 0 0 16 32":"L 1 0 L 1 32 L 16 32",u=n?"A 16 16 0 0 0 16 0":"L 31 32 L 31 0 L 16 0",l=i??!0;return L.createElement("div",{className:l?"kokopu-enabledNavigationButton":"kokopu-disabledNavigationButton",title:s,onClick:l?o:void 0},L.createElement("svg",{viewBox:"0 0 32 32",width:t,height:t},L.createElement("path",{d:`M 16 0 ${a} ${u} Z ${r}`,fill:"currentcolor"})))}function eT(t,e){const n=yF(t),r=bF(t);let s=0,i=!1;for(let o=0;o<e.length;++o)e[o]!=="spacer"&&(i&&e[o-1]==="spacer"&&(s+=r),i=!0,s+=n);return{width:s,height:n+vF(t)}}function yF(t){return Math.round((t*2+116)/7)}function bF(t){return Math.round((t*2+116)/14)}function vF(t){return Math.round((t*2+116)/28)}/*!
 * -------------------------------------------------------------------------- *
 *                                                                            *
 *    Kokopu-React - A React-based library of chess-related components.       *
 *    <https://www.npmjs.com/package/kokopu-react>                            *
 *    Copyright (C) 2021-2024  Yoann Le Montagner <yo35 -at- melix.net>       *
 *                                                                            *
 *    Kokopu-React is free software: you can redistribute it and/or           *
 *    modify it under the terms of the GNU Lesser General Public License      *
 *    as published by the Free Software Foundation, either version 3 of       *
 *    the License, or (at your option) any later version.                     *
 *                                                                            *
 *    Kokopu-React is distributed in the hope that it will be useful,         *
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of          *
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the            *
 *    GNU Lesser General Public License for more details.                     *
 *                                                                            *
 *    You should have received a copy of the GNU Lesser General               *
 *    Public License along with this program. If not, see                     *
 *    <http://www.gnu.org/licenses/>.                                         *
 *                                                                            *
 * -------------------------------------------------------------------------- */const aoe=1e3;class sw extends L.Component{constructor(e){super(e),this.navigationFieldRef=L.createRef(),this.state={nodeIdAsUncontrolled:Mo(e.initialNodeId),isPlayingAsUncontrolled:Xt(e.initialIsPlaying),flippedAsUncontrolled:Xt(e.initialFlipped)}}componentWillUnmount(){this.cancelCurrentTimeout()}render(){this.cancelCurrentTimeout();const e=iF(this.props.game,this.props.gameIndex,"NavigationBoard");if(e.error)return e.errorBox;const n=Br(this.props.nodeId,Mo)??this.state.nodeIdAsUncontrolled,r=e.game.findById(n)??e.game.mainVariation(),s=Br(this.props.isPlaying,Xt)??this.state.isPlayingAsUncontrolled,i=Br(this.props.flipped,Xt)??this.state.flippedAsUncontrolled;return L.createElement("div",{className:"kokopu-navigationBoard"},this.renderBoard(e.game,r,s,i),this.renderNavigationField(e.game,r.id()))}renderBoard(e,n,r,s){const i=n instanceof et.Node?n.positionBefore():n.initialPosition(),o=n instanceof et.Node?n.notation():void 0;return L.createElement(Wc,{position:i,move:o,flipped:s,squareMarkers:n.tag("csl"),arrowMarkers:n.tag("cal"),textMarkers:n.tag("ctl"),squareSize:this.props.squareSize,coordinateVisible:this.props.coordinateVisible,turnVisible:this.props.turnVisible,colorset:this.props.colorset,pieceset:this.props.pieceset,smallScreenLimits:this.props.smallScreenLimits,moveArrowVisible:this.props.moveArrowVisible,moveArrowColor:this.props.moveArrowColor,animated:this.props.animated,bottomComponent:({squareSize:a})=>this.renderToolbar(e,n,a,r)})}renderNavigationField(e,n){return L.createElement(oF,{ref:this.navigationFieldRef,onFirstPressed:()=>this.handleNavClicked(j0(e,n)),onPreviousPressed:()=>this.handleNavClicked(G0(e,n)),onNextPressed:()=>this.handleNavClicked(Hf(e,n)),onLastPressed:()=>this.handleNavClicked(q0(e,n))})}renderToolbar(e,n,r,s){const i=[],o=n.id(),a=o!=="start",u=(n instanceof et.Variation?n.first():n.next())!==void 0;if(i.push({iconPath:Zie,tooltip:Er.TOOLTIP_GO_FIRST,enabled:a,onClick:()=>this.handleNavClicked(j0(e,o))}),i.push({iconPath:Jie,tooltip:Er.TOOLTIP_GO_PREVIOUS,enabled:a,onClick:()=>this.handleNavClicked(G0(e,o))}),Xt(this.props.playButtonVisible)&&i.push({iconPath:s?roe:noe,tooltip:Er.TOOLTIP_PLAY_STOP,enabled:u,onClick:()=>this.handlePlayStopClicked(!s)}),i.push({iconPath:eoe,tooltip:Er.TOOLTIP_GO_NEXT,enabled:u,onClick:()=>this.handleNavClicked(Hf(e,o))}),i.push({iconPath:toe,tooltip:Er.TOOLTIP_GO_LAST,enabled:u,onClick:()=>this.handleNavClicked(q0(e,o))}),i.push("spacer"),Xt(this.props.flipButtonVisible)&&i.push({iconPath:soe,tooltip:Er.TOOLTIP_FLIP,onClick:()=>this.handleFlipButtonClicked()}),i.push("spacer"),s&&(u?this.timeoutId=window.setTimeout(()=>this.handleNavClicked(Hf(e,o),!1),aoe):this.timeoutId=window.setTimeout(()=>this.handlePlayStopClicked(!1,!1),0)),!Yie(this.props.additionalButtons))throw new ht("NavigationBoard","additionalButtons");for(const l of this.props.additionalButtons)i.push(l);return L.createElement(ioe,{squareSize:r,buttons:i})}handleNavClicked(e,n=!0){n&&this.focus(),e!==void 0&&(this.props.nodeId===void 0?this.setState({nodeIdAsUncontrolled:e}):this.props.onNodeIdChanged&&this.props.onNodeIdChanged(e))}handlePlayStopClicked(e,n=!0){n&&this.focus(),this.props.isPlaying===void 0?this.setState({isPlayingAsUncontrolled:e}):this.props.onIsPlayingChanged&&this.props.onIsPlayingChanged(e)}handleFlipButtonClicked(){this.focus(),this.props.flipped===void 0?this.setState({flippedAsUncontrolled:!this.state.flippedAsUncontrolled}):this.props.onFlippedChanged&&this.props.onFlippedChanged(!this.props.flipped)}cancelCurrentTimeout(){this.timeoutId!==void 0&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)}focus(){const e=this.navigationFieldRef.current;e&&e.focus()}static size(e){const{squareSize:n,coordinateVisible:r,turnVisible:s,smallScreenLimits:i,playButtonVisible:o,flipButtonVisible:a,additionalButtons:u}=V0(e,()=>new ht("NavigationBoard.size()","attr")),l=Br(o,Xt),c=Br(a,Xt);if(u!==void 0&&!ZN(u))throw new ht("NavigationBoard.size()","additionalButtons");const d=tT(l,c,u);return Wc.size({squareSize:n,coordinateVisible:r,turnVisible:s,smallScreenLimits:i,bottomComponent:({squareSize:f})=>eT(f,d)})}static adaptSquareSize(e,n,r){const{coordinateVisible:s,turnVisible:i,smallScreenLimits:o,playButtonVisible:a,flipButtonVisible:u,additionalButtons:l}=V0(r,()=>new ht("NavigationBoard.adaptSquareSize()","attr")),c=Br(a,Xt),d=Br(u,Xt);if(l!==void 0&&!ZN(l))throw new ht("NavigationBoard.adaptSquareSize()","additionalButtons");const f=tT(c,d,l);return Wc.adaptSquareSize(e,n,{coordinateVisible:s,turnVisible:i,smallScreenLimits:o,bottomComponent:({squareSize:h})=>eT(h,f)})}}sw.defaultProps={...rF(),game:new et.Game,gameIndex:0,initialNodeId:"start",initialIsPlaying:!1,initialFlipped:!1,playButtonVisible:!1,flipButtonVisible:!0,additionalButtons:[]};function tT(t,e,n){const r=[];if(r.push("button"),r.push("button"),(t??sw.defaultProps.playButtonVisible)&&r.push("button"),r.push("button"),r.push("button"),r.push("spacer"),(e??sw.defaultProps.flipButtonVisible)&&r.push("button"),r.push("spacer"),n!==void 0)for(const s of n)r.push(s);return r}const Kh=t=>{const e=wd(),n=()=>_.jsx(Wc,{turnVisible:!1,squareSize:20,position:e.fen,coordinateVisible:!1}),r=()=>_.jsx("div",{className:"text-white",children:t.text.map(function(i,o){return _.jsx("div",{children:i},o)})}),s=()=>_.jsxs("div",{className:"btn-group w-100",role:"group",children:[_.jsx(qJ,{setText:t.setText,playing:t.playing}),_.jsx(Bee,{})]});return _.jsx("div",{ref:t.sidebarRef,className:"d-flex flex-column text-center mx-1",style:{minWidth:"200px"},children:_.jsxs("ul",{className:"nav nav-pills flex-column",children:[_.jsx("li",{className:"my-1",style:{display:t.playing?"inline-block":"none"},children:n()}),t.children,_.jsx("li",{className:"border-top"}),_.jsx("li",{className:"my-1",children:r()}),_.jsx("li",{className:"border-top"}),_.jsx("li",{className:"my-1",children:s()})]})})},wF=t=>_.jsx("div",{className:"d-flex bg-dark h-100",children:t.children}),xF=(t,e,n,r)=>{const[s,i,o,a,u]=_D(t);ID(s,e,"blue",a,u),IY(s,n,"blue",a,u);for(let l=0;l<64;l++){let c=.1,d=-1;for(let p=0;p<12;p++)r[l][p]>c&&(c=r[l][p],d=p);if(d===-1)continue;const f=qC[d%qC.length],h=`${CD[d]}:${Math.round(100*c)}`;kY(s,f,e[l][0]*a,e[l][1]*u,h,i,o)}},Zy=(t,e,n=.6,r=.6)=>{let s=0;e.from.forEach(i=>{s+=1-Math.max(...t[i])-n});for(let i=0;i<e.to.length;i++)s+=t[e.to[i]][e.targets[i]]-r;return s},uoe=(t,e,n)=>{let r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=null,a=null;const u=new Set;return e.forEach(l=>{if(!(l.move1.sans[0]in u)){u.add(l.move1.sans[0]);const f=Zy(t,l.move1);f>0&&n.add(l.move1.sans[0]),f>r&&(o=l.move1,r=f)}if(l.move2===null||l.moves===null||!n.has(l.move1.sans[0]))return;const c=Zy(t,l.move2);if(c<0)return;c>s&&(s=c);const d=Zy(t,l.moves);d>i&&(i=d,a=l.moves)}),{bestScore1:r,bestScore2:s,bestJointScore:i,bestMove:o,bestMoves:a}},loe=t=>qe(()=>{const n=Le(t,[0,0],[-1,1]),r=Le(t,[0,2],[-1,1]),s=Le(t,[0,3],[-1,1]),i=ut(ke(n,r),2),o=Oe(s,ut(Oe(r,n),3));return dn([i,o],1)}),SF=(t,e,n)=>qe(()=>{const s=ss(loe(t),1),i=Rt(Hs(Oe(s,e)),2),o=DO(i,1),a=dn([Le(n,[0,1,0],[1,3,2]),Le(n,[0,0,0],[1,1,2])],1),u=s.shape[0],l=Lo(Oe(Le(n,[0,0,0],[1,4,1]),Le(a,[0,0,0],[1,4,1])),[2]),c=Lo(Oe(Le(n,[0,0,1],[1,4,1]),Le(a,[0,0,1],[1,4,1])),[2]),d=Lo(Oe(Le(s,[0,0,0],[u,1,1]),Le(a,[0,0,0],[1,4,1])),[2]),f=Lo(Oe(Le(s,[0,0,1],[u,1,1]),Le(a,[0,0,1],[1,4,1])),[2]),h=Oe(fe(l,f),fe(c,d));return $o(PO(P0(h,0),1),Ye(-1),o).arraySync()}),AF=(t,e)=>{const n=GD(64,12),r=t.arraySync();for(let s=0;s<e.length;s++){const i=e[s];if(i!=-1)for(let o=0;o<12;o++)n[i][o]=Math.max(n[i][o],r[s][o])}return n},coe=(t,e,n=.5)=>{for(let r=0;r<64;r++)for(let s=0;s<12;s++)t[r][s]=n*t[r][s]+(1-n)*e[r][s];return t},doe=(t,e)=>{t.move(e);const n=t.history({verbose:!0}),r=n[n.length-1].lan;return t.undo(),r},EF=async(t,e,n)=>{const{image4D:r,width:s,height:i,padding:o,roi:a}=E2(e,n),u=e.current.videoWidth,l=e.current.videoHeight,c=t.current.predict(r),{boxes:d,scores:f}=C2(c,s,i,u,l,o,a);return rn([r,c]),{boxes:d,scores:f}},CF=(t,e)=>b2.map(r=>zD(t.current[r],e.current.height,e.current.width)),foe=(t,e,n,r,s,i,o,a,u,l,c,d)=>{let f=null,h,p,y,b,g,v,w,x;const C=async()=>{if(r.current===!1||A2(e))f=null;else{if(f===null){g=CF(o,n);const se=BD(g);[f,p]=MD(se),[h,y]=VD(se),b=GD(64,12),v=new Set,x={}}const k=performance.now(),P=sd().numTensors,{boxes:N,scores:$}=await EF(t,e,g),U=SF(N,p,y),K=AF($,U);b=coe(b,K);const{bestScore1:Z,bestScore2:ie,bestJointScore:ee,bestMove:j,bestMoves:M}=uoe(b,u.current,v),O=performance.now(),D=(1e3/(O-k)).toFixed(1);let V=!1;if(M!==null&&d!=="play"){const se=M.sans[0];V=ie>0&&ee>0&&v.has(se),V&&(a.current.move(se),v.clear(),x={})}let F=!1;if(j!==null&&!V&&Z>0){const se=j.sans[0];se in x||(x[se]=O);const he=O-x[se]>1e3,ae=doe(a.current,se)!==l.current;F=he&&ae,F&&(a.current.move(se),x={greedyMove:x[se]})}if(V||F){const se=d==="play"?!1:F,he=k2(a.current,se);console.log("payload",he),i(R2(he))}s([`FPS: ${D}`,c.current]),xF(n.current,f,h,b),rn([N,$]);const ue=sd().numTensors;P<ue&&console.error(`Memory Leak! (${ue} > ${P})`)}w=requestAnimationFrame(C)};return w=requestAnimationFrame(C),()=>{Vx(),w&&window.cancelAnimationFrame(w)}},hoe=t=>{const e=L.useRef(t);return L.useEffect(()=>{e.current=t}),e},poe=(t,e=100,n=!1)=>{const r=hoe(t),s=L.useRef(),i=[e,n,r];function o(){s.current&&clearTimeout(s.current),s.current=void 0}L.useEffect(()=>o,i);function a(){s.current=void 0}return L.useCallback(function(){const u=arguments,{current:l}=s;if(l===void 0&&n)return s.current=setTimeout(a,e),r.current.apply(null,u);l&&clearTimeout(l),s.current=setTimeout(()=>{s.current=void 0,r.current.apply(null,u)},e)},i)},moe=(t,e,n)=>{const r=L.useState(t);return[r[0],poe(r[1],e,n)]};function Jy(t,e,n,r){const s=L.useRef(n),i=L.useRef(r);L.useEffect(()=>{s.current=n,i.current=r}),L.useEffect(()=>{const o=t&&"current"in t?t.current:t;if(!o)return;let a=0;function u(...c){a||s.current.apply(this,c)}o.addEventListener(e,u);const l=i.current;return()=>{a=1,o.removeEventListener(e,u),l&&l()}},[t,e])}const goe={},Kf=typeof window>"u"?null:window,yoe=Kf&&typeof Kf.visualViewport<"u"?Kf.visualViewport:null,nT=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],NF=function(t){t===void 0&&(t=goe);const{wait:e,leading:n,initialWidth:r=0,initialHeight:s=0}=t,[i,o]=moe(typeof document>"u"?[r,s]:nT,e,n),a=()=>o(nT);return Jy(Kf,"resize",a),Jy(yoe,"resize",a),Jy(Kf,"orientationchange",a),i},boe=t=>NF(t)[1],voe=t=>NF(t)[0],woe={g1:[bi.h1,bi.f1,Tf.R],c1:[bi.a1,bi.d1,Tf.R],g8:[bi.h8,bi.f8,Tf.r],c8:[bi.a8,bi.d8,Tf.r]},xoe=t=>{let e=t.piece;return t!=null&&t.promotion&&(e=t.promotion),t.color=="w"&&(e=e.toUpperCase()),Tf[e]},rT=t=>{const e=[bi[t.from]],n=[bi[t.to]],r=[xoe(t)];if(t.flags.includes("k")||t.flags.includes("q")){const[i,o,a]=woe[t.to];e.push(i),n.push(o),r.push(a)}else if(t.flags.includes("e")){const i=bi[t.to[0]+t.from[1]];e.push(i)}return{sans:[t.san],from:e,to:n,targets:r}},Soe=(t,e)=>{const n=e.from.concat(e.to),r=t.from.filter(c=>!n.includes(c)),s=[],i=[];for(let c=0;c<t.to.length;c++)n.includes(t.to[c])||(s.push(t.to[c]),i.push(t.targets[c]));const o=r.concat(e.from),a=s.concat(e.to),u=i.concat(e.targets);return{sans:[t.sans[0],e.sans[0]],from:o,to:a,targets:u}},sT=t=>{const e=[];return t.moves({verbose:!0}).forEach(n=>{const r=rT(n);t.move(n);let s=!0;if(t.moves({verbose:!0}).forEach(i=>{const o=rT(i),a=Soe(r,o),u={move1:r,move2:o,moves:a};e.push(u),s=!1}),s){const i={move1:r,move2:null,moves:null};e.push(i)}t.undo()}),e},Aoe=({piecesModelRef:t,canvasRef:e,videoRef:n,sidebarRef:r,playing:s,setPlaying:i,playingRef:o,setText:a,mode:u,cornersRef:l})=>{const c=wd(),d=L.useRef(null),f=L.useRef(Uv(c)),h=L.useRef(sT(f.current)),p=L.useRef(c.lastMove),y=L.useRef(""),b=voe(),g=boe(),v=Zs();L.useEffect(()=>{const ee=Uv(c);y.current=w(ee),c.greedy===!0?ee.undo():h.current=sT(ee),f.current=ee,p.current=c.lastMove},[c]);const w=ee=>{const j=ee.history();if(j.length==0)return"";if(j.length==1)return`1. ${j[j.length-1]}`;const M=j[j.length-2],O=j[j.length-1],D=Math.floor(j.length/2);return j.length%2==0?`${D}.${M} ${O}`:`${D}...${M} ${D+1}.${O}`},x=async()=>{const ee=await navigator.mediaDevices.getUserMedia(ND);return n.current!==null&&(n.current.srcObject=ee),ee},C=async()=>x(),k=()=>{let ee=(b-r.current.offsetWidth-Sa)/Mv+Sa;if(ee>g&&(ee=g),e.current.offsetHeight==0||e.current.offsetWidth==0)return;const j=(ee-Sa)*Mv+Sa,M=e.current.height,O=e.current.width;d.current.style.width=`${j}px`,d.current.style.height=`${ee}px`,d.current.width=j,d.current.height=ee,e.current.width=n.current.offsetWidth,e.current.height=n.current.offsetHeight,b2.forEach(D=>{const V=zD(l.current[D],M,O),F={xy:UD(V,e.current.height,e.current.width),key:D};v(N2(F))})};L.useEffect(()=>{k();let ee=null;u!=="upload"&&(ee=C()),foe(t,n,e,o,a,v,l,f,h,p,y,u);const j=async()=>{const M=await ee;M!==null&&M.getTracks().forEach(O=>O.stop())};return()=>{j()}},[]),L.useEffect(()=>{k()},[b,g]),L.useEffect(()=>{u!=="upload"||n.current.src===""||(o.current===!0?n.current.pause():n.current.play())},[s]);const P={position:"absolute",left:Rm,top:Rm},N={width:"100%",height:"100%",padding:Rm},$={width:"auto",height:"100%"},U={position:"relative",backgroundColor:"#343a40"},K=()=>{u!=="upload"&&window.setTimeout(()=>{if(!n.current)return;const ee=n.current.srcObject.getVideoTracks();if(ee.length!=0){try{const j=ee[0].getCapabilities();console.log("Capabilties",j),j.zoom&&ee[0].applyConstraints({zoom:j.zoom.min})}catch{console.log("Cannot update track capabilities")}try{const j=ee[0].getSettings();console.log("Settings",j)}catch{console.log("Cannot log track settings")}}},2e3)},Z=()=>{k()},ie=()=>{u==="upload"&&(n.current.currentTime=n.current.duration,n.current.pause()),i(!1)};return _.jsx("div",{className:"d-flex align-top justify-content-center",children:_.jsxs("div",{ref:d,style:U,children:[_.jsxs("div",{style:N,children:[_.jsx("video",{ref:n,autoPlay:u!=="upload",playsInline:!0,muted:!0,onLoadedMetadata:K,style:$,onCanPlay:Z,onEnded:ie}),_.jsx("canvas",{ref:e,style:P})]}),_.jsx($ee,{})]})})};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe=X();Eoe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Lr;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Lr||(Lr={}));var iT;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(iT||(iT={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe={};function TF(t){return Coe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A(t,e,n,r,s){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,u=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,l=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return Rn(e.inputNames[l],n,r,s);if(i.type==="tensors"){const f=e.inputs.slice(a,u);return e.inputNames.slice(a,u).filter((p,y)=>{var b;return((b=f[y])===null||b===void 0?void 0:b.op)!=="NoOp"}).map(p=>Rn(p,n,r,s))}const c=Rn(e.inputNames[l],n,r,s),d=c.dataSync();return i.type==="number"?d[0]:pv(c.shape,d)}const o=e.attrParams[t];return o&&o.value}function Rn(t,e,n,r){const[s,i]=Fr(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[H0(s,a)]);return o!==void 0?e[H0(s,o)][i]:void 0}function oT(t,e,n){return e[H0(t,n.currentContextId)]}function ko(t,e){const[n,r,s]=Fr(t,e);return[H0(n,e&&e.currentContextId),r,s]}function H0(t,e){return e?`${t}-${e}`:t}function Fr(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const i=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[i,a,o]}return n&&e.parseNodeNameCache.set(t,s),s}function Bm(t,e,n){let r=A("pad",t,e,n);if(r==="explicit"){r=A("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)s[i][0]=r[i*2],s[i][1]=r[i*2+1];return s}return r}function Ro(t){return t.kept?t:Fa(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Toe=Object.freeze(Object.defineProperty({__proto__:null,json:Noe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _oe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ioe=Object.freeze(Object.defineProperty({__proto__:null,json:_oe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const koe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Roe=Object.freeze(Object.defineProperty({__proto__:null,json:koe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Poe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Ooe=Object.freeze(Object.defineProperty({__proto__:null,json:Poe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Doe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Loe=Object.freeze(Object.defineProperty({__proto__:null,json:Doe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],$oe=Object.freeze(Object.defineProperty({__proto__:null,json:Foe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Moe=Object.freeze(Object.defineProperty({__proto__:null,json:Boe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Uoe=Object.freeze(Object.defineProperty({__proto__:null,json:Voe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Woe=Object.freeze(Object.defineProperty({__proto__:null,json:zoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Goe=Object.freeze(Object.defineProperty({__proto__:null,json:joe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Hoe=Object.freeze(Object.defineProperty({__proto__:null,json:qoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Xoe=Object.freeze(Object.defineProperty({__proto__:null,json:Koe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Qoe=Object.freeze(Object.defineProperty({__proto__:null,json:Yoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Joe=Object.freeze(Object.defineProperty({__proto__:null,json:Zoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],tae=Object.freeze(Object.defineProperty({__proto__:null,json:eae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],rae=Object.freeze(Object.defineProperty({__proto__:null,json:nae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],iae=Object.freeze(Object.defineProperty({__proto__:null,json:sae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],aae=Object.freeze(Object.defineProperty({__proto__:null,json:oae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],lae=Object.freeze(Object.defineProperty({__proto__:null,json:uae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aT{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Toe,Ioe,Roe,Ooe,Loe,$oe,Moe,Uoe,Woe,Goe,Hoe,Xoe,Qoe,Joe,tae,rae,iae,aae,lae],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],i=[],o=[],a=r.reduce((y,b)=>(y[b.name]=this.mapNode(b),b.op.startsWith("Placeholder")?s.push(y[b.name]):b.op==="Const"?i.push(y[b.name]):(b.input==null||b.input.length===0)&&o.push(y[b.name]),y),{});let u=[];const l=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const f=Object.keys(a);f.forEach(y=>{const b=a[y];b.inputNames.forEach((g,v)=>{const[w,,x]=ko(g),C=a[w];if(C.outputs!=null){const k=C.outputs.indexOf(x);if(k!==-1){const P=`${w}:${k}`;b.inputNames[v]=P}}b.inputs.push(C),C.children.push(b)})}),Object.keys(d).length===0?f.forEach(y=>{const b=a[y];b.children.length===0&&l.push(b)}):Object.keys(d).forEach(y=>{const[b]=ko(y),g=a[b];g!=null&&(g.signatureKey=d[y],l.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(y=>{const[b]=ko(y),g=a[b];g&&(g.signatureKey=c[y],u.push(g))}):u=s;let h={};e.library!=null&&e.library.function!=null&&(h=e.library.function.reduce((y,b)=>(y[b.signature.name]=this.mapFunction(b),y),{}));const p={nodes:a,inputs:u,outputs:l,weights:i,placeholders:s,signature:n,functions:h};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=TF(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,i)=>(s[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,i)=>{const o=i.type;let a;switch(i.type){case"string":a=iw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=iw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=fw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=fw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=aw(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=aw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=dw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=dw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=ow(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=ow(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=pw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=pw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=cw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=cw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=hw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=hw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=uw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=uw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=lw(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=lw(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=uT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=uT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return s[i.name]={value:a,type:o},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let i={};n!=null&&(i=n.reduce((d,f)=>(d[f.name]=this.mapNode(f),f.op==="Const"&&s.push(d[f.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[f]=ko(d.name),h={name:f,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Y2(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,o.push(h),i[f]=h}),Object.keys(i).forEach(d=>{const f=i[d];f.inputNames.forEach((h,p)=>{const[y,,b]=ko(h),g=i[y];if(g.outputs!=null){const v=g.outputs.indexOf(b);if(v!==-1){const w=`${y}:${v}`;f.inputNames[p]=w}}f.inputs.push(g),g.children.push(f)})});const l=e.ret;e.signature.outputArg.forEach(d=>{const[f,h]=ko(l[d.name]),p=i[f];p!=null&&(p.defaultOutput=h,a.push(p))});const c=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function cae(t){const e=X().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function _F(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):cae(t);return e?n:n.toLowerCase()}function iw(t,e,n,r=!1){const s=t[e];return s!=null?_F(s.s,r):n}function ow(t,e,n){const r=t[e];return r?r.b:n}function aw(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function Y2(t){switch(typeof t=="string"&&(t=Lr[t]),t){case Lr.DT_FLOAT:case Lr.DT_HALF:return"float32";case Lr.DT_INT32:case Lr.DT_INT64:case Lr.DT_INT8:case Lr.DT_UINT8:return"int32";case Lr.DT_BOOL:return"bool";case Lr.DT_DOUBLE:return"float32";case Lr.DT_STRING:return"string";case Lr.DT_COMPLEX64:case Lr.DT_COMPLEX128:return"complex64";default:return null}}function uT(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function uw(t,e,n){const r=t[e];return r&&r.type?Y2(r.type):n}function lw(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>Y2(s)):n}function IF(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function cw(t,e,n){const r=t[e];return r&&r.shape?IF(r.shape):n}function dw(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function fw(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(i=>_F(i,r)):n}function hw(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>IF(s)):n}function pw(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dae{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,i)=>(s[i]=this.getAttr(i),s),{}))}getInput(e){return Rn(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Rn(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return aw(this.node.rawAttrs,e,n);if(r.s!=null)return iw(this.node.rawAttrs,e,n);if(r.b!=null)return ow(this.node.rawAttrs,e,n);if(r.shape!=null)return cw(this.node.rawAttrs,e,n);if(r.type!=null)return uw(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return dw(this.node.rawAttrs,e,n);if(r.list.s!=null)return fw(this.node.rawAttrs,e,n);if(r.list.shape!=null)return hw(this.node.rawAttrs,e,n);if(r.list.b!=null)return pw(this.node.rawAttrs,e,n);if(r.list.type!=null)return lw(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:gO,abs:ns,acos:j7,acosh:q7,add:ke,addN:K7,all:Y7,any:PO,argMax:OO,argMin:DO,asin:tW,asinh:rW,atan:iW,atan2:aW,atanh:lW,avgPool:FO,avgPool3d:yW,basicLSTMCell:EW,batchNorm:_g,batchNorm2d:IW,batchNorm3d:RW,batchNorm4d:OW,batchToSpaceND:$O,bincount:BO,bitwiseAnd:FW,booleanMaskAsync:xH,broadcastArgs:BW,broadcastTo:jf,buffer:Ht,cast:cn,ceil:UW,clipByValue:WW,clone:Fa,complex:Wa,concat:dn,concat1d:GW,concat2d:HW,concat3d:XW,concat4d:QW,conv1d:e9,conv2d:Ig,conv2dTranspose:r9,conv3d:i9,conv3dTranspose:l9,cos:d9,cosh:h9,cosineWindow:a2,cumprod:m9,cumsum:y9,denseBincount:v9,depthToSpace:x9,depthwiseConv2d:jx,diag:E9,dilation2d:N9,div:ut,divNoNan:R9,dot:O9,dropout:DH,einsum:uc,elu:zO,enclosingPowerOfTwo:g4,ensureShape:$9,equal:UO,erf:M9,euclideanNorm:K9,exp:fl,expandDims:ss,expm1:Z9,eye:GO,fft:s2,fill:Wh,floor:qO,floorDiv:RO,fused:XH,gather:R0,gatherND:RH,greater:Rg,greaterEqual:HO,ifft:F0,imag:Pg,image:l2,inTopKAsync:FH,irfft:l4,isFinite:aj,isInf:lj,isNaN:dj,leakyRelu:KO,less:P0,lessEqual:Hx,linalg:_X,linspace:mj,localResponseNormalization:yj,log:wh,log1p:XO,logSigmoid:Ej,logSoftmax:Tj,logSumExp:QO,logicalAnd:O0,logicalNot:ZO,logicalOr:JO,logicalXor:Oj,losses:IX,lowerBound:Lj,matMul:bt,max:Ku,maxPool:e4,maxPool3d:Bj,maxPoolWithArgmax:Vj,maximum:t4,mean:D0,meshgrid:Wj,min:Ov,minimum:L0,mirrorPad:qj,mod:Kj,moments:Yj,movingAverage:EH,mul:fe,multiRNNCell:Zj,multinomial:eG,neg:oo,norm:kg,notEqual:n4,oneHot:rG,ones:ju,onesLike:iG,op:B,outerProduct:aG,pad:yd,pad1d:cG,pad2d:fG,pad3d:pG,pad4d:gG,pool:xG,pow:vh,prelu:s4,print:kO,prod:EG,raggedGather:NG,raggedRange:_G,raggedTensorToTensor:kG,rand:PG,randomGamma:ZG,randomNormal:o4,randomStandardNormal:tq,randomUniform:r2,randomUniformInt:sq,range:xh,real:Sh,reciprocal:aq,relu:Og,relu6:a4,reshape:te,reverse:hl,reverse1d:fq,reverse2d:pq,reverse3d:gq,reverse4d:bq,rfft:i2,round:u4,rsqrt:xq,scalar:Ye,scatterND:NH,searchSorted:Kx,selu:Aq,separableConv2d:Cq,setdiff1dAsync:Tq,sigmoid:Bc,sign:Iq,signal:TX,sin:Rq,sinh:Oq,slice:Le,slice1d:Lq,slice2d:$q,slice3d:Mq,slice4d:Uq,softmax:Wq,softplus:YO,spaceToBatchND:r4,sparse:kX,sparseToDense:IH,spectral:NX,split:Ah,sqrt:Go,square:Hs,squaredDifference:c4,squeeze:Lo,stack:Ho,step:d4,stridedSlice:eH,string:RX,sub:Oe,sum:Rt,tan:nH,tanh:Pv,tensor:io,tensor1d:Ws,tensor2d:Xu,tensor3d:f4,tensor4d:rH,tensor5d:sH,tensor6d:iH,tensorScatterUpdate:aH,tile:Gf,topk:lH,transpose:$0,truncatedNormal:dH,unique:hH,unsortedSegmentSum:mH,unstack:Nl,upperBound:yH,variable:bH,where:$o,whereAsync:m4,zeros:Ga,zerosLike:ls},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fae=(t,e,n,r=Fn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(A("a",t,e,n),A("b",t,e,n))];case"AddN":return[r.addN(A("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(A("a",t,e,n),A("b",t,e,n))];case"Mul":return[r.mul(A("a",t,e,n),A("b",t,e,n))];case"RealDiv":case"Div":return[r.div(A("a",t,e,n),A("b",t,e,n))];case"DivNoNan":return[r.divNoNan(A("a",t,e,n),A("b",t,e,n))];case"FloorDiv":return[r.floorDiv(A("a",t,e,n),A("b",t,e,n))];case"Sub":return[r.sub(A("a",t,e,n),A("b",t,e,n))];case"Minimum":return[r.minimum(A("a",t,e,n),A("b",t,e,n))];case"Maximum":return[r.maximum(A("a",t,e,n),A("b",t,e,n))];case"Pow":return[r.pow(A("a",t,e,n),A("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(A("a",t,e,n),A("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hae=(t,e,n,r=Fn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(A("x",t,e,n))];case"Acos":return[r.acos(A("x",t,e,n))];case"Acosh":return[r.acosh(A("x",t,e,n))];case"Asin":return[r.asin(A("x",t,e,n))];case"Asinh":return[r.asinh(A("x",t,e,n))];case"Atan":return[r.atan(A("x",t,e,n))];case"Atan2":return[r.atan2(A("x",t,e,n),A("y",t,e,n))];case"Atanh":return[r.atanh(A("x",t,e,n))];case"Ceil":return[r.ceil(A("x",t,e,n))];case"Complex":return[r.complex(A("real",t,e,n),A("imag",t,e,n))];case"Cos":return[r.cos(A("x",t,e,n))];case"Cosh":return[r.cosh(A("x",t,e,n))];case"Elu":return[r.elu(A("x",t,e,n))];case"Erf":return[r.erf(A("x",t,e,n))];case"Exp":return[r.exp(A("x",t,e,n))];case"Expm1":return[r.expm1(A("x",t,e,n))];case"Floor":return[r.floor(A("x",t,e,n))];case"Log":return[r.log(A("x",t,e,n))];case"Log1p":return[r.log1p(A("x",t,e,n))];case"Imag":return[r.imag(A("x",t,e,n))];case"Neg":return[r.neg(A("x",t,e,n))];case"Reciprocal":return[r.reciprocal(A("x",t,e,n))];case"Real":return[r.real(A("x",t,e,n))];case"Relu":return[r.relu(A("x",t,e,n))];case"Round":return[r.round(A("x",t,e,n))];case"Selu":return[r.selu(A("x",t,e,n))];case"Sigmoid":return[r.sigmoid(A("x",t,e,n))];case"Sin":return[r.sin(A("x",t,e,n))];case"Sign":return[r.sign(A("x",t,e,n))];case"Sinh":return[r.sinh(A("x",t,e,n))];case"Softplus":return[r.softplus(A("x",t,e,n))];case"Sqrt":return[r.sqrt(A("x",t,e,n))];case"Square":return[r.square(A("x",t,e,n))];case"Tanh":return[r.tanh(A("x",t,e,n))];case"Tan":return[r.tan(A("x",t,e,n))];case"ClipByValue":return[r.clipByValue(A("x",t,e,n),A("clipValueMin",t,e,n),A("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(A("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Rn(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(A("x",t,e,n),A("alpha",t,e,n))];case"Prelu":return[r.prelu(A("x",t,e,n),A("alpha",t,e,n))];case"IsNan":return[r.isNaN(Rn(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Rn(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Rn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){R(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],i=e[r];R(s<0||i<0||s===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function lT(t){return!(typeof t=="number"||t.some(e=>e<0))}function bf(t,e,n){let r=mw(t,n);const s=!lT(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(i=>{r=mw(i.shape,r)}),!lT(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function mw(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],i=e[r];if(s>=0&&i>=0&&s!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pae{constructor(e,n,r,s,i,o,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Ye(0),Zi(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Fs(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Zi(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return io([],[0].concat(this.elementShape));const r=this.readMany(e);return Fs(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ho(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return io([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return Fs(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),dn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Nl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(u=>(r+=u,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];qe(()=>{n=te(n,[1,r,i]);for(let u=0;u<e.length;++u){const c=[0,u===0?0:s[u-1],0],d=[1,e[u],i];o[u]=te(Le(n,c,d),this.elementShape)}return o});const a=[];for(let u=0;u<e.length;u++)a[u]=u;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yl{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);Fs(n,i.shape,"TensorList shape mismatch: "),Zi(i)}),this.idTensor=Ye(0),this.maxNumElements=s,Zi(this.idTensor)}copy(){return new yl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Fs(e,this.elementShape,"TensorList shape mismatch: ");const s=bf(this.elementShape,this.tensors,e);return qe(()=>{const i=this.tensors.map(o=>te(o,s));return Ho(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=bf(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,Fs(s.shape,e,"TensorList shape mismatch: "),te(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Fs(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Zi(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new yl([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Fs(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=bf(this.elementShape,this.tensors,n);return te(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Fs(this.elementShape,n.shape,"TensorList shape mismatch: "),Zi(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Fs(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=bf(this.elementShape,this.tensors,r);return e.length===0?io([],[0].concat(s)):qe(()=>{const i=e.map(o=>te(this.tensors[o],s));return Ho(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Fs(this.elementShape,n,"TensorList shape mismatch: ");const r=bf(this.elementShape,this.tensors,n);return this.size()===0?io([],[0].concat(r)):qe(()=>{const s=this.tensors.map(i=>te(i,r));return dn(s,0)})}}function mae(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);Fs(s,e,"TensorList shape mismatch: ");const i=Nl(t);return new yl(i,e,r)}function gae(t,e,n,r){return new yl([],t,e,r)}function yae(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new yl([],n,t.dtype,r),o=Nl(t,0);return e.forEach((a,u)=>{i.setItem(a,o[u])}),i}function bae(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=mw(i,n),a=r===0?0:t.size/r,u=qe(()=>{const c=[];t=te(t,[1,r,a]);for(let d=0;d<e.length;++d){const h=[0,d===0?0:s[d-1],0],p=[1,e[d],a];c[d]=te(Le(t,h,p),o)}return t.dispose(),c}),l=new yl([],n,t.dtype,e.length);for(let c=0;c<u.length;c++)l.setItem(c,u[c]);return l}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=A("thenBranch",t,e,n),s=A("elseBranch",t,e,n),i=A("cond",t,e,n),o=A("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=A("body",t,e,n),s=A("cond",t,e,n),i=A("args",t,e,n),o=await n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(c=>c.id);let u=await o[0].data();o.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let l=i;for(;u[0];){const c=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const d=l.map(h=>h.id);c.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});const f=await n.functionMap[s].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);u=await f[0].data(),f.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return l}case"LoopCond":{const r=A("pred",t,e,n);return[Ro(r)]}case"Switch":{const r=A("pred",t,e,n);let s=A("data",t,e,n);return s.kept||(s=Ro(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Rn(s,e,n)!==void 0);if(r){const s=Rn(r,e,n);return[Ro(s)]}return}case"Enter":{const r=A("frameName",t,e,n),s=A("tensor",t,e,n);return n.enterFrame(r),[Ro(s)]}case"Exit":{const r=A("tensor",t,e,n);return n.exitFrame(),[Ro(r)]}case"NextIteration":{const r=A("tensor",t,e,n);return n.nextIteration(),[Ro(r)]}case"TensorArrayV3":{const r=A("size",t,e,n),s=A("dtype",t,e,n),i=A("elementShape",t,e,n),o=A("dynamicSize",t,e,n),a=A("clearAfterRead",t,e,n),u=A("identicalElementShapes",t,e,n),l=A("name",t,e,n),c=new pae(l,s,r,i,u,o,a);return n.addTensorArray(c),[c.idTensor,Ye(1)]}case"TensorArrayWriteV3":{const r=A("tensorArrayId",t,e,n),s=A("index",t,e,n),i=A("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(s,i),[o.idTensor]}case"TensorArrayReadV3":{const r=A("tensorArrayId",t,e,n),s=A("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=A("tensorArrayId",t,e,n),s=A("indices",t,e,n),i=A("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=A("tensorArrayId",t,e,n),s=A("indices",t,e,n),i=A("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(s,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=A("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),i=A("dtype",t,e,n);return[s.concat(i)]}case"TensorArraySplitV3":{const r=A("tensorArrayId",t,e,n),s=A("tensor",t,e,n),i=A("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,s),[o.idTensor]}case"TensorArraySizeV3":{const r=A("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[Ye(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=A("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=A("tensorListId",t,e,n),s=A("index",t,e,n),i=A("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(s,i),[o.idTensor]}case"TensorListGetItem":{const r=A("tensorListId",t,e,n),s=A("index",t,e,n),i=A("elementShape",t,e,n),o=A("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=A("indices",t,e,n),s=A("tensor",t,e,n),i=A("elementShape",t,e,n),o=A("numElements",t,e,n),a=yae(s,r,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=A("elementShape",t,e,n),s=A("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=A(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,u=gae(r,s,o,a);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const r=A("tensorListId",t,e,n),s=A("indices",t,e,n),i=A("elementShape",t,e,n),o=A("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,o,i)]}case"TensorListStack":{const r=A("tensorListId",t,e,n),s=A("elementShape",t,e,n),i=A("elementDType",t,e,n),o=A("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,i,o)]}case"TensorListFromTensor":{const r=A("tensor",t,e,n),s=A("elementShape",t,e,n),i=A("elementDType",t,e,n),o=mae(r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=A("tensorListId",t,e,n),s=n.getTensorList(r.id),i=A("dtype",t,e,n),o=A("elementShape",t,e,n);return[s.concat(i,o)]}case"TensorListPushBack":{const r=A("tensorListId",t,e,n),s=A("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=A("tensorListId",t,e,n),s=A("elementShape",t,e,n),i=A("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=A("tensor",t,e,n),s=A("elementShape",t,e,n),i=A("lengths",t,e,n),o=bae(r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=A("tensorListId",t,e,n),s=n.getTensorList(r.id);return[Ye(s.size(),"int32")]}case"TensorListResize":{const r=A("tensorListId",t,e,n),s=A("size",t,e,n),o=n.getTensorList(r.id).resize(s);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(t,e,n){const[r,s]=A("fusedOps",t,e,n),i=r==="biasadd",o=!i,a=s==="prelu",u=r==="fusedbatchnorm",l=A("numArgs",t,e,n);if(i){if(a&&l!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&l!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=A("strides",t,e,n),d=Bm(t,e,n),f=A("dataFormat",t,e,n).toUpperCase(),h=A("dilations",t,e,n);let[p,y]=A("args",t,e,n);o&&(y=p,p=void 0);const b=A("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:f,dilations:h,biasArg:p,preluArg:y,activationFunc:s,leakyreluAlpha:b}}const wae=(t,e,n,r=Fn)=>{switch(t.op){case"Conv1D":{const s=A("stride",t,e,n),i=A("pad",t,e,n),o=A("dataFormat",t,e,n).toUpperCase(),a=A("dilation",t,e,n);return[r.conv1d(A("x",t,e,n),A("filter",t,e,n),s,i,o,a)]}case"Conv2D":{const s=A("strides",t,e,n),i=Bm(t,e,n),o=A("dataFormat",t,e,n).toUpperCase(),a=A("dilations",t,e,n);return[r.conv2d(A("x",t,e,n),A("filter",t,e,n),[s[1],s[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:d}=cT(t,e,n);return[r.fused.conv2d({x:A("x",t,e,n),filter:A("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:d}=cT(t,e,n);return[r.fused.depthwiseConv2d({x:A("x",t,e,n),filter:A("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=A("outputShape",t,e,n),i=A("strides",t,e,n),o=Bm(t,e,n);return[r.conv2dTranspose(A("x",t,e,n),A("filter",t,e,n),s,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=A("strides",t,e,n),i=Bm(t,e,n),o=A("dilations",t,e,n),a=A("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(A("input",t,e,n),A("filter",t,e,n),[s[1],s[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("dataFormat",t,e,n).toUpperCase(),a=A("dilations",t,e,n);return[r.conv3d(A("x",t,e,n),A("filter",t,e,n),[s[1],s[2],s[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("kernelSize",t,e,n);return[r.avgPool(A("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("kernelSize",t,e,n);return[r.maxPool(A("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("kernelSize",t,e,n),a=A("includeBatchInIndex",t,e,n),{result:u,indexes:l}=r.maxPoolWithArgmax(A("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i,a);return[u,l]}case"AvgPool3D":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("kernelSize",t,e,n);return[r.avgPool3d(A("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("kernelSize",t,e,n);return[r.maxPool3d(A("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=A("strides",t,e,n),i=A("pad",t,e,n),o=A("dilations",t,e,n),a=s[1],u=s[2],l=o[1],c=o[2];return[r.dilation2d(A("x",t,e,n),A("filter",t,e,n),[a,u],i,[l,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae=(t,e,n,r=Fn)=>{switch(t.op){case"Fill":{const s=A("shape",t,e,n),i=A("dtype",t,e,n),o=A("value",t,e,n);return[r.fill(s,o,i)]}case"LinSpace":{const s=A("start",t,e,n),i=A("stop",t,e,n),o=A("num",t,e,n);return[r.linspace(s,i,o)]}case"Multinomial":{const s=A("logits",t,e,n),i=A("numSamples",t,e,n),o=A("seed",t,e,n);return[r.multinomial(s,i,o)]}case"OneHot":{const s=A("indices",t,e,n),i=A("depth",t,e,n),o=A("onValue",t,e,n),a=A("offValue",t,e,n),u=A("dtype",t,e,n);return[r.oneHot(s,i,o,a,u)]}case"Ones":return[r.ones(A("shape",t,e,n),A("dtype",t,e,n))];case"OnesLike":return[r.onesLike(A("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(A("shape",t,e,n),A("dtype",t,e,n),A("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(A("shape",t,e,n),A("minval",t,e,n),A("maxval",t,e,n),A("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(A("shape",t,e,n),A("minval",t,e,n),A("maxval",t,e,n),A("seed",t,e,n))];case"Range":{const s=A("start",t,e,n),i=A("stop",t,e,n),o=A("step",t,e,n);return[r.range(s,i,o,A("dtype",t,e,n))]}case"TruncatedNormal":{const s=A("shape",t,e,n),i=A("mean",t,e,n),o=A("stdDev",t,e,n),a=A("seed",t,e,n);return[r.truncatedNormal(s,i,o,A("dtype",t,e,n),a)]}case"Zeros":return[r.zeros(A("shape",t,e,n),A("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(A("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eb(t,e,n){const r=A("boxes",t,e,n),s=A("scores",t,e,n),i=A("maxOutputSize",t,e,n),o=A("iouThreshold",t,e,n),a=A("scoreThreshold",t,e,n),u=A("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:u}}const Sae=async(t,e,n,r,s=Fn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l,softNmsSigma:c}=eb(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(i,o,a,u,l,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l}=eb(t,e,n),c=A("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(i,o,a,u,l,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:u,scoreThreshold:l}=eb(t,e,n);return[await s.image.nonMaxSuppressionAsync(i,o,a,u,l)]}case"Where":{const i=s.cast(A("condition",t,e,n),"bool"),o=[await s.whereAsync(i)];return i.dispose(),o}case"ListDiff":return s.setdiff1dAsync(A("x",t,e,n),A("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae=(t,e,n,r=Fn)=>{switch(t.op){case"LowerBound":{const s=A("sortedSequence",t,e,n),i=A("values",t,e,n);return[r.lowerBound(s,i)]}case"TopKV2":{const s=A("x",t,e,n),i=A("k",t,e,n),o=A("sorted",t,e,n),a=r.topk(s,i,o);return[a.values,a.indices]}case"UpperBound":{const s=A("sortedSequence",t,e,n),i=A("values",t,e,n);return[r.upperBound(s,i)]}case"Unique":{const s=A("x",t,e,n),i=r.unique(s);return[i.values,i.indices]}case"UniqueV2":{const s=A("x",t,e,n),i=A("axis",t,e,n),o=r.unique(s,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eae=(t,e,n,r=Fn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=A("default",t,e,n);return[Rn(t.name,e,n)||s];case"Placeholder":return[Rn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=A("x",t,e,n);return[Ro(c)]}case"IdentityN":return A("x",t,e,n).map(c=>Ro(c));case"Snapshot":const i=A("x",t,e,n);return[Ro(i)];case"Shape":return[r.tensor1d(A("x",t,e,n).shape,"int32")];case"ShapeN":return A("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(A("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(A("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=A("x",t,e,n),a=A("data",t,e,n),u=A("message",t,e,n),l=A("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cae{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Ye(0),this.tensorMap=new Map,Zi(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ye(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),qe(()=>{const s=Nl(n),i=r.length,o=s.length;R(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const u=r[a],l=s[a];Zi(l),this.tensorMap.set(u,l)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return qe(()=>{const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=this.findWithDefault(o,n);s.push(a)}return Ho(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const i=A("keyDType",t,e,n),o=A("valueDType",t,e,n),a=new Cae(i,o);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=A("tableHandle",t,e,n,r),i=A("keys",t,e,n),o=A("values",t,e,n);return[await r.getHashTableById(s.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const s=A("tableHandle",t,e,n,r),i=A("keys",t,e,n),o=A("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=A("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae=(t,e,n,r=Fn)=>{switch(t.op){case"ResizeBilinear":{const s=A("images",t,e,n),i=A("size",t,e,n),o=A("alignCorners",t,e,n),a=A("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const s=A("images",t,e,n),i=A("size",t,e,n),o=A("alignCorners",t,e,n),a=A("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[i[0],i[1]],o,a)]}case"CropAndResize":{const s=A("image",t,e,n),i=A("boxes",t,e,n),o=A("boxInd",t,e,n),a=A("cropSize",t,e,n),u=A("method",t,e,n),l=A("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,i,o,a,u,l)]}case"ImageProjectiveTransformV3":{const s=A("images",t,e,n),i=A("transforms",t,e,n),o=A("outputShape",t,e,n),a=A("fillValue",t,e,n),u=A("interpolation",t,e,n),l=A("fillMode",t,e,n);return[r.image.transform(s,i,u.toLowerCase(),l.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ae=(t,e,n,r=Fn)=>{switch(t.op){case"Equal":return[r.equal(A("a",t,e,n),A("b",t,e,n))];case"NotEqual":return[r.notEqual(A("a",t,e,n),A("b",t,e,n))];case"Greater":return[r.greater(A("a",t,e,n),A("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(A("a",t,e,n),A("b",t,e,n))];case"Less":return[r.less(A("a",t,e,n),A("b",t,e,n))];case"LessEqual":return[r.lessEqual(A("a",t,e,n),A("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(A("a",t,e,n),A("b",t,e,n))];case"LogicalNot":return[r.logicalNot(A("a",t,e,n))];case"LogicalOr":return[r.logicalOr(A("a",t,e,n),A("b",t,e,n))];case"Select":case"SelectV2":return[r.where(A("condition",t,e,n),A("a",t,e,n),A("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(A("a",t,e,n),A("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae=(t,e,n,r=Fn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(A("a",t,e,n),A("b",t,e,n),A("transposeA",t,e,n),A("transposeB",t,e,n))];case"Einsum":return[r.einsum(A("equation",t,e,n),...A("tensors",t,e,n))];case"Transpose":return[r.transpose(A("x",t,e,n),A("perm",t,e,n))];case"_FusedMatMul":const[s,i]=A("fusedOps",t,e,n),o=s==="biasadd",a=i==="prelu",u=A("numArgs",t,e,n),l=A("leakyreluAlpha",t,e,n);if(o){if(a&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=A("args",t,e,n);return[r.fused.matMul({a:A("a",t,e,n),b:A("b",t,e,n),transposeA:A("transposeA",t,e,n),transposeB:A("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart(A("a",t,e,n),A("numLower",t,e,n),A("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae=(t,e,n,r=Fn)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(A("x",t,e,n),A("axis",t,e,n),A("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(A("x",t,e,n),A("mean",t,e,n),A("variance",t,e,n),A("offset",t,e,n),A("scale",t,e,n),A("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(A("x",t,e,n),A("mean",t,e,n),A("variance",t,e,n),A("offset",t,e,n),A("scale",t,e,n),A("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(A("x",t,e,n),A("radius",t,e,n),A("bias",t,e,n),A("alpha",t,e,n),A("beta",t,e,n))];case"Softmax":return[r.softmax(A("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(A("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae=(t,e,n,r=Fn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:i}=r.raggedGather(A("paramsNestedSplits",t,e,n),A("paramsDenseValues",t,e,n),A("indices",t,e,n),A("outputRaggedRank",t,e,n));return s.concat(i)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:i}=r.raggedRange(A("starts",t,e,n),A("limits",t,e,n),A("splits",t,e,n));return[s,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(A("shape",t,e,n),A("values",t,e,n),A("defaultValue",t,e,n),A("rowPartitionTensors",t,e,n),A("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pae=(t,e,n,r=Fn)=>{switch(t.op){case"Max":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.max(A("x",t,e,n),a,u)]}case"Mean":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.mean(A("x",t,e,n),a,u)]}case"Min":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.min(A("x",t,e,n),a,u)]}case"Sum":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.sum(A("x",t,e,n),a,u)]}case"All":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.all(A("x",t,e,n),a,u)]}case"Any":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.any(A("x",t,e,n),a,u)]}case"ArgMax":{const a=A("axis",t,e,n);return[r.argMax(A("x",t,e,n),a)]}case"ArgMin":{const a=A("axis",t,e,n);return[r.argMin(A("x",t,e,n),a)]}case"Prod":{const a=A("axis",t,e,n),u=A("keepDims",t,e,n);return[r.prod(A("x",t,e,n),a,u)]}case"Cumprod":{const a=A("axis",t,e,n),u=A("exclusive",t,e,n),l=A("reverse",t,e,n);return[r.cumprod(A("x",t,e,n),a,u,l)]}case"Cumsum":{const a=A("axis",t,e,n),u=A("exclusive",t,e,n),l=A("reverse",t,e,n);return[r.cumsum(A("x",t,e,n),a,u,l)]}case"Bincount":const s=A("x",t,e,n),i=A("weights",t,e,n),o=A("size",t,e,n);return[r.bincount(s,i,o)];case"DenseBincount":{const a=A("x",t,e,n),u=A("weights",t,e,n),l=A("size",t,e,n),c=A("binaryOutput",t,e,n);return[r.denseBincount(a,u,l,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oae=(t,e,n,r=Fn)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=A("n",t,e,n),i=A("axis",t,e,n);let o=A("tensors",t,e,n);return o=o.slice(0,s),[r.concat(o,i)]}case"Gather":{const s=A("x",t,e,n),i=A("indices",t,e,n);return[r.gather(s,r.cast(i,"int32"),0)]}case"GatherV2":{const s=A("axis",t,e,n),i=A("batchDims",t,e,n),o=A("x",t,e,n),a=A("indices",t,e,n);return[r.gather(o,r.cast(a,"int32"),s,i)]}case"Reverse":{const s=A("dims",t,e,n),i=[];for(let a=0;a<s.length;a++)s[a]&&i.push(a);const o=A("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const s=A("axis",t,e,n),i=A("x",t,e,n);return[r.reverse(i,s)]}case"Slice":{const s=A("begin",t,e,n),i=A("size",t,e,n);return[r.slice(A("x",t,e,n),s,i)]}case"StridedSlice":{const s=A("begin",t,e,n),i=A("end",t,e,n),o=A("strides",t,e,n),a=A("beginMask",t,e,n),u=A("endMask",t,e,n),l=A("ellipsisMask",t,e,n),c=A("newAxisMask",t,e,n),d=A("shrinkAxisMask",t,e,n),f=A("x",t,e,n);return[r.stridedSlice(f,s,i,o,a,u,l,c,d)]}case"Pack":return qe(()=>{const s=A("axis",t,e,n),i=A("tensors",t,e,n),o=i[0].shape,a=r.squeeze(i[0]).shape,u=i.map(l=>{const c=qt(l.shape,o);if(!c&&!qt(r.squeeze(l).shape,a))throw new Error("the input tensors shape does not match");return c?l:r.reshape(l,o)});return[r.stack(u,s)]});case"Unpack":{const s=A("axis",t,e,n),i=A("tensor",t,e,n);return r.unstack(i,s)}case"Tile":{const s=A("reps",t,e,n);return[r.tile(A("x",t,e,n),s)]}case"Split":case"SplitV":{const s=A("axis",t,e,n),i=A("numOrSizeSplits",t,e,n),o=A("x",t,e,n);return r.split(o,i,s)}case"ScatterNd":{const s=A("indices",t,e,n),i=A("values",t,e,n),o=A("shape",t,e,n);return[r.scatterND(s,i,o)]}case"GatherNd":{const s=A("x",t,e,n),i=A("indices",t,e,n);return[r.gatherND(s,i)]}case"SparseToDense":{const s=A("sparseIndices",t,e,n),i=A("outputShape",t,e,n),o=A("sparseValues",t,e,n),a=A("defaultValue",t,e,n);return[r.sparseToDense(s,o,i,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const s=A("indices",t,e,n),i=A("values",t,e,n),o=A("tensor",t,e,n);return[r.tensorScatterUpdate(o,s,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae=(t,e,n,r=Fn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(A("indices",t,e,n),A("values",t,e,n),A("denseShape",t,e,n),A("defaultValue",t,e,n));return[s,i,o,a]}case"SparseReshape":{const{outputIndices:s,outputShape:i}=r.sparse.sparseReshape(A("inputIndices",t,e,n),A("inputShape",t,e,n),A("newShape",t,e,n));return[s,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(A("data",t,e,n),A("indices",t,e,n),A("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(A("data",t,e,n),A("indices",t,e,n),A("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae=(t,e,n,r=Fn)=>{switch(t.op){case"FFT":return[r.fft(A("x",t,e,n))];case"IFFT":return[r.ifft(A("x",t,e,n))];case"RFFT":return[r.rfft(A("x",t,e,n))];case"IRFFT":return[r.irfft(A("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae=(t,e,n,r=Fn)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(A("input",t,e,n),A("pattern",t,e,n),A("rewrite",t,e,n),A("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:i}=r.string.stringNGrams(A("data",t,e,n),A("dataSplits",t,e,n),A("separator",t,e,n),A("nGramWidths",t,e,n),A("leftPad",t,e,n),A("rightPad",t,e,n),A("padWidth",t,e,n),A("preserveShortSequences",t,e,n));return[s,i]}case"StringSplit":{const{indices:s,values:i,shape:o}=r.string.stringSplit(A("input",t,e,n),A("delimiter",t,e,n),A("skipEmpty",t,e,n));return[s,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(A("input",t,e,n),A("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae=(t,e,n,r=Fn)=>{switch(t.op){case"Cast":return[r.cast(A("x",t,e,n),A("dtype",t,e,n))];case"ExpandDims":{const s=A("axis",t,e,n);return[r.expandDims(A("x",t,e,n),s)]}case"Squeeze":{const s=A("axis",t,e,n);return[r.squeeze(A("x",t,e,n),s)]}case"Reshape":return[r.reshape(A("x",t,e,n),A("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(A("x",t,e,n),A("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(A("x",t,e,n),A("padding",t,e,n),A("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(A("x",t,e,n),A("padding",t,e,n),A("constantValue",t,e,n))];case"SpaceToBatchND":{const s=A("blockShape",t,e,n),i=A("paddings",t,e,n);return[r.spaceToBatchND(A("x",t,e,n),s,i)]}case"BatchToSpaceND":{const s=A("blockShape",t,e,n),i=A("crops",t,e,n);return[r.batchToSpaceND(A("x",t,e,n),s,i)]}case"DepthToSpace":{const s=A("blockSize",t,e,n),i=A("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(A("x",t,e,n),s,i)]}case"BroadcastTo":return[r.broadcastTo(A("x",t,e,n),A("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(A("s0",t,e,n),A("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dT(t,e,n,r,s=qe){const i=((o,a,u)=>{switch(o.category){case"arithmetic":return s(()=>fae(o,a,u));case"basic_math":return s(()=>hae(o,a,u));case"control":return vae(o,a,u);case"convolution":return s(()=>wae(o,a,u));case"creation":return s(()=>xae(o,a,u));case"dynamic":return Sae(o,a,u);case"evaluation":return s(()=>Aae(o,a,u));case"image":return s(()=>Tae(o,a,u));case"graph":return s(()=>Eae(o,a,u));case"logical":return s(()=>_ae(o,a,u));case"matrices":return s(()=>Iae(o,a,u));case"normalization":return s(()=>kae(o,a,u));case"ragged":return s(()=>Rae(o,a,u));case"reduction":return s(()=>Pae(o,a,u));case"slice_join":return s(()=>Oae(o,a,u));case"sparse":return s(()=>Dae(o,a,u));case"spectral":return s(()=>Lae(o,a,u));case"string":return s(()=>Fae(o,a,u));case"transformation":return s(()=>$ae(o,a,u));case"hash_table":return Nae(o,a,u,r);case"custom":const l=TF(o.op);if(l&&l.customExecutor)return l.customExecutor(new dae(o,a,u));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return ol(i)?i.then(o=>[].concat(o)):[].concat(i)}class fT{constructor(e={},n={},r={},s={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(t,e,n,r){const s=new Set,i=[];let o=null,a=null;const u=new Set,l=new Set(Object.keys(t).map(f=>Fr(f)[0]));r=r||[];const c=new Set(r.map(f=>Fr(f.name)[0])),d=[...e];for(;d.length>0;){const f=d.pop();if((Lu(f)||Gae(f)||qae(f))&&o==null&&(o=f,a=o.children.map(h=>h.name).filter(h=>s.has(h))),s.add(f.name),n[f.name]==null&&!l.has(f.name)&&!c.has(f.name)){if(f.inputs.length===0){i.push(f.name);continue}f.inputs.forEach(h=>{u.has(h.name)||(u.add(h.name),d.push(h))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:o,syncInputs:a}}function Bae(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(b=>Fr(b)[0]).map(b=>t.nodes[b]),i=t.initNodes||[],o=b=>n.has(typeof b=="string"?b:b.name);function a(b){return[...new Map(b.map(g=>[g.name,g])).values()]}const u=a([...s,...t.weights,...i]).filter(o),l=a([...u,...Object.values(t.nodes)]).filter(o),c=new Map(l.map(b=>[b.name,b])),d={};for(const b of l){d[b.name]=d[b.name]||0;for(const g of b.children)o(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const f=Object.entries(d).filter(([,b])=>b===0).map(([b])=>b),h=[...f];for(;f.length>0;){const b=f.pop(),g=c.get(b);for(const v of g.children.filter(o))--d[v.name]===0&&(h.push(v.name),f.push(v.name))}const p=h.map(b=>c.get(b)),y=Mae(p,u);return Vae(y,u),y}function Mae(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),s=new Set(r);for(;r.length>0;){const o=r.pop(),a=n.get(o);for(const u of a.children)!n.has(u.name)||s.has(u.name)||(s.add(u.name),r.push(u.name))}return t.filter(o=>s.has(o.name))}class im extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Vae(t,e){const n=new Map(t.map((a,u)=>[a.name,u])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const u of a.children.filter(o)){if(!n.has(u.name))throw new im(`Child ${u.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(u.name))throw new im(`Node ${a.name} is scheduled to run after its child ${u.name}.`)}if(!s(a))for(const u of a.inputs){if(!n.has(u.name))throw new im(`Input ${u.name} of node ${a.name} is unreachable.`);if(n.get(u.name)>n.get(a.name))throw new im(`Node ${a.name} is scheduled to run before its input ${u.name}.`)}}}function Uae(t){const e=new Map(t.map((a,u)=>[a.name,u])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,u)=>Lu(a)?n:u),s=a=>{const u=r[e.get(a.name)];return u??-1},i=t.map((a,u)=>a.children.map(s).reduce((l,c)=>Math.max(l,c),r[u])),o=new Map;for(let a=0;a<t.length;++a){const u=i[a];if(u===n)continue;const l=t[a],c=t[u];o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(l)}return o}const zae=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Wae=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),jae=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Lu(t){return zae.has(t.op)}function Gae(t){return Wae.has(t.op)}function qae(t){return jae.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K0{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new K0(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),s=n.map(i=>i.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=hT(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(s.length>0){const l=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${l}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=Bae(this.graph,r),u=Uae(a);return{orderedNodes:a,nodeLiveUntilMap:u}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Zi(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(f=>this.graph.nodes[Fr(f)[0]]),i=n.map(f=>Fr(f)[0]),o=new Set(i);let a=i.map(f=>this.graph.nodes[f]);a.length===0&&(a=this._outputs);const u=this.getCompilationKey(s,a);let l=this.compiledMap.get(u);l==null&&(l=this.compile(e,a),this.compiledMap.set(u,l));try{this.keepIntermediateTensors=X().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const c={},d={};return qe(()=>{const f=new fT(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[v,w]=Fr(g,f),x=[];x[w]=e[g],h[v]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(x))});const p=this.getFrozenTensorIds(h),{orderedNodes:y,nodeLiveUntilMap:b}=l;for(const g of y){if(h[g.name])continue;const v=dT(g,h,f,this._resourceManager);if(ol(v))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);h[g.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,h,f,p,o,b.get(g.name))}return this.parent==null&&f.dispose(p),n.map(g=>Rn(g,h,f))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,i,o,a){if(!(Lu(n)||o.has(e))){for(const u of r[e])u!=null&&(a[u.id]=(a[u.id]||0)+n.children.length);for(const u of n.inputs){if(Lu(u))continue;const l=oT(u.name,r,s);if(l!=null)for(const c of l){if(!c||c.kept||i.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,i,o){function a(u){return Lu(u)||i.has(u.name)}if(!(Lu(e)||o==null))for(const u of o){if(a(u))continue;const l=oT(u.name,n,r);for(const c of l)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},i={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=X().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const o=new fT(this.weightMap,s,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,r),u=n.map(f=>Rn(f,a,o)),l=u.map(f=>f.id),c=Object.keys(e).map(f=>e[f].id),d=new Set([...l,...c,...this.weightIds]);return Object.values(a).forEach(f=>{f.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&o.dispose(d),u}async executeFunctionAsync(e,n,r){const s=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const i=Object.keys(e),o=i.map(x=>this.graph.nodes[Fr(x)[0]]),a=r.map(x=>Fr(x)[0]),u=new Set(a);let l=a.map(x=>this.graph.nodes[x]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:f,syncInputs:h}=hT(e,l,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(x=>({node:x,contexts:n.currentContext})),y=Object.assign({},this.weightMap);Object.keys(e).forEach(x=>{const[C,k]=Fr(x),P=[];P[k]=e[x],y[C]=P});const b={},g=this.getFrozenTensorIds(y),v={};for(;p.length>0;){const x=this.processStack(o,p,n,y,v,g,u,b,c);await Promise.all(x)}f==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=l.filter(x=>!Lu(x)&&!Rn(x.name,y,n)).map(x=>x.name);if(w.length>0){let x="";throw f!=null&&(x=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${x}`)}return y}processStack(e,n,r,s,i,o,a,u,l){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let f="";if(d.node.op==="Enter"&&A("isConstant",d.node,s,r)&&([f]=ko(d.node.name,r)),s[d.node.name]==null){const h=dT(d.node,s,r,this._resourceManager);f||([f]=ko(d.node.name,r));const p=r.currentContext;ol(h)?c.push(h.then(y=>(s[f]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(y)),r.currentContext=p,this.checkTensorForDisposal(f,d.node,s,r,o,a,u),this.processChildNodes(d.node,n,r,s,i,l),y))):(s[f]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(h)),this.checkTensorForDisposal(f,d.node,s,r,o,a,u),this.processChildNodes(d.node,n,r,s,i,l))}else this.processChildNodes(d.node,n,r,s,i,l)}return c}processChildNodes(e,n,r,s,i,o){e.children.forEach(a=>{const[u]=ko(a.name,r);i[u]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(l=>!!Rn(l,s,r))&&(i[u]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(l=>!!Rn(l,s,r))&&(i[u]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=Fr(n),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((u,l)=>o[l]===-1||o[l]===u);R(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&R(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const i in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[i];o!=null?s[o.name]=e[i]:s[i]=e[i]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=Fr(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const i=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=Fr(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class Hae{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae="?tfjs-format=file",Xae="model.json";class Yae{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=_4){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new Hae}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return ol(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await wO(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new K0(aT.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=aT.Instance.transformGraph(e.modelInitializer);this.initializer=new K0(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof or?[e]:e,r={};return n.forEach((s,i)=>r[this.structuredOutputKeys[i]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof or)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((i,o)=>{var a,u,l;const c=(l=(u=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||u===void 0?void 0:u[o])===null||l===void 0?void 0:l.resourceId;return c!=null?i[o]=this.resourceIdToCapturedInput[c]:i[o]=e[s++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&rn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function pT(t,e={},n=_4){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Qae(t));const r=new Yae(t,e,n);return await r.load(),r}function Qae(t){return t.endsWith("/")||(t=t+"/"),`${t}${Xae}${Kae}`}const Zae=(t,e)=>{t.current!==void 0&&e.current!==void 0||Jz().then(async()=>{X().set("WEBGL_EXP_CONV",!0),X().set("WEBGL_PACK",!1),X().set("ENGINE_COMPILE_ONLY",!0);const n=Ga([1,rr,nr,3]),r=await pT("480M_pieces_float16/model.json"),s=r.execute(n),i=await pT("480L_xcorners_float16/model.json"),o=i.execute(n);rn([n,s,o]);const a=yO();a.checkCompileCompletion(),a.getUniformLocations(),X().set("ENGINE_COMPILE_ONLY",!1),t.current=r,e.current=i})},Jae=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:i,setPlaying:o,text:a,setText:u,cornersRef:l})=>{const c={display:i?"none":"inline-block"};return _.jsxs(Kh,{sidebarRef:s,playing:i,text:a,setText:u,children:[_.jsx("li",{className:"my-1",style:c,children:_.jsx(J2,{videoRef:n})}),_.jsx("li",{className:"my-1",style:c,children:_.jsx(Ug,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:u})}),_.jsx("li",{className:"my-1",style:c,children:_.jsx(FF,{piecesModelRef:t,videoRef:n,canvasRef:r,setText:u,cornersRef:l})}),_.jsx("li",{className:"my-1",children:_.jsxs("div",{className:"btn-group w-100",role:"group",children:[_.jsx(T2,{playing:i,setPlaying:o}),_.jsx(ZD,{setPlaying:o,setText:u})]})})]})},eue=({videoRef:t,playing:e,setPlaying:n})=>{const r=s=>{s.preventDefault(),t.current.src.startsWith("blob")&&n(!e)};return _.jsx(lo,{onClick:r,children:_.jsx(Il,{iconName:e?"bi-pause":"bi-play"})})},tue=({videoRef:t,setText:e})=>{const n=Zs(),r=s=>{s.preventDefault(),t.current.currentTime=0,n(xd()),n(Gh()),e(["Rewound video","Reset PGN to start position"])};return _.jsx(lo,{onClick:r,children:_.jsx(Il,{iconName:"bi-skip-start"})})},nue=({videoRef:t,canvasRef:e,setPlaying:n})=>{const r=L.useRef(null),[s,i]=L.useState(!1),o=()=>{if(t.current.src!==void 0){const l=t.current.src;t.current.src="",URL.revokeObjectURL(l)}TD(e.current.getContext("2d")),i(!1),r.current.value="",t.current.style.display="none"},a=l=>{const c=URL.createObjectURL(l.target.files[0]);t.current.src=c,t.current.style.display="block",i(!0)},u=()=>{s===!1?r.current.click():o(),n(!1)};return _.jsxs(_.Fragment,{children:[_.jsx("input",{type:"file",accept:"video/*",style:{display:"none"},onChange:a,ref:r}),_.jsx(lo,{onClick:u,children:_.jsx(Il,{iconName:s?"bi-folder-x":"bi-folder"})})]})},rue=({videoRef:t})=>{const e=({playbackRate:n})=>{const r=s=>{s.preventDefault(),t.current.playbackRate=n};return _.jsxs("button",{type:"button",className:"btn btn-secondary btn-dark btn-outline-light w-100",onClick:r,children:[n,"x"]})};return _.jsxs("div",{className:"btn-group w-100",role:"group",children:[_.jsx(e,{playbackRate:1}),_.jsx(e,{playbackRate:2}),_.jsx(e,{playbackRate:4})]})},sue=({videoRef:t,setPlaying:e,setText:n})=>{const r=Zs(),s=i=>{i.preventDefault(),t.current.src.startsWith("blob")&&(e(!1),r(xd()),r(Gh()),n(["Reset to start position"]))};return _.jsx(lo,{onClick:s,children:_.jsx(Il,{iconName:"bi-stop"})})},iue=({videoRef:t,xcornersModelRef:e,piecesModelRef:n,canvasRef:r,sidebarRef:s,text:i,setText:o,playing:a,setPlaying:u,cornersRef:l})=>{const c={display:a?"none":"inline-block"};return _.jsxs(Kh,{sidebarRef:s,playing:a,text:i,setText:o,children:[_.jsx("li",{className:"my-1",style:c,children:_.jsx(nue,{videoRef:t,canvasRef:r,setPlaying:u})}),_.jsx("li",{className:"my-1",style:c,children:_.jsx(Ug,{piecesModelRef:n,xcornersModelRef:e,videoRef:t,canvasRef:r,setText:o})}),_.jsx("li",{className:"my-1",style:c,children:_.jsx(FF,{piecesModelRef:n,videoRef:t,canvasRef:r,setText:o,cornersRef:l})}),_.jsx("li",{className:"my-1",style:c,children:_.jsx(rue,{videoRef:t})}),_.jsx("li",{className:"my-1",children:_.jsxs("div",{className:"btn-group w-100",role:"group",children:[_.jsx(eue,{videoRef:t,playing:a,setPlaying:u}),_.jsx(sue,{videoRef:t,setPlaying:u,setText:o}),_.jsx(tue,{videoRef:t,setText:o})]})})]})},oue=({setBoardNumber:t})=>{const e=n=>{t(parseInt(n.target.value))};return _.jsxs("div",{className:"text-white",children:[_.jsx("label",{className:"form-check-label",htmlFor:"board",children:"Board:"}),_.jsx("input",{type:"number",id:"board",onChange:e,min:1,max:64})]})},aue=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:i,setPlaying:o,text:a,setText:u,study:l,setStudy:c,setBoardNumber:d})=>{const f={display:i?"none":"inline-block"};return _.jsxs(Kh,{sidebarRef:s,playing:i,text:a,setText:u,children:[_.jsx("li",{className:"my-1",style:f,children:_.jsx(J2,{videoRef:n})}),_.jsx("li",{className:"my-1",style:f,children:_.jsx(LF,{study:l,setStudy:c,onlyBroadcasts:!0})}),_.jsx("li",{className:"my-1",style:f,children:_.jsx(oue,{setBoardNumber:d})}),_.jsx("li",{className:"my-1",style:f,children:_.jsx(Ug,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:u})}),_.jsx("li",{className:"my-1",children:_.jsxs("div",{className:"btn-group w-100",role:"group",children:[_.jsx(T2,{playing:i,setPlaying:o}),_.jsx(ZD,{setPlaying:o,setText:u})]})})]})},uue=({setGameId:t,setColor:e,setText:n})=>{const r=Xo().token,[s,i]=L.useState([]),[o,a]=L.useState(null),u=Zs(),l=async(d,f)=>{if(d.preventDefault(),(o==null?void 0:o.fullId)===f.fullId)return;a(f),t(f.gameId),e(f.color==="white"?"w":"b");const h=f.color==="white"?"White":"Black",p=f.opponent.username;n(["Starting game",`${h} vs ${p}`]);const y=new _2(f.fen),b=k2(y);u(R2(b)),u(YD(f.fen))},c=async d=>{d.preventDefault();const f=await qU(r);i(f.nowPlaying)};return _.jsxs("div",{className:"dropdown",children:[_.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"deviceButton","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:d=>c(d),children:o===null?"Select a Game":`Game: ${o.opponent.username}`}),_.jsx("ul",{className:"dropdown-menu","aria-labelledby":"deviceButton",children:s.map(d=>_.jsx("li",{children:_.jsxs("a",{onClick:f=>l(f,d),className:"dropdown-item",href:"#",children:[d.opponent.username," (",d.gameId,")"]})},d.fullId))})]})},lue=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:i,setPlaying:o,text:a,setText:u})=>{const l=Xo().token,c=wd(),d=L.useRef(c),[f,h]=L.useState(),[p,y]=L.useState(),b=Zs(),g={display:i?"none":"inline-block"};L.useEffect(()=>{d.current=c},[c]),L.useEffect(()=>{const w=d.current.fen.split(" ")[1],x=d.current.lastMove;w===p||x===""||f===void 0||p===void 0||HU(l,f,x)},[d.current]);const v=async w=>{const x=w.moves;if(x===void 0)return;const C=x.split(" "),k=C[C.length-1];if(k===d.current.lastMove)return;const P=Uv(d.current);P.move(k);const N=k2(P);console.log("payload",N),b(R2(N))};return L.useEffect(()=>{f!==void 0&&GU(l,v,f)},[f]),_.jsxs(Kh,{sidebarRef:s,playing:i,text:a,setText:u,children:[_.jsx("li",{className:"my-1",style:g,children:_.jsx(J2,{videoRef:n})}),_.jsx("li",{className:"my-1",style:g,children:_.jsx(uue,{setGameId:h,setColor:y,setText:u})}),_.jsx("li",{className:"my-1",style:g,children:_.jsx(Ug,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:u})}),_.jsx("li",{className:"my-1",children:_.jsx("div",{className:"btn-group w-100",role:"group",children:_.jsx(T2,{playing:i,setPlaying:o})})})]})};var Q2={};Q2.match=mue;Q2.parse=kF;var cue=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,due=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,fue=/^(?:(min|max)-)?(.+)/,hue=/(em|rem|px|cm|mm|in|pt|pc)?$/,pue=/(dpi|dpcm|dppx)?$/;function mue(t,e){return kF(t).some(function(n){var r=n.inverse,s=n.type==="all"||e.type===n.type;if(s&&r||!(s||r))return!1;var i=n.expressions.every(function(o){var a=o.feature,u=o.modifier,l=o.value,c=e[a];if(!c)return!1;switch(a){case"orientation":case"scan":return c.toLowerCase()===l.toLowerCase();case"width":case"height":case"device-width":case"device-height":l=yT(l),c=yT(c);break;case"resolution":l=gT(l),c=gT(c);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":l=mT(l),c=mT(c);break;case"grid":case"color":case"color-index":case"monochrome":l=parseInt(l,10)||1,c=parseInt(c,10)||0;break}switch(u){case"min":return c>=l;case"max":return c<=l;default:return c===l}});return i&&!r||!i&&r})}function kF(t){return t.split(",").map(function(e){e=e.trim();var n=e.match(cue),r=n[1],s=n[2],i=n[3]||"",o={};return o.inverse=!!r&&r.toLowerCase()==="not",o.type=s?s.toLowerCase():"all",i=i.match(/\([^\)]+\)/g)||[],o.expressions=i.map(function(a){var u=a.match(due),l=u[1].toLowerCase().match(fue);return{modifier:l[1],feature:l[2],value:u[2]}}),o})}function mT(t){var e=Number(t),n;return e||(n=t.match(/^(\d+)\s*\/\s*(\d+)$/),e=n[1]/n[2]),e}function gT(t){var e=parseFloat(t),n=String(t).match(pue)[1];switch(n){case"dpcm":return e/2.54;case"dppx":return e*96;default:return e}}function yT(t){var e=parseFloat(t),n=String(t).match(hue)[1];switch(n){case"em":return e*16;case"rem":return e*16;case"cm":return e*96/2.54;case"mm":return e*96/2.54/10;case"in":return e*96;case"pt":return e*72;case"pc":return e*72/12;default:return e}}var gue=Q2.match,bT=typeof window<"u"?window.matchMedia:null;function yue(t,e,n){var r=this,s;bT&&!n&&(s=bT.call(window,t)),s?(this.matches=s.matches,this.media=s.media,s.addListener(a)):(this.matches=gue(t,e),this.media=t),this.addListener=i,this.removeListener=o,this.dispose=u;function i(l){s&&s.addListener(l)}function o(l){s&&s.removeListener(l)}function a(l){r.matches=l.matches,r.media=l.media}function u(){s&&s.removeListener(a)}}function bue(t,e,n){return new yue(t,e,n)}var vue=bue;const wue=cd(vue);var xue=/[A-Z]/g,Sue=/^ms-/,tb={};function Aue(t){return"-"+t.toLowerCase()}function RF(t){if(tb.hasOwnProperty(t))return tb[t];var e=t.replace(xue,Aue);return tb[t]=Sue.test(e)?"-"+e:e}function Eue(t,e){if(t===e)return!0;if(!t||!e)return!1;const n=Object.keys(t),r=Object.keys(e),s=n.length;if(r.length!==s)return!1;for(let i=0;i<s;i++){const o=n[i];if(t[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}const xr=pt.oneOfType([pt.string,pt.number]),Z2={all:pt.bool,grid:pt.bool,aural:pt.bool,braille:pt.bool,handheld:pt.bool,print:pt.bool,projection:pt.bool,screen:pt.bool,tty:pt.bool,tv:pt.bool,embossed:pt.bool},PF={orientation:pt.oneOf(["portrait","landscape"]),scan:pt.oneOf(["progressive","interlace"]),aspectRatio:pt.string,deviceAspectRatio:pt.string,height:xr,deviceHeight:xr,width:xr,deviceWidth:xr,color:pt.bool,colorIndex:pt.bool,monochrome:pt.bool,resolution:xr,type:Object.keys(Z2)},{type:Gwe,...Cue}=PF,OF={minAspectRatio:pt.string,maxAspectRatio:pt.string,minDeviceAspectRatio:pt.string,maxDeviceAspectRatio:pt.string,minHeight:xr,maxHeight:xr,minDeviceHeight:xr,maxDeviceHeight:xr,minWidth:xr,maxWidth:xr,minDeviceWidth:xr,maxDeviceWidth:xr,minColor:pt.number,maxColor:pt.number,minColorIndex:pt.number,maxColorIndex:pt.number,minMonochrome:pt.number,maxMonochrome:pt.number,minResolution:xr,maxResolution:xr,...Cue},Nue={...Z2,...OF};var Tue={all:Nue,types:Z2,matchers:PF,features:OF};const _ue=t=>`not ${t}`,Iue=(t,e)=>{const n=RF(t);return typeof e=="number"&&(e=`${e}px`),e===!0?n:e===!1?_ue(n):`(${n}: ${e})`},kue=t=>t.join(" and "),Rue=t=>{const e=[];return Object.keys(Tue.all).forEach(n=>{const r=t[n];r!=null&&e.push(Iue(n,r))}),kue(e)},Pue=L.createContext(void 0),Oue=t=>t.query||Rue(t),vT=t=>t?Object.keys(t).reduce((n,r)=>(n[RF(r)]=t[r],n),{}):void 0,DF=()=>{const t=L.useRef(!1);return L.useEffect(()=>{t.current=!0},[]),t.current},Due=t=>{const e=L.useContext(Pue),n=()=>vT(t)||vT(e),[r,s]=L.useState(n);return L.useEffect(()=>{const i=n();Eue(r,i)||s(i)},[t,e]),r},Lue=t=>{const e=()=>Oue(t),[n,r]=L.useState(e);return L.useEffect(()=>{const s=e();n!==s&&r(s)},[t]),n},Fue=(t,e)=>{const n=()=>wue(t,e||{},!!e),[r,s]=L.useState(n),i=DF();return L.useEffect(()=>{if(i){const o=n();return s(o),()=>{o&&o.dispose()}}},[t,e]),r},$ue=t=>{const[e,n]=L.useState(t.matches);return L.useEffect(()=>{const r=s=>{n(s.matches)};return t.addListener(r),n(t.matches),()=>{t.removeListener(r)}},[t]),e},Bue=(t,e,n)=>{const r=Due(e),s=Lue(t);if(!s)throw new Error("Invalid or missing MediaQuery!");const i=Fue(s,r),o=$ue(i),a=DF();return L.useEffect(()=>{a&&n&&n(o)},[o]),L.useEffect(()=>()=>{i&&i.dispose()},[]),o},Mue=()=>_.jsx("h1",{className:"text-white text-center w-100 p-3 h-2",children:"Please use your device in landscape mode"}),om=({mode:t})=>{const e=XV(),n=Zs(),r=jD(),s=Xo().token,i=wd().moves,o=Bue({orientation:"portrait"}),[a,u]=L.useState([]),[l,c]=L.useState(!1),[d,f]=L.useState(null),[h,p]=L.useState(-1),y=L.useRef(null),b=L.useRef(l),g=L.useRef(null),v=L.useRef(null),w=L.useRef(r);L.useEffect(()=>{if(t!=="broadcast"||d===null||h===-1)return;const k=['[Result "*"]',`[FEN "${Bv}"]`,`[Board "${h}"]`,`[Site "${h}"]`,`[White "White ${h}"]`,`[Black "Black ${h}"]`,'[Annotator "Chess Academy"]',"",i].join("\r");jU(s,k,d.id)},[i]),L.useEffect(()=>{b.current=l},[l]),L.useEffect(()=>{w.current=r},[r]),L.useEffect(()=>{Zae(e.piecesModelRef,e.xcornersModelRef),n(mJ()),n(QD()),n(xd()),n(Gh())},[]);const x={playing:l,text:a,study:d,setPlaying:c,setText:u,setBoardNumber:p,setStudy:f,piecesModelRef:e.piecesModelRef,xcornersModelRef:e.xcornersModelRef,videoRef:y,canvasRef:g,sidebarRef:v,cornersRef:w,playingRef:b,mode:t},C=()=>{switch(t){case"record":return _.jsx(Jae,{...x});case"upload":return _.jsx(iue,{...x});case"play":return _.jsx(lue,{...x});case"broadcast":return _.jsx(aue,{...x})}};return _.jsx(wF,{children:o?_.jsx(Mue,{}):_.jsxs(_.Fragment,{children:[C(),_.jsx(Aoe,{...x})]})})},LF=({study:t,setStudy:e,onlyBroadcasts:n})=>{const[r,s]=L.useState([]),i=Xo();L.useEffect(()=>{UU(i.token,s,i.username,n)},[]);const o=(a,u)=>{a.preventDefault(),e(u)};return _.jsxs("div",{className:"dropdown",children:[_.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",children:t===null?"Select a Study":`Study: ${t.name}`}),_.jsx("ul",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton1",children:r.map(a=>_.jsx("li",{children:_.jsxs("a",{onClick:u=>o(u,a),className:"dropdown-item",href:"#",children:[a.name," (",a.id,")"]})},a.id))})]})},Vue=(t,e)=>{let n=t.fen();const r=e==="w"?"b":"w";n=n.replace(` ${r} `,` ${e} `);let s=null;for(let i=0;i<64;i++){const o=B0[i],a=t.get(o),u=a.type==="k",l=a.color===r,c=t.isAttacked(o,e);if(u&&l&&c)return s="Side to move has opponent in check",{fen:n,error:s}}return{fen:n,error:s}},Uue=(t,e,n,r)=>{const s=Array(64).fill(-1);let i=-1,o=-1;for(let h=0;h<64;h++){const p=t[h][1];p>i&&(i=p,o=h)}s[o]=1;let a=-1,u=-1;for(let h=0;h<64;h++){if(h==o)continue;const p=t[h][7];p>a&&(a=p,u=h)}s[u]=7;const l=[0,2,3,4,5,6,8,9,10,11];for(let h=0;h<64;h++){if(s[h]!==-1)continue;let p=null,y=.3;l.forEach(b=>{const g=B0[h],v=g[1]==="1"||g[1]==="8";if(GC[b%6]==="p"&&v)return;const x=t[h][b];x>y&&(p=b,y=x)}),p!==null&&(s[h]=p)}const c=new _2;c.clear();for(let h=0;h<64;h++){if(s[h]===-1)continue;const p=GC[s[h]%6],y=s[h]>5?"w":"b",b=B0[h];c.put({type:p,color:y},b)}const{fen:d,error:f}=Vue(c,e);f===null?(n(YD(d)),n(jJ(d)),n(xd()),r(["Set starting FEN"])):r(["Invalid FEN:",f])},zue=async({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:i,color:o})=>{if(A2(e))return;const a=CF(n,r),u=BD(a),[l,c]=MD(u),[d,f]=VD(u),{boxes:h,scores:p}=await EF(t,e,a),y=SF(h,c,f),b=AF(p,y);Uue(b,o,s,i),xF(r.current,l,d,b),rn([h,p,c,f])},Wue=async({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:i,color:o})=>{const a=sd().numTensors;await zue({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:i,color:o});const u=sd().numTensors;return a<u&&console.error(`Memory Leak! (${u} > ${a})`),()=>{Vx()}},FF=({piecesModelRef:t,videoRef:e,canvasRef:n,setText:r,cornersRef:s})=>{const i=["Normal","Infer (White to move)","Infer (Black to move)"],o=Zs(),[a,u]=L.useState(i[0]),l=(c,d)=>{if(c.preventDefault(),d==="Normal")o(QD()),o(xd()),o(Gh());else{const f=d.includes("White to move")?"w":"b";Wue({piecesModelRef:t,videoRef:e,cornersRef:s,canvasRef:n,dispatch:o,setText:r,color:f})}u(d)};return _.jsxs("div",{className:"dropdown",children:[_.jsxs("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",children:["Start: ",a]}),_.jsx("ul",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton1",children:i.map(c=>_.jsx("li",{children:_.jsx("a",{onClick:d=>l(d,c),className:"dropdown-item",href:"#",children:c})},c))})]})},J2=({videoRef:t})=>{const[e,n]=L.useState([]),[r,s]=L.useState(null),i=async(o,a)=>{if(o.preventDefault(),(r==null?void 0:r.deviceId)===a.deviceId)return;s(a);const u={...ND};u.video.deviceId=a.deviceId;const l=await navigator.mediaDevices.getUserMedia(u);t.current.srcObject=l};return L.useEffect(()=>{const o=[];navigator.mediaDevices.enumerateDevices().then(a=>{a.forEach(u=>{u.kind=="videoinput"&&o.push(u)})}).catch(a=>{console.error(`${a.name}: ${a.message}`)}),n(o)},[]),_.jsxs("div",{className:"dropdown",children:[_.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"deviceButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:r===null?"Select a Device":`Device: ${r.label.split("(")[0]}`}),_.jsx("ul",{className:"dropdown-menu","aria-labelledby":"deviceButton",children:e.map(o=>_.jsx("li",{children:_.jsx("a",{onClick:a=>i(a,o),className:"dropdown-item",href:"#",children:o.label.split("(")[0]})},o.deviceId))})]})},jue=({study:t,setText:e,pgn:n})=>{const r=Xo().token,s=()=>{const o=new Date,a=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0"),l=String(o.getDate()).padStart(2,"0"),c=String(o.getHours()).padStart(2,"0"),d=String(o.getMinutes()).padStart(2,"0"),f=String(o.getSeconds()).padStart(2,"0");return`${a}-${u}-${l}-${c}-${d}-${f}`},i=async()=>{if(t===null){e(["Please select a study"]);return}const o=s();WU(r,n,o,t.id),e(["Exported game to",`"${t.name}/${o}"`])};return _.jsx(lo,{onClick:i,children:"Export Game"})},Gue=({pgn:t})=>{const[e,n]=L.useState(null),[r,s]=L.useState(["Select a study","Export the game"]);return _.jsxs(Kh,{playing:!1,text:r,setText:s,children:[_.jsx("li",{className:"border-top"}),_.jsx("li",{className:"my-2",children:_.jsx(LF,{study:e,setStudy:n,onlyBroadcasts:!1})}),_.jsx("li",{className:"my-2",children:_.jsx(jue,{study:e,setText:s,pgn:t})})]})},que=({pgn:t})=>{const[e,n]=L.useState(""),r=Xo().token,s=async()=>{const o=`https://lichess.org/embed/game/${(await zU(r,t)).id}?theme=brown&bg=dark`;n(o)};return L.useEffect(()=>{s()},[]),_.jsx("div",{className:"ratio ratio-21x9",children:_.jsx("iframe",{src:e})})},Hue=()=>{const t=I2(wd());return _.jsxs(wF,{children:[_.jsx(Gue,{pgn:t}),_.jsx(que,{pgn:t})]})},Kue=()=>_.jsxs("div",{className:"page",children:[_.jsx("div",{className:"header",children:_.jsx("div",{className:"container",children:_.jsx("p",{className:"title",children:"Privacy Policy for ChessCam"})})}),_.jsx("div",{className:"translations-content-container",children:_.jsx("div",{className:"container",children:_.jsxs("div",{className:"tab-content translations-content-item en visible",id:"en",children:[_.jsx("h1",{children:"Privacy Policy"}),_.jsx("p",{children:"Last updated: December 08, 2023"}),_.jsx("p",{children:"This Privacy Policy describes Our policies and procedures on the collection, use and disclosure of Your information when You use the Service and tells You about Your privacy rights and how the law protects You."}),_.jsx("p",{children:"We use Your Personal data to provide and improve the Service. By using the Service, You agree to the collection and use of information in accordance with this Privacy Policy."}),_.jsx("h2",{children:"Interpretation and Definitions"}),_.jsx("h3",{children:"Interpretation"}),_.jsx("p",{children:"The words of which the initial letter is capitalized have meanings defined under the following conditions. The following definitions shall have the same meaning regardless of whether they appear in singular or in plural."}),_.jsx("h3",{children:"Definitions"}),_.jsx("p",{children:"For the purposes of this Privacy Policy:"}),_.jsxs("ul",{children:[_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Account"})," means a unique account created for You to access our Service or parts of our Service."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Affiliate"}),' means an entity that controls, is controlled by or is under common control with a party, where "control" means ownership of 50% or more of the shares, equity interest or other securities entitled to vote for election of directors or other managing authority.']})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Application"})," refers to ChessCam, the software program provided by the Company."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Company"}),' (referred to as either "the Company", "We", "Us" or "Our" in this Agreement) refers to ChessCam.']})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Country"})," refers to: United Kingdom"]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Device"})," means any device that can access the Service such as a computer, a cellphone or a digital tablet."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Personal Data"})," is any information that relates to an identified or identifiable individual."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Service"})," refers to the Application."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Service Provider"})," means any natural or legal person who processes the data on behalf of the Company. It refers to third-party companies or individuals employed by the Company to facilitate the Service, to provide the Service on behalf of the Company, to perform services related to the Service or to assist the Company in analyzing how the Service is used."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"Usage Data"})," refers to data collected automatically, either generated by the use of the Service or from the Service infrastructure itself (for example, the duration of a page visit)."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"You"})," means the individual accessing or using the Service, or the company, or other legal entity on behalf of which such individual is accessing or using the Service, as applicable."]})})]}),_.jsx("h2",{children:"Collecting and Using Your Personal Data"}),_.jsx("h3",{children:"Types of Data Collected"}),_.jsx("h4",{children:"Personal Data"}),_.jsx("p",{children:"While using Our Service, We may ask You to provide Us with certain personally identifiable information that can be used to contact or identify You. Personally identifiable information may include, but is not limited to:"}),_.jsx("ul",{children:_.jsx("li",{children:"Usage Data"})}),_.jsx("h4",{children:"Usage Data"}),_.jsx("p",{children:"Usage Data is collected automatically when using the Service."}),_.jsx("p",{children:"Usage Data may include information such as Your Device's Internet Protocol address (e.g. IP address), browser type, browser version, the pages of our Service that You visit, the time and date of Your visit, the time spent on those pages, unique device identifiers and other diagnostic data."}),_.jsx("p",{children:"When You access the Service by or through a mobile device, We may collect certain information automatically, including, but not limited to, the type of mobile device You use, Your mobile device unique ID, the IP address of Your mobile device, Your mobile operating system, the type of mobile Internet browser You use, unique device identifiers and other diagnostic data."}),_.jsx("p",{children:"We may also collect information that Your browser sends whenever You visit our Service or when You access the Service by or through a mobile device."}),_.jsx("h3",{children:"Use of Your Personal Data"}),_.jsx("p",{children:"The Company may use Personal Data for the following purposes:"}),_.jsxs("ul",{children:[_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"To provide and maintain our Service"}),", including to monitor the usage of our Service."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"To manage Your Account:"})," to manage Your registration as a user of the Service. The Personal Data You provide can give You access to different functionalities of the Service that are available to You as a registered user."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"For the performance of a contract:"})," the development, compliance and undertaking of the purchase contract for the products, items or services You have purchased or of any other contract with Us through the Service."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"To contact You:"})," To contact You by email, telephone calls, SMS, or other equivalent forms of electronic communication, such as a mobile application's push notifications regarding updates or informative communications related to the functionalities, products or contracted services, including the security updates, when necessary or reasonable for their implementation."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"To provide You"})," with news, special offers and general information about other goods, services and events which we offer that are similar to those that you have already purchased or enquired about unless You have opted not to receive such information."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"To manage Your requests:"})," To attend and manage Your requests to Us."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"For business transfers:"})," We may use Your information to evaluate or conduct a merger, divestiture, restructuring, reorganization, dissolution, or other sale or transfer of some or all of Our assets, whether as a going concern or as part of bankruptcy, liquidation, or similar proceeding, in which Personal Data held by Us about our Service users is among the assets transferred."]})}),_.jsx("li",{children:_.jsxs("p",{children:[_.jsx("strong",{children:"For other purposes"}),": We may use Your information for other purposes, such as data analysis, identifying usage trends, determining the effectiveness of our promotional campaigns and to evaluate and improve our Service, products, services, marketing and your experience."]})})]}),_.jsx("p",{children:"We may share Your personal information in the following situations:"}),_.jsxs("ul",{children:[_.jsxs("li",{children:[_.jsx("strong",{children:"With Service Providers:"})," We may share Your personal information with Service Providers to monitor and analyze the use of our Service, to contact You."]}),_.jsxs("li",{children:[_.jsx("strong",{children:"For business transfers:"})," We may share or transfer Your personal information in connection with, or during negotiations of, any merger, sale of Company assets, financing, or acquisition of all or a portion of Our business to another company."]}),_.jsxs("li",{children:[_.jsx("strong",{children:"With Affiliates:"})," We may share Your information with Our affiliates, in which case we will require those affiliates to honor this Privacy Policy. Affiliates include Our parent company and any other subsidiaries, joint venture partners or other companies that We control or that are under common control with Us."]}),_.jsxs("li",{children:[_.jsx("strong",{children:"With business partners:"})," We may share Your information with Our business partners to offer You certain products, services or promotions."]}),_.jsxs("li",{children:[_.jsx("strong",{children:"With other users:"})," when You share personal information or otherwise interact in the public areas with other users, such information may be viewed by all users and may be publicly distributed outside."]}),_.jsxs("li",{children:[_.jsx("strong",{children:"With Your consent"}),": We may disclose Your personal information for any other purpose with Your consent."]})]}),_.jsx("h3",{children:"Retention of Your Personal Data"}),_.jsx("p",{children:"The Company will retain Your Personal Data only for as long as is necessary for the purposes set out in this Privacy Policy. We will retain and use Your Personal Data to the extent necessary to comply with our legal obligations (for example, if we are required to retain your data to comply with applicable laws), resolve disputes, and enforce our legal agreements and policies."}),_.jsx("p",{children:"The Company will also retain Usage Data for internal analysis purposes. Usage Data is generally retained for a shorter period of time, except when this data is used to strengthen the security or to improve the functionality of Our Service, or We are legally obligated to retain this data for longer time periods."}),_.jsx("h3",{children:"Transfer of Your Personal Data"}),_.jsx("p",{children:"Your information, including Personal Data, is processed at the Company's operating offices and in any other places where the parties involved in the processing are located. It means that this information may be transferred to  and maintained on  computers located outside of Your state, province, country or other governmental jurisdiction where the data protection laws may differ than those from Your jurisdiction."}),_.jsx("p",{children:"Your consent to this Privacy Policy followed by Your submission of such information represents Your agreement to that transfer."}),_.jsx("p",{children:"The Company will take all steps reasonably necessary to ensure that Your data is treated securely and in accordance with this Privacy Policy and no transfer of Your Personal Data will take place to an organization or a country unless there are adequate controls in place including the security of Your data and other personal information."}),_.jsx("h3",{children:"Delete Your Personal Data"}),_.jsx("p",{children:"You have the right to delete or request that We assist in deleting the Personal Data that We have collected about You."}),_.jsx("p",{children:"Our Service may give You the ability to delete certain information about You from within the Service."}),_.jsx("p",{children:"You may update, amend, or delete Your information at any time by signing in to Your Account, if you have one, and visiting the account settings section that allows you to manage Your personal information. You may also contact Us to request access to, correct, or delete any personal information that You have provided to Us."}),_.jsx("p",{children:"Please note, however, that We may need to retain certain information when we have a legal obligation or lawful basis to do so."}),_.jsx("h3",{children:"Disclosure of Your Personal Data"}),_.jsx("h4",{children:"Business Transactions"}),_.jsx("p",{children:"If the Company is involved in a merger, acquisition or asset sale, Your Personal Data may be transferred. We will provide notice before Your Personal Data is transferred and becomes subject to a different Privacy Policy."}),_.jsx("h4",{children:"Law enforcement"}),_.jsx("p",{children:"Under certain circumstances, the Company may be required to disclose Your Personal Data if required to do so by law or in response to valid requests by public authorities (e.g. a court or a government agency)."}),_.jsx("h4",{children:"Other legal requirements"}),_.jsx("p",{children:"The Company may disclose Your Personal Data in the good faith belief that such action is necessary to:"}),_.jsxs("ul",{children:[_.jsx("li",{children:"Comply with a legal obligation"}),_.jsx("li",{children:"Protect and defend the rights or property of the Company"}),_.jsx("li",{children:"Prevent or investigate possible wrongdoing in connection with the Service"}),_.jsx("li",{children:"Protect the personal safety of Users of the Service or the public"}),_.jsx("li",{children:"Protect against legal liability"})]}),_.jsx("h3",{children:"Security of Your Personal Data"}),_.jsx("p",{children:"The security of Your Personal Data is important to Us, but remember that no method of transmission over the Internet, or method of electronic storage is 100% secure. While We strive to use commercially acceptable means to protect Your Personal Data, We cannot guarantee its absolute security."}),_.jsx("h2",{children:"Children's Privacy"}),_.jsx("p",{children:"Our Service does not address anyone under the age of 13. We do not knowingly collect personally identifiable information from anyone under the age of 13. If You are a parent or guardian and You are aware that Your child has provided Us with Personal Data, please contact Us. If We become aware that We have collected Personal Data from anyone under the age of 13 without verification of parental consent, We take steps to remove that information from Our servers."}),_.jsx("p",{children:"If We need to rely on consent as a legal basis for processing Your information and Your country requires consent from a parent, We may require Your parent's consent before We collect and use that information."}),_.jsx("h2",{children:"Links to Other Websites"}),_.jsx("p",{children:"Our Service may contain links to other websites that are not operated by Us. If You click on a third party link, You will be directed to that third party's site. We strongly advise You to review the Privacy Policy of every site You visit."}),_.jsx("p",{children:"We have no control over and assume no responsibility for the content, privacy policies or practices of any third party sites or services."}),_.jsx("h2",{children:"Changes to this Privacy Policy"}),_.jsx("p",{children:"We may update Our Privacy Policy from time to time. We will notify You of any changes by posting the new Privacy Policy on this page."}),_.jsx("p",{children:'We will let You know via email and/or a prominent notice on Our Service, prior to the change becoming effective and update the "Last updated" date at the top of this Privacy Policy.'}),_.jsx("p",{children:"You are advised to review this Privacy Policy periodically for any changes. Changes to this Privacy Policy are effective when they are posted on this page."}),_.jsx("h2",{children:"Contact Us"}),_.jsx("p",{children:"If you have any questions about this Privacy Policy, You can contact us:"}),_.jsx("ul",{children:_.jsx("li",{children:"By email: camerachess1@gmail.com"})})]})})}),_.jsx("div",{className:"footer",children:_.jsx("div",{className:"container"})})]});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fu={},am={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Xue(t,e){Fu[t]=e}function Oi(t,e){if(!(t in Fu)||e!=null){const r=Que(t,e);if(r!==null)Fu[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Fu[t];return n==null||n.isContextLost()?(delete Fu[t],Oi(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Fu[t])}function Yue(t){if(!X().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Que(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Yue(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Fu[t]},!1),X().getBool("SOFTWARE_WEBGL_ENABLED")&&(am.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",am)||n.getContext("experimental-webgl",am):n.getContext("webgl2",am)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Nh;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Nh||(Nh={}));var as;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(as||(as={}));var Pn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Pn||(Pn={}));function Xh(t,e){return[e,t]}function Zue(t,e){return t*e}function um(t){const e=de(t),n=Math.ceil(e/4);return dv(n)}function Td(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Jue(t,e){const[n,r]=Td(t,e);return n*r*4}function eS(t,e){const n=t;let r,s,i,o,a,u,l,c,d,f;return X().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,l=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,u=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,l=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,u=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t,e){const n=e();return X().getBool("DEBUG")&&ele(t),n}function ele(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+sle(t,e))}const tle=596e-10,nle=65504;function rle(t){return!!(X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||tle<Math.abs(t)&&Math.abs(t)<nle)}function sle(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function lm(t,e){return Qo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ile(t,e){const n=Qo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ye(t,()=>t.shaderSource(n,e)),ye(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ole(t,e){const n=Qo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ye(t,()=>t.shaderSource(n,e)),ye(t,()=>t.compileShader(n)),X().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw $F(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const ale=/ERROR: [0-9]+:([0-9]+):/g;function $F(t,e){const n=ale.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((d,f)=>Lc((f+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const u=o.slice(0,r-1),l=o.slice(r-1,r),c=o.slice(r);console.log(u.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Lc(l[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function ule(t){return Qo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function lle(t,e){if(ye(t,()=>t.linkProgram(e)),!X().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function nb(t,e){if(ye(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function cle(t,e){const n=Qo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ye(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function dle(t,e){const n=Qo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ye(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function fle(t){return Qo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function hle(t,e){const n=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function ple(t){return Qo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function wT(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),ye(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),ye(t,()=>t.enableVertexAttribArray(a)),!0)}function mle(t,e,n){wle(t,n),ye(t,()=>t.activeTexture(t.TEXTURE0+n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function gle(t,e,n){return Qo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function yle(t,e,n){return t.getUniformLocation(e,n)}function ble(t,e,n,r){ye(t,()=>mle(t,e,r)),ye(t,()=>t.uniform1i(n,r))}function rb(t,e,n){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function xT(t,e){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function cm(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+vle(t,e))}function vle(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Qo(t,e,n){const r=ye(t,()=>e());if(r==null)throw new Error(n);return r}function wle(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function ud(t,e=2){return de(t.slice(0,t.length-e))}function ld(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function dm(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ud(t),...ld(t)]),e}function xle(t,e=!1){let n=X().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=X().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&X().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,u)=>u>=t.length-2?Rx(t[u]):t[u]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Qa(t).newShape);let s=de(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=ud(t);let u=2,l=2;t.length&&([u,l]=ld(t)),s=a*(u/2)*(l/2),i=dv(s).map(c=>c*2)}else i=dv(s);return i}function fm(t){return t%2===0}function X0(t,e){if(t=t.slice(-2),e=e.slice(-2),qt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||fm(n)&&fm(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&fm(t[0])&&fm(e[0])}let sb,ib;function Sle(t){if(sb==null){const e=Oi(t);sb=e.getParameter(e.MAX_TEXTURE_SIZE)}return sb}function Ale(t){if(ib==null){const e=Oi(t);ib=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ib)}function Ele(t){if(t===0)return 0;let e;const n=Oi(t);return Gs(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Gs(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Gs(t,e){return t.getExtension(e)!=null}function ST(t){try{if(Oi(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Cle(t){if(t===0)return!1;const e=Oi(t);if(t===1){if(!Gs(e,"OES_texture_float"))return!1}else if(!Gs(e,"EXT_color_buffer_float"))return!1;return gw(e)}function Nle(t){if(t===0)return!1;const e=Oi(t);if(t===1){if(!Gs(e,"OES_texture_float")||!Gs(e,"WEBGL_color_buffer_float"))return!1}else{if(Gs(e,"EXT_color_buffer_float"))return gw(e);const r="EXT_color_buffer_half_float";if(Gs(e,r)){const s=e.getExtension(r);return Tle(e,s)}return!1}return gw(e)}function gw(t){const e=eS(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Tle(t,e){const n=eS(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function _le(t){return t!==2?!1:Oi(t).fenceSync!=null}function Yh(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&R(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ne=X();Ne.registerFlag("HAS_WEBGL",()=>Ne.getNumber("WEBGL_VERSION")>0);Ne.registerFlag("WEBGL_VERSION",()=>ST(2)?2:ST(1)?1:0);Ne.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ne.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ne.get("WEBGL_VERSION")===2);Ne.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ne.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ne.registerFlag("WEBGL_PACK",()=>Ne.getBool("HAS_WEBGL"));Ne.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_CLIP",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_REDUCE",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_CONV_IM2COL",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ne.getBool("WEBGL_PACK"));Ne.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Sle(Ne.getNumber("WEBGL_VERSION")));Ne.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Ale(Ne.getNumber("WEBGL_VERSION")));Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ne.getNumber("WEBGL_VERSION");return t===0?0:Ele(t)});Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ne.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!hO());Ne.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Cle(Ne.getNumber("WEBGL_VERSION")));Ne.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ne.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ne.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ne.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Nle(Ne.getNumber("WEBGL_VERSION")));Ne.registerFlag("WEBGL_FENCE_API_ENABLED",()=>_le(Ne.getNumber("WEBGL_VERSION")));Ne.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ne.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ne.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ne.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>hO()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ne.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ne.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ne.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ne.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ne.registerFlag("WEBGL_EXP_CONV",()=>!1);Ne.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ne.getBool("IS_TEST"));Ne.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ne.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ne.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ne.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(){let t,e,n,r,s,i,o,a,u,l;return X().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=X().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(t,e,n="index"){const r=Dn(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function a1(t,e,n="index"){const r=Dn(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Ile(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function kle(t,e,n="index"){const r=t.map((i,o)=>o),s=Ile(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,u=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${u};`}).join("")}function tS(t){const e=Dn(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function nS(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const BF=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:MF}=NY;function Rle(t,e,n){const r=[];if(t.forEach(h=>{const p=de(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:y}=rS(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(y.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(h=>Ple(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=fr(),u=Lle(a);let l,c,d=Ble(a);return e.isPacked?(l=Ole(e.logicalShape,o,n.enableShapeUniforms),c=$le(a)):(l=Dle(e.logicalShape,o,n.enableShapeUniforms),c=Fle(a)),n.packedInputs&&(d+=zle),[d,u,c,s,l,i,n.userCode].join(`
`)}function _d(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return ece(t,e);case 1:return nce(t,e);case 2:return sce(t,e);case 3:return oce(t,e);case 4:return uce(t,e);case 5:return lce(t);case 6:return cce(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function VF(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Jle(t);case 1:return tce(t,e);case 2:return rce(t,e);case 3:return ice(t,e);default:return ace(t,e)}}function Ple(t,e,n=!1,r){let s="";n?s+=VF(t,r):s+=_d(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=dce(t,e):s+=fce(t,e)),s}function Ole(t,e,n){switch(t.length){case 0:return UF();case 1:return Wle(t,e,n);case 2:return Qle(t,e,n);case 3:return Gle(t,e,n);default:return Hle(t,e,n)}}function Dle(t,e,n){switch(t.length){case 0:return UF();case 1:return jle(t,e,n);case 2:return Zle(t,e,n);case 3:return qle(t,e,n);case 4:return Kle(t,e,n);case 5:return Xle(t,e);case 6:return Yle(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Lle(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Fle(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function $le(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Ble(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Mle}
    ${Vle}
    ${Ule}
  `}const Mle=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vle=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ule=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,zle=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function UF(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Wle(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function jle(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Gle(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function qle(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${a1(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Ol(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Hle(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",u="b, r, c";for(let l=2;l<t.length-1;l++)o*=t[t.length-l-1],a=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+a,u=`b${l}, `+u;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${u});
    }
  `}function Kle(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${a1(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Ol(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Xle(t,e){const n=Ol(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Yle(t,e){const n=Ol(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Qle(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(qt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function Zle(t,e,n){return qt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Dl(t){return`offset${t}`}function Jle(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=fr();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function ece(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Dl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,u]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${u}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function tce(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=fr();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function nce(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Id(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Dl(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function rce(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],u=fr();if(i!=null&&qt(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${u.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${u.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${l[0]}, ${l[1]}, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function sce(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&qt(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const f=i[0],h=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=Qa(n),u=o;if(u.length<n.length){const f=kd(t,u),h=["row","col"];return`
      ${_d(f,e)}
      float ${s}(int row, int col) {
        return ${s}(${Rd(h,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Id(t)}
      }
    `;const l=i[0],c=i[1],d=Dl(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${l}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function ice(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const f=n.slice(1),h=[1,2],p=kd(t,f),y=["b","row","col"];return`
        ${VF(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Rd(y,h)});
        }
      `}const a=fr();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const u=o[0],l=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${l}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function oce(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:u}=Qa(n),l=a;if(l.length<n.length){const y=kd(t,l),b=["row","col","depth"];return`
        ${_d(y,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Rd(b,u)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Id(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===i&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===o&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Dl(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function ace(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=fr();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=u[0],c=u[1],d=Math.ceil(i[o-1]/2);let f=d*Math.ceil(i[o-2]/2),h="int b, int row, int col",p=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let y=2;y<o-1;y++)h=`int b${y}, `+h,f*=i[o-y-1],p=`b${y} * ${f} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${l});
      return ${s.texture2D}(${n}, uv);
    }
  `}function uce(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:u,keptDims:l}=Qa(n);if(u.length<n.length){const v=kd(t,u),w=["row","col","depth","depth2"];return`
      ${_d(v,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Rd(w,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Id(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1],p=`int stride2 = ${r}Shape[3];`,y=`int stride1 = ${r}Shape[2] * stride2;`,b=`int stride0 = ${r}Shape[1] * stride1;`;if(h===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===i&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=Dl(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${y}
      ${b}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${f}, ${h}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function lce(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:u,keptDims:l}=Qa(e);if(u.length<e.length){const y=kd(t,u),b=["row","col","depth","depth2","depth3"];return`
      ${_d(y)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Rd(b,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${Id(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Dl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function cce(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=Qa(e);if(s.length<e.length){const b=kd(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${_d(b)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Rd(g,i)});
      }
    `}const o=e[5],a=e[4]*o,u=e[3]*a,l=e[2]*u,c=e[1]*l;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${l}, ${u}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Id(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${u}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=Dl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${l} + depth * ${u} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Id(t){const e=t.name,n=de(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function dce(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=MF(t.shapeInfo.logicalShape,e.logicalShape),u=wt(o),l=o-i;let c;const d=["x","y","z","w","u","v"];i===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(v=>`coords.${d[v+l]} = 0;`).join(`
`);let f="";o<2&&i>0?f="coords":f=t.shapeInfo.logicalShape.map((v,w)=>`coords.${d[w+l]}`).join(", ");let h="return outputValue;";const y=de(t.shapeInfo.logicalShape)===1,g=de(e.logicalShape)===1;if(i===1&&!y&&!g)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(y&&!g)o===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=i-2,w=i-1;a.indexOf(v)>-1&&a.indexOf(w)>-1?h="return vec4(outputValue.x);":a.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${u} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${f});
      ${h}
    }
  `}function fce(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===u&&t.shapeInfo.flatOffset==null&&qt(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const l=wt(u),c=MF(t.shapeInfo.logicalShape,e.logicalShape),d=u-a;let f;const h=["x","y","z","w","u","v"];a===0?f="":u<2&&c.length>=1?f="coords = 0;":f=c.map(y=>`coords.${h[y+d]} = 0;`).join(`
`);let p="";return u<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((y,b)=>`coords.${h[b+d]}`).join(", "),`
    float ${s}() {
      ${l} coords = getOutputCoords();
      ${f}
      return get${r}(${p});
    }
  `}function wt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function rS(t,e,n){const{newShape:r,keptDims:s}=Qa(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,u=!t&&i>1&&!qt(e,n)&&r.length<i||o;return{useSqueezeShape:u,uniformShape:u?a:e,keptDims:s}}function kd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Rd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t,e,n,r){const s=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),i=s.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Rle(s,o,e),u=ole(t.gl,a),l=t.createProgram(u);return X().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(l),Object.assign({program:e,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:i,outShapeInfo:o},zF(t,e,l)))}function zF(t,e,n){const r=[],s=[];let i,o,a,u=null,l=null;l=t.getUniformLocation(n,"NAN",!1),X().getNumber("WEBGL_VERSION")===1&&(u=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(f)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),o=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:u,nanLoc:l,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function AT(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!qt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!qt(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function pce(t,e,n,r,s){e.program.enableShapeUniforms||(AT(e.inShapeInfos,n),AT([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),X().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<n.length;++u){const l=n[u],{uniform:c,offset:d,shape:f,texShape:h}=e.variablesLocations[u];if(f){const{uniformShape:p}=rS(e.program.packedInputs,l.shape,l.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(f,new Int32Array(p));break;case 2:t.gl.uniform2iv(f,new Int32Array(p));break;case 3:t.gl.uniform3iv(f,new Int32Array(p));break;case 4:t.gl.uniform4iv(f,new Int32Array(p));break}}if(h&&t.gl.uniform2i(h,l.texData.texShape[0],l.texData.texShape[1]),c!=null){if(l.isUniform){if(de(l.shape)<2)t.gl.uniform1f(c,l.uniformValues[0]);else{let p=l.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}l.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,c,u)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const u=Dn(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let u=0;u<e.program.customUniforms.length;++u){const l=e.program.customUniforms[u],c=e.customUniformLocations[u],d=s[u];if(l.type==="float")t.gl.uniform1fv(c,d);else if(l.type==="vec2")t.gl.uniform2fv(c,d);else if(l.type==="vec3")t.gl.uniform3fv(c,d);else if(l.type==="vec4")t.gl.uniform4fv(c,d);else if(l.type==="int")t.gl.uniform1iv(c,d);else if(l.type==="ivec2")t.gl.uniform2iv(c,d);else if(l.type==="ivec3")t.gl.uniform3iv(c,d);else if(l.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}t.executeProgram()}function mce(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const u=o.texData.texShape,{useSqueezeShape:l,uniformShape:c,keptDims:d}=rS(t.packedInputs,o.shape,u);let f="",h="",p="";if(c.length===1&&t.packedInputs){const C=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];f=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const C=Dn(c);p=`${C[0]===u[1]}_${C[C.length-1]===u[1]}`}const y=o.shape.length,b=c.length===2&&qt(o.shape,u),g=de(o.shape)===1,v=k0(o.shape,n.shape),w=!t.packedInputs&&y===n.shape.length&&qt(u,n.texData.texShape),x=t.packedInputs||c.length>2?"":`${u[0]>1}_${u[1]>1}`;r+=`${y}_${w}_${l?d:""}_${c.length}_${g}_${v}_${b}_${f}_${h}_${p}_${x}_${a}`}else{const u=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${u}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${X().getNumber("WEBGL_VERSION")}`,i}function qn(t){return X().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gce{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Nh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=fr();this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?a1(["r","c","d"],e):Ol(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Nh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=fr();this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?a1(["r","c","d"],e):Ol(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bce{constructor(e){this.variableNames=["A"],this.outTexUsage=as.DOWNLOAD;const n=fr();this.outputShape=e,this.userCode=`
      ${BF}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=as.DOWNLOAD;const n=fr();this.outputShape=e,this.userCode=`
      ${BF}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce={R:0,G:1,B:2,A:3};class ET{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=fr();this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const u=r[a];o+=`
          if(offset == ${a}) {
            result = values[${wce[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?nS():tS(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xce{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=fr();this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const u=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?nS():tS(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(t){const e=fr(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ile(t,n)}function Ace(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return cle(t,e)}function Ece(t){const e=new Uint16Array([0,1,2,2,1,3]);return dle(t,e)}function Qh(t,e,n,r,s,i){hle(e,n);const o=fle(t),a=t.TEXTURE_2D;return ye(t,()=>t.bindTexture(a,o)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),X().getNumber("WEBGL_VERSION")===1?ye(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):ye(t,()=>t.texStorage2D(a,1,r,e,n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function WF(t){return t.internalFormatFloat}function Cce(t,e,n,r){const[s,i]=Xh(e,n);return Qh(t,s,i,WF(r),r.textureFormatFloat,t.FLOAT)}function jF(t){return t.internalFormatHalfFloat}function Nce(t,e,n,r){const[s,i]=Xh(e,n);return Qh(t,s,i,jF(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function GF(t){return t.downloadTextureFormat}function Tce(t,e,n,r){const[s,i]=Xh(e,n);return Qh(t,s,i,GF(r),t.RGBA,t.UNSIGNED_BYTE)}function qF(t){return t.internalFormatPackedFloat}function _ce(t,e,n,r){const[s,i]=Td(e,n);return Qh(t,s,i,qF(r),t.RGBA,t.FLOAT)}function HF(t){return t.internalFormatPackedHalfFloat}function Ice(t,e,n,r){const[s,i]=Td(e,n);return Qh(t,s,i,HF(r),t.RGBA,r.textureTypeHalfFloat)}function kce(t,e,n){return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),wT(t,e,"clipSpacePos",n,3,20,0)&&wT(t,e,"uv",n,2,20,12)}function Rce(t,e,n,r,s,i){ye(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,u;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,u=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,u=i.internalFormatPackedFloat),o.set(s),X().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,u,n,r,0,t.RGBA,a,o)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Pce(t,e,n){ye(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?X().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):X().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Oce(t,e,n,r){const s=t.createBuffer();ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return ye(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ye(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function Dce(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Lce(t,e,n,r){const[s,i]=Xh(e,n),o=4,a=new Uint8Array(Zue(e*n,o));return ye(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Fce(t,e,n,r,s,i,o,a){const u=t,l=new Float32Array(Jue(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function $ce(t,e,n){const r=new Float32Array(e*n*4);return ye(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ob{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=X().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Xue(n,e)):this.gl=Oi(n),e=this.gl,X().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>ye(i,()=>i.createVertexArray()),this.bindVertexArray=o=>ye(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>ye(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>ye(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ye(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>ye(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ye(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>ye(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),X().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=lm(this.gl,i),Gs(this.gl,o))this.textureHalfFloatExtension=lm(this.gl,o);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Gs(this.gl,s))this.colorBufferHalfFloatExtension=lm(this.gl,s);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Gs(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Gs(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Ace(this.gl),this.indexBuffer=Ece(this.gl),this.framebuffer=ple(this.gl),this.textureConfig=eS(this.gl,this.textureHalfFloatExtension)}get debug(){return X().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ye(e,()=>e.finish()),ye(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ye(e,()=>e.deleteFramebuffer(this.framebuffer)),ye(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ye(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ye(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Cce(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Nce(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Tce(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Pce(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Rce(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Ice(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),_ce(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(xT(this.gl,this.framebuffer),this.outputTexture=null),ye(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Lce(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return Fce(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Dce(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=Oce(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(X().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>$ce(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Sce(n));const r=ule(n);ye(n,()=>n.attachShader(r,this.vertexShader)),ye(n,()=>n.attachShader(r,e)),lle(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&nb(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ye(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),kce(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ye(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&nb(this.gl,this.program),ye(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?gle(this.gl,e,n):yle(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ye(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),ble(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=Td(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&nb(this.gl,this.program),cm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ye(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ye(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=lm(this.gl,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await xC(()=>this.disposed||this.isQueryAvailable(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Bce(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in X().platform&&(r=X().platform.setTimeoutCustom.bind(X().platform)),xC(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),rb(this.gl,e,this.framebuffer),this.debug&&cm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(rb(this.gl,this.outputTexture,this.framebuffer),this.debug&&cm(this.gl)):xT(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;rb(s,e,this.framebuffer),this.debug&&cm(s),this.outputTexture=e,ye(s,()=>s.viewport(0,0,n,r)),ye(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),ye(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Bce(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(t){return(e,n,r,s,i)=>{const o=st(e,n),a=o.length,u=Dn(o),l=de(o),c=Ua(i,l),d=e.length,f=n.length,h=Dn(e),p=Dn(n),y=k0(e,o),b=k0(n,o);if(y.length+b.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const v=Px(g,a,u),w=v.slice(-d);y.forEach(P=>w[P]=0);const x=mv(w,d,h),C=v.slice(-f);b.forEach(P=>C[P]=0);const k=mv(C,f,p);c[g]=t(r[x],s[k])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Tg([0],n),[i,o]=Rr((a,u)=>a!==u?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce=Rr((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t,e,n,r,s){const i=de(r),o=za(s,n);for(let a=0;a<t.length;a++){const u=t[a];if(u<0)throw new Error("Input x must be non-negative!");u>=s||(i>0?o[u]+=e[a]:o[u]+=1)}return o}function Wce(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=Ht([s,n],e.dtype);for(let a=0;a<s;a++)for(let u=0;u<i;u++){const l=t.get(a,u);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?o.set(1,a,l):e.size>0?o.set(o.get(a,l)+e.get(a,u),a,l):o.set(o.get(a,l)+1,a,l))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jce=Rr((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zo(t){return(e,n,r)=>{const s=Sn(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=Zo(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(t,e,n,r){const s=Sn(n,de(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=de(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?id(o.vals):o.vals;let u=0;for(let l=0;l<o.shape[0];++l){const c=l*e[1]+i;for(let d=0;d<o.shape[1];++d)s[c+d]=a[u++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce=Rr((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce=Zo(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xce=Zo(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yce=Zo(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce=Rr((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t,e,n,r,s,i,o,a,u){const l=Ht([r,i],n);for(let c=0;c<r;c++){const d=[];let f=0;for(let h=0;h<s;h++){const p=t[c*s+h];f+=p*o[h],d.push(p)}if(f<0||f>=u/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let h=0;h<i;h++)l.values[c*i+h]=e.get(...e.indexToLoc(f*i+h))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t,e,n){const r=Ht(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],u=o[2],l=e.locToIndex([a,u]);o[2]=e.values[l];const c=t.locToIndex(o);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede=Rr((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tde=Rr((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nde=Rr((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde=Rr((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(t,e,n){const r=(e-t)/(n-1),s=za(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ide=Zo(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(t,e,n,r){const s=Ua(r,de(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let u=0;u<e;++u){const l=t[o+u];(Number.isNaN(l)||l>a)&&(a=l)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ade=Rr((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude=Rr((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KF=Rr((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t,e,n){const r=md(-1,n);return KF([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde=Rr((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t,e,n,r,s){const i=e.length,o=de(e),a=Dn(e),u=Dn(s),l=Ua(n,de(s));for(let c=0;c<o;++c){const d=Px(c,i,a),f=new Array(d.length);for(let p=0;p<f.length;p++)f[p]=d[r[p]];const h=mv(f,i,u);l[h]=t[c]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(t,e,n,r){const[s,i]=co(t,r),o=uo(e,"int32"),a=za(de(s),o),u=de(i);for(let l=0;l<a.length;++l){const c=l*u;let d=1;for(let f=0;f<u;++f)d*=n[c+f];a[l]=d}return{outVals:a,outShape:s,outDtype:o}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=Px(s,e.length,Dn(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function pde(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function mde(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);pde(n,r);let u=1;for(let l=0;l<e.length-1;++l){u*=e[l];const c=e[l+1];for(let d=1;d<u+1;++d)a[l].push(d*c)}for(let l=0;l<t.length;++l){let c=t[l],d=t[l]+1;for(let f=0;f<n.length;++f){const h=n[f],p=f+e.length-1;if(p>=0){const y=a[p],b=y[y.length-1]-h[c];for(let g=c;g<d;++g)a[p].push(h[g+1]+b)}c=h[c],d=h[d]}d!==c&&(s.push([c,d]),i+=d-c)}return{outSplits:a,valueSlices:s,numValues:i}}function gde(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=Sn("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function CT(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function yde(t,e,n,r,s,i){const o=CT(e,2)[1],a=CT(i,2)[1];let u=0;for(const l of n)for(let c=l[0];c<l[1];++c){for(let d=0;d<r;++d)s[u*a+d]=t[c*o+d];++u}}function bde(t,e,n,r,s){const i=e.slice();i[0]=s;const o=Sn(n,de(i)),a=t.length,u=a===0?0:a/e[0];return yde(t,e,r,u,o,i),[o,i]}function vde(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(hde(i,o,u),r.length===0)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:c,valueSlices:d,numValues:f}=mde(i,o,t,l),h=gde(c),p=bde(n,r,s,d,f);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NT=2147483647;function wde(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,u=s.length===0,l=o.length===0,c=[];a||c.push(e[0]),u||c.push(s[0]),l||c.push(o[0]);for(let b=1;b<c.length;++b)if(c[b]!==c[b-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=Sn("int32",d+1);f[0]=0;for(let b=0;b<d;++b){const g=a?t[0]:t[b],v=u?r[0]:r[b],w=l?i[0]:i[b];if(w===0)throw new Error("Requires delta != 0");let x;if(w>0&&v<g||w<0&&v>g)x=0;else if(x=Math.ceil(Math.abs((v-g)/w)),x>NT)throw new Error(`Requires ((limit - start) / delta) <= ${NT}`);f[b+1]=f[b]+x}const h=f[d],p=Sn(n,h);let y=0;for(let b=0;b<d;++b){const g=f[b+1]-f[b];let v=a?t[0]:t[b];const w=l?i[0]:i[b];for(let x=0;x<g;++x)p[y++]=v,v+=w}return[f,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Os=Ei;class Y0{constructor(e,n,r,s,i,o,a,u,l,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=j4(c),this.raggedRank=G4(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Os.VALUE_ROWIDS:return Y0.getMaxWidthValueRowID(n);case Os.ROW_SPLITS:return Y0.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Os[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return _T(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;q4(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=W4(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return R(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const u=e[a+1]-e[a];let l=Math.min(s,u),c=n[a];c===-1&&(l=0);for(let d=0;d<l;++d)o.push(c),c+=r;for(let d=0;d<u-l;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,u=e[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let l=n[u];o.push(l);for(let c=1;c<i;++c){const d=e[c];if(d===u)l>=0&&(++a,a<s?l+=r:l=-1);else{if(a=0,u=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);l=n[d]}o.push(l)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Os.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case Os.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${Os[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Os.FIRST_DIM_SIZE:return e[0];case Os.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Os.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Os[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let u=s.length-2;u>=0;--u)s[u]=s[u+1]*r[u+1];const i=_T(r,!1),o=Sn(this.valuesDType,de(i));if(s[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let l=1;l<=this.raggedRank;++l)u=this.calculateOutputIndex(l-1,u,s[l],r[l]);this.setOutput(this.raggedRank,u,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const u=de(a),l=n.length;let c=this.defaultValue;if(c.length!==u&&c.length!==1){const p=this.defaultValueShape;qe(()=>{const y=te(c,p);c=jf(y,a).dataSync()})}let d=0,f=0,h=0;for(let p=0;p<=l;++p){let y=p<l?n[p]:-1;if(y===h){++h;continue}if(f<h){const b=i.subarray(d*u),g=o.subarray(f*u),v=(h-f)*u;TT(g,b,v)}if(p>=l){const b=r.length;y=Math.floor(b/u)}if(y>h)if(this.defaultValue.length===1)o.subarray(h*u,y*u).fill(this.defaultValue[0]),h=y;else for(;y>h;){const b=o.slice(h*u);TT(b,c,u),++h}y<0?(d=p+1,f=h):(d=p,f=h,h=f+1)}}}function TT(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function _T(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function xde(t,e,n,r,s,i,o,a,u,l){return new Y0(t,e,n,r,s,i,o,a,u,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return za(0,r);const a=Math.abs(Math.ceil((e-t)/n)),u=za(a,r);e<t&&n===1&&(n=-1),u[0]=t;for(let l=1;l<u.length;l++)u[l]=u[l-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ade=Zo(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ede(t,e,n,r,s,i,o,a,u,l){const c=[r/s,s],d=t.values,f=e.values;if(r===0)return Ht(n,e.dtype);const h=u instanceof nd?u:Ht(c,e.dtype);typeof u=="string"||typeof u=="number"?h.values.fill(u):typeof u=="boolean"&&h.values.fill(+u);for(let p=0;p<i;p++){const y=[];let b=0;for(let g=0;g<o;g++){const v=d[p*o+g];y.push(v),b+=v*a[g]}if(b<0||b>=r/s)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let g=0;g<s;g++)l?h.values[b*s+g]+=f[p*s+g]:h.values[b*s+g]=e.rank===0?f[0]:f[p*s+g]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde=Zo(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t,e,n,r,s){const i=f2(r,e,n),o=de(n),a=Dn(r);if(i){const d=h2(e,a);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const u=s==="string"?id(t):t,l=Ht(r,s,u),c=Ht(n,s);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),h=f.map((p,y)=>p+e[y]);c.set(l.get(...h),...f)}return s==="string"?ED(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tde(t,e,n,r,s,i,o){const a=e[0],u=i[0],l=new Array(u),c=new Array(a),d=e[1];if(u===0){if(a!==0)throw new Error(cD(a));const b=Sn(n,0),g=Sn(s,0);return[b,[0,d],g,l,c]}let f=!0,h=0;const p=new Array(u).fill(0);for(let b=0;b<a;++b){const g=t[b*d];if(g<0)throw new Error(dD(b,g));if(g>=u)throw new Error(fD(b,g,u));++p[g],f=f&&g>=h,h=g}let y=!0;for(let b=0;b<u;++b){const g=p[b]===0;l[b]=g,y=y&&!g,p[b]=Math.max(p[b],1),b>0&&(p[b]+=p[b-1])}if(y&&f){const b=t,g=r;for(let v=0;v<a;++v)c[v]=v;return[b,[a,d],g,l,c]}else{const b=p[u-1],g=Sn(n,b*d),v=Sn(s,b),w=new Array(u).fill(0);for(let x=0;x<a;++x){const C=t[x*d],k=w[C],P=(C===0?0:p[C-1])+k;w[C]++;for(let N=0;N<d;++N)g[P*d+N]=t[x*d+N];v[P]=r[x],c[x]=P}for(let x=0;x<u;++x)if(w[x]===0){const k=x===0?0:p[x-1];g[k*d+0]=x;for(let P=1;P<d;++P)g[k*d+P]=0;v[k]=o}return[g,[b,d],v,l,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(t,e,n,r,s){const i=de(r),o=e[0],a=s.length,u=[];let l=1,c=-1;for(let b=0;b<a;++b){const g=s[b];if(g===-1){if(c!==-1)throw new Error(hD(c,b));c=b,u.push(1)}else{if(g<0)throw new Error(pD(b,g));l*=g,u.push(g)}}if(c!==-1){if(l<=0)throw new Error(mD());const b=Math.trunc(i/l);if(l*b!==i)throw new Error(gD(r,u));u[c]=b}if(de(u)!==i)throw new Error(yD(r,u));const f=r.length,h=[];if(f>0){h[f-1]=1;for(let b=f-2;b>=0;--b)h[b]=h[b+1]*r[b+1]}const p=[];if(a>0){p[a-1]=1;for(let b=a-2;b>=0;--b)p[b]=p[b+1]*u[b+1]}const y=Sn(n,o*a);for(let b=0;b<o;++b){let g=0;for(let v=0;v<f;++v)g+=t[b*f+v]*h[v];for(let v=0;v<a;++v)y[b*a+v]=Math.trunc(g/p[v]),g%=p[v]}return[y,[o,a],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ide(t,e,n,r,s,i=!1,o=0){const a=r.length,u=[e[0],t.length/e[0]],l=u[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error($v());const f=e.slice();f[0]=d;const h=f.reduce((w,x)=>w*x,1),p=Sn(n,h);if(a===0)return d>0&&p.fill(o),[p,f];if(d<=0)throw new Error($v());let y=0,b=1,g=0,v=s[y];for(;;){let w=0;if(b<a){if(w=s[b],v===w){++b;continue}if(v>=w)throw new Error(bD())}if(v<0||v>=d)throw new Error(vD(v,d));v>g&&p.fill(o,g*l,v*l);for(let x=y;x<b;++x){const C=r[x];if(C<0||C>=u[0])throw new Error(wD(x,r[x],u[0]));for(let k=0;k<l;k++)p[v*l+k]+=t[C*l+k]}if(i)for(let x=0;x<l;x++)p[v*l+x]/=b-y;if(y=b,++b,g=v+1,v=w,b>a)break}return g<d&&p.fill(o,g*l,d*l),[p,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kde=Zo(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rde=Rr((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde=Zo((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(t,e,n,r){const s=Ht(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let u=0;u<a.length;u++)a[u]=o[u]*n[u]+r[u];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dde{constructor(e,n,r,s,i,o){this.separator=Hu(e),this.nGramWidths=n,this.leftPad=Hu(r),this.rightPad=Hu(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const u=this.getPadWidth(o),l=Math.max(0,u-a),c=Math.max(0,u-(i-(a+1))),d=o-(l+c),f=n+(l>0?0:a-u);let h=0;h+=l*this.leftPad.length;for(let v=0;v<d;++v)h+=e[f+v].length;h+=c*this.rightPad.length;const p=l+c+d-1;h+=p*this.separator.length,r[s+a]=new Uint8Array(h);const y=r[s+a];let b=0;const g=v=>v.forEach(w=>y[b++]=w);for(let v=0;v<l;++v)g(this.leftPad),g(this.separator);for(let v=0;v<d-1;++v)g(e[f+v]),g(this.separator);if(d>0){g(e[f+d-1]);for(let v=0;v<c;++v)g(this.separator),g(this.rightPad)}else{for(let v=0;v<c-1;++v)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let l=1;l<s;++l){let c=n[l]>=u;if(c=c&&n[l]<=r,!c)throw new Error(`Invalid split value ${n[l]}, must be in [${u}, ${r}]`);u=n[l]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const i=s-1,o=Sn("int32",s);if(r===0||s===0){const u=new Array(r);for(let l=0;l<=i;++l)o[l]=0;return[u,o]}o[0]=0;for(let u=1;u<=i;++u){const l=n[u]-n[u-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(l,d)}),this.preserveShort&&l>0&&c===0&&(c=1),o[u]=o[u-1]+c}const a=new Array(o[i]);for(let u=0;u<i;++u){const l=n[u];let c=o[u];if(this.nGramWidths.forEach(d=>{const f=n[u+1]-n[u],h=this.getNumNGrams(f,d);this.createNGrams(e,l,a,c,h,d),c+=h}),this.preserveShort&&c===o[u]){const d=n[u+1]-n[u];if(d===0)continue;const f=d+2*this.padWidth;this.createNGrams(e,l,a,c,1,f)}}return[a,o]}}function Lde(t,e,n,r,s,i,o,a){return new Dde(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function $de(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let f=0;f<r;++f){const h=s.length;Fde(t[f],e,n,s);const p=s.length-h;a[f]=p,i+=p,o=Math.max(o,p)}const u=Sn("int32",i*2),l=new Array(i),c=[r,o];let d=0;for(let f=0;f<r;++f)for(let h=0;h<a[f];++h)u[d*2]=f,u[d*2+1]=h,l[d]=s[d],++d;return[u,l,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bde(t,e){const n=Sn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=Dz(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde=Rr((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vde(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Ht(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let u=0;u<o.length;u++)o[u]=i[u]%t.shape[u];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Of=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function XF(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,u=e-n+1,l=Math.log(a),c=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*c*(a-c)/a)*Math.sign(u-a/2),f=Math.max(n,Math.floor(e-u*c/a+d)),h=Math.min(r,Math.floor(e+(a-u)*c/a+d));XF(t,e,f,h)}const s=t[e];let i=n,o=r;for(of(t,n,e),Of(t[r],s)>0&&of(t,n,r);i<o;){for(of(t,i,o),i++,o--;Of(t[i],s)<0;)i=i+1;for(;Of(t[o],s)>0;)o=o-1}Of(t[n],s)===0?of(t,n,o):(o=o+1,of(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function Ude(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],u=Ua(n,o*r),l=Ua("int32",o*r);for(let d=0;d<o;d++){const f=d*a,h=t.subarray(f,f+a);let p=new Array(h.length);h.forEach((v,w)=>p[w]={value:v,index:w}),r<p.length&&(XF(p,r),p=p.slice(0,r)),s&&p.sort(Of);const y=d*r,b=u.subarray(y,y+r),g=l.subarray(y,y+r);for(let v=0;v<r;v++)b[v]=p[v].value,g[v]=p[v].index}const c=e.slice();return c[c.length-1]=r,[Ht(c,n,u),Ht(c,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zde(t,e,n,r){const s=An(e,n)[0],i=[1,n[0],1];for(let p=0;p<s;p++)i[0]*=n[p];i[1]=n[s];for(let p=s+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[s]),u=new nd(i,r,t),l=[],c=i[0]===1&&i[2]===1;for(let p=0;p<n[s];p++){let y;if(c)y=t[p].toString();else{const g=[];for(let v=0;v<i[0];v++)for(let w=0;w<i[2];w++)g.push(u.get(v,p,w));y=g.join(",")}const b=o.get(y);if(b!=null)a[p]=b;else{const g=o.size;o.set(y,g),a[p]=g,l.push(p)}}const d=i.slice();d[1]=o.size;const f=new nd(d,r);l.forEach((p,y)=>{for(let b=0;b<i[0];b++)for(let g=0;g<i[2];g++)f.set(u.get(b,p,g),b,y,g)});const h=n.slice();return h[s]=d[1],{outputValues:f.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Uce,bincountImpl:zce,bincountReduceImpl:Wce,bitwiseAndImpl:jce,castImpl:Vce,ceilImpl:Gce,concatImpl:qce,equalImpl:Hce,expImpl:Kce,expm1Impl:Xce,floorDivImpl:Qce,floorImpl:Yce,gatherNdImpl:Zce,gatherV2Impl:Jce,greaterEqualImpl:tde,greaterImpl:ede,lessEqualImpl:rde,lessImpl:nde,linSpaceImpl:sde,logImpl:ide,maxImpl:ode,maximumImpl:ade,minimumImpl:ude,multiplyImpl:KF,negImpl:lde,notEqualImpl:cde,prodImpl:fde,raggedGatherImpl:vde,raggedRangeImpl:wde,raggedTensorToTensorImpl:xde,rangeImpl:Sde,rsqrtImpl:Ade,scatterImpl:Ede,sigmoidImpl:Cde,simpleAbsImpl:Mce,sliceImpl:Nde,sparseFillEmptyRowsImpl:Tde,sparseReshapeImpl:_de,sparseSegmentReductionImpl:Ide,sqrtImpl:kde,squaredDifferenceImpl:Rde,staticRegexReplaceImpl:Pde,stridedSliceImpl:Ode,stringNGramsImpl:Lde,stringSplitImpl:$de,stringToHashBucketFastImpl:Bde,subImpl:Mde,tileImpl:Vde,topKImpl:Ude,transposeImpl:dde,uniqueImpl:zde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:jde,bincountImpl:YF,bincountReduceImpl:Gde,bitwiseAndImpl:qde,castImpl:Hde,ceilImpl:Kde,concatImpl:Xde,equalImpl:Yde,expImpl:Qde,expm1Impl:Zde,floorImpl:Jde,gatherNdImpl:efe,gatherV2Impl:tfe,greaterImpl:nfe,greaterEqualImpl:rfe,lessImpl:sfe,lessEqualImpl:ife,linSpaceImpl:ofe,logImpl:afe,maxImpl:ufe,maximumImpl:lfe,minimumImpl:cfe,multiplyImpl:dfe,negImpl:ffe,notEqualImpl:hfe,prodImpl:pfe,raggedGatherImpl:mfe,raggedRangeImpl:gfe,raggedTensorToTensorImpl:yfe,rangeImpl:bfe,rsqrtImpl:vfe,scatterImpl:wfe,sigmoidImpl:xfe,simpleAbsImpl:QF,sliceImpl:Sfe,sparseFillEmptyRowsImpl:Afe,sparseReshapeImpl:Efe,sparseSegmentReductionImpl:ZF,sqrtImpl:Cfe,staticRegexReplaceImpl:Nfe,stridedSliceImpl:Tfe,stringNGramsImpl:_fe,stringSplitImpl:Ife,stringToHashBucketFastImpl:kfe,subImpl:Rfe,tileImpl:Pfe,topKImpl:Ofe,transposeImpl:sS,uniqueImpl:Dfe}=Wde;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ur(t,e){return e===1?[t]:JF(t,e)}function Lfe(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ffe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=qn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ur("rc",this.rank),r=wt(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e6{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${$fe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?nS():tS(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function $fe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?kle(["r","c","d"],"inputShape"):Ol(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bfe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=kT(n,r),i=RT(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=IT(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const u=this.freeTextures[i].pop();return this.usedTextures[i].push(u),u}let a;return s===Pn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Pn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Pn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Pn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Pn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=kT(r,s),o=RT(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=IT(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),u=X().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],c=l&&l.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Mfe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function IT(t,e,n,r,s){const i=Vfe(e,r);let o;if(s){const[u,l]=Td(t[0],t[1]);o=u*l}else{const[u,l]=Xh(t[0],t[1]);o=u*l}const a=Mfe(n,i);return o*a}function Vfe(t,e){switch(t){case Pn.PACKED_2X2_FLOAT32:return qF(e);case Pn.PACKED_2X2_FLOAT16:return HF(e);case Pn.UNPACKED_FLOAT32:return WF(e);case Pn.UNPACKED_FLOAT16:return jF(e);case Pn.PACKED_4X1_UNSIGNED_BYTE:return GF(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Ufe(t){return X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Pn.PACKED_2X2_FLOAT32:Pn.UNPACKED_FLOAT32:t?Pn.PACKED_2X2_FLOAT16:Pn.UNPACKED_FLOAT16}function kT(t,e){if(t===as.UPLOAD)return Pn.PACKED_2X2_FLOAT32;if(t===as.RENDER||t==null)return Ufe(e);if(t===as.DOWNLOAD||t===as.PIXELS)return Pn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function RT(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class no{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ri="if (isnan(x)) return x;",zfe="return x;",PT="return abs(x);",Wfe="return (x >= 0.0) ? x : (exp(x) - 1.0);",jfe=ri+`
  return (x < 0.0) ? 0.0 : x;
`,Gfe=ri+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ga="return x;",qfe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe="return x;",Kfe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xfe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Yfe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qfe="return 1.0 / (1.0 + exp(-1.0 * x));";class Ca{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zfe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length);const n=e.length,r=ur("rc",n),s=wt(n),i=Lfe(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jfe=p4,ehe=1e-7,the=1e-4,hm={};function nhe(t){return t in hm||(hm[t]={}),hm[t]}const rhe=X().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),she=600;function ihe(){return X().global.screen==null?1024:X().global.screen.height*X().global.screen.width*window.devicePixelRatio*she/1024/1024}class u1 extends n3{nextDataId(){return u1.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!X().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof ob)n=e;else{const r=Oi(X().getNumber("WEBGL_VERSION"),e);n=new ob(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Oi(X().getNumber("WEBGL_VERSION"));n=new ob(r),this.binaryCache=nhe(X().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Bfe(this.gpgpu),this.numMBBeforeWarning=ihe(),this.texData=new JU(this,sa())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),u=this.texData.get(a.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[s,i]},u.texShape=[s,i];const l=dm(n),c=new ET(l,!1,o),d=this.runWebGLProgram(c,[a],r,[[s,i]]);return d.shape=n,u.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((X().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||X().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:as.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(X().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:as.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:u}=n;if(o!=null){let f;u?f=new Ca(a,ga):f=new no(a,ga);const h=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const l=this.activeTimers!=null;let c;l&&(c=xi());let d;if(s==="complex64"){const f=this.readSync(i.real.dataId),h=this.readSync(i.imag.dataId);d=Fv(f,h)}else d=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=xi()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(y=>p.push(y))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:u}=n;if(i!=null){let p;u?p=new Ca(s,ga):p=new no(s,ga);const y=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:o}],o),b=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),b}if(r!=null)return this.convertAndCacheOnCPU(e);if(X().getBool("DEBUG")&&!X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&X().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(o!=="complex64"&&X().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(p.texture.texture,...um(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),y=p[0],b=p[1];d=Fv(y,b)}else if(l==null)d=this.getValuesFromTexture(e);else{const p=de(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(l,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){const p=this.gpgpu.gl;ye(p,()=>p.deleteBuffer(l))}const f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(p=>p(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&sa().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:u,texture:l}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let h;u?h=new Ca(i,ga):h=new no(i,ga);const p=this.runWebGLProgram(h,[{dataId:e,shape:i,dtype:a}],a),y=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),y}if(l==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=sa().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>td(s));return Ht(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ht(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!rle(r))throw X().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=de(n);if(X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),h=this.texData.get(f.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...um(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(f),p}const o=X().getBool("WEBGL_PACK")&&s===!0,a=o?dm(n):n,u=o?new vce(a):new bce(a),l=this.runWebGLProgram(u,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(l.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),d}timerAvailable(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=al(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=al(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(i);a.kernelMs=ez(u),a.getExtraProfileInfo=()=>u.map((l,c)=>({name:o[c],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xi(),endMs:null}}endTimer(e){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=xi(),e)}async getQueryTime(e){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),u=a&&a.origDataId||e,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=rhe){return X().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&de(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ni("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Jfe(e.shape,n)}packedUnaryOp(e,n,r){const s=new Ca(e.shape,n),i=this.compileAndRun(s,[e],r);return sa().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=QF(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,PT,e.dtype);const n=new no(e.shape,PT),r=this.compileAndRun(n,[e]);return sa().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&Cg(r[0])){const i=r.map(o=>Hu(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return sa().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new Zfe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Ffe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[ud(e.shape),...ld(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[ud(n),...ld(n)],o=new e6(i,r),a=!0,u=[r],l=this.runWebGLProgram(o,[s],e.dtype,u,a);return{dataId:l.dataId,shape:n,dtype:l.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const f=de(i),h=n[0]*n[1]*4;R(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=dm(i);let u;s?u=new yce(a):u=new gce(a);const l=!0,c=[n??um(a)],d=this.runWebGLProgram(u,[{shape:a,dtype:o,dataId:e}],o,c,l,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),u=this.texData.get(a.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Nh.DENSE){const g=o??um(e.outputShape);u.texShape=g.map(v=>v*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),de(a.shape)===0)return u.values=Ua(a.dtype,0),a;const l=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(g.dataId);if(v.texture==null){if(!e.packedInputs&&de(g.shape)<=X().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!v.isPacked!=!!e.packedInputs)g=v.isPacked?this.unpackTensor(g):this.packTensor(g),l.push(g),v=this.texData.get(g.dataId);else if(v.isPacked&&!X0(v.shape,g.shape)){const w=g,x=g.shape;g.shape=v.shape,g=this.packedReshape(g,x),l.push(g),v=this.texData.get(g.dataId),w.shape=x}return{shape:g.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:u,isUniform:!1},f=mce(e,c,d),h=this.getAndSaveBinary(f,()=>hce(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let y;p&&(y=this.startTimer()),X().get("ENGINE_COMPILE_ONLY")||pce(this.gpgpu,h,c,d,s),l.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const b=X().getNumber("WEBGL_FLUSH_THRESHOLD");if(b>0){const g=xi();g-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!X().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&i===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(X().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=qe(()=>{if(!X().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=X().getBool("DEBUG");X().set("DEBUG",!1);const n=this.abs(Ye(1e-8)).dataSync()[0];if(X().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?ehe:the}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:u}=n;if(o!=null)return;const l=this.activeTimers!=null;let c;l&&(c=xi());let d=n.texShape;if(d==null&&(d=xle(r,u),n.texShape=d),i!=null){const f=dm(r);let h,p=d[1],y=d[0];const b=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(u||!b)&&([p,y]=Td(d[0],d[1])),u?h=new xce(f,b):h=new ET(f,b);const g=b?[y,p]:d,v=this.makeTensorInfo(g,s),w=this.texData.get(v.dataId);b?w.usage=as.PIXELS:w.usage=as.UPLOAD,w.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,y,i);const x=[[y,p]],k=this.runWebGLProgram(h,[v],s,x,!0),P=this.texData.get(k.dataId);n.texShape=P.texShape,n.isPacked=P.isPacked,n.usage=P.usage,X().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=P.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(v),l&&(this.uploadWaitMs+=xi()-c)}else{const f=this.acquireTexture(d,a,s,u);n.texture=f}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=ohe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*C0(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await mY(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?($F(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:u}=zF(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=u}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,u=sa().backend;if(!u.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=u.writeTexture(s,n,r,i,o,a);return sa().makeTensorFromDataId(l,n,r,u)}}u1.nextDataId=0;function ohe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pO()&&t7("webgl",()=>new u1,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iS=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class bl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=st(n,r),this.enableShapeUniforms=qn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ll=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Pd{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=st(n,r);const i=this.outputShape.length;this.enableShapeUniforms=qn(i);let o="";if(s)if(i===0||de(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${wt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=ur("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${u[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${u[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${u[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${u[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gr(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const ahe={kernelName:Fx,backendName:"webgl",kernelFunc:Gr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=Gr({inputs:{x:r},backend:n}),u=Gr({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:u},i}const uhe={kernelName:I3,backendName:"webgl",kernelFunc:tu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6="return (a < 0.) ? b * a : a;",n6=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",md(i,"float32")),a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Pd(n6,s.shape,o.shape):new bl(t6,s.shape,o.shape),u=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),u}const che={kernelName:bR,backendName:"webgl",kernelFunc:lhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6="return (a < 0.) ? b * a : a;",s6=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function dhe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Pd(s6,r.shape,s.shape):new bl(r6,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const fhe={kernelName:YR,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Od="if (isnan(x)) return x;";function rt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,u=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),f=n(d.values,u);return a.makeTensorInfo(o.shape,u,f)}const l=X().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return l?c=new Ca(o.shape,e):c=new no(o.shape,t),a.runWebGLProgram(c,[o],u)}}function $n({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:u,b:l}=o,c=a;if(r&&u.dtype==="complex64"){const p=c.texData.get(u.dataId),y=c.texData.get(l.dataId),[b,g]=[[p.complexTensorInfos.real,y.complexTensorInfos.real],[p.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(w=>{const[x,C]=w,k={dataId:x.dataId,dtype:x.dtype,shape:u.shape},P={dataId:C.dataId,dtype:C.dtype,shape:l.shape},N=new bl(t,u.shape,l.shape);return c.runWebGLProgram(N,[k,P],uo(x.dtype,C.dtype))}),v=tu({inputs:{real:b,imag:g},backend:c});return c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(g),v}const d=i||uo(u.dtype,l.dtype);if((u.dtype==="string"||l.dtype==="string"||c.shouldExecuteOnCPU([u,l]))&&s!=null){const p=c.texData.get(u.dataId).values,y=c.texData.get(l.dataId).values,b=u.dtype==="string"?id(p):p,g=u.dtype==="string"?id(y):y,[v,w]=s(u.shape,l.shape,b,g,d),x=c.makeTensorInfo(w,d),C=c.texData.get(x.dataId);return C.values=v,x}const f=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return f?h=new Pd(e,u.shape,l.shape,n):h=new bl(t,u.shape,l.shape),c.runWebGLProgram(h,[u,l],d)}}function Th(t,e=!1){if(t==="linear")return e?Hfe:zfe;if(t==="relu")return e?Xfe:jfe;if(t==="elu")return e?Kfe:Wfe;if(t==="relu6")return e?Yfe:Gfe;if(t==="prelu")return e?s6:r6;if(t==="leakyrelu")return e?n6:t6;if(t==="sigmoid")return e?Qfe:qfe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i6{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,u=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=qn(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),f=s?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let b="",g="";a&&(u?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:l?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:b=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let w="rc.x",x="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${b}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${x};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${y[0]});
          result += (${p[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OT={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class DT{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=st(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LT="return a * b;";function oS(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=uo(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),u=n.texData.get(s.dataId),l=new DT(OT.REAL,r.shape,s.shape),c=new DT(OT.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:s.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:s.shape}],f=n.runWebGLProgram(l,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=tu({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),u=n.texData.get(s.dataId),[l,c]=dfe(r.shape,s.shape,a.values,u.values,i),d=n.makeTensorInfo(c,i),f=n.texData.get(d.dataId);return f.values=l,d}let o;return X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Pd(LT,r.shape,s.shape):o=new bl(LT,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const hhe={kernelName:MR,backendName:"webgl",kernelFunc:oS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function phe(t,e,n){const r=[ud(t.shape),...ld(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[ud(e),...ld(e)],o=new e6(i,r),a=!0,u=[r],l=n.runWebGLProgram(o,[s],t.dtype,u,a);return{dataId:l.dataId,shape:e,dtype:l.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function me(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=de(s.shape),u=nz(i,a),l=de(u);R(a===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(s.dataId);return c.isPacked&&!X0(s.shape,u)&&!(c.texture!==null&&X0(c.shape,u))?phe(s,u,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:u,dtype:s.dtype})}const mhe={kernelName:iP,backendName:"webgl",kernelFunc:me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FT{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,u=r%4;let l="sumValue += dot(values, ones);";if(n!=null){const d=1/n;l=`sumValue += dot(values * ${Jc(d)?d.toPrecision(2):d}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${a};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ghe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",u="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",u="min"):n==="max"&&(a="-1.0 / 1e-20",u="max");let l=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?l="sumValue":n==="prod"?l="prodValue":n==="all"?l="allValue":n==="any"&&(l="anyValue");const c=Math.floor(r/4)*4,d=r%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Mg(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Fl(t,e,n,r){const s=yhe(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:u,outSize:l}=s[o];let c,d;n==="mean"?c=o===0?new FT({windowSize:u,inSize:a,batchSize:t.shape[0],outSize:l},a):new FT({windowSize:u,inSize:a,batchSize:t.shape[0],outSize:l}):c=new ghe({windowSize:u,inSize:a,batchSize:t.shape[0],outSize:l},n),d=i,i=r.runWebGLProgram(c,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bhe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=wt(this.rank),i=vhe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function vhe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class whe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=wt(this.rank),i=JF("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const a=`vec2(${o.slice(-2).join()})`,u=`++${i[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${u}) {
        result[1] = ${l};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${u}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1(t,e,n){const r=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new whe(t.shape,e):new bhe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(t,e,n,r){const s=e,i=t.shape.length,o=An(s,t.shape);let a=o;const u=ei(a,i),l=u!=null;let c=t;l&&(c=l1(t,u,r),a=ti(a.length,i)),Fi("sum",a,i);const[d,f]=co(c.shape,a);let h=d;n&&(h=ws(d,o));const p=de(f),b=de(t.shape)/p,g=me({inputs:{x:c},attrs:{shape:[b,p]},backend:r}),v=Mx(t.dtype),w=Fl(g,v,"sum",r),x=me({inputs:{x:w},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(w),l&&r.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return xhe(s,i,o,n)}const She={kernelName:EP,backendName:"webgl",kernelFunc:c1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,u=new Array(a);for(let c=0;c<u.length;c++)u[c]=s.shape[i[c]];let l;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,f=sS(d,s.shape,s.dtype,i,u);l=o.makeTensorInfo(u,s.dtype);const h=o.texData.get(l.dataId);h.values=f}else l=l1(s,i,o);return l}const Ahe={kernelName:_m,backendName:"webgl",kernelFunc:cr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6=1e3;function Q0({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:u=null}){const l=t.shape.length,c=e.shape.length,d=n?t.shape[l-2]:t.shape[l-1],f=r?e.shape[c-1]:e.shape[c-2],h=n?t.shape[l-1]:t.shape[l-2],p=r?e.shape[c-2]:e.shape[c-1],y=t.shape.slice(0,-2),b=e.shape.slice(0,-2),g=de(y),v=de(b),x=st(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);R(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const C=n?[g,d,h]:[g,h,d],k=r?[v,p,f]:[v,f,p],P=me({inputs:{x:t},backend:s,attrs:{shape:C}}),N=me({inputs:{x:e},backend:s,attrs:{shape:k}}),$=[P,N],U=Math.max(g,v),K=n?P.shape[1]:P.shape[2],Z=i!=null,ie=o!=null,ee=u==="leakyrelu",j=u!=null?Th(u,!0):null,M=Z||ie||ee||j!=null;let O;if((h===1||p===1)&&K>o6&&M===!1){let V=P,F=N;n&&(V=cr({inputs:{x:P},backend:s,attrs:{perm:[0,2,1]}}),$.push(V)),r&&(F=cr({inputs:{x:N},backend:s,attrs:{perm:[0,2,1]}}),$.push(F));const ue=p!==1,se=p===1;let he=V;ue&&(he=me({inputs:{x:V},backend:s,attrs:{shape:[U,K,1]}}),$.push(he));const ae=p===1?2:1;let be=F;se&&(be=me({inputs:{x:F},backend:s,attrs:{shape:[U,1,K]}}),$.push(be));const _e=oS({inputs:{a:he,b:be},backend:s});O=c1({inputs:{x:_e},backend:s,attrs:{axis:ae,keepDims:!0}}),$.push(_e)}else{const V=uo(t.dtype,e.dtype),F=new i6(C,k,[U,h,p],n,r,Z,j,ie,ee),ue=[P,N];if(i!=null&&ue.push(i),ie&&ue.push(o),ee){const se=s.makeTensorInfo([],"float32",md(a,"float32"));ue.push(se),$.push(se)}O=s.runWebGLProgram(F,ue,V)}const D=me({inputs:{x:O},backend:s,attrs:{shape:x}});$.push(O);for(const V of $)s.disposeIntermediateTensorInfo(V);return D}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ehe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:d}=r;return Q0({a:s,b:i,transposeA:u,transposeB:l,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const Che={kernelName:yv,backendName:"webgl",kernelFunc:Ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $T="return abs(x);";function Nhe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=QF(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Ca(r.shape,$T):s=new no(r.shape,$T),n.runWebGLProgram(s,[r],r.dtype)}const The={kernelName:a3,backendName:"webgl",kernelFunc:Nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he=ri+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Ihe=rt({opSnippet:_he}),khe={kernelName:u3,backendName:"webgl",kernelFunc:Ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rhe=ri+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Phe=rt({opSnippet:Rhe}),Ohe={kernelName:l3,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BT="return a + b;",Dhe=$n({opSnippet:BT,packedOpSnippet:BT,supportsComplex:!0,cpuKernelImpl:jde}),Lhe={kernelName:Dx,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fhe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $he{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mm(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Gr({inputs:{x:r[0]},backend:n});if(r.length>X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),l=Mm({inputs:r.slice(0,u),backend:n}),c=Mm({inputs:r.slice(u),backend:n});return Mm({inputs:[l,c],backend:n})}const s=r.map(u=>u.dtype).reduce((u,l)=>uo(u,l)),i=r.map(u=>u.shape),a=X().getBool("WEBGL_PACK")?new $he(r[0].shape,i):new Fhe(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const Bhe={kernelName:c3,backendName:"webgl",kernelFunc:Mm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,u=An(i,s.shape);let l=u;const c=ei(l,a);let d=s;c!=null&&(d=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=ti(l.length,a)),Fi("all",l,a);const[f,h]=co(d.shape,l),p=de(h),y=me({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),b=Fl(y,y.dtype,"all",n);let g;if(o){const v=ws(f,u);g=me({inputs:{x:b},backend:n,attrs:{shape:v}})}else g=me({inputs:{x:b},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),c!=null&&n.disposeIntermediateTensorInfo(d),g}const Vhe={kernelName:d3,backendName:"webgl",kernelFunc:Mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,u=An(i,s.shape);let l=u;const c=ei(l,a);let d=s;c!=null&&(d=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=ti(l.length,a)),Fi("any",l,a);const[f,h]=co(d.shape,l),p=de(h),y=me({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),b=Fl(y,y.dtype,"any",n);let g;if(o){const v=ws(f,u);g=me({inputs:{x:b},backend:n,attrs:{shape:v}})}else g=me({inputs:{x:b},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),c!=null&&n.disposeIntermediateTensorInfo(d),g}const zhe={kernelName:f3,backendName:"webgl",kernelFunc:Uhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Whe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jhe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,R(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,l=wt(u),c=ur("coords",u);let d,f;if(o===1){f=u+1;const N=wt(f);d=`
        ${N} sourceLocR = ${N}(${c.join()}, 0);
        ++${c[u-1]};
        ${N} sourceLocG = ${N}(${c.join()}, 0);
        ++${c[u-2]};
        ${N} sourceLocA = ${N}(${c.join()}, 0);
        --${c[u-1]};
        ${N} sourceLocB = ${N}(${c.join()}, 0);
        --${c[u-2]};`}else f=u,d=`
        ${l} sourceLocR = coords;
        ++${c[u-1]};
        ${l} sourceLocG = coords;
        ++${c[u-2]};
        ${l} sourceLocA = coords;
        --${c[u-1]};
        ${l} sourceLocB = coords;
        --${c[u-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],y=h.map(N=>"int "+N),b=ur("sourceLocR",f-1).concat("inIdx.r"),g=ur("sourceLocG",f-1).concat("inIdx.g"),v=ur("sourceLocB",f-1).concat("inIdx.b"),w=ur("sourceLocA",f-1).concat("inIdx.a"),x=r==="max"?"greaterThan":"lessThan",C=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,k=`vec4(
            getAChannel(${b.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,P=s?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${P}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[u-1]} < ${a[u-1]-1};
        bool hasNextRow = ${c[u-2]} < ${a[u-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=Mg(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},u=new Whe(a,n,r==null),l=[e];r!=null&&l.push(r);const c=t.runWebGLProgram(u,l,"int32");if(c.shape[1]===1)return c;const d=a6(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function u6(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=Mg(i),a=new jhe(s,o,n,r==null),u=r==null?[e]:[e,r],l=t.runWebGLProgram(a,u,"int32");if(l.shape.length===e.shape.length){const c=u6(t,e,n,l);return t.disposeIntermediateTensorInfo(l),c}return l}function l6(t,e,n,r){const s=[n];if(Fi("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!X().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let u=e;a&&(u=t.unpackTensor(e),i.push(u));const[l,c]=co(u.shape,s),d=de(c),f=me({inputs:{x:u},backend:t,attrs:{shape:[-1,d]}});i.push(f);const h=a6(t,f,r);i.push(h);const p=me({inputs:{x:h},backend:t,attrs:{shape:l}});return i.forEach(y=>t.disposeIntermediateTensorInfo(y)),p}return u6(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=An(i,s.shape);const a=ei(o,s.shape.length);let u=s;const l=[];a!=null&&(u=cr({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(u),o=ti(o.length,u.shape.length)),Fi("argMax",[o[0]],u.shape.length);const c=l6(n,u,o[0],"max");return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const qhe={kernelName:h3,backendName:"webgl",kernelFunc:Ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=An(i,s.shape);const a=ei(o,s.shape.length);let u=s;const l=[];a!=null&&(u=cr({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(u),o=ti(o.length,u.shape.length)),Fi("argMin",[o[0]],u.shape.length);const c=l6(n,u,o[0],"min");return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Khe={kernelName:p3,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe=ri+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Yhe=rt({opSnippet:Xhe}),Qhe={kernelName:m3,backendName:"webgl",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe=ri+"return log(x + sqrt(x * x + 1.0));",Jhe=rt({opSnippet:Zhe}),epe={kernelName:g3,backendName:"webgl",kernelFunc:Jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tpe=ri+`
  return atan(x);
`,npe=rt({opSnippet:tpe}),rpe={kernelName:y3,backendName:"webgl",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe=iS+`
  return atan(a, b);
`,ipe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ll+`
  return result;
`,ope=$n({opSnippet:spe,packedOpSnippet:ipe}),ape={kernelName:v3,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe=ri+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lpe=rt({opSnippet:upe}),cpe={kernelName:b3,backendName:"webgl",kernelFunc:lpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _h{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",b=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(y||(v="-1.0 / 1e-20"),r){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${u});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?b:g:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,k=o%4,P=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${u});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${P}
          }

          int xC = xCCorner + ${C};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${P}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${P}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${P}
          }
        }
        setOutput(${x});
      }
    `}}class aS{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,u=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,y=e.effectiveFilterWidth,b=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let x="0.0";if(w||(x="-1.0 / 1e-20"),r){const U=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${u}, ${l});
        const ivec3 pads = ivec3(${b}, ${g}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${U} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const P=Math.floor(o/4)*4,N=o%4,$=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${u}, ${l});
      const ivec3 pads = ivec3(${b}, ${g}, ${v});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${P}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${P};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${$}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Yh(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:u}=r,l=1;R(Hr(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=El(s.shape,i,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&qt(c.inShape,c.outShape))return Gr({inputs:{x:s},backend:n});const d=new _h(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const fpe={kernelName:w3,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r,c=[1,1,1],d=Uh(s.shape,i,o,c,a,u,l),f=new aS(d,"avg",!1);return n.runWebGLProgram(f,[s],"float32")}const ppe={kernelName:x3,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mpe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=u-1-e.padInfo.top,d=l-1-e.padInfo.left,f=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class gpe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=d-1-e.padInfo.front,y=f-1-e.padInfo.top,b=h-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${y}, ${b});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ype(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,d=[1,1,1],f=Uh(o.shape,a,u,d,l,c),h=new gpe(f);return n.runWebGLProgram(h,[s],o.dtype)}const bpe={kernelName:gz,backendName:"webgl",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;Yh([s,i],"avgPoolGrad");const{filterSize:a,strides:u,pad:l}=r,c=El(o.shape,a,u,1,l),d=new mpe(c);return n.runWebGLProgram(d,[s],o.dtype)}const wpe={kernelName:mz,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return Q0({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const Spe={kernelName:S3,backendName:"webgl",kernelFunc:xpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ape{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],st(e,n),st(e,r);let a="0.0";s!=null&&(st(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";i!=null&&(st(e,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Epe{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],st(e,n),st(e,r);let a="vec4(0.0)";s!=null&&(st(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";i!=null&&(st(e,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;R(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;u==null&&(u=.001);const l=[r,s,i];let c=null;o!=null&&(c=o.shape,l.push(o));let d=null;a!=null&&(d=a.shape,l.push(a));const f=X().getBool("WEBGL_PACK_NORMALIZATION")?new Epe(r.shape,s.shape,i.shape,c,d,u):new Ape(r.shape,s.shape,i.shape,c,d,u);return e.runWebGLProgram(f,l,l[0].dtype)},Npe={kernelName:uR,backendName:"webgl",kernelFunc:Cpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tpe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=wt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=_pe(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${yw[a]} = start[${a}] + coords.${yw[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const yw=["x","y","z","w","u","v"];function _pe(t){if(t===1)return"sourceLoc";if(t<=6)return yw.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ipe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=wt(this.rank),r=ur("coords",this.rank),s=ur("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${a}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=h2(e,Dn(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}function Dd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,u]=V4(s,i,o);if(k4(s,a,u),de(u)===0)return n.makeTensorInfo(u,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),f=Sfe(d.values,a,u,s.shape,s.dtype);return n.makeTensorInfo(u,s.dtype,f)}const{isPacked:l}=n.texData.get(s.dataId),c=f2(s.shape,a,u);if(l||!c){const d=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ipe(u):new Tpe(u),f=[a];return n.runWebGLProgram(d,[s],s.dtype,f)}return n.uploadToGPU(s.dataId),kpe(s,a,u,n)}const Rpe={kernelName:yP,backendName:"webgl",kernelFunc:Dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;R(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((v,w)=>v*w),u=m2(s.shape,i,a),l=g2(u.length,i.length),c=y2(s.shape,i,a),d=K4(o,i.length),f=X4(c,o,i.length),h=[],p=me({inputs:{x:s},backend:n,attrs:{shape:u}}),y=cr({inputs:{x:p},backend:n,attrs:{perm:l}}),b=me({inputs:{x:y},backend:n,attrs:{shape:c}}),g=Dd({inputs:{x:b},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(y),h.push(b),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),g},Ope={kernelName:A3,backendName:"webgl",kernelFunc:Ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),u=n.readSync(i.dataId),l=YF(a,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}const Lpe={kernelName:E3,backendName:"webgl",kernelFunc:Dpe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,$pe=`
  return float(int(a.r) & int(b.r));
`;function Bpe(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=X().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const u=n.texData.get(r.dataId).values,l=n.texData.get(s.dataId).values,[c,d]=qde(r.shape,s.shape,u,l,r.dtype),f=n.makeTensorInfo(d,r.dtype),h=n.texData.get(f.dataId);return h.values=c,f}let a;return i?a=new Pd(Fpe,r.shape,s.shape,!1):a=new bl($pe,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const Mpe={kernelName:C3,backendName:"webgl",kernelFunc:Bpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=st(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Upe={kernelName:N3,backendName:"webgl",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe="return float(a != b);",c6=$n({opSnippet:zpe,cpuKernelImpl:hfe,dtype:"bool"}),Wpe={kernelName:UR,backendName:"webgl",kernelFunc:c6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Gr({inputs:{x:s.complexTensorInfos.real},backend:n})}const jpe={kernelName:nP,backendName:"webgl",kernelFunc:Zh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe="return float(int(x));";function qpe(t,e){const n=new no(t.shape,Gpe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Gr({inputs:{x:s},backend:n});const o=Ga(s.shape),a=bw({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),u=tu({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),u}if(s.dtype==="complex64"){const o=Zh({inputs:{input:s},backend:n}),a=bw({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!iz(s.dtype,i)){const o=Gr({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,u,l]=Hde(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,u,l)}if(i==="int32")return qpe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Ua("bool",1)),u=c6({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),u}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const Hpe={kernelName:Lx,backendName:"webgl",kernelFunc:bw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MT="return ceil(x);",Kpe=rt({opSnippet:MT,packedOpSnippet:MT,cpuKernelImpl:Kde}),Xpe={kernelName:T3,backendName:"webgl",kernelFunc:Kpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ype{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qpe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;X().getBool("WEBGL_PACK_CLIP")?a=new Qpe(s.shape):a=new Ype(s.shape);const u=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,u)}const Jpe={kernelName:_3,backendName:"webgl",kernelFunc:Zpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function tme(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new eme(r.shape),o=[VT(r,s.complexTensorInfos.real),VT(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const nme={kernelName:k3,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rme{constructor(e){this.outputShape=[],this.outputShape=ml(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sme{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ml(e,n);const r=this.outputShape,s=r.length,i=wt(s),o=ur("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((y,b)=>`T${b}`);const u=new Array(e.length-1);u[0]=e[0][n];for(let y=1;y<u.length;y++)u[y]=u[y-1]+e[y][n];const l=a[n],c=a.slice(-2),d=a.join();let f=`if (${l} < ${u[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let y=1;y<u.length;y++){const b=u[y-1];f+=`
        if (${l} < ${u[y]}  && ${l} >= ${u[y-1]}) {
          return getChannel(
            getT${y}(${pm(a,l,b)}),
            vec2(${pm(c,l,b)}));
        }`}const h=u.length,p=u[u.length-1];f+=`
        return getChannel(
          getT${h}(${pm(a,l,p)}),
          vec2(${pm(c,l,p)}));`,this.userCode=`
      float getValue(${a.map(y=>"int "+y)}) {
        ${f}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function pm(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Gr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const ime={kernelName:pR,backendName:"webgl",kernelFunc:d1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Df(t,e,n){const r=t[0].dtype;if(r==="complex64"){const h=t.map(v=>Zh({inputs:{input:v},backend:n})),p=t.map(v=>d1({inputs:{input:v},backend:n})),y=Df(h,e,n),b=Df(p,e,n),g=tu({inputs:{real:y,imag:b},backend:n});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const h=t.map(x=>{const k=[-1,de(x.shape.slice(e))];return me({inputs:{x},backend:n,attrs:{shape:k}})}),p=h.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),y=ml(h.map(x=>x.shape),1),b=h[0].shape[0]===1,g=Xde(p,y,r,b),v=ml(t.map(x=>x.shape),e),w=n.makeTensorInfo(v,r,g);return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),w}const i=t.filter(h=>de(h.shape)>0),o=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const h=o?new no(t[0].shape,ga):new Ca(t[0].shape,ga);return n.runWebGLProgram(h,t,r)}const a=X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const h=[];for(let y=0;y<i.length;y+=a){const b=i.slice(y,y+a);h.push(Df(b,e,n))}const p=Df(h,e,n);for(const y of h)n.disposeIntermediateTensorInfo(y);return p}if(o){const h=new sme(i.map(p=>p.shape),e);return n.runWebGLProgram(h,i,r)}const{tensors2D:u,outShape:l}=ome(i,e,n),c=new rme(u.map(h=>h.shape)),d=n.runWebGLProgram(c,u,r);u.forEach(h=>n.disposeIntermediateTensorInfo(h));const f=me({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),f}function ome(t,e,n){const r=ml(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>me({inputs:{x:i},attrs:{shape:[-1,de(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=An(s,e[0].shape)[0],o=e.map(l=>l.shape);z4(o,i);const a=ml(e.map(l=>l.shape),i);if(de(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const u=e.filter(l=>de(l.shape)>0);return u.length===1?Gr({inputs:{x:u[0]},backend:n}):Df(u,i,n)}const ame={kernelName:R3,backendName:"webgl",kernelFunc:d6};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f6{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,b=e.dataFormat==="channelsLast",g=b?1:2,v=b?2:3,w=b?3:1;let x="",C="";r&&(s?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:x=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${u}, ${l});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${b}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${b}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${b}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${b}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${C}
        setOutput(result);
      }
    `}}class ume{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h6{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=qn(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,u=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<c;b++)f+=`
           vec4 xTexelC${b*2};
           int xTexelC${b*2}Ready;
           vec4 xTexelC${b*2+1};
           int xTexelC${b*2+1}Ready;
           vec4 xC${b};`;f+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let b=0;b<c;b++)f+=`
           xTexelC${b*2} = vec4(0.0);
           xTexelC${b*2}Ready = 0;
           xTexelC${b*2+1} = vec4(0.0);
           xTexelC${b*2+1}Ready = 0;
           xC${b} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let b=0;b<(d+1)/2;b++){const g=b*2;if(f+=`
           xC = xCCorner + ${g*u};
           `,a===1){if(g<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,u===1&&g>0?f+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const v=o%2===0?Rx(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,u>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:f+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):v===1?f+=`
                     xC${g+1} = xTexelC${g};
                     `:f+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(f+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(f+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(f+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let h="",p="";r&&(s?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lme{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=qn(this.outputShape.length);const{dataFormat:r}=n,s=fr(),i=r==="channelsLast",o=i?1:2,a=i?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)l+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function p6({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const u=t.shape,l=r.texData.get(t.dataId),c=n.inChannels,d=u[0]*u[1]*u[2],f=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,y=!1;let b;const g=[];if(i!=null){const x=Z0(i.shape,h);x!=null&&(i=me({inputs:{x:i},backend:r,attrs:{shape:x}}),g.push(i))}if(s!=null){const x=Z0(s.shape,h);x!=null&&(s=me({inputs:{x:s},backend:r,attrs:{shape:x}}),g.push(s))}if(!((d===1||f===1)&&c>o6)&&l.isPacked&&h&&l.texture!=null&&u[2]%2!==0&&qt(l.shape.slice(-3),u.slice(-3))){const x=u[0]*u[1]*(u[2]+1),C={dataId:t.dataId,shape:[1,x,n.inChannels],dtype:t.dtype},k=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,R(X0(l.shape,C.shape),()=>`packed reshape ${l.shape} to ${C.shape} isn't free`);const P=me({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(P);const N=Q0({a:C,b:P,backend:r,transposeA:p,transposeB:y,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),$=r.texData.get(N.dataId);R($.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=k,$.shape=n.outShape,b=Gr({inputs:{x:N},backend:r}),b.shape=n.outShape,g.push(N)}else{const x=n.outHeight*n.outWidth,C=me({inputs:{x:t},backend:r,attrs:{shape:h?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),k=me({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),P=Q0({a:h?C:k,b:h?k:C,transposeA:!h,transposeB:y,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});b=me({inputs:{x:P},backend:r,attrs:{shape:n.outShape}}),g.push(C),g.push(k),g.push(P)}for(const x of g)r.disposeIntermediateTensorInfo(x);return b}function m6({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:u,filterHeight:l,inChannels:c,outWidth:d,outHeight:f,dataFormat:h}=n,p=h==="channelsLast",y=u*l*c,b=f*d,g=[n.batchSize,y,b],v=!0,w=!1,x=[];if(i!=null){const D=Z0(i.shape,p);D!=null&&(i=me({inputs:{x:i},backend:r,attrs:{shape:D}}),x.push(i))}if(s!=null){const D=Z0(s.shape,p);D!=null&&(s=me({inputs:{x:s},backend:r,attrs:{shape:D}}),x.push(s))}const C=me({inputs:{x:e},backend:r,attrs:{shape:[1,y,de(e.shape)/y]}});x.push(C);const k=new lme(g,n),P=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],N=r.runWebGLProgram(k,[t],"float32",P),$=me({inputs:{x:N},backend:r,attrs:{shape:g}});x.push(N),x.push($);const U=s!=null,K=i!=null,Z=a==="leakyrelu",ie=a?Th(a,!0):null,ee=new i6(p?$.shape:C.shape,p?C.shape:$.shape,p?[n.batchSize,b,n.outChannels]:[n.batchSize,n.outChannels,b],v,w,U,ie,K,Z),j=p?[$,C]:[C,$];if(s&&j.push(s),K&&j.push(i),Z){const D=r.makeTensorInfo([],"float32",md(o,"float32"));j.push(D),x.push(D)}const M=r.runWebGLProgram(ee,j,"float32"),O=me({inputs:{x:M},backend:r,attrs:{shape:n.outShape}});x.push(M);for(const D of x)r.disposeIntermediateTensorInfo(D);return O}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:u,dilations:l,dimRoundingMode:c}=r,d=gd(u),f=vs(s.shape,i.shape,o,l,a,c,!1,d);let h;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))h=p6({x:s,filter:i,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&X().getBool("WEBGL_EXP_CONV")){const y=new h6(f),b=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];h=n.runWebGLProgram(y,[s,i],"float32",b)}else if(X().getBool("WEBGL_CONV_IM2COL"))h=m6({x:s,filter:i,convInfo:f,backend:n});else{const y=new f6(f);h=n.runWebGLProgram(y,[s,i],"float32")}const p=me({inputs:{x:h},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(h),p}const dme={kernelName:P3,backendName:"webgl",kernelFunc:cme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fme{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hme{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,u=r-1-e.padInfo.left,l=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pme{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class mme{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,u=n-1-e.padInfo.front,l=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:u,dimRoundingMode:l,filterShape:c}=r,d=gd(u),f=vs(s.shape,c,o,1,a,l,!1,d),h=new fme(f);return n.runWebGLProgram(h,[s,i],"float32")}const yme={kernelName:O3,backendName:"webgl",kernelFunc:gme};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bme{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=qn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:u,dataFormat:l,dimRoundingMode:c}=r,d=gd(l),f=vs(o,i.shape,a,1,u,c,!1,d);if(X().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[f.strideHeight,f.strideWidth]],p=new bme(f);return n.runWebGLProgram(p,[s,i],"float32",h)}else{const h=new hme(f);return n.runWebGLProgram(h,[s,i],"float32")}}const wme={kernelName:D3,backendName:"webgl",kernelFunc:vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:u}=r,l=zh(s.shape,i.shape,o,u,a),c=new ume(l);return n.runWebGLProgram(c,[s,i],"float32")}const Sme={kernelName:L3,backendName:"webgl",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:u}=r,l=zh(s.shape,u,o,1,a),c=new pme(l);return n.runWebGLProgram(c,[s,i],"float32")}const Eme={kernelName:yz,backendName:"webgl",kernelFunc:Ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:u}=r,l=zh(u,i.shape,a,1,o),c=new mme(l);return n.runWebGLProgram(c,[s,i],"float32")}const Nme={kernelName:F3,backendName:"webgl",kernelFunc:Cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme=Od+`
  return cos(x);
`,_me=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Ll}
  return result;
`,Ime=rt({opSnippet:Tme,packedOpSnippet:_me}),kme={kernelName:$3,backendName:"webgl",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Pme=rt({opSnippet:Rme}),Ome={kernelName:B3,backendName:"webgl",kernelFunc:Pme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dme{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,u,l]=e,[c]=n,[d,f]=r;this.outputShape=[c,d,f,l];const h=s==="bilinear"?1:0,[p,y]=[`${a-1}.0`,`${u-1}.0`],[b,g,v]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[w,x,C]=f>1?[`${(u-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${b});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${x};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:u,extrapolationValue:l}=r,c=new Dme(s.shape,i.shape,a,u,l);return n.runWebGLProgram(c,[s,i,o],"float32")},Fme={kernelName:U3,backendName:"webgl",kernelFunc:Lme};var Ih;(function(t){t.Prod="*",t.Sum="+"})(Ih||(Ih={}));class UT{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Ih.Prod?"1.0":"0.0",a=r?o:`getX(${zT(i,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let l="",c="";r?(l=s?`end != ${u-1}`:"end != 0",c=s?"end + 1":"end - 1"):(l=s?`end + pow2 < ${u}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${wt(i)} coords = getOutputCoords();
        int end = ${WT(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${WT(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${zT(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function zT(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function WT(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g6(t,e,n,r,s,i){const o=e.shape.length,a=ei([r],o);let u=e;a!=null&&(u=cr({inputs:{x:e},backend:n,attrs:{perm:a}}));const l=ti(1,o)[0];if(l!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=u.shape[l];let d=Gr({inputs:{x:u},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new UT(t,u.shape,!1,i),p=[[f]],y=d;d=n.runWebGLProgram(h,[d],d.dtype,p),n.disposeIntermediateTensorInfo(y)}if(s){const f=new UT(t,u.shape,s,i),h=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const f=qx(a),h=cr({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(u),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $me(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return g6(Ih.Prod,s,n,i,o,a)}const Bme={kernelName:M3,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return g6(Ih.Sum,s,n,i,o,a)}const Vme={kernelName:V3,backendName:"webgl",kernelFunc:Mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ume(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const u=n.readSync(s.dataId),l=n.readSync(i.dataId),c=YF(u,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(s.shape.length===2){const u=n.bufferSync(s),l=n.bufferSync(i),c=Gde(u,l,o,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const zme={kernelName:z3,backendName:"webgl",kernelFunc:Ume};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wme{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],u=o==="NHWC"?s.shape[1]:s.shape[2],l=o==="NHWC"?s.shape[2]:s.shape[3],c=o==="NHWC"?s.shape[3]:s.shape[1],d=u*i,f=l*i,h=c/(i*i),p=o==="NHWC"?[a,d,f,h]:[a,h,d,f],y=new Wme(p,i,o);return n.runWebGLProgram(y,[s],s.dtype)}const Gme={kernelName:W3,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y6{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=qn(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,u=e.outChannels/e.inChannels;let l="",c="";r&&(s?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:l=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b6{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=qn(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,u=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)h+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<d;g++)h+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(f+1)/2;g++){const v=g*2;if(h+=`
          xC = xCCorner + ${v*l};
          `,u===1){if(v<d&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,l===1&&v>0?h+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=a%2===0?Rx(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,l>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:h+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?h+=`
                    xC${v+1} = xTexelC${v};
                    `:h+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(h+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(h+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(h+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",y="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,y="result = activation(result);");const b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${b}
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:u,dimRoundingMode:l}=r;let c=u;c==null&&(c=[1,1]),R(Hr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=vs(s.shape,i.shape,o,c,a,l,!0);let f;X().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new b6(d):f=new y6(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[s,i],"float32",h)}const Hme={kernelName:j3,backendName:"webgl",kernelFunc:qme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kme{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Xme{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:u,dimRoundingMode:l,filterShape:c}=r,d=vs(s.shape,c,o,a,u,l,!0),f=new Kme(d);return n.runWebGLProgram(f,[s,i],"float32")}const Qme={kernelName:G3,backendName:"webgl",kernelFunc:Yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:u,dimRoundingMode:l,inputShape:c}=r,d=vs(c,i.shape,o,a,u,l,!0),f=new Xme(d);return n.runWebGLProgram(f,[s,i],"float32")}const Jme={kernelName:q3,backendName:"webgl",kernelFunc:Zme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e0e{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t0e(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=de(r.shape),o=me({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new e0e(i),u=n.runWebGLProgram(a,[o],o.dtype),l=me({inputs:{x:u},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}const n0e={kernelName:H3,backendName:"webgl",kernelFunc:t0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r0e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:u,dilationHeight:l,dilationWidth:c}=e,{top:d,left:f}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:u}=r,l=LO(s.shape,i.shape,o,a,"NHWC",u);let c;const d=new r0e(l);c=n.runWebGLProgram(d,[s,i],"float32");const f=me({inputs:{x:c},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(c),f}const i0e={kernelName:K3,backendName:"webgl",kernelFunc:s0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:u}=sD(s,i.length);oD(o.length,u,i);const{path:l,steps:c}=aD(a,u),d=c.length;let f=null,h=o.length;const p=[];for(let y=0;y<d;++y){for(const b of c[y]){const{permutationIndices:g,expandDims:v}=iD(h,u[b]);let w;uD(g)?w=i[b]:(w=cr({inputs:{x:i[b]},backend:n,attrs:{perm:g}}),p.push(w));const x=w.shape.slice();for(let C=0;C<v.length;++C)x.splice(v[C],0,1);qt(w.shape,x)||(w=me({inputs:{x:w},backend:n,attrs:{shape:x}}),p.push(w)),f===null?f=w:(f=oS({inputs:{a:w,b:f},backend:n}),p.push(f))}y<d-1&&(l[y]>=0&&(f=c1({inputs:{x:f},backend:n,attrs:{axis:l[y]-(o.length-h),keepDims:!1}}),p.push(f)),h--)}for(const y of p)y!==f&&n.disposeIntermediateTensorInfo(y);return f}const a0e={kernelName:Y3,backendName:"webgl",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u0e="return (x >= 0.0) ? x : (exp(x) - 1.0);",l0e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,c0e=rt({opSnippet:u0e,packedOpSnippet:l0e}),d0e={kernelName:Q3,backendName:"webgl",kernelFunc:c0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0e="return (b >= 0.0) ? a : a * (b + 1.0);",h0e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,p0e=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Pd(h0e,r.shape,s.shape):new bl(f0e,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},m0e={kernelName:bz,backendName:"webgl",kernelFunc:p0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g0e=`
  return vec4(equal(a, b));
`,y0e="return float(a == b);",b0e=$n({opSnippet:y0e,packedOpSnippet:g0e,dtype:"bool",cpuKernelImpl:Yde}),v0e={kernelName:J3,backendName:"webgl",kernelFunc:b0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w0e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Z4};
  float a1 = ${J4};
  float a2 = ${eD};
  float a3 = ${tD};
  float a4 = ${nD};
  float a5 = ${rD};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,x0e=rt({opSnippet:w0e}),S0e={kernelName:Z3,backendName:"webgl",kernelFunc:x0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0e=Od+`
  return exp(x);
`,E0e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,v6=rt({opSnippet:A0e,packedOpSnippet:E0e,cpuKernelImpl:Qde,dtype:"float32"}),C0e={kernelName:eR,backendName:"webgl",kernelFunc:v6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let u=s;return s<0&&(R(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+s+1),a.splice(u,0,1),me({inputs:{x:i},backend:r,attrs:{shape:a}})}const N0e={kernelName:tR,backendName:"webgl",kernelFunc:vw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jT="return exp(x) - 1.0;",T0e=rt({opSnippet:jT,packedOpSnippet:jT,cpuKernelImpl:Zde}),_0e={kernelName:nR,backendName:"webgl",kernelFunc:T0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GT{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(t,e,n){const r=n.texData.get(t.dataId),s=de(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=me({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),u=a.shape,l=new GT("real",u,e),c=new GT("imag",u,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],f=n.runWebGLProgram(l,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=tu({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);const y=me({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0e(t){const{inputs:e,backend:n}=t,{input:r}=e;return w6(r,!1,n)}const k0e={kernelName:rR,backendName:"webgl",kernelFunc:I0e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R0e{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jh(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||Mh(s),i==="string"){const o=Sn(i,de(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new R0e(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const P0e={kernelName:sR,backendName:"webgl",kernelFunc:Jh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O0e{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e={kernelName:iR,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new O0e(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qT="return floor(x);",L0e=rt({opSnippet:qT,packedOpSnippet:qT,cpuKernelImpl:Jde}),F0e={kernelName:oR,backendName:"webgl",kernelFunc:L0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $0e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,B0e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,M0e=$n({opSnippet:$0e,packedOpSnippet:B0e,dtype:"int32"}),V0e={kernelName:aR,backendName:"webgl",kernelFunc:M0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U0e{constructor(e){this.variableNames=["A"];const n=fr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z0e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=fr(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W0e={kernelName:gv,backendName:"webgl",kernelFunc:j0e};let ic,ab=X().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function j0e(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[u,l]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[l,u],d=[l,u,i];if(a||o){const y=X().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ic==null||y!==ab)&&(ab=y,ic=document.createElement("canvas").getContext("2d",{willReadFrequently:ab})),ic.canvas.width=u,ic.canvas.height=l,ic.drawImage(s,0,0,u,l),s=ic.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=as.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);const h=X().getBool("WEBGL_PACK")?new z0e(d):new U0e(d),p=n.runWebGLProgram(h,[f],"int32");return n.disposeData(f.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:u,pad:l,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,y=gd(c),b=vs(s.shape,i.shape,u,d,l,f,!1,y);let g;const v=[],w=o!=null,x=a!=null,C=h==="leakyrelu",k=()=>{const N=[s,i],$=(U,K)=>{if(K==="NCHW"&&U.shape.length===1&&U.shape[0]!==1){const Z=me({inputs:{x:U},backend:n,attrs:{shape:[U.shape[0],1,1]}});return v.push(Z),Z}return U};if(w&&N.push($(o,c)),x&&N.push($(a,c)),C){const U=n.makeTensorInfo([],"float32",md(p,"float32"));N.push(U),v.push(U)}return N};if(b.filterHeight===1&&b.filterWidth===1&&b.dilationHeight===1&&b.dilationWidth===1&&b.strideHeight===1&&b.strideWidth===1&&(b.padInfo.type==="SAME"||b.padInfo.type==="VALID"))g=p6({x:s,filter:i,convInfo:b,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(b.strideWidth<=2&&y==="channelsLast"&&X().getBool("WEBGL_EXP_CONV")){const N=h?Th(h,!0):null,$=new h6(b,w,N,x,C),U=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],K=k();g=n.runWebGLProgram($,K,"float32",U)}else if(X().getBool("WEBGL_CONV_IM2COL"))g=m6({x:s,filter:i,convInfo:b,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const N=h?Th(h,!1):null,$=new f6(b,w,N,x,C),U=k();g=n.runWebGLProgram($,U,"float32")}const P=me({inputs:{x:g},backend:n,attrs:{shape:b.outShape}});return v.push(g),v.forEach(N=>n.disposeIntermediateTensorInfo(N)),P}const q0e={kernelName:bv,backendName:"webgl",kernelFunc:G0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:u,pad:l,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,p=[];let y=c;y==null&&(y=[1,1]),R(Hr(u,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${y}'`);const b=vs(s.shape,i.shape,u,y,l,d,!0),g=X().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,v=f?Th(f,g):null,w=[s,i],x=o!=null,C=a!=null,k=f==="leakyrelu";if(x&&w.push(o),C&&w.push(a),k){const U=n.makeTensorInfo([],"float32",md(h,"float32"));w.push(U),p.push(U)}let P;g?P=new b6(b,x,v,C,k):P=new y6(b,x,v,C,k);const N=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],$=n.runWebGLProgram(P,w,"float32",N);return p.forEach(U=>n.disposeIntermediateTensorInfo(U)),$}const K0e={kernelName:vv,backendName:"webgl",kernelFunc:H0e};class X0e{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=wt(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=de(r.shape),[u,l,c,d]=I4(r,s),f=me({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),h=me({inputs:{x:r},backend:n,attrs:{shape:[de(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),v=n.bufferSync(r),w=efe(g,v,r.dtype,l,o,c,d,r.shape,a);return n.makeTensorInfo(u,r.dtype,w.values)}const p=new X0e(o,d,[l,c],r.shape),y=n.runWebGLProgram(p,[h,f],h.dtype),b=me({inputs:{x:y},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(y),b}const Q0e={kernelName:cR,backendName:"webgl",kernelFunc:Y0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z0e{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=wt(this.rank),s=J0e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function J0e(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,u=An(o,s.shape)[0];if(X().get("DEBUG")){const v=n.readSync(i.dataId),w=s.shape[u];for(let x=0;x<v.length;++x){const C=v[x];R(C<=w-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${w-1}]`)}}const l=AD(s,i,u,a),c=de(i.shape),d=[],f=me({inputs:{x:s},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),h=me({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,c/l.batchSize]}});d.push(f),d.push(h);const p=[l.batchSize,l.outerSize,c/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const v=n.bufferSync(h),w=n.bufferSync(f),x=tfe(w,v,p);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(l.outputShape,x.dtype,x.values)}const y=new Z0e(f.shape,p),b=n.runWebGLProgram(y,[f,h],f.dtype);d.push(b);const g=me({inputs:{x:b},backend:n,attrs:{shape:l.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const ege={kernelName:lR,backendName:"webgl",kernelFunc:x6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tge="return float(a > b);",nge=`
  return vec4(greaterThan(a, b));
`,rge=$n({opSnippet:tge,packedOpSnippet:nge,cpuKernelImpl:nfe,dtype:"bool"}),sge={kernelName:dR,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ige="return float(a >= b);",oge=`
  return vec4(greaterThanEqual(a, b));
`,age=$n({opSnippet:ige,packedOpSnippet:oge,dtype:"bool",cpuKernelImpl:rfe}),uge={kernelName:fR,backendName:"webgl",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lge(t){const{inputs:e,backend:n}=t,{input:r}=e;return w6(r,!0,n)}const cge={kernelName:hR,backendName:"webgl",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dge="return float(!isnan(x) && !isinf(x));",fge=rt({opSnippet:dge,dtype:"bool"}),hge={kernelName:mR,backendName:"webgl",kernelFunc:fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge="return float(isinf(x));",mge=rt({opSnippet:pge,dtype:"bool"}),gge={kernelName:gR,backendName:"webgl",kernelFunc:mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yge="return float(isnan(x));",bge=rt({opSnippet:yge,dtype:"bool"}),vge={kernelName:yR,backendName:"webgl",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge="return float(a < b);",xge=`
  return vec4(lessThan(a, b));
`,Sge=$n({opSnippet:wge,packedOpSnippet:xge,cpuKernelImpl:sfe,dtype:"bool"}),Age={kernelName:vR,backendName:"webgl",kernelFunc:Sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ege="return float(a <= b);",Cge=`
  return vec4(lessThanEqual(a, b));
`,Nge=$n({opSnippet:Ege,packedOpSnippet:Cge,cpuKernelImpl:ife,dtype:"bool"}),Tge={kernelName:wR,backendName:"webgl",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ge(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=ofe(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const Ige={kernelName:xR,backendName:"webgl",kernelFunc:_ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kge=Od+`
  return x < 0.0 ? 0./0. : log(x);
`,Rge=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Pge=rt({opSnippet:kge,packedOpSnippet:Rge,cpuKernelImpl:afe}),Oge={kernelName:SR,backendName:"webgl",kernelFunc:Pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dge=Od+`
  return log(1.0 + x);
`,Lge=rt({opSnippet:Dge}),Fge={kernelName:AR,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ge="return float(a >= 1.0 && b >= 1.0);",Bge=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Mge=$n({opSnippet:$ge,packedOpSnippet:Bge,dtype:"bool"}),Vge={kernelName:ER,backendName:"webgl",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uge="return float(!(x >= 1.0));",zge=rt({opSnippet:Uge}),Wge={kernelName:CR,backendName:"webgl",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge="return float(a >= 1.0 || b >= 1.0);",Gge=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,qge=$n({opSnippet:jge,packedOpSnippet:Gge,dtype:"bool"}),Hge={kernelName:NR,backendName:"webgl",kernelFunc:qge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kge{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let u;const l=`float(${r}) + float(${s}) * sum`;i===.5?u=`inversesqrt(${l})`:i===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xge{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let u;const l=`float(${r}) + float(${s}) * sum`;i===.5?u=`inversesqrt(${l})`:i===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yge=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:u}=r,l=X().getBool("WEBGL_PACK_NORMALIZATION")?new Xge(s.shape,i,o,a,u):new Kge(s.shape,i,o,a,u);return n.runWebGLProgram(l,[s],s.dtype)},Qge={kernelName:TR,backendName:"webgl",kernelFunc:Yge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zge{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jge=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:u,alpha:l,beta:c}=r,d=new Zge(s.shape,a,u,l,c);return n.runWebGLProgram(d,[s,i,o],s.dtype)},e1e={kernelName:vz,backendName:"webgl",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1e(t,e,n,r){const s=de(e),o=de(t.shape)/s,a=me({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),u=Fl(a,t.dtype,"max",r),l=me({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,u=An(i,s.shape);let l=u;const c=ei(l,a),d=c!=null,f=n.shouldExecuteOnCPU([s]);let h=s;if(d){if(f){const w=n.texData.get(h.dataId).values,x=new Array(a);for(let P=0;P<x.length;P++)x[P]=s.shape[c[P]];const C=sS(w,s.shape,s.dtype,c,x);h=n.makeTensorInfo(x,s.dtype);const k=n.texData.get(h.dataId);k.values=C}else h=l1(s,c,n);l=ti(l.length,a)}Fi("max",l,a);const[p,y]=co(h.shape,l);let b=p;o&&(b=ws(p,u));let g;if(f){const w=n.texData.get(h.dataId).values,x=ufe(w,de(y),b,s.dtype);g=n.makeTensorInfo(b,s.dtype);const C=n.texData.get(g.dataId);C.values=x}else g=t1e(h,y,b,n);return d&&n.disposeIntermediateTensorInfo(h),g}const n1e={kernelName:_R,backendName:"webgl",kernelFunc:S6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=iS+`
  return max(a, b);
`,s1e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ll+`
  return result;
`,i1e=$n({opSnippet:r1e,packedOpSnippet:s1e,cpuKernelImpl:lfe}),o1e={kernelName:IR,backendName:"webgl",kernelFunc:i1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Yh(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:u}=r,l=1;R(Hr(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=El(s.shape,i,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&qt(c.inShape,c.outShape))return Gr({inputs:{x:s},backend:n});const d=new _h(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const u1e={kernelName:kR,backendName:"webgl",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:u,dimRoundingMode:l}=r,c=[1,1,1],d=Uh(s.shape,i,o,c,a,l,u),f=new aS(d,"max",!1);return n.runWebGLProgram(f,[s],s.dtype)}const c1e={kernelName:RR,backendName:"webgl",kernelFunc:l1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d1e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,u=o-1-e.padInfo.left,l=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class f1e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=u-1-e.padInfo.front,f=l-1-e.padInfo.top,h=c-1-e.padInfo.left,p=u*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,d=[1,1,1],f=Uh(o.shape,a,u,d,l,c),h=new aS(f,"max",!0),p=n.runWebGLProgram(h,[o],o.dtype),y=new f1e(f),b=n.runWebGLProgram(y,[s,p],o.dtype);return n.disposeIntermediateTensorInfo(p),b}const p1e={kernelName:xz,backendName:"webgl",kernelFunc:h1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;Yh([i,o],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:d}=r,f=El(a.shape,u,l,1,c,d),h=!0,p=new _h(f,"max",h),y=n.runWebGLProgram(p,[a],a.dtype),b=new d1e(f),g=n.runWebGLProgram(b,[s,y],a.dtype);return n.disposeIntermediateTensorInfo(y),g}const g1e={kernelName:wz,backendName:"webgl",kernelFunc:m1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(t,e,n,r){let s=new _h(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new _h(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1e={kernelName:PR,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,u=n;R(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];R(Hr(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const c=El(r.shape,s,i,l,o),[d,f]=y1e(r,a,c,u);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t,e,n,r){const s=de(e),o=de(t.shape)/s,a=me({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),u=Fl(a,"float32","mean",r),l=me({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e={kernelName:OR,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,u=An(i,r.shape);let l=u;const c=ei(l,a),d=c!=null,f=o.shouldExecuteOnCPU([r]),h=[];let p=r;if(d){if(f){const x=o.texData.get(p.dataId).values,C=new Array(a);for(let N=0;N<C.length;N++)C[N]=r.shape[c[N]];const k=sS(x,r.shape,r.dtype,c,C);p=o.makeTensorInfo(C,r.dtype);const P=o.texData.get(p.dataId);P.values=k}else p=l1(r,c,o);h.push(p),l=ti(l.length,a)}Fi("sum",l,a);const[y,b]=co(p.shape,l);let g=y;s&&(g=ws(y,u));const v=v1e(p,b,g,o);for(const w of h)o.disposeIntermediateTensorInfo(w);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,u=An(i,s.shape);let l=u;const c=ei(l,a);let d=s;c!=null&&(d=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=ti(l.length,s.shape.length)),Fi("min",l,a);const[f,h]=co(d.shape,l),p=de(h),y=me({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),b=Fl(y,y.dtype,"min",n);let g;if(o){const v=ws(f,u);g=me({inputs:{x:b},backend:n,attrs:{shape:v}})}else g=me({inputs:{x:b},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),c!=null&&n.disposeIntermediateTensorInfo(d),g}const S1e={kernelName:DR,backendName:"webgl",kernelFunc:x1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A1e=iS+`
  return min(a, b);
`,E1e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ll+`
  return result;
`,C1e=$n({opSnippet:A1e,packedOpSnippet:E1e,cpuKernelImpl:cfe}),N1e={kernelName:LR,backendName:"webgl",kernelFunc:C1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T1e{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,i=wt(s),o=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),l=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _1e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,y)=>p[0]+e[y]+p[1]);const s=e.length,i=wt(s),o=n.map(p=>p[0]).join(","),a=n.map((p,y)=>p[0]+e[y]).join(","),u=ur("rc",s),l=ur("source",s),c=`${u[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${l.slice(-2).join()})`,f=r==="reflect"?0:1;let h="";if(s===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;h=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${d});
        ${u[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;h=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${d});
        ${u[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${d});
        }
        rc = outputLoc;
        ${u[s-2]} += 1;
        if(${u[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${l.join()}), ${d});
          ${u[s-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${l.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1e=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _1e(r.shape,s,i):new T1e(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},k1e={kernelName:FR,backendName:"webgl",kernelFunc:I1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R1e=`if (b == 0.0) return NAN;
  return mod(a, b);`,P1e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ll+`
  return result;
`,O1e=$n({opSnippet:R1e,packedOpSnippet:P1e}),D1e={kernelName:$R,backendName:"webgl",kernelFunc:O1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L1e{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1e=`
if (a == b) {
  return 1.0;
};
return a / b;`,$1e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,A6=$n({opSnippet:F1e,packedOpSnippet:$1e,checkOutOfBounds:!0}),B1e={kernelName:X3,backendName:"webgl",kernelFunc:A6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HT="return a - b;",E6=$n({opSnippet:HT,packedOpSnippet:HT,supportsComplex:!0,cpuKernelImpl:Rfe}),M1e={kernelName:MP,backendName:"webgl",kernelFunc:E6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=An([i],s.shape),a=S6({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=ws(a.shape,o),l=me({inputs:{x:a},backend:n,attrs:{shape:u}}),c=E6({inputs:{a:s,b:l},backend:n}),d=v6({inputs:{x:c},backend:n}),f=c1({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),h=me({inputs:{x:f},backend:n,attrs:{shape:u}}),p=A6({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}const V1e={kernelName:TP,backendName:"webgl",kernelFunc:C6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,u=a?s:C6({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),l=u.shape[0],c=u.shape[1],d=new L1e(l,c,i),f=[[o]],h=n.runWebGLProgram(d,[u],"int32",f);return a||n.disposeIntermediateTensorInfo(u),h}const z1e={kernelName:BR,backendName:"webgl",kernelFunc:U1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1e=ri+`
  return -x;
`,j1e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function G1e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=ffe(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Ca(r.shape,j1e):s=new no(r.shape,W1e),n.runWebGLProgram(s,[r],r.dtype)}const q1e={kernelName:VR,backendName:"webgl",kernelFunc:G1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H1e=v4;function K1e(t){Ni("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r,l=n.readSync(s.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=H1e(l,c,o,a,u);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const X1e={kernelName:zR,backendName:"webgl",kernelFunc:K1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y1e=w4;function Q1e(t){Ni("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:l}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),{selectedIndices:f,validOutputs:h}=Y1e(c,d,o,a,u,l);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const Z1e={kernelName:WR,backendName:"webgl",kernelFunc:Q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J1e=x4;function eye(t){Ni("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=r,c=n.readSync(s.dataId),d=n.readSync(i.dataId),f=o,h=a,p=u,y=l,{selectedIndices:b,selectedScores:g}=J1e(c,d,f,h,p,y);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const tye={kernelName:jR,backendName:"webgl",kernelFunc:eye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nye{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:u}=r,l=de(s.shape),c=new nye(l,o,a,u),d=me({inputs:{x:s},backend:n,attrs:{shape:[l]}}),f=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);const h=[...s.shape,o],p=me({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),p},sye={kernelName:qR,backendName:"webgl",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Zh({inputs:{input:r},backend:n}),i=J0({inputs:{x:s},backend:n}),o=d1({inputs:{input:r},backend:n}),a=J0({inputs:{x:o},backend:n}),u=tu({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return Jh({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const iye={kernelName:HP,backendName:"webgl",kernelFunc:J0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Zh({inputs:{input:r},backend:n}),i=N6({inputs:{x:s},backend:n}),o=d1({inputs:{input:r},backend:n}),a=J0({inputs:{x:o},backend:n}),u=tu({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return Jh({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const oye={kernelName:GR,backendName:"webgl",kernelFunc:N6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aye(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return vw({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{ys(i,c.shape,"All tensors passed to stack must have matching shapes"),R(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=e.map(c=>{const d=vw({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),l=d6({inputs:u,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),l}const uye={kernelName:HR,backendName:"webgl",kernelFunc:aye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lye{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((l,c)=>l[0]+e[c]+l[1]);const s=e.length,i=wt(s),o=n.map(l=>l[0]).join(","),a=n.map((l,c)=>l[0]+e[c]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cye{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,b)=>y[0]+e[b]+y[1]);const s=e.length,i=wt(s),o=n.map(y=>y[0]).join(","),a=n.map((y,b)=>y[0]+e[b]).join(","),u=ur("rc",s),l=ur("source",s),c=`${u[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${l.slice(-2).join()})`,f=[`${i} rc = outputLoc;`,`${u[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${u[s-2]} += 1;
       if(${u[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${u[s-1]} += 1;
         if(${c}) {`],h=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let y=0,b=s===1?2:4;y<b;y++)p+=`
        ${f[y]}
        if (${h}) {
          result[${y}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${y}] = getChannel(getX(${l.join()}), ${d});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(de(s.shape)===0){const l=i.map((c,d)=>c[0]+s.shape[d]+c[1]);return Jh({backend:n,attrs:{shape:l,value:o,dtype:s.dtype}})}const a=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cye(s.shape,i,o):new lye(s.shape,i,o),u=[[o]];return n.runWebGLProgram(a,[s],s.dtype,u)},dye={kernelName:KR,backendName:"webgl",kernelFunc:T6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fye=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,hye=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ll+`
  return result;
`,pye=$n({opSnippet:fye,packedOpSnippet:hye}),mye={kernelName:XR,backendName:"webgl",kernelFunc:pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,u=[],l=An(i,s.shape);let c=l;const d=ei(c,a);let f=s;d!=null&&(f=cr({inputs:{x:s},backend:n,attrs:{perm:d}}),c=ti(c.length,a),u.push(f)),Fi("prod",c,a);let h;if(n.shouldExecuteOnCPU([f])){const p=n.texData.get(f.dataId).values,{outVals:y,outShape:b,outDtype:g}=pfe(f.shape,f.dtype,p,c);h=n.makeTensorInfo(b,g,y)}else{const[p,y]=co(f.shape,c),b=de(y),g=me({inputs:{x:f},backend:n,attrs:{shape:[-1,b]}}),v=Mx(s.dtype),w=Fl(g,v,"prod",n);h=me({inputs:{x:w},backend:n,attrs:{shape:p}}),u.push(g),u.push(w)}if(o){u.push(h);const p=ws(h.shape,l);h=me({inputs:{x:h},backend:n,attrs:{shape:p}})}return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const yye={kernelName:QR,backendName:"webgl",kernelFunc:gye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bye(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,u=s.map(g=>n.readSync(g.dataId)),l=s.map(g=>g.shape),c=n.readSync(i.dataId),d=n.readSync(o.dataId),[f,h,p]=mfe(u,l,c,i.shape,i.dtype,d,o.shape,a),y=f.map(g=>n.makeTensorInfo([g.length],"int32",g)),b=n.makeTensorInfo(p,i.dtype,h);return y.concat([b])}const vye={kernelName:ZR,backendName:"webgl",kernelFunc:bye};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wye(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),u=n.readSync(i.dataId),[l,c]=gfe(o,r.shape,r.dtype,a,s.shape,u,i.shape),d=n.makeTensorInfo([l.length],"int32",l),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const xye={kernelName:JR,backendName:"webgl",kernelFunc:wye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:u}=r,l=n.readSync(s.dataId),c=n.readSync(i.dataId),d=n.readSync(o.dataId),f=a.map(b=>n.readSync(b.dataId)),h=a.map(b=>b.shape),[p,y]=yfe(l,s.shape,c,i.shape,i.dtype,d,o.shape,f,h,u);return n.makeTensorInfo(p,i.dtype,y)}const Aye={kernelName:eP,backendName:"webgl",kernelFunc:Sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _6=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=bfe(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},Eye={kernelName:tP,backendName:"webgl",kernelFunc:_6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cye="return 1.0 / x;",Nye=rt({opSnippet:Cye}),Tye={kernelName:rP,backendName:"webgl",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ye=ri+`
  return (x < 0.0) ? 0.0 : x;
`,Iye=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kye=rt({opSnippet:_ye,packedOpSnippet:Iye}),Rye={kernelName:sP,backendName:"webgl",kernelFunc:kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pye=ri+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Oye=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dye=rt({opSnippet:Pye,packedOpSnippet:Oye}),Lye={kernelName:uP,backendName:"webgl",kernelFunc:Dye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fye{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=e;this.outputShape=[o,n,r,l];const c=[s&&n>1?a-1:a,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;i?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ye{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=e;this.outputShape=[o,n,r,l];const c=[s&&n>1?a-1:a,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;i?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[u,l]=a,c=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $ye(s.shape,u,l,i,o):new Fye(s.shape,u,l,i,o);return n.runWebGLProgram(c,[s],"float32")}const Mye={kernelName:aP,backendName:"webgl",kernelFunc:Bye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vye{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,u=[r&&o>1?s-1:s,r&&a>1?i-1:i],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],d=u[1]/l[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,y=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Vye(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const zye={kernelName:Az,backendName:"webgl",kernelFunc:Uye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wye{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=e;this.outputShape=[o,n,r,l];const c=[s&&n>1?a-1:a,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;i?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jye{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=e;this.outputShape=[o,n,r,l];const c=[s&&n>1?a-1:a,s&&r>1?u-1:u],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;i?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[u,l]=a,c=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new jye(s.shape,u,l,i,o):new Wye(s.shape,u,l,i,o);return n.runWebGLProgram(c,[s],s.dtype)}const qye={kernelName:oP,backendName:"webgl",kernelFunc:Gye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hye{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,u=[r&&o>1?s-1:s,r&&a>1?i-1:i],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],d=u[1]/l[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,y=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new Hye(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const Xye={kernelName:Sz,backendName:"webgl",kernelFunc:Kye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yye{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,u)=>s(u)).join(","),o=wt(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qye{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=ur("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=wt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(s.slice())};
          if(${i}){
            result.g = ${l(s.slice())};
          }
          if(${o}) {
            result.b = ${c(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(p){return f(p)}function l(p){return p[r-1]="("+p[r-1]+" + 1)",f(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",f(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",f(p)}function f(p){const y=e.map((v,w)=>h(w,p)),b=y.join(","),g=y.slice(-2).join(",");return`getChannel(getX(${b}), vec2(${g}))`}function h(p,y){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${y[p]} - 1`:`${y[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=An(i,s.shape);if(o===0)return Gr({inputs:{x:s},backend:n});const u=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Qye(s.shape,a):new Yye(s.shape,a);return n.runWebGLProgram(u,[s],s.dtype)}const Jye={kernelName:lP,backendName:"webgl",kernelFunc:Zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ebe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tbe={kernelName:XP,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,u=new ebe(r.shape,i),[l,c]=H4(o,r.shape[1],r.shape[2]),d=[[l,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(u,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nbe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,rbe=rt({opSnippet:nbe}),sbe={kernelName:cP,backendName:"webgl",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ibe="return inversesqrt(x);",obe=rt({opSnippet:ibe,cpuKernelImpl:vfe}),abe={kernelName:dP,backendName:"webgl",kernelFunc:obe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uS{constructor(e,n,r,s,i,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=wt(i.length),c=wt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let y="";u&&(y="coords[0], coords[1]");const b=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${b}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ube{constructor(e,n,r,s,i,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const l=wt(i.length),c=wt(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let y="";u&&(y="coords[0], coords[1]");const b=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${b}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:d}=Dg(i,s,o),f=[d/l,l];if(d===0)return n.makeTensorInfo(o,s.dtype);const h=me({inputs:{x:s},backend:n,attrs:{shape:[u,a]}}),p=me({inputs:{x:i},backend:n,attrs:{shape:[u,l]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0]));let b;X().getBool("WEBGL_PACK")?b=new ube(u,a,h.shape.length,p.shape.length,c,f):b=new uS(u,a,h.shape.length,p.shape.length,c,f);const g=n.runWebGLProgram(b,[p,h,y],p.dtype),v=me({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),v}const cbe={kernelName:fP,backendName:"webgl",kernelFunc:lbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dbe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=X().getNumber("WEBGL_VERSION")===2?i:o,u=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fbe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new dbe(s.shape[0],s.shape[1],i.shape[1],o),u=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",u)}const hbe={kernelName:pP,backendName:"webgl",kernelFunc:fbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pbe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[];for(let c=0;c<n.length;c++)l.push(`${a[c]}`),c<e&&u.push(`${a[c]}`);s=u.join(),i=l.join()}const o=wt(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new pbe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],uo(s.dtype,i.dtype))}const gbe={kernelName:mP,backendName:"webgl",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Y4};
  float scale = ${Q4};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,bbe=rt({opSnippet:ybe}),vbe={kernelName:gP,backendName:"webgl",kernelFunc:bbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe=Od+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,xbe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Sbe=rt({opSnippet:wbe,packedOpSnippet:xbe,cpuKernelImpl:xfe}),Abe={kernelName:xP,backendName:"webgl",kernelFunc:Sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ebe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Cbe=rt({opSnippet:Ebe}),Nbe={kernelName:wP,backendName:"webgl",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbe=Od+`
  return sin(x);
`,_be=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Ll}
  return result;
`,Ibe=rt({opSnippet:Tbe,packedOpSnippet:_be}),kbe={kernelName:bP,backendName:"webgl",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rbe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Pbe=rt({opSnippet:Rbe}),Obe={kernelName:vP,backendName:"webgl",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Lbe=rt({opSnippet:Dbe}),Fbe={kernelName:SP,backendName:"webgl",kernelFunc:Lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $be=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;R(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((g,v)=>g*v),u=[[0,0]];u.push(...o);for(let g=1+i.length;g<s.shape.length;++g)u.push([0,0]);const l=[],c=T6({inputs:{x:s},backend:n,attrs:{paddings:u,constantValue:0}}),d=m2(c.shape,i,a,!1),f=g2(d.length,i.length,!1),h=y2(c.shape,i,a,!1),p=me({inputs:{x:c},backend:n,attrs:{shape:d}}),y=cr({inputs:{x:p},backend:n,attrs:{perm:f}}),b=me({inputs:{x:y},backend:n,attrs:{shape:h}});return l.push(c),l.push(p),l.push(y),l.forEach(g=>n.disposeIntermediateTensorInfo(g)),b},Bbe={kernelName:CP,backendName:"webgl",kernelFunc:$be};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),u=n.readSync(s.dataId),l=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[d,f,h,p,y]=Afe(a,r.shape,r.dtype,u,s.dtype,l,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(b=>Number(b)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const Vbe={kernelName:_P,backendName:"webgl",kernelFunc:Mbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),[l,c,d]=Efe(a,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const zbe={kernelName:IP,backendName:"webgl",kernelFunc:Ube};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),u=n.readSync(i.dataId),[l,c]=ZF(o,r.shape,r.dtype,a,u,!0);return n.makeTensorInfo(c,r.dtype,l)}const jbe={kernelName:kP,backendName:"webgl",kernelFunc:Wbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),u=n.readSync(i.dataId),[l,c]=ZF(o,r.shape,r.dtype,a,u);return n.makeTensorInfo(c,r.dtype,l)}const qbe={kernelName:RP,backendName:"webgl",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:d,outputSize:f}=Dg(i,s,a),h=!1;if(i.dtype==="string"){const g=n.bufferSync(s),v=n.bufferSync(i),w=td(n.readSync(o.dataId)[0]),x=wfe(g,v,a,f,c,l,u,d,w,h);return n.makeTensorInfo(a,x.dtype,x.values)}const p=new uS(l,u,s.shape.length,i.shape.length,d,[f,1],h),y=n.runWebGLProgram(p,[i,s,o],i.dtype),b=me({inputs:{x:y},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(y),b}const Kbe={kernelName:PP,backendName:"webgl",kernelFunc:Hbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=An(o,s.shape)[0],u=lD(s,i,a),l=s.shape.length,c=new Array(l).fill(0),d=s.shape.slice();return u.map(f=>{const h=[...d];h[a]=f;const p=Dd({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});return c[a]+=f,p})}const Ybe={kernelName:NP,backendName:"webgl",kernelFunc:Xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KT="return sqrt(x);",Qbe=rt({opSnippet:KT,packedOpSnippet:KT,cpuKernelImpl:Cfe}),Zbe={kernelName:AP,backendName:"webgl",kernelFunc:Qbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jbe="return x * x;",eve=rt({opSnippet:Jbe}),tve={kernelName:Ez,backendName:"webgl",kernelFunc:eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XT="return (a - b) * (a - b);",nve=$n({opSnippet:XT,packedOpSnippet:XT}),rve={kernelName:OP,backendName:"webgl",kernelFunc:nve};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=id(i),a=Nfe(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const ive={kernelName:DP,backendName:"webgl",kernelFunc:sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=ri+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new no(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const ave={kernelName:KP,backendName:"webgl",kernelFunc:ove};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uve{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=wt(r.length),o=wt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let u=0;a=r.map((l,c)=>(u++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${u-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:y,sliceDim0:b,isSimpleSlice:g,begin:v,end:w,strides:x}=U4(s.shape,i,o,a,u,l,c,d,f);let C;if(y)C=me({inputs:{x:s},backend:n,attrs:{shape:p}});else if(b||g){R(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const P=R4(v,w,x),N=Dd({inputs:{x:s},backend:n,attrs:{begin:v,size:P}});C=me({inputs:{x:N},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(N)}else if(n.shouldExecuteOnCPU([s])){const N=n.readSync(s.dataId),$=Ht(s.shape,s.dtype,N),U=Tfe(h,$,x,v);C=n.makeTensorInfo(p,s.dtype,U.values)}else{const N=new uve(v,x,h);C=n.runWebGLProgram(N,[s],s.dtype)}const k=me({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(C),k}const cve={kernelName:LP,backendName:"webgl",kernelFunc:lve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,y]=_fe(f,h,s,i,o,a,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",y)]}const fve={kernelName:FP,backendName:"webgl",kernelFunc:dve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[l,c,d]=Ife(a,u,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",l),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const pve={kernelName:$P,backendName:"webgl",kernelFunc:hve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=kfe(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const gve={kernelName:BP,backendName:"webgl",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve="return tan(x);",bve=rt({opSnippet:yve}),vve={kernelName:VP,backendName:"webgl",kernelFunc:bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wve=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,xve=rt({opSnippet:wve}),Sve={kernelName:UP,backendName:"webgl",kernelFunc:xve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:d}=Dg(o,i,s.shape),f=[d/l,l];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const h=me({inputs:{x:i},backend:n,attrs:{shape:[u,a]}}),p=me({inputs:{x:o},backend:n,attrs:{shape:[u,l]}}),y=me({inputs:{x:s},backend:n,attrs:{shape:f}}),b=new uS(u,a,h.shape.length,p.shape.length,c,f,!1,!0),g=n.runWebGLProgram(b,[p,h,y],y.dtype),v=me({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),v}const Eve={kernelName:hP,backendName:"webgl",kernelFunc:Ave};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cve{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=wt(this.rank),i=Nve(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function Nve(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const u=n.readSync(s.dataId),l=s.dtype==="string"?u.map(f=>td(f)):u,c=Ht(s.shape,s.dtype,l),d=Pfe(c,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new Cve(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const Tve={kernelName:$x,backendName:"webgl",kernelFunc:I6};class _ve{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Ive{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tu(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function YT(t){let e=1;for(;e<t;)e*=2;return e}function kve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=X().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=X().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=s.shape,c=l[l.length-1];if(n.shouldExecuteOnCPU([s])||c<a||i>u){const U=n.readSync(s.dataId),[K,Z]=Ofe(U,l,s.dtype,i,o);return[n.makeTensorInfo(K.shape,K.dtype,K.values),n.makeTensorInfo(Z.shape,Z.dtype,Z.values)]}if(i===0)return l[l.length-1]=0,[n.makeTensorInfo(l,s.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(c===1)return[s,Jh({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),f=d!==null&&d.isPacked,h=f?n.unpackTensor(s):s,y=de(l)/c,b=me({inputs:{x:h},attrs:{shape:[y,c]},backend:n});f&&Tu(n,h);const g=YT(i),v=YT(c);let w=null;const x=()=>w===null?[b,b]:[b,w],C=(U,K,Z)=>{const ie=x(),ee=new _ve(Z),M=[[c],[w===null?1:0],[Number.NEGATIVE_INFINITY],[U],[K]],O=w;w=n.runWebGLProgram(ee,ie,"int32",M),Tu(n,O)};for(let U=1;U<g;U*=2){const K=U*2;for(let Z=U;Z>=1;Z/=2)C(K,Z,[y,v])}for(let U=v;U>g;U/=2){const K=x(),Z=new Ive([y,U/2]),ee=[[c],[w===null?1:0],[g]],j=w;w=n.runWebGLProgram(Z,K,"int32",ee),Tu(n,j);const M=g/2,O=M*2;for(let D=M;D>=1;D/=2)C(O,D,w.shape)}let k=w;w=Dd({inputs:{x:w},backend:n,attrs:{begin:0,size:[y,i]}}),Tu(n,k);let P=x6({inputs:{x:b,indices:w},backend:n,attrs:{axis:1,batchDims:1}});Tu(n,b);const N=l.slice(0,-1);N.push(i),k=w,w=me({inputs:{x:w},attrs:{shape:N},backend:n}),Tu(n,k);const $=P;return P=me({inputs:{x:P},attrs:{shape:N},backend:n}),Tu(n,$),[P,w]}const Rve={kernelName:zP,backendName:"webgl",kernelFunc:kve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pve{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let u;switch(s){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:u,outputShape:l}=r,[c,d,f,h]=s.shape,[p,y]=l??[d,f],b=[c,p,y,h],g=new Pve(d,f,o,a,u,b);return n.runWebGLProgram(g,[s,i],"float32")}const Dve={kernelName:WP,backendName:"webgl",kernelFunc:Ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Yh(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:u,indices:l}=Dfe(o,s,i.shape,i.dtype);return[r.makeTensorInfo(u,i.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const Fve={kernelName:jP,backendName:"webgl",kernelFunc:Lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,u=s.shape[i],l=new Array(a-1);let c=0;for(let y=0;y<a;y++)y!==i&&(l[c++]=o.shape[y]);const d=[],f=new Array(a).fill(0),h=o.shape.slice();h[i]=1;const p=new Array(u);for(let y=0;y<p.length;y++){f[i]=y;const b=Dd({inputs:{x:o},backend:n,attrs:{begin:f,size:h}}),g=me({inputs:{x:b},backend:n,attrs:{shape:l}});p[y]=g,d.push(b)}return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),p}const Bve={kernelName:GP,backendName:"webgl",kernelFunc:$ve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mve{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const u="0.0",l="sumValue",c=Math.floor(r/4)*4,d=r%4,f=`
        sumValue += dot(values, segFilter);
    `;let h="";i%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,u=[];let l=0;const c=ei([l],a);let d=s;c!=null&&(d=cr({inputs:{x:s},backend:n,attrs:{perm:c}}),u.push(d),l=ti(1,a)[0]);const f=SD(d.shape,l,o),h=de([d.shape[l]]),p=me({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});u.push(p);const y=Mx(s.dtype),b=(x,C,k,P,N)=>{const $=x.shape[0],U=x.shape[1],K=xD(U,N),Z={windowSize:K,inSize:U,batchSize:$,numSegments:N},ie=new Mve(Z,C),ee=n.compileAndRun(ie,[x,k],P);if(u.push(ee),ee.shape[1]===N)return ee;const j=_6({backend:n,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),M=I6({inputs:{x:j},backend:n,attrs:{reps:[U/K]}});return u.push(j),u.push(M),b(ee,C,M,P,N)},g=b(p,"unsortedSegmentSum",i,y,o),v=me({inputs:{x:g},backend:n,attrs:{shape:f}});let w=v;if(c!=null){u.push(v);const x=qx(c);w=cr({inputs:{x:w},backend:n,attrs:{perm:x}})}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),w}const Uve={kernelName:qP,backendName:"webgl",kernelFunc:Vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zve=[Che,The,khe,Ohe,Lhe,Bhe,Vhe,zhe,qhe,Khe,Qhe,epe,rpe,ape,cpe,fpe,ppe,bpe,wpe,Spe,Npe,Ope,Lpe,Mpe,Upe,Hpe,Xpe,Jpe,uhe,nme,ame,dme,yme,wme,Sme,Eme,Nme,kme,Ome,Fme,Bme,Vme,zme,Gme,Hme,Qme,Jme,n0e,i0e,a0e,d0e,m0e,v0e,S0e,C0e,N0e,_0e,k0e,P0e,D0e,F0e,V0e,W0e,q0e,K0e,Q0e,ege,sge,uge,ahe,cge,ime,hge,gge,vge,che,Age,Tge,Ige,Oge,Fge,Vge,Wge,Hge,Qge,e1e,n1e,o1e,u1e,c1e,p1e,g1e,b1e,w1e,S1e,N1e,k1e,D1e,z1e,hhe,q1e,X1e,Z1e,tye,Wpe,sye,oye,uye,dye,mye,fhe,yye,vye,xye,Aye,Eye,jpe,B1e,Tye,Rye,Lye,mhe,Mye,zye,qye,Xye,Jye,tbe,sbe,abe,cbe,hbe,gbe,vbe,Abe,Nbe,kbe,Obe,Rpe,V1e,Fbe,Bbe,Vbe,zbe,jbe,qbe,Kbe,Ybe,Zbe,tve,rve,ive,ave,cve,fve,pve,gve,M1e,She,vve,Sve,Eve,Tve,Rve,Dve,Ahe,Fve,Bve,Uve,iye];for(const t of zve)Tz(t);const Wve=()=>{const t=Zs(),e=wg(),n=Xo().token,[r,s]=L.useState(!0),i=L.useRef(),o=L.useRef(),a={piecesModelRef:i,xcornersModelRef:o};return L.useEffect(()=>{n===""&&KU(e,t),s(!1)},[]),_.jsx(_.Fragment,{children:!r&&_.jsx(l5,{context:a})})};var k6,QT=Lh;k6=QT.createRoot,QT.hydrateRoot;var lS="persist:",cS="persist/FLUSH",f1="persist/REHYDRATE",dS="persist/PAUSE",fS="persist/PERSIST",hS="persist/PURGE",pS="persist/REGISTER",jve=-1;function Vm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vm=function(n){return typeof n}:Vm=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Vm(t)}function ZT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Gve(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZT(n,!0).forEach(function(r){qve(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZT(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hve(t,e,n,r){r.debug;var s=Gve({},n);return t&&Vm(t)==="object"&&Object.keys(t).forEach(function(i){i!=="_persist"&&e[i]===n[i]&&(s[i]=t[i])}),s}function Kve(t){var e=t.blacklist||null,n=t.whitelist||null,r=t.transforms||[],s=t.throttle||0,i="".concat(t.keyPrefix!==void 0?t.keyPrefix:lS).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(C){return C}:typeof t.serialize=="function"?a=t.serialize:a=Xve;var u=t.writeFailHandler||null,l={},c={},d=[],f=null,h=null,p=function(C){Object.keys(C).forEach(function(k){g(k)&&l[k]!==C[k]&&d.indexOf(k)===-1&&d.push(k)}),Object.keys(l).forEach(function(k){C[k]===void 0&&g(k)&&d.indexOf(k)===-1&&l[k]!==void 0&&d.push(k)}),f===null&&(f=setInterval(y,s)),l=C};function y(){if(d.length===0){f&&clearInterval(f),f=null;return}var x=d.shift(),C=r.reduce(function(k,P){return P.in(k,x,l)},l[x]);if(C!==void 0)try{c[x]=a(C)}catch(k){console.error("redux-persist/createPersistoid: error serializing state",k)}else delete c[x];d.length===0&&b()}function b(){Object.keys(c).forEach(function(x){l[x]===void 0&&delete c[x]}),h=o.setItem(i,a(c)).catch(v)}function g(x){return!(n&&n.indexOf(x)===-1&&x!=="_persist"||e&&e.indexOf(x)!==-1)}function v(x){u&&u(x)}var w=function(){for(;d.length!==0;)y();return h||Promise.resolve()};return{update:p,flush:w}}function Xve(t){return JSON.stringify(t)}function Yve(t){var e=t.transforms||[],n="".concat(t.keyPrefix!==void 0?t.keyPrefix:lS).concat(t.key),r=t.storage;t.debug;var s;return t.deserialize===!1?s=function(o){return o}:typeof t.deserialize=="function"?s=t.deserialize:s=Qve,r.getItem(n).then(function(i){if(i)try{var o={},a=s(i);return Object.keys(a).forEach(function(u){o[u]=e.reduceRight(function(l,c){return c.out(l,u,a)},s(a[u]))}),o}catch(u){throw u}else return})}function Qve(t){return JSON.parse(t)}function Zve(t){var e=t.storage,n="".concat(t.keyPrefix!==void 0?t.keyPrefix:lS).concat(t.key);return e.removeItem(n,Jve)}function Jve(t){}function JT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function No(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JT(n,!0).forEach(function(r){ewe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JT(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ewe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function twe(t,e){if(t==null)return{};var n=nwe(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function nwe(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var rwe=5e3;function swe(t,e){var n=t.version!==void 0?t.version:jve;t.debug;var r=t.stateReconciler===void 0?Hve:t.stateReconciler,s=t.getStoredState||Yve,i=t.timeout!==void 0?t.timeout:rwe,o=null,a=!1,u=!0,l=function(d){return d._persist.rehydrated&&o&&!u&&o.update(d),d};return function(c,d){var f=c||{},h=f._persist,p=twe(f,["_persist"]),y=p;if(d.type===fS){var b=!1,g=function(N,$){b||(d.rehydrate(t.key,N,$),b=!0)};if(i&&setTimeout(function(){!b&&g(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},i),u=!1,o||(o=Kve(t)),h)return No({},e(y,d),{_persist:h});if(typeof d.rehydrate!="function"||typeof d.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return d.register(t.key),s(t).then(function(P){var N=t.migrate||function($,U){return Promise.resolve($)};N(P,n).then(function($){g($)},function($){g(void 0,$)})},function(P){g(void 0,P)}),No({},e(y,d),{_persist:{version:n,rehydrated:!1}})}else{if(d.type===hS)return a=!0,d.result(Zve(t)),No({},e(y,d),{_persist:h});if(d.type===cS)return d.result(o&&o.flush()),No({},e(y,d),{_persist:h});if(d.type===dS)u=!0;else if(d.type===f1){if(a)return No({},y,{_persist:No({},h,{rehydrated:!0})});if(d.key===t.key){var v=e(y,d),w=d.payload,x=r!==!1&&w!==void 0?r(w,c,v,t):v,C=No({},x,{_persist:No({},h,{rehydrated:!0})});return l(C)}}}if(!h)return e(c,d);var k=e(y,d);return k===y?c:l(No({},k,{_persist:h}))}}function e_(t){return awe(t)||owe(t)||iwe()}function iwe(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function owe(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function awe(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function t_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function ww(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?t_(n,!0).forEach(function(r){uwe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):t_(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uwe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var R6={registry:[],bootstrapped:!1},lwe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:R6,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case pS:return ww({},e,{registry:[].concat(e_(e.registry),[n.key])});case f1:var r=e.registry.indexOf(n.key),s=e_(e.registry);return s.splice(r,1),ww({},e,{registry:s,bootstrapped:s.length===0});default:return e}};function cwe(t,e,n){var r=Ax(lwe,R6,void 0),s=function(u){r.dispatch({type:pS,key:u})},i=function(u,l,c){var d={type:f1,payload:l,err:c,key:u};t.dispatch(d),r.dispatch(d)},o=ww({},r,{purge:function(){var u=[];return t.dispatch({type:hS,result:function(c){u.push(c)}}),Promise.all(u)},flush:function(){var u=[];return t.dispatch({type:cS,result:function(c){u.push(c)}}),Promise.all(u)},pause:function(){t.dispatch({type:dS})},persist:function(){t.dispatch({type:fS,register:s,rehydrate:i})}});return o.persist(),o}var mS={},gS={};gS.__esModule=!0;gS.default=hwe;function Um(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Um=function(n){return typeof n}:Um=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Um(t)}function ub(){}var dwe={getItem:ub,setItem:ub,removeItem:ub};function fwe(t){if((typeof self>"u"?"undefined":Um(self))!=="object"||!(t in self))return!1;try{var e=self[t],n="redux-persist ".concat(t," test");e.setItem(n,"test"),e.getItem(n),e.removeItem(n)}catch{return!1}return!0}function hwe(t){var e="".concat(t,"Storage");return fwe(e)?self[e]:dwe}mS.__esModule=!0;mS.default=gwe;var pwe=mwe(gS);function mwe(t){return t&&t.__esModule?t:{default:t}}function gwe(t){var e=(0,pwe.default)(t);return{getItem:function(r){return new Promise(function(s,i){s(e.getItem(r))})},setItem:function(r,s){return new Promise(function(i,o){i(e.setItem(r,s))})},removeItem:function(r){return new Promise(function(s,i){s(e.removeItem(r))})}}}var P6=void 0,ywe=bwe(mS);function bwe(t){return t&&t.__esModule?t:{default:t}}var vwe=(0,ywe.default)("local");P6=vwe;const wwe=Fk({game:GJ,corners:gJ,user:OU}),xwe={key:"root",version:1,storage:P6,blacklist:[]},Swe=swe(xwe,wwe),O6=X5({reducer:Swe,middleware:t=>t({serializableCheck:{ignoredActions:[cS,f1,dS,fS,hS,pS]}})});function zm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zm=function(n){return typeof n}:zm=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},zm(t)}function Awe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ewe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cwe(t,e,n){return e&&Ewe(t.prototype,e),t}function Nwe(t,e){return e&&(zm(e)==="object"||typeof e=="function")?e:Wm(t)}function xw(t){return xw=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},xw(t)}function Wm(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Twe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sw(t,e)}function Sw(t,e){return Sw=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},Sw(t,e)}function jm(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var D6=function(t){Twe(e,t);function e(){var n,r;Awe(this,e);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=Nwe(this,(n=xw(e)).call.apply(n,[this].concat(i))),jm(Wm(r),"state",{bootstrapped:!1}),jm(Wm(r),"_unsubscribe",void 0),jm(Wm(r),"handlePersistorState",function(){var a=r.props.persistor,u=a.getState(),l=u.bootstrapped;l&&(r.props.onBeforeLift?Promise.resolve(r.props.onBeforeLift()).finally(function(){return r.setState({bootstrapped:!0})}):r.setState({bootstrapped:!0}),r._unsubscribe&&r._unsubscribe())}),r}return Cwe(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(L.PureComponent);jm(D6,"defaultProps",{children:null,loading:null});const _we="modulepreload",Iwe=function(t){return"/"+t},n_={},kwe=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(n.map(a=>{if(a=Iwe(a),a in n_)return;n_[a]=!0;const u=a.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${l}`))return;const c=document.createElement("link");if(c.rel=u?"stylesheet":_we,u||(c.as="script",c.crossOrigin=""),c.href=a,o&&c.setAttribute("nonce",o),document.head.appendChild(c),u)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};function Rwe(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,u,l;const c=async(f=!0)=>{await u,await(l==null?void 0:l())};async function d(){if("serviceWorker"in navigator){if(a=await kwe(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-D5gOYdM7.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/sw.js",{scope:"/",type:"classic"})).catch(f=>{o==null||o(f)}),!a)return;l=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let f=!1;const h=()=>{f=!0,a==null||a.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",p=>{typeof p.isUpdate>"u"?typeof p.isExternal<"u"?p.isExternal?h():!f&&(r==null||r()):p.isExternal?window.location.reload():!f&&(r==null||r()):p.isUpdate||r==null||r()}),a.addEventListener("waiting",h),a.addEventListener("externalwaiting",h)}a.register({immediate:e}).then(f=>{i?i("/sw.js",f):s==null||s(f)}).catch(f=>{o==null||o(f)})}}return u=d(),c}const Pwe=Rwe({onNeedRefresh(){confirm("New content available. Reload?")&&(localStorage.clear(),Pwe(!0))}}),Owe=h5([{path:"/",element:_.jsx(Wve,{}),children:[{path:"",element:_.jsx(YU,{})},{path:"/record",element:_.jsx(om,{mode:"record"})},{path:"/upload",element:_.jsx(om,{mode:"upload"})},{path:"/broadcast",element:_.jsx(om,{mode:"broadcast"})},{path:"/play",element:_.jsx(om,{mode:"play"})},{path:"/export",element:_.jsx(Hue,{})},{path:"/privacy",element:_.jsx(Kue,{})}]}]),Dwe=k6(document.getElementById("root")),Lwe=cwe(O6);Dwe.render(_.jsx(TU,{store:O6,children:_.jsx(D6,{persistor:Lwe,children:_.jsx(S5,{router:Owe})})}));
//# sourceMappingURL=index-m2knOmMX.js.map
